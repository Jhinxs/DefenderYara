
rule Trojan_Win32_ModiLoader_HNA_MTB{
	meta:
		description = "Trojan:Win32/ModiLoader.HNA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 06 00 00 "
		
	strings :
		$a_01_0 = {00 00 00 61 72 63 68 69 76 65 5f 77 72 69 74 65 5f 6f 70 65 6e 00 00 61 72 63 68 69 76 65 69 6e 74 00 00 ff ff ff ff } //1
		$a_01_1 = {48 6f 6f 6b 43 61 6c 6c 62 61 63 6b 00 00 00 00 ff ff ff ff 0a 00 00 00 4a 75 73 6d 65 40 5e 5e 5e 40 00 00 } //1
		$a_01_2 = {46 69 72 65 77 61 6c 6c 41 50 49 2e 00 00 00 00 49 63 66 49 73 50 6f 72 74 41 6c 6c 6f 77 65 64 00 00 00 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 } //1
		$a_01_3 = {73 63 72 65 65 6e 70 73 00 00 00 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 00 00 ff ff ff ff 05 00 00 00 73 6d 61 72 74 } //1
		$a_03_4 = {00 42 43 72 79 70 74 00 00 ff ff ff ff 02 00 00 00 56 65 00 00 ff ff ff ff 02 00 00 00 72 69 00 00 ff ff ff ff 02 00 00 00 66 79 00 00 ff ff ff ff 02 00 00 00 ?? ?? 00 } //1
		$a_01_5 = {44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 00 00 ff ff ff ff 03 00 00 00 65 61 6d 00 ff ff ff ff 08 00 00 00 73 63 72 65 65 6e 70 73 00 00 00 00 ff ff ff ff 05 00 00 00 73 6d 61 72 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_03_4  & 1)*1+(#a_01_5  & 1)*1) >=2
 
}
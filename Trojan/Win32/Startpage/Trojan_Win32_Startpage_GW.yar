
rule Trojan_Win32_Startpage_GW{
	meta:
		description = "Trojan:Win32/Startpage.GW,SIGNATURE_TYPE_PEHSTR_EXT,03 00 02 00 03 00 00 "
		
	strings :
		$a_01_0 = {43 4c 53 49 44 5c 7b 38 37 31 43 35 33 38 30 2d 34 32 41 30 2d 31 30 36 39 2d 41 32 45 41 2d 30 38 30 30 32 42 33 30 33 30 39 44 7d 5c 73 68 65 6c 6c 5c 4f 70 65 6e 48 6f 6d 65 50 61 67 65 5c 43 6f 6d 6d 61 6e 64 } //1 CLSID\{871C5380-42A0-1069-A2EA-08002B30309D}\shell\OpenHomePage\Command
		$a_03_1 = {68 04 00 00 80 6a 00 68 ?? ?? ?? ?? 68 04 00 00 80 6a 00 68 ?? ?? ?? ?? 68 01 03 00 80 6a 00 68 01 00 00 00 68 03 00 00 00 bb a4 06 00 00 e8 ?? ?? ?? ?? 83 c4 28 68 05 00 00 80 6a 00 68 ?? ?? ?? ?? 68 04 00 00 80 6a 00 68 ?? ?? ?? ?? 68 02 00 00 00 bb 6c 02 00 00 e8 } //2
		$a_03_2 = {6a 01 6a 00 68 ?? ?? ?? ?? 52 ff d6 8b 4c 24 1c 8d 44 24 28 50 68 ?? ?? ?? ?? 51 ff d7 6a 00 6a 26 8d 54 24 3c 52 6a 00 ff 15 ?? ?? ?? ?? 8b 84 24 48 03 00 00 50 8d 4c 24 38 51 8d 94 24 40 01 00 00 } //2
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*2+(#a_03_2  & 1)*2) >=2
 
}
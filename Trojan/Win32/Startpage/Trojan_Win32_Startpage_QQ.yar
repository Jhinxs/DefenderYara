
rule Trojan_Win32_Startpage_QQ{
	meta:
		description = "Trojan:Win32/Startpage.QQ,SIGNATURE_TYPE_PEHSTR_EXT,06 00 05 00 08 00 00 "
		
	strings :
		$a_01_0 = {5c 7b 65 31 37 64 34 66 63 30 2d 35 35 36 34 2d 31 31 64 31 2d 38 33 66 32 2d 30 30 61 30 63 39 30 64 63 38 34 39 7d 5c 73 68 65 6c 6c 5c c6 f4 b6 af 49 6e 74 65 72 6e 65 74 } //1
		$a_01_1 = {52 75 6e 64 6c 6c 33 32 2e 65 78 65 20 53 68 65 6c 6c 33 32 2e 64 6c 6c 2c 43 6f 6e 74 72 6f 6c 5f 52 75 6e 44 4c 4c 20 49 6e 65 74 63 70 6c 2e 63 70 6c } //1 Rundll32.exe Shell32.dll,Control_RunDLL Inetcpl.cpl
		$a_01_2 = {5c 53 68 65 6c 6c 46 6f 6c 64 65 72 00 48 69 64 65 4f 6e 44 65 73 6b 74 6f 70 50 65 72 55 73 65 72 00 41 74 74 72 69 62 75 74 65 73 00 30 78 30 30 30 30 30 30 30 30 } //1
		$a_01_3 = {5c 41 64 76 61 6e 63 65 64 00 48 69 64 64 65 6e 00 30 78 30 30 30 30 30 30 30 32 } //1
		$a_01_4 = {5c 48 69 64 65 44 65 73 6b 74 6f 70 49 63 6f 6e 73 00 43 6c 61 73 73 69 63 53 74 61 72 74 4d 65 6e 75 00 30 78 30 30 30 30 30 30 30 31 } //1
		$a_01_5 = {5c 50 6f 6c 69 63 69 65 73 5c 45 78 70 6c 6f 72 65 72 00 4e 6f 49 6e 74 65 72 6e 65 74 49 63 6f 6e } //1
		$a_01_6 = {73 68 65 6c 6c 33 32 2e 64 6c 6c 3a 3a 53 48 43 68 61 6e 67 65 4e 6f 74 69 66 79 28 6c 2c 20 6c 2c 20 69 2c 20 69 29 20 76 20 28 30 78 30 38 30 30 30 30 30 30 2c 20 30 2c 20 30 2c 20 30 29 } //1 shell32.dll::SHChangeNotify(l, l, i, i) v (0x08000000, 0, 0, 0)
		$a_01_7 = {43 61 6c 6c 00 6f 70 65 6e 00 68 74 74 70 3a 2f 2f 77 77 77 2e } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=5
 
}
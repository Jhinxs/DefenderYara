
rule Trojan_Win32_Tarifarch_F{
	meta:
		description = "Trojan:Win32/Tarifarch.F,SIGNATURE_TYPE_PEHSTR_EXT,2a 00 2a 00 13 00 00 "
		
	strings :
		$a_01_0 = {52 55 53 53 49 41 4e 5f 43 48 41 52 53 45 54 } //1 RUSSIAN_CHARSET
		$a_01_1 = {73 00 74 00 61 00 72 00 69 00 66 00 66 00 73 00 2e 00 72 00 75 00 } //1 stariffs.ru
		$a_01_2 = {57 00 69 00 6e 00 5a 00 69 00 70 00 20 00 32 00 30 00 } //1 WinZip 20
		$a_01_3 = {2f 00 72 00 65 00 62 00 69 00 6c 00 6c 00 2f 00 72 00 75 00 } //1 /rebill/ru
		$a_11_4 = {8c 2d c6 5c a3 b9 bd 1d 3b 83 e6 74 27 35 3d 07 a7 cb 56 19 be 18 d4 ca 9e 59 53 90 8b 14 0e 01 } //1
		$a_bc_5 = {af fe f0 19 58 fe c1 67 50 f7 c9 4e b4 ac 11 48 46 } //7936
		$a_82_6 = {96 3b 7d 4a 7f f4 2c 01 00 76 01 2f 00 70 00 61 00 72 00 74 00 6e 00 65 00 72 00 5f 00 6e 00 65 00 77 00 5f 00 75 00 72 00 6c 00 3d 00 68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 73 00 74 00 61 00 74 00 2e 00 6f 00 70 00 65 00 6e 00 70 00 61 00 72 00 74 00 2e 00 72 00 75 00 2f 00 6e 00 65 00 77 00 74 00 6f 00 6f 00 6c 00 62 00 61 00 72 00 3f 00 70 00 3d 00 71 00 63 00 61 00 73 00 68 00 01 00 40 01 26 00 67 00 75 00 69 00 64 } //8326
		$a_00_8 = {47 00 55 00 49 00 44 00 26 00 73 00 69 00 67 00 3d 00 24 00 5f 00 5f 00 53 00 49 00 47 00 00 00 00 00 72 00 75 00 6e 00 61 00 73 00 00 00 0a 00 12 01 10 63 6f 6e 66 69 72 6d 61 74 69 6f 6e 43 6f 64 65 24 0a 00 12 01 65 53 75 62 43 66 43 6f 64 65 4b 65 79 50 72 65 73 73 0a 00 12 01 6c } //95
		$a_73_9 = {72 69 70 74 69 6f 6e 53 74 65 70 33 0a 00 16 01 6c 53 77 69 74 63 68 54 6f 4e 6f 72 6d 61 6c 53 6d 73 4d 6f 64 65 0a 00 0c 01 62 74 6e 52 65 62 69 6c 6c 49 6d 67 0a 00 1b 01 6c 53 77 69 74 63 68 54 6f 4e 6f 72 6d 61 6c 53 6d 73 4d 6f 64 65 43 6c 69 63 6b 0a 00 18 01 6c 61 62 65 6c 41 62 6f 6e } //30035
		$a_53_10 = {73 49 6e 66 6f 43 6c 69 63 6b 0a 00 27 01 6c 43 68 6f 6f 73 65 44 69 66 66 65 72 65 6e 74 53 75 62 73 63 72 69 70 74 69 6f 6e 4e 75 6d 62 65 72 43 6c 69 63 6b 0a 00 10 01 6f 6e 53 74 72 61 6e 61 49 7a 6d 65 6e 65 6e 61 0a 00 20 01 62 74 6e 53 75 62 73 63 72 69 70 74 69 6f 6e 43 68 65 63 6b 43 6f 64 65 49 6d 67 4c 61 62 65 6c 0a 00 18 01 63 6f 6e } //28261
		$a_6d_11 = {74 69 6f 6e 43 6f 64 65 4b 65 79 50 72 65 73 73 00 00 5d 04 00 00 c4 02 03 80 5c 23 00 00 c5 02 03 80 00 00 01 00 08 00 0d 00 ac 21 54 61 72 69 66 61 72 63 68 2e 47 00 00 01 40 05 82 70 00 04 00 78 25 01 00 03 00 03 00 05 00 00 02 00 20 11 6d 8c 2d c6 5c a3 b9 bd 1d 3b 83 e6 74 27 35 3d 07 a7 cb 56 19 be 18 d4 ca 9e 59 53 90 8b 14 0e 02 00 } //26982
		$a_00_12 = {67 00 75 00 69 00 64 00 3d 00 24 00 5f 00 5f 00 47 00 55 00 49 00 44 00 26 00 73 00 69 00 67 00 3d 00 24 00 5f 00 } //320 guid=$__GUID&sig=$_
		$a_00_13 = {49 00 47 00 00 00 00 00 72 00 75 00 6e 00 61 00 73 00 00 00 02 00 76 01 2f 00 70 00 61 00 72 00 74 00 6e 00 65 00 72 00 5f 00 6e 00 65 00 77 00 5f 00 75 00 72 00 6c 00 3d 00 68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 73 00 74 00 61 00 74 00 2e 00 6f } //95
		$a_00_15 = {61 00 72 00 74 00 2e 00 72 00 75 00 2f 00 6e 00 65 00 77 00 74 00 6f 00 6f 00 6c 00 62 00 61 00 72 00 3f 00 70 00 3d 00 71 00 63 00 61 00 73 00 68 00 01 00 1a 01 2f 00 72 00 65 00 62 00 69 00 6c 00 6c 00 2f 00 72 00 75 00 6c 00 65 00 73 00 01 00 18 01 6f 6e 4b 65 79 50 72 65 73 73 56 61 6c 69 64 61 74 65 4e 75 6d 62 65 72 00 00 5d 04 } //110
		$a_02_16 = {03 80 5c 23 00 00 c6 02 03 80 00 00 01 00 08 00 0d 00 ac 21 54 61 72 69 66 61 72 63 68 2e 48 00 00 01 40 05 82 70 00 04 00 78 eb 00 00 02 00 02 00 05 00 00 01 00 20 11 6d 8c 2d c6 5c a3 b9 bd 1d 3b 83 e6 74 27 35 3d 07 a7 cb 56 19 be 18 d4 ca 9e 59 53 90 8b 14 0e 01 00 35 01 34 04 3b 04 4f 04 20 00 3f 04 3e 04 34 04 42 04 32 04 35 04 40 04 36 04 34 04 35 04 3d 04 38 04 4f 04 2c 00 20 00 47 04 42 04 3e 04 20 00 12 04 4b 04 20 00 00 01 00 40 01 12 04 4b 04 20 00 34 04 3e 04 3b 04 36 04 3d 04 4b 04 20 00 41 04 3e 04 33 04 3b 04 30 04 41 04 38 04 42 04 4c 04 41 04 4f 04 20 00 41 04 20 00 } //0
		$a_04_17 = {30 04 32 04 38 04 3b 04 30 04 00 00 01 00 26 01 68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 68 00 65 00 6c 00 70 00 70 00 72 00 69 00 63 00 65 00 2e 00 69 00 6e 00 01 00 13 01 20 33 33 33 39 20 } //1087
		$a_66_18 = {20 3a 29 3b 20 4d 54 43 00 00 5d 04 00 00 c6 02 03 80 5c 24 00 00 c7 02 03 80 00 00 01 00 08 00 0e 00 ac 21 54 61 72 69 66 61 72 63 68 2e 41 4b 00 00 01 40 05 82 70 00 04 00 67 16 00 00 ff 6d b2 0c 83 b1 65 05 52 ad cd b4 b6 86 5a 00 01 20 b8 94 a1 74 5d 04 00 00 c7 02 03 80 5c 24 00 00 c8 02 03 80 00 00 01 00 08 } //27680
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_11_4  & 1)*1+(#a_bc_5  & 1)*7936+(#a_82_6  & 1)*8326+(#a_00_8  & 1)*95+(#a_73_9  & 1)*30035+(#a_53_10  & 1)*28261+(#a_6d_11  & 1)*26982+(#a_00_12  & 1)*320+(#a_00_13  & 1)*95+(#a_00_15  & 1)*110+(#a_02_16  & 1)*0+(#a_04_17  & 1)*1087+(#a_66_18  & 1)*27680) >=42
 
}

rule Trojan_Win32_Ramnit_gen_C{
	meta:
		description = "Trojan:Win32/Ramnit.gen!C,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 11 00 00 "
		
	strings :
		$a_00_0 = {00 65 6c 65 76 61 74 65 00 61 64 6d 69 6e 00 } //1
		$a_00_1 = {77 73 63 73 76 63 00 57 69 6e 44 65 66 65 6e 64 00 77 75 61 75 73 65 72 76 00 4d 70 73 53 76 63 00 } //1
		$a_00_2 = {4d 70 73 53 76 63 00 77 73 63 73 76 63 00 57 69 6e 44 65 66 65 6e 64 00 77 75 61 75 73 65 72 76 } //1 灍即捶眀捳癳c楗䑮晥湥d畷畡敳癲
		$a_00_3 = {5c 36 33 31 44 32 34 30 38 44 34 34 43 34 66 34 37 41 43 36 34 37 41 42 39 36 39 38 37 44 34 44 35 00 } //1 㙜ㄳ㉄〴䐸㐴㑃㑦䄷㙃㜴䉁㘹㠹䐷䐴5
		$a_00_4 = {52 61 70 70 6f 72 74 4d 67 6d 74 53 65 72 76 69 63 65 00 4d 69 63 6f 72 73 6f 66 74 20 57 69 6e } //1 慒灰牯䵴浧却牥楶散䴀捩牯潳瑦圠湩
		$a_00_5 = {5c 64 65 6d 65 74 72 61 5c 6c 6f 61 64 65 72 7e 31 5c 64 72 69 76 65 72 73 5c 73 73 64 74 5c } //1 \demetra\loader~1\drivers\ssdt\
		$a_00_6 = {65 78 65 63 00 6b 6f 73 00 73 63 72 65 65 6e 00 75 70 64 61 74 65 00 } //1
		$a_01_7 = {34 35 42 6e 39 39 67 54 00 } //1
		$a_00_8 = {55 41 43 5f 62 79 70 61 73 73 65 64 00 00 00 00 54 52 55 45 00 } //1
		$a_00_9 = {52 61 70 70 6f 72 74 00 00 3a 5a 6f 6e 65 2e 49 64 65 6e 74 69 66 69 65 72 00 63 6f 6e 73 65 6e 74 2e 65 78 65 00 } //1
		$a_00_10 = {22 25 25 77 69 6e 64 69 72 25 25 5c 73 79 73 74 65 6d 33 32 5c 73 64 62 69 6e 73 74 2e 65 78 65 22 20 2f 71 20 2f 75 20 22 25 73 22 00 } //1
		$a_00_11 = {6c 6f 61 64 65 72 2e 65 78 65 00 5f 41 70 70 6c 79 45 78 70 6c 6f 69 74 40 34 00 5f 43 68 65 63 6b 42 79 70 61 73 73 65 64 40 30 00 } //1 潬摡牥攮數开灁汰䕹灸潬瑩㑀开桃捥䉫灹獡敳䁤0
		$a_00_12 = {52 00 65 00 64 00 69 00 72 00 65 00 63 00 74 00 45 00 58 00 45 00 00 00 01 88 52 00 00 00 25 00 74 00 65 00 6d 00 70 00 25 00 5c 00 2e 00 2e 00 5c 00 2e 00 2e 00 5c 00 4c 00 6f 00 63 00 61 00 6c 00 4c 00 6f 00 77 00 5c 00 63 00 6d 00 64 00 2e 00 25 00 75 00 73 00 65 00 72 00 6e 00 61 00 6d 00 65 00 25 00 2e 00 62 00 61 00 74 00 00 00 } //1
		$a_00_13 = {00 43 68 65 63 6b 42 79 70 61 73 73 65 64 20 6f 6b 00 } //1 䌀敨正祂慰獳摥漠k
		$a_00_14 = {25 54 45 4d 50 25 5c 70 2e 65 78 65 00 00 00 00 22 20 25 54 45 4d 50 25 5c 70 2e 65 78 65 00 00 63 6f 70 79 20 2f 62 20 22 00 } //1
		$a_00_15 = {5c 57 69 6e 64 6f 77 73 20 44 65 66 65 6e 64 65 72 5c 45 78 63 6c 75 73 69 6f 6e 73 5c 50 72 6f 63 65 73 73 65 73 20 20 22 20 2f 76 20 73 76 63 68 6f 73 74 2e 65 78 65 20 2f 74 20 20 52 45 47 5f 44 57 4f 52 44 20 2f 64 20 30 } //1 \Windows Defender\Exclusions\Processes  " /v svchost.exe /t  REG_DWORD /d 0
		$a_00_16 = {63 6f 6d 2e 25 73 2e 73 64 62 00 00 25 73 5c 63 6d 64 2e 25 73 2e 62 61 74 00 00 00 75 73 65 72 6e 61 6d 65 00 } //1
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_01_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1+(#a_00_16  & 1)*1) >=2
 
}
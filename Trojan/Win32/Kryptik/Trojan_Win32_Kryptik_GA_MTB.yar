
rule Trojan_Win32_Kryptik_GA_MTB{
	meta:
		description = "Trojan:Win32/Kryptik.GA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 02 00 00 "
		
	strings :
		$a_00_0 = {88 44 24 28 8b 13 8a 44 24 28 8b f1 33 ed 03 f2 8a 16 3a d0 75 1f 8b c7 8b fe 2b 7c 24 2c 84 d2 74 0f 80 38 00 74 } //1
		$a_02_1 = {8b 75 d8 81 fe 00 00 00 01 77 9b c7 05 ?? ?? ?? ?? 50 72 6f 63 c7 05 ?? ?? ?? ?? 65 73 73 33 c7 05 ?? ?? ?? ?? 32 46 69 72 66 c7 05 ?? ?? ?? ?? 73 74 68 ?? ?? ?? ?? 56 e8 } //1
	condition:
		((#a_00_0  & 1)*1+(#a_02_1  & 1)*1) >=2
 
}
rule Trojan_Win32_Kryptik_GA_MTB_2{
	meta:
		description = "Trojan:Win32/Kryptik.GA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_02_0 = {8a 0c 30 a1 ?? ?? ?? ?? 88 0c 30 a1 ?? ?? ?? ?? 3d ?? ?? ?? ?? 75 } //1
		$a_02_1 = {8a 54 19 02 8a 4c 19 03 88 8d ?? ?? ?? ?? 80 e1 ?? c0 e1 ?? 88 95 ?? ?? ?? ?? 88 8d ?? ?? ?? ?? 83 f8 ?? 75 } //1
		$a_02_2 = {24 fc c0 e0 ?? c0 e1 ?? 0a d0 08 8d ?? ?? ?? ?? 88 34 3e 81 3d [0-08] 88 95 ?? ?? ?? ?? 75 } //1
		$a_02_3 = {8b c7 c1 e8 ?? 03 85 ?? ?? ?? ?? 33 c3 33 c2 2b f0 83 [0-06] 75 } //1
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1+(#a_02_3  & 1)*1) >=3
 
}

rule Trojan_Win32_Chksyn_D{
	meta:
		description = "Trojan:Win32/Chksyn.D,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 05 00 00 "
		
	strings :
		$a_03_0 = {74 3c ba 6c 00 00 00 8b 85 ?? ?? ?? ?? 66 89 50 04 b9 6f 00 00 00 8b 95 ?? ?? ?? ?? 66 89 4a 08 b8 73 00 00 00 8b 8d ?? ?? ?? ?? 66 89 41 0c ba 74 00 00 00 } //1
		$a_01_1 = {8a 11 88 10 8b 45 08 83 c0 01 89 45 08 8b 4d 0c 83 c1 01 89 4d 0c 8b 55 10 83 ea 01 89 55 10 75 d9 } //1
		$a_03_2 = {0f be 48 ff 83 f9 3a 75 27 8d 55 f4 52 8b 45 fc 83 c0 01 50 e8 ?? ?? ?? ?? 85 c0 75 13 } //1
		$a_01_3 = {75 6e 3d 25 73 26 76 3d 25 64 26 73 3d 25 64 26 68 3d 25 64 26 6f 3d 25 64 26 77 3d 25 64 26 63 3d 25 64 26 69 70 3d 25 73 26 73 79 73 3d 25 73 26 75 69 64 3d 25 64 26 66 74 70 3d 25 73 } //1 un=%s&v=%d&s=%d&h=%d&o=%d&w=%d&c=%d&ip=%s&sys=%s&uid=%d&ftp=%s
		$a_01_4 = {6d 3d 25 73 26 70 3d 25 73 26 76 3d 25 64 26 62 3d 25 73 26 75 3d 25 64 26 73 3d 25 73 26 68 65 61 64 65 72 73 3d 25 73 } //1 m=%s&p=%s&v=%d&b=%s&u=%d&s=%s&headers=%s
	condition:
		((#a_03_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=3
 
}
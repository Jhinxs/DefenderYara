
rule Trojan_Win32_Emotet_P4{
	meta:
		description = "Trojan:Win32/Emotet.P4,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 09 00 00 "
		
	strings :
		$a_80_0 = {00 52 53 44 53 } //  5
		$a_80_1 = {00 31 2e 70 64 62 00 } //  5
		$a_80_2 = {55 50 52 6b 57 6f 6e 4c 2f 30 4a 62 31 33 4e 44 59 53 61 } //UPRkWonL/0Jb13NDYSa  10
		$a_80_3 = {39 57 31 6a 5a 62 65 69 68 79 26 78 42 5e 74 55 6c 6d 46 } //9W1jZbeihy&xB^tUlmF  10
		$a_00_4 = {89 3d 64 f7 46 00 c7 05 58 f7 46 00 12 00 00 00 c7 05 68 f7 46 00 00 00 00 00 c7 05 60 f7 46 00 00 00 00 00 89 35 5c f7 46 00 01 25 58 f7 46 00 01 2d 68 f7 46 00 01 1d 60 f7 46 00 83 2d 58 f7 46 00 0e c3 } //10
		$a_00_5 = {89 3d c4 df 46 00 c7 05 b8 df 46 00 12 00 00 00 c7 05 c8 df 46 00 00 00 00 00 c7 05 c0 df 46 00 00 00 00 00 89 35 bc df 46 00 01 25 b8 df 46 00 01 2d c8 df 46 00 01 1d c0 df 46 00 83 2d b8 df 46 00 0e c3 } //10
		$a_00_6 = {89 3d 34 fb 46 00 c7 05 28 fb 46 00 12 00 00 00 c7 05 38 fb 46 00 00 00 00 00 c7 05 30 fb 46 00 00 00 00 00 89 35 2c fb 46 00 01 25 28 fb 46 00 01 2d 38 fb 46 00 01 1d 30 fb 46 00 83 2d 28 fb 46 00 0e c3 } //10
		$a_03_7 = {0c 00 00 00 14 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 00 00 00 00 00 00 f0 3f } //10
		$a_00_8 = {8b 44 24 14 f2 0f 2a c0 48 50 } //10
	condition:
		((#a_80_0  & 1)*5+(#a_80_1  & 1)*5+(#a_80_2  & 1)*10+(#a_80_3  & 1)*10+(#a_00_4  & 1)*10+(#a_00_5  & 1)*10+(#a_00_6  & 1)*10+(#a_03_7  & 1)*10+(#a_00_8  & 1)*10) >=30
 
}
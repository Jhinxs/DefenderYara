
rule Trojan_Win32_Emotet_PPP_MTB{
	meta:
		description = "Trojan:Win32/Emotet.PPP!MTB,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 17 00 00 "
		
	strings :
		$a_02_0 = {0f b6 c9 03 c1 99 b9 ?? ?? ?? ?? f7 f9 0f b6 94 15 ?? ?? ?? ?? 30 53 ff } //1
		$a_81_1 = {43 35 58 70 65 6f 7a 53 48 6e 56 63 61 5a 5a 74 71 32 4c 34 65 66 41 34 33 4a 34 6d 67 30 51 32 6f 54 52 54 57 74 46 49 } //1 C5XpeozSHnVcaZZtq2L4efA43J4mg0Q2oTRTWtFI
		$a_02_2 = {0f b6 84 05 ?? ?? ?? ?? 03 c1 b9 ?? ?? ?? ?? 99 f7 f9 8b 45 ?? 8a 8c 15 ?? ?? ?? ?? 30 08 } //1
		$a_81_3 = {34 33 38 6c 6f 37 37 6f 51 59 70 4b 47 36 7a 59 4f 64 72 62 61 6b 50 72 45 6c 4d 6c 54 66 71 36 5a 47 4c 48 50 47 74 58 } //1 438lo77oQYpKG6zYOdrbakPrElMlTfq6ZGLHPGtX
		$a_02_4 = {81 e1 ff 00 00 00 03 c1 b9 ?? ?? ?? ?? 99 f7 f9 8a 03 8a 54 14 ?? 32 c2 88 03 } //1
		$a_81_5 = {79 63 55 77 51 30 69 74 43 47 71 74 4f 70 35 4b 34 76 52 66 49 74 59 6d 4f 39 76 50 44 69 42 66 71 35 39 61 54 44 6f 57 54 78 50 } //1 ycUwQ0itCGqtOp5K4vRfItYmO9vPDiBfq59aTDoWTxP
		$a_02_6 = {0f b6 cb 03 c1 99 b9 ?? ?? ?? ?? f7 f9 8a 5d 00 8b 44 24 ?? 8a 54 14 ?? 32 da 88 5d 00 } //1
		$a_81_7 = {44 4e 33 32 30 66 72 34 5a 64 70 45 78 6e 76 57 51 46 4e 34 30 52 51 72 48 77 62 4b 49 36 77 6d 4f 65 30 43 38 33 73 } //1 DN320fr4ZdpExnvWQFN40RQrHwbKI6wmOe0C83s
		$a_02_8 = {0f b6 8c 05 ?? ?? ?? ?? 0f b6 c3 03 c1 b9 ?? ?? ?? ?? 99 f7 f9 8b 85 ?? ?? ?? ?? 8a 8c 15 ?? ?? ?? ?? 30 08 } //1
		$a_81_9 = {4b 38 35 51 59 4f 37 46 4a 38 7a 70 59 38 6b 35 39 7a 34 4f 7a 42 76 38 57 51 32 49 57 64 35 4b 55 34 70 47 74 } //1 K85QYO7FJ8zpY8k59z4OzBv8WQ2IWd5KU4pGt
		$a_02_10 = {0f b6 8c 05 ?? ?? ?? ?? 0f b6 c3 03 c1 99 b9 ?? ?? ?? ?? f7 f9 8b 85 ?? ?? ?? ?? 8a 8c 15 ?? ?? ?? ?? 30 08 } //1
		$a_81_11 = {49 46 61 64 69 55 42 62 6c 63 44 6f 62 46 49 6d 66 64 35 34 6f 71 37 64 79 4b 64 4e 4a 41 74 79 51 66 79 7a 67 7a } //1 IFadiUBblcDobFImfd54oq7dyKdNJAtyQfyzgz
		$a_02_12 = {0f b6 cb 03 c1 99 b9 ?? ?? ?? ?? f7 f9 83 c4 ?? 83 c5 01 0f b6 54 14 ?? 30 55 } //1
		$a_81_13 = {4a 41 34 72 59 69 78 66 4b 62 43 72 59 4c 73 62 35 54 31 57 68 4a 41 63 33 72 77 50 77 6b 50 4c 35 61 6b } //1 JA4rYixfKbCrYLsb5T1WhJAc3rwPwkPL5ak
		$a_02_14 = {0f b6 cb 03 c1 99 b9 ?? ?? ?? ?? f7 f9 8b 44 24 ?? 8b 4c 24 ?? 40 89 44 24 ?? 8a 54 14 ?? 30 54 01 } //1
		$a_81_15 = {51 55 5a 65 50 57 4d 72 77 44 78 50 66 6d 4e 62 37 6e 52 61 33 51 5a 31 73 43 31 54 63 77 51 6d 6f 4a 5a } //1 QUZePWMrwDxPfmNb7nRa3QZ1sC1TcwQmoJZ
		$a_02_16 = {0f b6 16 0f b6 c3 03 c2 8b f1 99 f7 fe 8b 45 ?? 8a 94 15 ?? ?? ?? ?? 30 10 } //1
		$a_81_17 = {79 4b 65 6d 70 32 30 64 4f 34 35 53 4e 4e 54 4f 57 45 44 37 4e 4c 78 52 51 4d 72 6b 79 50 48 66 41 66 } //1 yKemp20dO45SNNTOWED7NLxRQMrkyPHfAf
		$a_02_18 = {0f b6 44 14 ?? 0f b6 cb 03 c1 99 b9 ?? ?? ?? ?? f7 f9 8b 4c 24 ?? 8b 44 24 ?? 83 c1 01 89 4c 24 ?? 8a 54 14 ?? 30 54 08 } //1
		$a_02_19 = {0f b6 44 14 ?? 0f b6 cb 03 c1 99 b9 ?? ?? ?? ?? f7 f9 8b 4c 24 ?? 8b 84 24 ?? ?? ?? ?? 8a 1c 01 8a 54 14 ?? 32 da 88 1c 01 } //1
		$a_81_20 = {55 6b 68 52 31 42 67 35 6c 6b 4a 4b 6d 56 66 42 79 4e 64 4e 6b 42 61 41 4f 65 6f 69 6d 58 4f 76 4b 45 35 52 6f 62 38 } //1 UkhR1Bg5lkJKmVfByNdNkBaAOeoimXOvKE5Rob8
		$a_02_21 = {0f b6 84 35 ?? ?? ?? ?? 0f b6 c9 03 c1 99 b9 ?? ?? ?? ?? f7 f9 0f b6 94 15 ?? ?? ?? ?? 30 53 ff } //1
		$a_81_22 = {6a 35 54 39 31 30 48 53 5a 5a 4a 6f 4a 34 6c 76 6f 48 6d 49 62 78 38 5a 37 77 59 30 43 73 32 73 70 64 } //1 j5T910HSZZJoJ4lvoHmIbx8Z7wY0Cs2spd
	condition:
		((#a_02_0  & 1)*1+(#a_81_1  & 1)*1+(#a_02_2  & 1)*1+(#a_81_3  & 1)*1+(#a_02_4  & 1)*1+(#a_81_5  & 1)*1+(#a_02_6  & 1)*1+(#a_81_7  & 1)*1+(#a_02_8  & 1)*1+(#a_81_9  & 1)*1+(#a_02_10  & 1)*1+(#a_81_11  & 1)*1+(#a_02_12  & 1)*1+(#a_81_13  & 1)*1+(#a_02_14  & 1)*1+(#a_81_15  & 1)*1+(#a_02_16  & 1)*1+(#a_81_17  & 1)*1+(#a_02_18  & 1)*1+(#a_02_19  & 1)*1+(#a_81_20  & 1)*1+(#a_02_21  & 1)*1+(#a_81_22  & 1)*1) >=1
 
}
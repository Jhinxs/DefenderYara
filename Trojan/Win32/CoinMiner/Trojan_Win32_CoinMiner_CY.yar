
rule Trojan_Win32_CoinMiner_CY{
	meta:
		description = "Trojan:Win32/CoinMiner.CY,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 10 00 00 "
		
	strings :
		$a_03_0 = {b9 00 97 49 01 ff 15 ?? ?? ?? ?? c7 45 ?? ?? 00 00 00 48 8b 55 ?? 48 83 c2 e8 83 c8 ff f0 0f c1 42 10 83 e8 01 0f 8f ?? ?? ?? ?? 48 8b 0a 48 8b 01 ff 50 08 8b 7c 24 ?? e9 ?? ?? ff ff 48 8d 95 ?? ?? 00 00 48 8d 8d ?? ?? 00 00 ff 15 ?? ?? ?? ?? 48 8d ?? ?? ?? ?? ?? 48 8d 8d ?? ?? 00 00 ff 15 ?? ?? ?? ?? 48 8d 3d ?? ?? ?? ?? 48 89 7d ?? 44 8b 2d ?? ?? ?? ?? 44 89 6c 24 ?? 48 2b de 48 81 fb 80 51 01 00 } //3
		$a_00_1 = {22 64 6f 6e 61 74 65 2d 6c 65 76 65 6c 22 3a 20 30 } //1 "donate-level": 0
		$a_00_2 = {22 6c 6f 67 2d 66 69 6c 65 22 3a 20 6e 75 6c 6c } //1 "log-file": null
		$a_00_3 = {22 75 72 6c 22 3a 20 22 70 6f 6f 6c 2e 6d 69 6e 65 78 6d 72 2e 74 6f 3a 34 34 34 34 22 } //1 "url": "pool.minexmr.to:4444"
		$a_00_4 = {22 77 6f 72 6b 65 72 2d 69 64 22 3a 20 6e 75 6c 6c } //1 "worker-id": null
		$a_00_5 = {22 6d 61 78 2d 63 70 75 2d 75 73 61 67 65 22 3a 20 37 30 } //1 "max-cpu-usage": 70
		$a_00_6 = {22 75 73 65 72 22 3a 20 22 34 32 6f 78 64 76 32 54 6b 53 34 68 39 39 67 61 74 44 41 78 55 41 64 6d 35 44 63 67 77 56 41 70 78 35 55 4a 66 4b 69 4e 61 65 71 77 4c 73 36 45 57 64 5a 50 67 4a 6b 37 32 5a 32 4c 79 4e 4c 57 54 65 66 50 54 4e 51 39 4b 6b 51 37 6e 34 6e 39 5a 43 65 58 34 65 50 62 4e 79 78 57 4a 33 72 22 } //3 "user": "42oxdv2TkS4h99gatDAxUAdm5DcgwVApx5UJfKiNaeqwLs6EWdZPgJk72Z2LyNLWTefPTNQ9KkQ7n4n9ZCeX4ePbNyxWJ3r"
		$a_00_7 = {22 70 61 73 73 22 3a 20 22 78 22 } //2 "pass": "x"
		$a_00_8 = {26 65 61 3d 63 64 6c 5f 69 25 64 5f 65 25 64 5f 64 25 64 } //1 &ea=cdl_i%d_e%d_d%d
		$a_00_9 = {26 65 61 3d 63 77 5f 25 64 5f 25 64 } //1 &ea=cw_%d_%d
		$a_00_10 = {26 65 61 3d 65 64 6c 5f 69 25 64 5f 65 25 64 5f 64 25 64 } //1 &ea=edl_i%d_e%d_d%d
		$a_00_11 = {26 65 61 3d 65 72 5f 69 25 64 5f 65 25 64 5f 72 25 64 } //1 &ea=er_i%d_e%d_r%d
		$a_00_12 = {26 65 61 3d 65 77 5f 25 64 5f 25 64 } //1 &ea=ew_%d_%d
		$a_00_13 = {76 3d 31 26 74 69 64 3d 25 73 26 63 69 64 3d 25 73 26 74 3d 65 76 65 6e 74 26 65 63 3d 65 78 65 63 } //2 v=1&tid=%s&cid=%s&t=event&ec=exec
		$a_00_14 = {3a 2f 2f 25 73 2e 25 73 2f 25 64 2f 25 64 2f 3f 6f 3d 25 64 26 76 3d 25 73 26 74 73 3d 25 6c 6c 75 26 74 6c 3d 25 6c 6c 75 26 69 3d 25 6c 75 26 65 63 3d 25 64 26 75 63 3d 25 64 } //2 ://%s.%s/%d/%d/?o=%d&v=%s&ts=%llu&tl=%llu&i=%lu&ec=%d&uc=%d
		$a_00_15 = {7b 66 31 64 34 34 37 61 66 2d 31 62 61 32 2d 34 61 66 30 2d 39 35 38 34 2d 38 31 38 33 66 63 38 37 64 36 36 61 7d } //1 {f1d447af-1ba2-4af0-9584-8183fc87d66a}
	condition:
		((#a_03_0  & 1)*3+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*3+(#a_00_7  & 1)*2+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*2+(#a_00_14  & 1)*2+(#a_00_15  & 1)*1) >=10
 
}
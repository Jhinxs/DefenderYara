
rule Trojan_Win32_CoinMiner_DL_bit{
	meta:
		description = "Trojan:Win32/CoinMiner.DL!bit,SIGNATURE_TYPE_PEHSTR_EXT,09 00 09 00 07 00 00 "
		
	strings :
		$a_03_0 = {2d 2d 64 6f 6e 61 74 65 2d 6c 65 76 65 6c [0-10] 2d 2d 6d 61 78 2d 63 70 75 2d 75 73 61 67 65 [0-10] 2d 6f [0-50] 2d 75 [0-50] 2d 70 [0-50] 2d 6b } //1
		$a_03_1 = {2d 2d 64 6f 6e 61 74 65 2d 6c 65 76 65 6c [0-50] 2d 2d 63 75 64 61 2d 6d 61 78 2d 74 68 72 65 61 64 73 3d [0-50] 2d 2d 63 75 64 61 2d 62 66 61 63 74 6f 72 3d [0-50] 2d 2d 63 75 64 61 2d 62 73 6c 65 65 70 3d [0-50] 2d 6f [0-50] 2d 75 [0-50] 2d 70 [0-50] 2d 6b } //1
		$a_03_2 = {2d 2d 64 6f 6e 61 74 65 2d 6c 65 76 65 6c [0-50] 2d 6f [0-50] 2d 75 [0-50] 2d 70 [0-50] 2d 6b } //1
		$a_01_3 = {64 53 35 76 64 33 64 33 59 53 35 6a 62 32 31 38 4f 54 55 7a 4d 51 3d 3d } //2 dS5vd3d3YS5jb218OTUzMQ==
		$a_01_4 = {4d 54 41 7a 4c 6a 49 78 4f 43 34 79 4c 6a 45 30 4e 48 77 35 4e 54 4d 78 } //2 MTAzLjIxOC4yLjE0NHw5NTMx
		$a_01_5 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 52 75 6e } //3 Software\Microsoft\Windows\CurrentVersion\Run
		$a_03_6 = {63 73 63 72 69 70 74 20 2f 2f 62 20 2f 2f 6e 6f 6c 6f 67 6f 20 25 74 6d 70 25 2f [0-20] 2e 76 62 73 } //3
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*3+(#a_03_6  & 1)*3) >=9
 
}
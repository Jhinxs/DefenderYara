
rule Trojan_Win32_CoinMiner_BV_bit{
	meta:
		description = "Trojan:Win32/CoinMiner.BV!bit,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_03_0 = {6a 00 8b 55 ?? 8b 42 54 50 8b 4d 08 51 8b [0-05] 52 8b 85 ?? ?? ?? ?? 50 ff 95 } //1
		$a_03_1 = {8b 55 08 03 51 3c 03 55 ?? 8b [0-05] 0f af 45 ?? 03 d0 89 95 } //1
		$a_03_2 = {6a 00 8b 85 ?? ?? ?? ?? 8b 48 10 51 8b 95 ?? ?? ?? ?? 8b 45 08 03 42 14 50 8b 8d ?? ?? ?? ?? 8b [0-05] 03 51 0c 52 8b 85 ?? ?? ?? ?? 50 ff 95 } //1
		$a_03_3 = {6a 00 6a 04 8b 55 ?? 83 c2 34 52 8b 45 ?? 8b 88 a4 00 00 00 83 c1 08 51 8b 95 ?? ?? ?? ?? 52 ff 95 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1) >=4
 
}
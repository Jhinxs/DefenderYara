
rule Trojan_Win32_Kovter_S_psh{
	meta:
		description = "Trojan:Win32/Kovter.S!psh,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 09 00 00 "
		
	strings :
		$a_80_0 = {3b 7d 5b 42 79 74 65 5b 5d 5d 20 24 } //;}[Byte[]] $  1
		$a_80_1 = {2e 69 6e 76 6f 6b 65 28 30 2c } //.invoke(0,  1
		$a_02_2 = {2e 00 67 00 65 00 74 00 6d 00 65 00 74 00 68 00 6f 00 64 00 28 00 [0-04] 67 00 65 00 74 00 70 00 72 00 6f 00 63 00 61 00 64 00 64 00 72 00 65 00 73 00 73 00 [0-04] 29 00 2e 00 69 00 6e 00 76 00 6f 00 6b 00 65 00 } //1
		$a_02_3 = {2e 67 65 74 6d 65 74 68 6f 64 28 [0-04] 67 65 74 70 72 6f 63 61 64 64 72 65 73 73 [0-04] 29 2e 69 6e 76 6f 6b 65 } //1
		$a_80_4 = {30 78 63 36 2c 30 78 38 35 2c 30 78 32 66 2c 30 78 66 66 2c 30 78 66 66 2c 30 78 66 66 2c 30 78 36 31 2c 30 78 63 36 2c 30 78 38 35 2c 30 78 33 30 2c 30 78 66 66 2c 30 78 66 66 2c 30 78 66 66 2c 30 78 36 34 2c 30 78 63 36 2c 30 78 38 35 2c 30 78 33 31 2c 30 78 66 66 2c 30 78 66 66 2c 30 78 66 66 2c 30 78 37 36 } //0xc6,0x85,0x2f,0xff,0xff,0xff,0x61,0xc6,0x85,0x30,0xff,0xff,0xff,0x64,0xc6,0x85,0x31,0xff,0xff,0xff,0x76  1
		$a_80_5 = {30 78 30 33 2c 30 78 63 62 2c 30 78 38 31 2c 30 78 33 39 2c 30 78 35 32 2c 30 78 36 35 2c 30 78 36 37 2c 30 78 34 66 } //0x03,0xcb,0x81,0x39,0x52,0x65,0x67,0x4f  1
		$a_80_6 = {30 78 38 64 2c 30 78 34 31 2c 30 78 30 34 2c 30 78 38 31 2c 30 78 33 38 2c 30 78 37 30 2c 30 78 36 35 2c 30 78 36 65 2c 30 78 34 62 } //0x8d,0x41,0x04,0x81,0x38,0x70,0x65,0x6e,0x4b  1
		$a_80_7 = {30 78 38 31 2c 30 78 33 39 2c 30 78 34 35 2c 30 78 37 38 2c 30 78 36 39 2c 30 78 37 34 2c 30 78 37 35 } //0x81,0x39,0x45,0x78,0x69,0x74,0x75  1
		$a_80_8 = {30 78 38 31 2c 30 78 33 38 2c 30 78 35 30 2c 30 78 37 32 2c 30 78 36 46 2c 30 78 36 33 2c 30 78 37 35 } //0x81,0x38,0x50,0x72,0x6F,0x63,0x75  1
	condition:
		((#a_80_0  & 1)*1+(#a_80_1  & 1)*1+(#a_02_2  & 1)*1+(#a_02_3  & 1)*1+(#a_80_4  & 1)*1+(#a_80_5  & 1)*1+(#a_80_6  & 1)*1+(#a_80_7  & 1)*1+(#a_80_8  & 1)*1) >=4
 
}
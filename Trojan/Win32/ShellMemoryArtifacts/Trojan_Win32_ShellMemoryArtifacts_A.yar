
rule Trojan_Win32_ShellMemoryArtifacts_A{
	meta:
		description = "Trojan:Win32/ShellMemoryArtifacts.A,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 32 00 00 "
		
	strings :
		$a_02_0 = {48 31 c0 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_1 = {48 31 c0 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_2 = {48 31 c9 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 41 49 51 59 61 69 71 79 60 } //10
		$a_02_3 = {48 31 c9 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 41 49 51 59 61 69 71 79 60 } //10
		$a_02_4 = {48 31 d2 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 42 4a 52 5a 62 6a 72 7a 60 } //10
		$a_02_5 = {48 31 d2 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 42 4a 52 5a 62 6a 72 7a 60 } //10
		$a_02_6 = {48 31 db 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 43 4b 53 5b 63 6b 73 7b 60 } //10
		$a_02_7 = {48 31 db 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 43 4b 53 5b 63 6b 73 7b 60 } //10
		$a_02_8 = {4d 31 c0 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_9 = {4d 31 c0 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_10 = {4d 31 c9 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 41 49 51 59 61 69 71 79 60 } //10
		$a_02_11 = {4d 31 c9 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 41 49 51 59 61 69 71 79 60 } //10
		$a_02_12 = {4d 31 d2 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 42 4a 52 5a 62 6a 72 7a 60 } //10
		$a_02_13 = {4d 31 d2 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 42 4a 52 5a 62 6a 72 7a 60 } //10
		$a_02_14 = {4d 31 db 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 43 4b 53 5b 63 6b 73 7b 60 } //10
		$a_02_15 = {4d 31 db 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 43 4b 53 5b 63 6b 73 7b 60 } //10
		$a_02_16 = {4d 31 ed 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 45 4d 55 5d 65 6d 75 7d 60 } //10
		$a_02_17 = {4d 31 ed 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 45 4d 55 5d 65 6d 75 7d 60 } //10
		$a_02_18 = {4d 31 f6 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 46 4e 56 5e 66 6e 76 7e 60 } //10
		$a_02_19 = {4d 31 f6 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 46 4e 56 5e 66 6e 76 7e 60 } //10
		$a_02_20 = {4d 31 ff 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 47 4f 57 5f 67 6f 77 7f 60 } //10
		$a_02_21 = {4d 31 ff 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 47 4f 57 5f 67 6f 77 7f 60 } //10
		$a_02_22 = {48 31 c0 48 f7 e0 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_23 = {48 31 c0 48 f7 e0 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_24 = {48 31 db 48 f7 e3 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_25 = {48 31 db 48 f7 e3 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_26 = {48 31 c9 48 f7 e1 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_27 = {48 31 c9 48 f7 e1 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_28 = {48 31 d2 48 f7 e2 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_29 = {48 31 d2 48 f7 e2 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_30 = {48 31 f6 48 f7 e6 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_31 = {48 31 f6 48 f7 e6 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_32 = {48 31 ff 48 f7 e7 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_33 = {48 31 ff 48 f7 e7 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_34 = {4d 31 c0 49 f7 e0 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_35 = {4d 31 c0 49 f7 e0 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_36 = {4d 31 c9 49 f7 e1 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_37 = {4d 31 c9 49 f7 e1 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_38 = {4d 31 d2 49 f7 e2 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_39 = {4d 31 d2 49 f7 e2 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_40 = {4d 31 db 49 f7 e3 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_41 = {4d 31 db 49 f7 e3 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_42 = {4d 31 e4 49 f7 e4 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_43 = {4d 31 e4 49 f7 e4 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_44 = {4d 31 ed 49 f7 e5 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_45 = {4d 31 ed 49 f7 e5 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_46 = {4d 31 f6 49 f7 e6 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_47 = {4d 31 f6 49 f7 e6 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_48 = {4d 31 ff 49 f7 e7 65 48 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
		$a_02_49 = {4d 31 ff 49 f7 e7 65 4c 8b 90 17 08 01 01 01 01 01 01 01 01 40 48 50 58 60 68 70 78 60 } //10
	condition:
		((#a_02_0  & 1)*10+(#a_02_1  & 1)*10+(#a_02_2  & 1)*10+(#a_02_3  & 1)*10+(#a_02_4  & 1)*10+(#a_02_5  & 1)*10+(#a_02_6  & 1)*10+(#a_02_7  & 1)*10+(#a_02_8  & 1)*10+(#a_02_9  & 1)*10+(#a_02_10  & 1)*10+(#a_02_11  & 1)*10+(#a_02_12  & 1)*10+(#a_02_13  & 1)*10+(#a_02_14  & 1)*10+(#a_02_15  & 1)*10+(#a_02_16  & 1)*10+(#a_02_17  & 1)*10+(#a_02_18  & 1)*10+(#a_02_19  & 1)*10+(#a_02_20  & 1)*10+(#a_02_21  & 1)*10+(#a_02_22  & 1)*10+(#a_02_23  & 1)*10+(#a_02_24  & 1)*10+(#a_02_25  & 1)*10+(#a_02_26  & 1)*10+(#a_02_27  & 1)*10+(#a_02_28  & 1)*10+(#a_02_29  & 1)*10+(#a_02_30  & 1)*10+(#a_02_31  & 1)*10+(#a_02_32  & 1)*10+(#a_02_33  & 1)*10+(#a_02_34  & 1)*10+(#a_02_35  & 1)*10+(#a_02_36  & 1)*10+(#a_02_37  & 1)*10+(#a_02_38  & 1)*10+(#a_02_39  & 1)*10+(#a_02_40  & 1)*10+(#a_02_41  & 1)*10+(#a_02_42  & 1)*10+(#a_02_43  & 1)*10+(#a_02_44  & 1)*10+(#a_02_45  & 1)*10+(#a_02_46  & 1)*10+(#a_02_47  & 1)*10+(#a_02_48  & 1)*10+(#a_02_49  & 1)*10) >=10
 
}

rule Trojan_Win32_Fakntor_B_MSR{
	meta:
		description = "Trojan:Win32/Fakntor.B!MSR,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_01_0 = {72 75 6e 64 6c 6c 33 32 2e 65 78 65 20 25 73 20 2c 4e 76 53 6d 61 72 74 4d 61 78 55 73 65 44 79 6e 61 6d 69 63 44 65 76 69 63 65 47 72 69 64 73 } //1 rundll32.exe %s ,NvSmartMaxUseDynamicDeviceGrids
		$a_01_1 = {25 73 45 78 2e 65 78 65 } //1 %sEx.exe
		$a_01_2 = {39 00 34 00 35 00 46 00 34 00 31 00 30 00 36 00 2d 00 43 00 36 00 39 00 31 00 2d 00 34 00 39 00 32 00 31 00 2d 00 41 00 43 00 41 00 42 00 2d 00 45 00 35 00 38 00 43 00 35 00 30 00 43 00 35 00 46 00 31 00 35 00 30 00 } //1 945F4106-C691-4921-ACAB-E58C50C5F150
		$a_01_3 = {43 00 46 00 30 00 38 00 43 00 33 00 46 00 33 00 2d 00 32 00 43 00 41 00 33 00 2d 00 34 00 32 00 31 00 35 00 2d 00 38 00 43 00 42 00 33 00 2d 00 34 00 43 00 44 00 42 00 44 00 33 00 30 00 33 00 30 00 45 00 43 00 34 00 } //1 CF08C3F3-2CA3-4215-8CB3-4CDBD3030EC4
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=3
 
}

rule Trojan_Win32_LummaC_HNAA_MTB{
	meta:
		description = "Trojan:Win32/LummaC.HNAA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 07 00 00 "
		
	strings :
		$a_03_0 = {64 8b 12 51 50 6a 00 ff 72 ?? ff 15 } //1
		$a_03_1 = {31 f2 89 54 24 ?? 8b 54 24 } //1
		$a_01_2 = {31 c8 89 45 e4 8b 45 e4 } //1
		$a_01_3 = {f3 a5 8b 74 24 f8 8b 7c 24 f4 8d 54 24 04 ff 54 24 fc } //10
		$a_03_4 = {8b 14 24 8b 34 24 0f b6 74 34 04 81 c2 ?? ?? ?? ?? 31 f2 89 54 24 0c 8b 54 24 0c 80 c2 ?? 8b 34 24 88 54 } //11
		$a_01_5 = {c7 44 24 34 29 23 17 1d c7 44 24 38 15 1f 13 19 c7 44 24 3c 11 1b 1f 15 c7 44 24 40 1d 17 b2 11 c7 44 24 44 10 11 0e 0f c7 44 24 48 0c 0d 0a 0b c7 44 24 4c f6 09 fe 07 c7 44 24 50 09 08 0f 0e } //11
		$a_03_6 = {5c 41 70 70 44 61 74 61 5c 52 6f 61 6d 69 6e 67 00 00 00 [0-10] 68 74 74 70 73 3a 2f 2f [0-10] 2e ?? ?? ?? 2f [0-15] 2e 65 78 65 00 00 [0-ff] [0-f0] 68 74 74 70 73 3a 2f 2f [0-15] 2e [0-04] 2f 61 70 69 00 } //11
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*10+(#a_03_4  & 1)*11+(#a_01_5  & 1)*11+(#a_03_6  & 1)*11) >=11
 
}
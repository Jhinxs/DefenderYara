
rule Trojan_Win32_Anobato_A{
	meta:
		description = "Trojan:Win32/Anobato.A,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {31 ff 83 f8 00 74 07 80 7c 03 ff c3 74 06 } //1
		$a_01_1 = {31 ff c7 43 04 c2 a5 10 28 31 ff 66 c7 43 02 9c 40 31 ff } //1
		$a_01_2 = {49 89 c7 48 05 00 20 00 00 31 ff 49 89 07 48 05 00 20 00 00 31 ff } //1
		$a_03_3 = {31 ff 48 83 ec 20 48 c7 c1 00 00 00 00 48 c7 c2 00 40 01 00 49 c7 c0 00 30 00 00 49 c7 c1 40 00 00 00 ff 15 ?? ?? ?? ?? 48 83 c4 20 31 ff } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_03_3  & 1)*1) >=4
 
}
rule Trojan_Win32_Anobato_A_2{
	meta:
		description = "Trojan:Win32/Anobato.A,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 09 00 00 "
		
	strings :
		$a_03_0 = {83 bd 40 05 00 00 01 90 05 10 01 90 75 ?? 90 05 10 01 90 eb ?? 90 05 10 01 90 c7 85 40 05 00 00 00 00 00 ?? 90 05 10 01 90 eb ?? 90 05 10 01 90 c7 85 40 05 00 00 00 00 00 ?? 90 05 10 01 90 6a 40 68 00 30 00 00 68 00 (20 00|40 01) 00 6a 00 } //10
		$a_03_1 = {ff b5 a0 05 00 00 68 02 02 00 00 ?? 95 80 04 00 00 6a 06 6a 01 6a 02 ?? 95 c8 04 00 00 89 85 b8 05 00 00 } //10
		$a_03_2 = {d0 8b 45 00 83 c0 0c ff 75 10 50 ff 90 04 01 02 95 15 ?? ?? ?? ?? ff b5 b8 05 00 00 ff 95 90 90 04 00 00 68 (e8 03|d0 07) 00 00 ff 90 04 01 02 95 15 ?? ?? ?? ?? ?? ?? ?? ff ff } //10
		$a_01_3 = {35 30 2e 37 2e 31 33 38 2e 31 33 38 } //1 50.7.138.138
		$a_00_4 = {35 30 2e 37 2e 31 32 34 2e 31 39 39 } //1 50.7.124.199
		$a_00_5 = {31 34 39 2e 31 35 34 2e 36 34 2e 31 36 37 } //1 149.154.64.167
		$a_00_6 = {35 2e 38 2e 36 30 2e 32 33 } //1 5.8.60.23
		$a_02_7 = {31 39 33 2e 32 38 2e 31 37 39 2e 90 0f 01 00 90 10 02 00 } //1
		$a_00_8 = {38 35 2e 39 33 2e 30 2e 32 32 } //1 85.93.0.22
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*10+(#a_03_2  & 1)*10+(#a_01_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_02_7  & 1)*1+(#a_00_8  & 1)*1) >=31
 
}
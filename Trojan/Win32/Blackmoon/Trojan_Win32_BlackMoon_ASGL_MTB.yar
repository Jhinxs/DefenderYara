
rule Trojan_Win32_BlackMoon_ASGL_MTB{
	meta:
		description = "Trojan:Win32/BlackMoon.ASGL!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 07 00 00 "
		
	strings :
		$a_03_0 = {68 01 00 00 00 bb dc 09 00 00 e8 ?? ?? ?? 00 83 c4 10 89 45 f8 89 65 f4 68 00 00 00 00 68 00 00 00 00 ff 75 0c ff 75 f8 68 00 00 00 00 68 00 00 00 00 ff 15 } //4
		$a_03_1 = {83 c4 04 ff 75 dc ff 75 e4 ff 75 e8 68 ?? ?? ?? 00 b9 04 00 00 00 e8 ?? ?? ?? ff 83 c4 10 89 45 } //1
		$a_01_2 = {62 6c 61 63 6b 6d 6f 6f 6e } //1 blackmoon
		$a_01_3 = {62 38 36 39 37 30 36 62 34 32 66 30 63 32 30 32 65 35 36 36 37 66 32 32 64 61 31 63 39 63 66 35 } //1 b869706b42f0c202e5667f22da1c9cf5
		$a_01_4 = {77 77 77 2e 6d 79 64 6c 71 2e 63 6f 6d } //1 www.mydlq.com
		$a_01_5 = {68 75 61 6e 73 68 6f 75 50 48 5a 48 7c 6e 75 6c 6c } //1 huanshouPHZH|null
		$a_01_6 = {79 77 67 6e 2d 34 33 44 32 34 41 33 32 44 43 45 44 43 43 43 36 41 43 33 35 38 32 42 35 46 33 33 44 41 43 33 46 33 42 39 41 34 31 46 30 31 41 35 46 44 32 36 38 26 32 44 45 36 31 45 39 45 33 43 33 38 32 45 35 32 45 36 46 45 37 44 36 44 31 37 39 34 30 36 36 38 } //1 ywgn-43D24A32DCEDCCC6AC3582B5F33DAC3F3B9A41F01A5FD268&2DE61E9E3C382E52E6FE7D6D17940668
	condition:
		((#a_03_0  & 1)*4+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1) >=10
 
}

rule Trojan_Win32_BlackMoon_DT_MTB{
	meta:
		description = "Trojan:Win32/BlackMoon.DT!MTB,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 0d 00 00 "
		
	strings :
		$a_01_0 = {53 65 6c 66 64 72 61 77 69 6e 67 2e 65 78 65 } //2 Selfdrawing.exe
		$a_01_1 = {64 61 74 5c 62 69 6e 2e 64 61 74 } //2 dat\bin.dat
		$a_01_2 = {6b 33 33 4c 33 35 6a 37 62 38 63 59 4c 38 33 62 39 75 38 66 49 7a 51 56 } //1 k33L35j7b8cYL83b9u8fIzQV
		$a_01_3 = {56 66 54 70 77 76 75 38 58 77 66 77 50 70 4b 37 33 37 48 31 34 38 71 55 } //1 VfTpwvu8XwfwPpK737H148qU
		$a_01_4 = {65 65 65 2e 77 78 68 75 61 6a 69 61 2e 63 6f 6d } //1 eee.wxhuajia.com
		$a_01_5 = {6d 69 61 6f 73 68 61 2e 34 6a 69 61 73 75 2e 63 6f 6d } //1 miaosha.4jiasu.com
		$a_01_6 = {6d 73 2e 67 6f 6d 6b 6b 2e 63 6f 6d } //1 ms.gomkk.com
		$a_01_7 = {45 75 30 6c 55 48 43 71 54 58 4a 79 5a 2f 44 59 6c 4a 65 4b 78 6f 6b 57 37 4e 62 74 79 46 4b 6e 33 42 34 48 55 59 49 37 6c 32 71 78 57 5a 36 6a 44 6f 57 33 7a 72 42 63 4a 75 46 34 31 44 32 75 4d 4c 42 4d 56 33 45 } //1 Eu0lUHCqTXJyZ/DYlJeKxokW7NbtyFKn3B4HUYI7l2qxWZ6jDoW3zrBcJuF41D2uMLBMV3E
		$a_01_8 = {33 66 33 6f 50 73 34 48 54 48 7a 6d 56 6b 55 75 35 74 51 46 31 35 36 59 4c 4f 69 53 52 35 45 73 6e 54 4d 34 6f 41 73 6a 55 43 74 6f 4c 7a 6a 73 5a 78 5a 73 32 46 4e 50 53 72 6f 47 63 } //1 3f3oPs4HTHzmVkUu5tQF156YLOiSR5EsnTM4oAsjUCtoLzjsZxZs2FNPSroGc
		$a_01_9 = {34 44 39 44 46 42 39 45 41 34 45 35 45 41 30 32 42 45 38 46 42 33 38 39 42 35 43 44 44 30 41 33 33 43 41 34 45 35 39 33 } //1 4D9DFB9EA4E5EA02BE8FB389B5CDD0A33CA4E593
		$a_01_10 = {34 46 42 39 33 46 45 46 34 34 33 37 34 36 35 32 30 46 37 44 30 37 39 38 44 33 38 37 31 30 32 34 35 37 42 38 34 36 46 30 44 33 } //1 4FB93FEF443746520F7D0798D387102457B846F0D3
		$a_01_11 = {39 39 65 65 35 39 32 30 39 62 31 64 36 39 63 32 34 62 62 33 61 31 31 66 39 37 31 63 62 38 33 63 31 64 39 31 39 34 35 31 61 } //1 99ee59209b1d69c24bb3a11f971cb83c1d919451a
		$a_01_12 = {38 44 33 38 37 31 30 32 34 35 37 42 38 34 36 37 45 34 36 44 35 41 30 36 44 46 31 41 36 31 43 37 31 36 30 33 42 46 38 43 31 } //1 8D387102457B8467E46D5A06DF1A61C71603BF8C1
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1) >=8
 
}
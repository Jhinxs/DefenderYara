
rule Trojan_Win32_UACBypassExp_SA{
	meta:
		description = "Trojan:Win32/UACBypassExp.SA,SIGNATURE_TYPE_CMDHSTR_EXT,65 00 65 00 0d 00 00 "
		
	strings :
		$a_02_0 = {72 00 65 00 67 00 20 00 61 00 64 00 64 00 [0-05] 68 00 6b 00 63 00 75 00 5c 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 63 00 6c 00 61 00 73 00 73 00 65 00 73 00 5c 00 66 00 6f 00 6c 00 64 00 65 00 72 00 5c 00 73 00 68 00 65 00 6c 00 6c 00 5c 00 6f 00 70 00 65 00 6e 00 5c 00 63 00 6f 00 6d 00 6d 00 61 00 6e 00 64 00 [0-10] 20 00 2f 00 64 00 20 00 [0-10] 63 00 6d 00 64 00 [0-10] 20 00 2f 00 63 00 20 00 } //100
		$a_02_1 = {72 65 67 20 61 64 64 [0-05] 68 6b 63 75 5c 73 6f 66 74 77 61 72 65 5c 63 6c 61 73 73 65 73 5c 66 6f 6c 64 65 72 5c 73 68 65 6c 6c 5c 6f 70 65 6e 5c 63 6f 6d 6d 61 6e 64 [0-10] 20 2f 64 20 [0-10] 63 6d 64 [0-10] 20 2f 63 20 } //100
		$a_02_2 = {72 00 65 00 67 00 20 00 61 00 64 00 64 00 [0-05] 68 00 6b 00 63 00 75 00 5c 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 63 00 6c 00 61 00 73 00 73 00 65 00 73 00 5c 00 6d 00 73 00 2d 00 73 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 73 00 68 00 65 00 6c 00 6c 00 5c 00 6f 00 70 00 65 00 6e 00 5c 00 63 00 6f 00 6d 00 6d 00 61 00 6e 00 64 00 [0-10] 20 00 2f 00 64 00 20 00 [0-10] 63 00 6d 00 64 00 [0-10] 20 00 2f 00 63 00 20 00 } //100
		$a_02_3 = {72 65 67 20 61 64 64 [0-05] 68 6b 63 75 5c 73 6f 66 74 77 61 72 65 5c 63 6c 61 73 73 65 73 5c 6d 73 2d 73 65 74 74 69 6e 67 73 5c 73 68 65 6c 6c 5c 6f 70 65 6e 5c 63 6f 6d 6d 61 6e 64 [0-10] 20 2f 64 20 [0-10] 63 6d 64 [0-10] 20 2f 63 20 } //100
		$a_80_4 = {77 6d 69 63 } //wmic  1
		$a_80_5 = {72 75 6e 64 6c 6c 33 32 } //rundll32  1
		$a_80_6 = {72 65 67 73 76 72 33 32 } //regsvr32  1
		$a_80_7 = {70 6f 77 65 72 73 68 65 6c 6c } //powershell  1
		$a_80_8 = {63 73 63 72 69 70 74 } //cscript  1
		$a_80_9 = {77 73 63 72 69 70 74 } //wscript  1
		$a_80_10 = {73 63 68 74 61 73 6b 73 } //schtasks  1
		$a_80_11 = {6d 73 68 74 61 } //mshta  1
		$a_80_12 = {62 69 74 73 61 64 6d 69 6e } //bitsadmin  1
	condition:
		((#a_02_0  & 1)*100+(#a_02_1  & 1)*100+(#a_02_2  & 1)*100+(#a_02_3  & 1)*100+(#a_80_4  & 1)*1+(#a_80_5  & 1)*1+(#a_80_6  & 1)*1+(#a_80_7  & 1)*1+(#a_80_8  & 1)*1+(#a_80_9  & 1)*1+(#a_80_10  & 1)*1+(#a_80_11  & 1)*1+(#a_80_12  & 1)*1) >=101
 
}
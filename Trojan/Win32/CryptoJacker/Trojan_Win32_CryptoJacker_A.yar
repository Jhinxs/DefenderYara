
rule Trojan_Win32_CryptoJacker_A{
	meta:
		description = "Trojan:Win32/CryptoJacker.A,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 0f 00 00 "
		
	strings :
		$a_00_0 = {83 f8 0d 75 23 8b 45 fc 66 83 38 52 75 1a 8d 45 d4 8b 55 f8 } //10
		$a_00_1 = {83 f8 0d 75 23 8b 45 fc 66 83 38 5a 75 1a 8d 45 d0 8b 55 f4 } //10
		$a_00_2 = {83 f8 2a 75 23 8b 45 fc 66 83 38 30 75 1a 8d 45 bc 8b 55 e4 } //10
		$a_00_3 = {83 f8 22 75 23 8b 45 fc 66 83 38 31 75 1a 8d 45 c0 8b 55 e8 } //10
		$a_00_4 = {83 f8 6a 75 23 8b 45 fc 66 83 38 34 75 1a 8d 45 b8 8b 55 e0 } //10
		$a_00_5 = {83 f8 22 75 23 8b 45 fc 66 83 38 4c 75 1a 8d 45 b4 8b 55 d8 } //10
		$a_80_6 = {63 6d 64 20 2f 6b 20 61 74 74 72 69 62 20 2b 73 20 2b 68 20 22 43 3a 5c 50 72 6f 67 72 61 6d 44 61 74 61 5c 4e 56 49 44 49 41 5c 4e 56 44 69 73 70 6c 61 79 2e 43 6f 6e 74 61 69 6e 65 72 2e 65 78 65 22 } //cmd /k attrib +s +h "C:\ProgramData\NVIDIA\NVDisplay.Container.exe"  10
		$a_80_7 = {43 3a 5c 50 72 6f 67 72 61 6d 44 61 74 61 5c 4e 56 49 44 49 41 5c 4e 56 44 69 73 70 6c 61 79 2e 43 6f 6e 74 61 69 6e 65 72 2e 65 78 65 } //C:\ProgramData\NVIDIA\NVDisplay.Container.exe  10
		$a_00_8 = {30 78 45 34 34 35 39 38 41 42 37 34 34 32 35 34 35 30 36 39 32 46 37 62 33 61 39 66 38 39 38 31 31 39 39 36 38 64 61 38 41 64 } //10 0xE44598AB74425450692F7b3a9f898119968da8Ad
		$a_00_9 = {34 42 72 4c 35 31 4a 43 63 39 4e 47 51 37 31 6b 57 68 6e 59 6f 44 52 66 66 73 44 5a 79 37 6d 31 48 55 55 37 4d 52 55 34 6e 55 4d 58 41 48 4e 46 42 45 } //10 4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBE
		$a_00_10 = {31 4c 47 73 6b 41 79 63 78 76 63 67 68 36 69 41 6f 69 67 63 76 62 77 54 74 46 6a 53 66 64 6f 64 32 78 } //10 1LGskAycxvcgh6iAoigcvbwTtFjSfdod2x
		$a_00_11 = {4c 59 42 35 36 64 36 54 65 4d 67 36 56 6d 61 68 63 67 66 54 5a 53 41 4c 41 51 52 63 4e 52 51 55 56 64 } //10 LYB56d6TeMg6VmahcgfTZSALAQRcNRQUVd
		$a_00_12 = {37 39 39 36 35 30 31 37 34 37 38 } //10 79965017478
		$a_00_13 = {52 30 36 34 35 36 35 36 39 31 33 36 39 } //10 R064565691369
		$a_00_14 = {5a 31 35 32 39 31 33 37 34 38 35 36 32 } //10 Z152913748562
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*10+(#a_00_4  & 1)*10+(#a_00_5  & 1)*10+(#a_80_6  & 1)*10+(#a_80_7  & 1)*10+(#a_00_8  & 1)*10+(#a_00_9  & 1)*10+(#a_00_10  & 1)*10+(#a_00_11  & 1)*10+(#a_00_12  & 1)*10+(#a_00_13  & 1)*10+(#a_00_14  & 1)*10) >=30
 
}
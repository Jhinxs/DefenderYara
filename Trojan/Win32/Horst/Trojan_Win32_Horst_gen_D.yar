
rule Trojan_Win32_Horst_gen_D{
	meta:
		description = "Trojan:Win32/Horst.gen!D,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 09 00 00 "
		
	strings :
		$a_01_0 = {c6 03 e3 33 c0 c6 43 05 01 89 45 e1 89 45 e5 88 45 e9 89 45 fc 8b 45 08 8d 88 60 02 00 00 } //10
		$a_00_1 = {25 73 5c 25 73 5c 63 61 6c 63 2e 63 66 67 00 } //1
		$a_00_2 = {25 73 5c 25 73 5c 63 61 6c 63 2e 65 78 65 00 } //1
		$a_00_3 = {25 73 20 2d 20 4e 6f 43 44 20 43 72 61 63 6b 20 4b 65 79 47 65 6e 2e 65 78 65 00 } //1
		$a_00_4 = {25 73 20 43 72 61 63 6b 20 50 61 74 63 68 20 53 65 72 69 61 6c 20 4b 65 79 67 65 6e 2e 65 78 65 00 } //1
		$a_00_5 = {25 73 20 2b 20 43 52 41 43 4b 20 2b 20 4e 4f 43 44 2e 65 78 65 00 } //1 猥⬠䌠䅒䭃⬠丠䍏⹄硥e
		$a_00_6 = {25 73 20 2b 20 43 52 41 43 4b 20 2b 20 41 43 54 49 56 41 54 4f 52 2e 45 58 45 00 } //1
		$a_00_7 = {25 73 20 6b 65 79 67 65 6e 20 63 72 61 63 6b 20 70 61 74 63 68 2e 65 78 65 00 } //1
		$a_00_8 = {25 73 5f 63 72 61 63 6b 5f 6b 65 79 67 65 6e 2e 65 78 65 00 } //1
	condition:
		((#a_01_0  & 1)*10+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1) >=12
 
}

rule Trojan_Win32_Horst_gen_C{
	meta:
		description = "Trojan:Win32/Horst.gen!C,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 07 00 00 "
		
	strings :
		$a_03_0 = {b9 aa 05 00 00 (66 9c [0-10] c|)6 90 03 01 01 82 86 a8 05 00 00 0a [0-20] c6 90 03 01 01 82 86 a9 05 00 00 00 90 03 05 00 66 9c [0-10] 33 ?? 85 ?? 7e ?? [0-20] 80 34 } //1
		$a_03_1 = {b9 aa 05 00 00 66 9c [0-20] c6 (82|86) a8 05 00 00 0a c6 (82|86) a9 05 00 00 00 [0-10] 33 ?? 85 ?? 7e ?? [0-04] 80 34 } //1
		$a_03_2 = {b9 aa 05 00 00 3b c1 7e 10 8b c1 c6 86 a8 05 00 00 0a c6 86 a9 05 00 00 00 33 ?? 85 ?? 7e ?? 80 34 } //1
		$a_03_3 = {be aa 05 00 00 (66 9c [0-20] 9|)0 03 04 00 e8 ?? ?? ?? ?? c6 87 a8 05 00 00 0a (66 9c [0-20] 9|)0 03 06 07 88 8f a9 05 00 00 c6 87 a9 05 00 00 00 90 03 05 00 66 9c [0-10] [0-01] 33 ?? 85 ?? [0-01] 7e [0-20] 80 34 } //1
		$a_03_4 = {ba aa 05 00 00 (66 9c [0-30] c|)6 86 a8 05 00 00 0a 90 03 05 00 66 9c [0-20] 90 03 06 07 88 8e a9 05 00 00 c6 86 a9 05 00 00 00 90 03 05 00 66 9c [0-10] 33 ?? 85 ?? 7e ?? [0-20] 80 34 } //1
		$a_03_5 = {bf aa 05 00 00 c6 86 a8 05 00 00 0a 88 8e a9 05 00 00 33 ?? 85 ?? 7e ?? [0-04] 80 34 } //1
		$a_03_6 = {b8 aa 05 00 00 c6 82 a8 05 00 00 0a 88 8a a9 05 00 00 33 ?? 85 ?? 7e ?? 80 34 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1) >=1
 
}
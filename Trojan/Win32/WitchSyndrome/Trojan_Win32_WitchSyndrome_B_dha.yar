
rule Trojan_Win32_WitchSyndrome_B_dha{
	meta:
		description = "Trojan:Win32/WitchSyndrome.B!dha,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 17 00 00 "
		
	strings :
		$a_81_0 = {50 53 44 53 64 65 72 64 66 63 63 65 77 34 72 74 66 67 64 76 65 72 54 45 52 59 26 25 5e 55 48 46 64 76 63 61 77 65 34 40 54 52 52 55 54 59 55 4a 47 46 42 56 58 43 57 51 52 57 65 72 74 65 72 59 72 65 72 65 77 72 77 65 72 21 32 34 } //1 PSDSderdfccew4rtfgdverTERY&%^UHFdvcawe4@TRRUTYUJGFBVXCWQRWerterYrerewrwer!24
		$a_81_1 = {59 69 55 70 4f 67 63 35 42 67 73 4a 45 54 39 4c 4b 32 68 54 43 51 4d 54 42 52 67 4b 41 53 59 67 49 6a 52 50 47 44 49 77 50 69 4d 6f 47 41 77 49 41 77 52 61 4c 79 63 67 4e 79 55 35 4d 43 35 77 4e 44 49 76 4d 54 55 74 50 69 59 3d } //1 YiUpOgc5BgsJET9LK2hTCQMTBRgKASYgIjRPGDIwPiMoGAwIAwRaLycgNyU5MC5wNDIvMTUtPiY=
		$a_81_2 = {49 79 41 68 4d 41 73 58 49 6a 74 55 55 41 30 4d 49 41 3d 3d } //1 IyAhMAsXIjtUUA0MIA==
		$a_81_3 = {63 44 42 72 63 77 41 49 45 51 3d 3d } //1 cDBrcwAIEQ==
		$a_81_4 = {4e 53 73 68 66 51 41 6f 45 51 3d 3d } //1 NSshfQAoEQ==
		$a_03_5 = {3c 00 61 00 20 00 68 00 72 00 65 00 66 00 3d 00 27 00 23 00 27 00 ?? 6f 00 6e 00 63 00 6c 00 69 00 63 00 6b 00 3d 00 22 00 22 00 66 00 70 00 6f 00 73 00 74 00 28 00 27 00 } //1
		$a_03_6 = {3c 61 20 68 72 65 66 3d 27 23 27 ?? 6f 6e 63 6c 69 63 6b 3d 22 22 66 70 6f 73 74 28 27 } //1
		$a_03_7 = {3c 00 62 00 72 00 3e 00 3c 00 69 00 6e 00 70 00 75 00 74 00 ?? 74 00 79 00 70 00 65 00 3d 00 22 00 22 00 68 00 69 00 64 00 64 00 65 00 6e 00 22 00 } //1
		$a_03_8 = {3c 62 72 3e 3c 69 6e 70 75 74 ?? 74 79 70 65 3d 22 22 68 69 64 64 65 6e 22 } //1
		$a_81_9 = {63 70 70 61 74 68 } //1 cppath
		$a_81_10 = {3c 74 72 3e 3c 74 64 3e 7b 30 7d 3c 2f 74 64 3e 3c 74 64 3e 26 6c 74 3b 44 49 52 26 67 74 3b 3c 74 64 3e 7b 31 7d 3c 2f 74 64 3e 3c 74 64 3e 3c 2f 74 64 3e 3c 74 64 3e 3c 2f 74 64 3e 3c 74 64 3e 7b 32 7d 3c 2f 74 64 3e 3c 2f 74 72 3e } //1 <tr><td>{0}</td><td>&lt;DIR&gt;<td>{1}</td><td></td><td></td><td>{2}</td></tr>
		$a_81_11 = {6f 6e 63 6c 69 63 6b 3d 22 22 66 67 65 74 } //1 onclick=""fget
		$a_81_12 = {6f 6e 63 6c 69 63 6b 3d 22 22 66 63 6f 70 79 } //1 onclick=""fcopy
		$a_81_13 = {6f 6e 63 6c 69 63 6b 3d 22 22 66 64 65 6c } //1 onclick=""fdel
		$a_81_14 = {74 78 74 43 4d 50 } //1 txtCMP
		$a_81_15 = {74 78 74 43 4d 50 48 69 64 64 65 6e } //1 txtCMPHidden
		$a_81_16 = {6c 62 6c 44 72 69 76 65 73 } //1 lblDrives
		$a_81_17 = {6c 62 6c 50 61 74 68 } //1 lblPath
		$a_81_18 = {6c 62 6c 44 69 72 4f 75 74 } //1 lblDirOut
		$a_81_19 = {72 65 73 57 6d } //1 resWm
		$a_81_20 = {62 74 6e 57 6d } //1 btnWm
		$a_81_21 = {74 78 74 53 6c 65 65 70 } //1 txtSleep
		$a_81_22 = {62 74 6e 45 78 } //1 btnEx
	condition:
		((#a_81_0  & 1)*1+(#a_81_1  & 1)*1+(#a_81_2  & 1)*1+(#a_81_3  & 1)*1+(#a_81_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1+(#a_03_7  & 1)*1+(#a_03_8  & 1)*1+(#a_81_9  & 1)*1+(#a_81_10  & 1)*1+(#a_81_11  & 1)*1+(#a_81_12  & 1)*1+(#a_81_13  & 1)*1+(#a_81_14  & 1)*1+(#a_81_15  & 1)*1+(#a_81_16  & 1)*1+(#a_81_17  & 1)*1+(#a_81_18  & 1)*1+(#a_81_19  & 1)*1+(#a_81_20  & 1)*1+(#a_81_21  & 1)*1+(#a_81_22  & 1)*1) >=6
 
}
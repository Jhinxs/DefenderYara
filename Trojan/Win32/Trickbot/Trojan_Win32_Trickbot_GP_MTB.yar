
rule Trojan_Win32_Trickbot_GP_MTB{
	meta:
		description = "Trojan:Win32/Trickbot.GP!MTB,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_02_0 = {55 8b ec 51 [0-06] 64 a1 30 00 00 00 89 45 [0-01] 8b 45 [0-06] 8b e5 5d c3 [0-ff] b9 6f 00 00 00 66 [0-04] 61 00 66 [0-04] 66 [0-04] b9 6c 00 00 00 66 [0-04] 73 00 66 [0-04] 77 00 66 [0-04] 68 00 66 [0-04] 6b 00 66 [0-04] 2e 00 66 [0-04] 64 00 } //1
		$a_02_1 = {55 8b ec 51 [0-06] 64 a1 30 00 00 00 89 45 [0-01] 8b 45 [0-06] 8b e5 5d c3 [0-ff] 61 00 66 c7 [0-04] 73 00 66 [0-04] 77 00 66 [0-04] 68 00 66 [0-04] 6f 00 66 [0-04] 6f 00 66 [0-04] 6b 00 66 [0-04] 2e 00 66 [0-04] 64 00 66 [0-04] 6c 00 66 [0-04] 6c 00 66 [0-04] 00 00 } //1
		$a_80_2 = {f7 d8 1b c0 59 f7 d8 48 c3 } //ï¿½ï¿½ï¿½Yï¿½ï¿½Hï¿½  1
		$a_02_3 = {51 3d 00 10 00 00 8d [0-05] 81 e9 00 10 00 00 2d 00 10 00 00 85 01 3d 00 10 00 00 [0-04] 8b c4 85 01 [0-04] 8b [0-04] 50 c3 } //1
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_80_2  & 1)*1+(#a_02_3  & 1)*1) >=3
 
}
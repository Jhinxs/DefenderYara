
rule Trojan_Win32_TurlaCarbonInstaller_C{
	meta:
		description = "Trojan:Win32/TurlaCarbonInstaller.C,SIGNATURE_TYPE_PEHSTR,0d 00 0d 00 0b 00 00 "
		
	strings :
		$a_01_0 = {4d 00 6f 00 7a 00 69 00 6c 00 6c 00 61 00 2f 00 35 00 2e 00 30 00 20 00 28 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 20 00 31 00 30 00 2e 00 30 00 3b 00 20 00 57 00 69 00 6e 00 36 00 34 00 3b 00 20 00 78 00 36 00 34 00 29 00 20 00 41 00 70 00 70 00 6c 00 65 00 57 00 65 00 62 00 4b 00 69 00 74 00 2f 00 35 00 33 00 37 00 2e 00 33 00 36 00 20 00 28 00 4b 00 48 00 54 00 4d 00 4c 00 2c 00 20 00 6c 00 69 00 6b 00 65 00 20 00 47 00 65 00 63 00 6b 00 6f 00 29 00 20 00 43 00 68 00 72 00 6f 00 6d 00 65 00 2f 00 31 00 30 00 37 00 2e 00 30 00 2e 00 30 00 2e 00 30 00 20 00 53 00 61 00 66 00 61 00 72 00 69 00 2f 00 35 00 33 00 37 00 2e 00 33 00 36 00 } //1 Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36
		$a_01_1 = {4d 00 6f 00 7a 00 69 00 6c 00 6c 00 61 00 2f 00 35 00 2e 00 30 00 20 00 28 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 20 00 31 00 30 00 2e 00 30 00 3b 00 20 00 57 00 69 00 6e 00 36 00 34 00 3b 00 20 00 78 00 36 00 34 00 3b 00 20 00 72 00 76 00 3a 00 31 00 30 00 36 00 2e 00 30 00 29 00 20 00 47 00 65 00 63 00 6b 00 6f 00 2f 00 32 00 30 00 31 00 30 00 30 00 31 00 30 00 31 00 20 00 46 00 69 00 72 00 65 00 66 00 6f 00 78 00 2f 00 31 00 30 00 36 00 2e 00 30 00 } //1 Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0
		$a_01_2 = {4d 00 6f 00 7a 00 69 00 6c 00 6c 00 61 00 2f 00 35 00 2e 00 30 00 20 00 28 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 20 00 31 00 30 00 2e 00 30 00 3b 00 20 00 54 00 72 00 69 00 64 00 65 00 6e 00 74 00 2f 00 37 00 2e 00 30 00 3b 00 20 00 72 00 76 00 3a 00 31 00 31 00 2e 00 30 00 29 00 20 00 6c 00 69 00 6b 00 65 00 20 00 47 00 65 00 63 00 6b 00 6f 00 } //1 Mozilla/5.0 (Windows NT 10.0; Trident/7.0; rv:11.0) like Gecko
		$a_01_3 = {43 00 3a 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5c 00 24 00 4e 00 74 00 55 00 6e 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 51 00 36 00 30 00 38 00 33 00 31 00 37 00 24 00 } //2 C:\Windows\$NtUninstallQ608317$
		$a_01_4 = {53 65 74 20 69 6d 70 6c 61 6e 74 20 49 44 20 74 6f 20 } //2 Set implant ID to 
		$a_01_5 = {53 68 65 6c 6c 20 43 6f 6d 6d 61 6e 64 3a 20 } //2 Shell Command: 
		$a_01_6 = {52 75 6e 20 61 73 20 75 73 65 72 3a 20 } //2 Run as user: 
		$a_01_7 = {55 70 6c 6f 61 64 20 66 69 6c 65 } //2 Upload file
		$a_01_8 = {47 00 6c 00 6f 00 62 00 61 00 6c 00 5c 00 57 00 69 00 6e 00 42 00 61 00 73 00 65 00 53 00 76 00 63 00 44 00 42 00 4c 00 6f 00 63 00 6b 00 } //1 Global\WinBaseSvcDBLock
		$a_01_9 = {47 00 6c 00 6f 00 62 00 61 00 6c 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 43 00 6f 00 6d 00 6d 00 43 00 74 00 72 00 6c 00 44 00 42 00 } //1 Global\WindowsCommCtrlDB
		$a_01_10 = {2f 00 49 00 4d 00 41 00 47 00 45 00 53 00 2f 00 33 00 2f 00 } //1 /IMAGES/3/
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_01_6  & 1)*2+(#a_01_7  & 1)*2+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1) >=13
 
}
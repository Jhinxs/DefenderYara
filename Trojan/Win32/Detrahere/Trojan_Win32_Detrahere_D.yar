
rule Trojan_Win32_Detrahere_D{
	meta:
		description = "Trojan:Win32/Detrahere.D,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 10 00 00 "
		
	strings :
		$a_03_0 = {4a 6e 30 79 c7 ?? ?? 6e 54 6e 49 c7 ?? ?? 2e 70 79 79 } //10
		$a_03_1 = {43 38 76 33 c7 ?? ?? 70 54 6e 76 c7 ?? ?? 38 36 6f 33 c7 ?? ?? 70 70 36 38 c7 ?? ?? 6f 6f 38 6f } //10
		$a_03_2 = {7b 00 41 00 c7 ?? ?? ?? 00 00 00 42 00 45 00 c7 ?? ?? ?? 00 00 00 34 00 37 00 c7 ?? ?? ?? 00 00 00 42 00 37 00 c7 ?? ?? ?? 00 00 00 32 00 2d 00 c7 ?? ?? ?? 00 00 00 30 00 43 00 c7 ?? ?? ?? 00 00 00 32 00 46 00 } //5
		$a_03_3 = {47 00 6c 00 c7 ?? ?? 6f 00 62 00 c7 ?? ?? 61 00 6c 00 c7 ?? ?? 5c 00 53 00 c7 ?? ?? 65 00 74 00 c7 ?? ?? 75 00 70 00 c7 ?? ?? 4d 00 75 00 c7 ?? ?? 74 00 65 00 c7 ?? ?? 78 00 5f 00 } //5
		$a_03_4 = {50 00 72 00 c7 ?? ?? 69 00 6b 00 c7 ?? ?? 72 00 79 00 c7 ?? ?? 6c 00 00 00 } //10
		$a_03_5 = {6d 00 73 00 c7 ?? ?? 69 00 64 00 c7 ?? ?? 6e 00 74 00 c7 ?? ?? 66 00 73 00 } //10
		$a_03_6 = {63 64 6e 2e c7 ?? ?? 6f 70 74 69 c7 ?? ?? 74 63 2e 63 c7 ?? ?? 6f 6d 2f 6a c7 ?? ?? 71 75 65 72 c7 ?? ?? 79 2e 6d 69 c7 ?? ?? 6e 2e 6a 73 } //10
		$a_00_7 = {68 74 74 70 73 3a 2f 2f 63 64 6e 2e 6f 70 74 69 74 63 2e 63 6f 6d 2f 6a 71 75 65 72 79 2e 6d 69 6e 2e 6a 73 } //5 https://cdn.optitc.com/jquery.min.js
		$a_80_8 = {7b 41 42 45 34 37 42 37 32 2d 30 43 32 46 2d 34 32 31 46 2d 42 46 35 2d 44 38 36 46 38 41 42 44 33 35 37 30 7d } //{ABE47B72-0C2F-421F-BF5-D86F8ABD3570}  5
		$a_03_9 = {46 33 3f 69 40 00 51 3d c7 ?? ?? ?? 00 00 44 33 3f 74 40 00 51 47 c7 ?? ?? ?? 00 00 5c 69 74 58 40 00 51 51 c7 ?? ?? ?? 00 00 73 3f 4a 2f } //10
		$a_03_10 = {43 38 76 4a 40 00 4c 2a c7 ?? ?? 00 00 00 51 48 54 34 40 00 4c 34 c7 ?? ?? 00 00 00 79 38 72 00 } //10
		$a_03_11 = {7b 00 41 00 c7 ?? ?? 42 00 45 00 c7 ?? ?? 34 00 37 00 c7 ?? ?? 42 00 37 00 } //5
		$a_03_12 = {57 57 2e 56 c7 ?? ?? 6f 38 36 34 c7 ?? ?? 38 6f 76 2e c7 ?? ?? 52 31 6c 71 } //10
		$a_03_13 = {30 76 76 6e c7 ?? ?? 71 61 61 2d c7 ?? ?? 6e 76 75 2e c7 ?? ?? 52 31 6c 61 } //10
		$a_00_14 = {68 74 74 70 3a 2f 2f 6f 70 74 69 74 6d 2e 63 6f 6d 2f 63 6c 69 65 6e 74 } //5 http://optitm.com/client
		$a_00_15 = {68 74 74 70 3a 2f 2f 67 70 74 39 2e 63 6f 6d 2f 61 70 69 2f 63 70 78 3f 4c 71 3d } //5 http://gpt9.com/api/cpx?Lq=
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*10+(#a_03_2  & 1)*5+(#a_03_3  & 1)*5+(#a_03_4  & 1)*10+(#a_03_5  & 1)*10+(#a_03_6  & 1)*10+(#a_00_7  & 1)*5+(#a_80_8  & 1)*5+(#a_03_9  & 1)*10+(#a_03_10  & 1)*10+(#a_03_11  & 1)*5+(#a_03_12  & 1)*10+(#a_03_13  & 1)*10+(#a_00_14  & 1)*5+(#a_00_15  & 1)*5) >=20
 
}
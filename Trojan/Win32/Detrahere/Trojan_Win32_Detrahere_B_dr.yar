
rule Trojan_Win32_Detrahere_B_dr{
	meta:
		description = "Trojan:Win32/Detrahere.B!dr,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 34 00 00 "
		
	strings :
		$a_01_0 = {61 5f 71 54 77 42 48 57 4b 46 44 4d 6b 69 55 6d 49 65 6c 4a 38 79 68 6a 62 30 66 34 7a 51 4f 39 53 78 75 58 41 56 5a 33 37 32 45 4c 72 74 47 36 76 43 4e 64 73 35 70 6f 59 6e 31 63 67 50 52 } //20 a_qTwBHWKFDMkiUmIelJ8yhjb0f4zQO9SxuXAVZ372ELrtG6vCNds5poYn1cgPR
		$a_01_1 = {52 50 67 63 31 6e 59 6f 70 35 73 64 4e 43 76 36 47 74 72 4c 45 32 37 33 5a 56 41 58 75 78 53 39 4f 51 7a 34 66 30 62 6a 68 79 38 4a 6c 65 49 6d 55 69 6b 4d 44 46 4b 57 48 42 77 54 71 } //20 RPgc1nYop5sdNCv6GtrLE273ZVAXuxS9OQz4f0bjhy8JleImUikMDFKWHBwTq
		$a_03_2 = {33 d2 85 f6 ?? ?? 83 c0 03 ?? ?? 83 c0 40 f7 f3 8a 44 15 b8 88 01 } //10
		$a_00_3 = {85 db 74 05 83 c0 fd eb 03 83 c0 46 99 } //10
		$a_03_4 = {31 6e 59 6f c7 ?? ?? 70 35 73 64 c7 ?? ?? 4e 43 76 36 c7 ?? ?? 47 74 72 4c } //10
		$a_03_5 = {44 72 76 50 [0-03] c7 [0-07] 72 6f 74 65 [0-03] c7 [0-07] 63 74 00 00 } //10
		$a_03_6 = {2e 00 5c 00 c7 ?? ?? 44 00 72 00 c7 ?? ?? 76 00 50 00 c7 ?? ?? 72 00 6f 00 c7 ?? ?? 74 00 65 00 c7 ?? ?? 63 00 74 00 } //10
		$a_80_7 = {5c 2e 5c 5c 44 72 76 50 72 6f 74 65 63 74 } //\.\\DrvProtect  10
		$a_00_8 = {72 00 71 00 32 00 63 00 43 00 79 00 38 00 66 00 68 00 4c 00 70 00 49 00 34 00 54 00 77 00 43 00 46 00 52 00 43 00 55 00 } //10 rq2cCy8fhLpI4TwCFRCU
		$a_00_9 = {57 00 2d 00 72 00 50 00 4a 00 62 00 77 00 36 00 4c 00 51 00 74 00 6d 00 50 00 65 00 66 00 35 00 6b 00 78 00 71 00 68 00 } //10 W-rPJbw6LQtmPef5kxqh
		$a_00_10 = {51 00 65 00 63 00 54 00 6d 00 7a 00 67 00 63 00 6d 00 66 00 57 00 36 00 53 00 43 00 66 00 34 00 2d 00 73 00 35 00 73 00 } //10 QecTmzgcmfW6SCf4-s5s
		$a_00_11 = {6d 00 4e 00 79 00 52 00 70 00 36 00 6b 00 59 00 48 00 35 00 63 00 55 00 73 00 6f 00 4e 00 6c 00 75 00 54 00 43 00 6e 00 } //10 mNyRp6kYH5cUsoNluTCn
		$a_03_12 = {72 00 71 00 c7 [0-03] 32 00 63 00 c7 [0-03] 43 00 79 00 c7 [0-03] 38 00 66 00 } //10
		$a_03_13 = {6d 00 4e 00 c7 [0-03] 79 00 52 00 c7 [0-03] 70 00 36 00 c7 [0-03] 6b 00 59 00 c7 [0-03] 48 00 35 00 } //10
		$a_03_14 = {78 35 31 00 65 00 c7 [0-03] 63 00 54 00 c7 [0-03] 6d 00 7a 00 c7 [0-03] 67 00 63 } //10
		$a_03_15 = {69 6e 73 74 c7 [0-03] 61 00 00 00 } //10
		$a_03_16 = {18 49 67 6f 76 c7 [0-06] 1c 54 00 00 00 8d 51 01 } //10
		$a_03_17 = {6d 38 36 67 c7 ?? ?? 38 79 45 72 c7 ?? ?? 2e 70 79 79 } //10
		$a_03_18 = {43 38 76 37 c7 ?? ?? 38 36 6f 49 c7 ?? ?? 31 67 74 41 66 ?? ?? dc 44 00 } //10
		$a_03_19 = {43 38 76 35 c7 ?? ?? 54 76 49 64 c7 ?? ?? 38 58 62 6f c7 ?? ?? 76 38 6c 4a c7 ?? ?? 67 51 31 00 } //10
		$a_03_20 = {52 00 6a 00 c7 ?? ?? 79 00 55 00 c7 ?? ?? 35 00 46 00 c7 ?? ?? 64 00 79 } //10
		$a_00_21 = {65 67 6c 54 6e 37 49 38 57 78 51 6b 49 79 38 } //10 eglTn7I8WxQkIy8
		$a_00_22 = {4a 6f 4b 54 70 58 76 36 49 67 2d 2f 76 36 44 } //10 JoKTpXv6Ig-/v6D
		$a_00_23 = {3f 38 2d 69 38 79 38 76 38 37 54 79 56 38 44 } //10 ?8-i8y8v87TyV8D
		$a_00_24 = {43 38 76 73 31 6c 6c 54 67 70 47 49 67 38 44 } //10 C8vs1llTgpGIg8D
		$a_00_25 = {3f 38 2d 73 36 38 54 76 38 4d 38 62 74 41 44 } //10 ?8-s68Tv8M8btAD
		$a_00_26 = {43 38 76 4d 38 62 35 54 6c 38 48 38 41 76 44 } //10 C8vM8b5Tl8H8AvD
		$a_00_27 = {2f 36 31 52 38 6f 6f 45 72 6b 49 36 6f 76 44 } //10 /61R8ooErkI6ovD
		$a_00_28 = {44 49 67 46 76 76 6e 3f 38 54 70 69 54 76 54 } //10 DIgFvvn?8TpiTvT
		$a_00_29 = {69 38 64 49 52 38 4a 31 73 31 67 76 36 31 79 } //10 i8dIR8J1s1gv61y
		$a_00_30 = {6e 65 74 66 69 6c 74 65 72 33 5f 78 36 34 5f 78 70 2e 64 61 74 61 } //2 netfilter3_x64_xp.data
		$a_00_31 = {6e 65 74 66 69 6c 74 65 72 33 5f 78 36 34 5f 77 69 6e 38 2e 64 61 74 61 } //2 netfilter3_x64_win8.data
		$a_00_32 = {6e 65 74 66 69 6c 74 65 72 33 5f 78 36 34 5f 77 69 6e 37 2e 64 61 74 61 } //2 netfilter3_x64_win7.data
		$a_00_33 = {6e 65 74 66 69 6c 74 65 72 33 5f 78 38 36 5f 78 70 2e 64 61 74 61 } //2 netfilter3_x86_xp.data
		$a_00_34 = {6e 65 74 66 69 6c 74 65 72 33 5f 78 38 36 5f 77 69 6e 38 2e 64 61 74 61 } //2 netfilter3_x86_win8.data
		$a_00_35 = {6e 65 74 66 69 6c 74 65 72 33 5f 78 38 36 5f 77 69 6e 37 2e 64 61 74 61 } //2 netfilter3_x86_win7.data
		$a_00_36 = {72 61 64 61 72 64 74 33 32 2e 64 61 74 61 } //2 radardt32.data
		$a_00_37 = {72 61 64 61 72 64 74 36 34 2e 64 61 74 61 } //2 radardt64.data
		$a_00_38 = {6d 73 69 64 6e 74 6c 64 33 32 2e 64 61 74 61 } //2 msidntld32.data
		$a_00_39 = {6d 73 69 64 6e 74 6c 64 36 34 2e 64 61 74 61 } //2 msidntld64.data
		$a_00_40 = {75 64 69 73 6b 2e 64 61 74 61 } //2 udisk.data
		$a_00_41 = {61 74 61 64 2e 70 78 5f 34 36 78 5f 33 72 65 74 6c 69 66 74 65 6e } //2 atad.px_46x_3retliften
		$a_00_42 = {61 74 61 64 2e 38 6e 69 77 5f 34 36 78 5f 33 72 65 74 6c 69 66 74 65 6e } //2 atad.8niw_46x_3retliften
		$a_00_43 = {61 74 61 64 2e 37 6e 69 77 5f 34 36 78 5f 33 72 65 74 6c 69 66 74 65 6e } //2 atad.7niw_46x_3retliften
		$a_00_44 = {61 74 61 64 2e 70 78 5f 36 38 78 5f 33 72 65 74 6c 69 66 74 65 6e } //2 atad.px_68x_3retliften
		$a_00_45 = {61 74 61 64 2e 38 6e 69 77 5f 36 38 78 5f 33 72 65 74 6c 69 66 74 65 6e } //2 atad.8niw_68x_3retliften
		$a_00_46 = {61 74 61 64 2e 37 6e 69 77 5f 36 38 78 5f 33 72 65 74 6c 69 66 74 65 6e } //2 atad.7niw_68x_3retliften
		$a_00_47 = {61 74 61 64 2e 32 33 74 64 72 61 64 61 72 } //2 atad.23tdradar
		$a_00_48 = {61 74 61 64 2e 34 36 74 64 72 61 64 61 72 } //2 atad.46tdradar
		$a_00_49 = {61 74 61 64 2e 32 33 64 6c 74 6e 64 69 73 6d } //2 atad.23dltndism
		$a_00_50 = {61 74 61 64 2e 34 36 64 6c 74 6e 64 69 73 6d } //2 atad.46dltndism
		$a_00_51 = {61 74 61 64 2e 6b 73 69 64 75 } //2 atad.ksidu
	condition:
		((#a_01_0  & 1)*20+(#a_01_1  & 1)*20+(#a_03_2  & 1)*10+(#a_00_3  & 1)*10+(#a_03_4  & 1)*10+(#a_03_5  & 1)*10+(#a_03_6  & 1)*10+(#a_80_7  & 1)*10+(#a_00_8  & 1)*10+(#a_00_9  & 1)*10+(#a_00_10  & 1)*10+(#a_00_11  & 1)*10+(#a_03_12  & 1)*10+(#a_03_13  & 1)*10+(#a_03_14  & 1)*10+(#a_03_15  & 1)*10+(#a_03_16  & 1)*10+(#a_03_17  & 1)*10+(#a_03_18  & 1)*10+(#a_03_19  & 1)*10+(#a_03_20  & 1)*10+(#a_00_21  & 1)*10+(#a_00_22  & 1)*10+(#a_00_23  & 1)*10+(#a_00_24  & 1)*10+(#a_00_25  & 1)*10+(#a_00_26  & 1)*10+(#a_00_27  & 1)*10+(#a_00_28  & 1)*10+(#a_00_29  & 1)*10+(#a_00_30  & 1)*2+(#a_00_31  & 1)*2+(#a_00_32  & 1)*2+(#a_00_33  & 1)*2+(#a_00_34  & 1)*2+(#a_00_35  & 1)*2+(#a_00_36  & 1)*2+(#a_00_37  & 1)*2+(#a_00_38  & 1)*2+(#a_00_39  & 1)*2+(#a_00_40  & 1)*2+(#a_00_41  & 1)*2+(#a_00_42  & 1)*2+(#a_00_43  & 1)*2+(#a_00_44  & 1)*2+(#a_00_45  & 1)*2+(#a_00_46  & 1)*2+(#a_00_47  & 1)*2+(#a_00_48  & 1)*2+(#a_00_49  & 1)*2+(#a_00_50  & 1)*2+(#a_00_51  & 1)*2) >=20
 
}
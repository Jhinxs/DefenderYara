
rule Trojan_Win32_VB_VT{
	meta:
		description = "Trojan:Win32/VB.VT,SIGNATURE_TYPE_PEHSTR_EXT,0d 00 0d 00 05 00 00 "
		
	strings :
		$a_00_0 = {30 00 30 00 37 00 37 00 41 00 35 00 37 00 37 00 } //1 0077A577
		$a_00_1 = {37 00 37 00 45 00 36 00 42 00 34 00 36 00 36 00 37 00 37 00 46 00 30 00 46 00 30 00 35 00 34 00 30 00 36 00 33 00 37 00 44 00 36 00 37 00 37 00 } //1 77E6B46677F0F0540637D677
		$a_00_2 = {43 72 65 61 74 65 50 72 6f 63 65 73 73 41 } //1 CreateProcessA
		$a_00_3 = {57 72 69 74 65 50 72 6f 63 65 73 73 4d 65 6d 6f 72 79 } //1 WriteProcessMemory
		$a_01_4 = {eb 0f 8b 45 e8 03 45 b4 0f 80 d8 00 00 00 89 45 e8 8b 45 e8 3b 45 b0 7f 7c c7 45 d0 01 00 00 00 } //10
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_01_4  & 1)*10) >=13
 
}
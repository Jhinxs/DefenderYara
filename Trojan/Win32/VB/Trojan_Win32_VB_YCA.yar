
rule Trojan_Win32_VB_YCA{
	meta:
		description = "Trojan:Win32/VB.YCA,SIGNATURE_TYPE_PEHSTR,15 00 15 00 06 00 00 "
		
	strings :
		$a_01_0 = {37 00 38 00 45 00 31 00 42 00 44 00 44 00 31 00 2d 00 39 00 39 00 34 00 31 00 2d 00 31 00 31 00 63 00 66 00 2d 00 39 00 37 00 35 00 36 00 2d 00 30 00 30 00 41 00 41 00 30 00 30 00 43 00 30 00 30 00 39 00 30 00 38 00 } //10 78E1BDD1-9941-11cf-9756-00AA00C00908
		$a_01_1 = {41 00 5f 00 46 00 49 00 4e 00 41 00 4c 00 32 00 5c 00 41 00 5f 00 46 00 49 00 4e 00 41 00 4c 00 2e 00 76 00 62 00 70 00 } //4 A_FINAL2\A_FINAL.vbp
		$a_01_2 = {70 69 6c 6f 74 6f 32 00 41 5f 46 49 4e 41 4c 00 00 41 5f 46 49 4e 41 4c 32 } //4
		$a_01_3 = {43 48 45 47 41 44 4f 53 5f 4e 4f 56 4f 53 } //3 CHEGADOS_NOVOS
		$a_01_4 = {42 6c 6f 63 6f 20 64 65 20 44 61 64 6f 73 } //3 Bloco de Dados
		$a_01_5 = {54 6f 70 4c 65 76 56 69 73 57 69 6e 64 73 46 6f 75 6e 64 } //3 TopLevVisWindsFound
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*4+(#a_01_2  & 1)*4+(#a_01_3  & 1)*3+(#a_01_4  & 1)*3+(#a_01_5  & 1)*3) >=21
 
}

rule Trojan_Win32_Herxmin_A{
	meta:
		description = "Trojan:Win32/Herxmin.A,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 07 00 00 "
		
	strings :
		$a_01_0 = {3a 79 65 61 68 79 65 61 68 79 65 61 68 40 6d 69 6e 65 2e 70 6f 6f 6c 2d 78 2e 65 75 } //1 :yeahyeahyeah@mine.pool-x.eu
		$a_02_1 = {79 65 61 68 79 65 61 68 79 65 61 68 [0-08] 62 61 72 62 69 65 2e 31 } //1
		$a_01_2 = {0f b7 07 0f b7 1e ff 4d 08 ff 4d fc 83 c6 02 89 45 f8 83 c7 02 } //1
		$a_03_3 = {89 5e 78 89 5e 7c 88 9e 80 00 00 00 68 ?? ?? ?? 00 8b ce c6 ?? ?? 06 c7 46 34 03 00 00 00 } //1
		$a_01_4 = {63 6f 69 6e 2d 6d 69 6e 65 72 } //1 coin-miner
		$a_03_5 = {50 53 53 6a 1a 53 ff 15 ?? ?? ?? ?? 68 04 01 00 00 8d 85 ?? ?? ?? ?? 53 50 e8 ?? ?? ?? ?? 6a 25 58 66 89 45 } //1
		$a_03_6 = {68 41 00 00 80 ff 15 ?? ?? ?? ?? 8b 85 64 ff ff ff 3b c3 74 05 8d 70 50 eb 02 33 f6 05 d8 02 00 00 50 8b ce 89 86 00 02 00 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_02_1  & 1)*1+(#a_01_2  & 1)*1+(#a_03_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1) >=4
 
}

rule Trojan_Win32_Rapid_AA_MTB{
	meta:
		description = "Trojan:Win32/Rapid.AA!MTB,SIGNATURE_TYPE_PEHSTR,07 00 07 00 07 00 00 "
		
	strings :
		$a_01_0 = {53 6f 66 74 77 61 72 65 5c 45 6e 63 72 79 70 74 4b 65 79 73 } //1 Software\EncryptKeys
		$a_01_1 = {72 65 63 6f 76 65 72 79 2e 74 78 74 } //1 recovery.txt
		$a_01_2 = {48 6f 77 20 52 65 63 6f 76 65 72 79 20 46 69 6c 65 73 2e 74 78 74 } //1 How Recovery Files.txt
		$a_01_3 = {44 45 43 52 59 50 54 45 44 } //1 DECRYPTED
		$a_01_4 = {49 45 46 4d 54 43 42 5a 54 31 56 53 49 45 52 50 51 31 56 4e 52 55 35 55 55 79 77 67 55 45 68 50 56 45 39 54 4c 43 42 45 51 56 52 42 51 6b 46 54 52 56 4d 67 51 55 35 45 49 45 39 55 53 45 56 53 49 45 6c 4e 55 45 39 53 56 45 46 4f 56 43 42 47 53 55 78 46 55 79 42 49 51 56 5a 46 49 45 4a 46 52 55 34 67 52 55 35 44 55 6c 6c 51 56 45 56 45 49 51 30 } //1 IEFMTCBZT1VSIERPQ1VNRU5UUywgUEhPVE9TLCBEQVRBQkFTRVMgQU5EIE9USEVSIElNUE9SVEFOVCBGSUxFUyBIQVZFIEJFRU4gRU5DUllQVEVEIQ0
		$a_01_5 = {43 69 42 4f 62 33 52 6c 49 53 42 45 62 32 35 30 49 47 52 6c 62 47 56 30 5a 53 42 79 59 57 35 7a 62 32 31 33 59 58 4a 6c 49 47 46 75 5a 43 42 30 64 58 4a 75 4c 57 39 75 49 47 46 75 65 53 42 68 62 6e 52 70 64 6d 6c 79 64 58 4d 73 49 47 4a 6c 59 32 46 31 63 32 55 67 65 57 39 31 49 47 4e 68 62 69 42 73 62 33 4e 7a 49 47 46 73 62 43 42 35 62 33 56 79 49 47 5a 70 62 47 56 7a 49 51 30 } //1 CiBOb3RlISBEb250IGRlbGV0ZSByYW5zb213YXJlIGFuZCB0dXJuLW9uIGFueSBhbnRpdmlydXMsIGJlY2F1c2UgeW91IGNhbiBsb3NzIGFsbCB5b3VyIGZpbGVzIQ0
		$a_01_6 = {49 46 64 6c 49 48 4e 6c 62 6d 51 67 65 57 39 31 49 47 5a 31 62 47 77 67 61 57 35 7a 64 48 4a 31 59 33 52 70 62 32 34 67 61 47 39 33 49 48 52 76 49 47 52 6c 59 33 4a 35 63 48 51 67 59 57 78 73 49 48 6c 76 64 58 49 67 5a 6d 6c 73 5a 58 4d 75 } //1 IFdlIHNlbmQgeW91IGZ1bGwgaW5zdHJ1Y3Rpb24gaG93IHRvIGRlY3J5cHQgYWxsIHlvdXIgZmlsZXMu
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1) >=7
 
}
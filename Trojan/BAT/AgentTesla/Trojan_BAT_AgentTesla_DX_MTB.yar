
rule Trojan_BAT_AgentTesla_DX_MTB{
	meta:
		description = "Trojan:BAT/AgentTesla.DX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 06 00 00 "
		
	strings :
		$a_01_0 = {40 00 4c 00 6f 00 67 00 69 00 6e 00 4e 00 61 00 6d 00 65 00 } //1 @LoginName
		$a_01_1 = {40 00 4c 00 6f 00 67 00 69 00 6e 00 50 00 77 00 64 00 } //1 @LoginPwd
		$a_01_2 = {44 00 61 00 74 00 61 00 20 00 53 00 6f 00 75 00 72 00 63 00 65 00 3d 00 31 00 37 00 32 00 2e 00 32 00 30 00 2e 00 35 00 38 00 2e 00 33 00 } //1 Data Source=172.20.58.3
		$a_01_3 = {66 00 74 00 70 00 3a 00 2f 00 2f 00 31 00 37 00 32 00 2e 00 32 00 30 00 2e 00 35 00 38 00 2e 00 35 00 3a 00 38 00 30 00 31 00 37 00 2f 00 53 00 6f 00 66 00 74 00 55 00 70 00 64 00 61 00 74 00 65 00 } //1 ftp://172.20.58.5:8017/SoftUpdate
		$a_01_4 = {41 00 6e 00 64 00 72 00 6f 00 69 00 64 00 53 00 74 00 75 00 64 00 69 00 6f 00 2e 00 64 00 6c 00 6c 00 } //1 AndroidStudio.dll
		$a_01_5 = {52 00 69 00 67 00 68 00 74 00 69 00 6e 00 67 00 53 00 79 00 73 00 2e 00 44 00 41 00 4c 00 } //1 RightingSys.DAL
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=5
 
}
rule Trojan_BAT_AgentTesla_DX_MTB_2{
	meta:
		description = "Trojan:BAT/AgentTesla.DX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,19 00 19 00 11 00 00 "
		
	strings :
		$a_81_0 = {24 61 38 34 35 64 32 39 37 2d 64 36 32 61 2d 34 65 35 34 2d 38 36 35 36 2d 64 38 32 35 35 64 34 65 32 62 62 38 } //20 $a845d297-d62a-4e54-8656-d8255d4e2bb8
		$a_81_1 = {24 61 32 33 36 34 30 38 66 2d 64 30 34 63 2d 34 35 31 34 2d 38 62 64 65 2d 62 66 34 31 63 63 37 32 34 37 66 31 } //20 $a236408f-d04c-4514-8bde-bf41cc7247f1
		$a_81_2 = {24 30 64 30 64 33 34 34 62 2d 30 37 63 65 2d 34 39 36 65 2d 38 30 33 38 2d 64 39 61 38 30 36 39 32 33 37 36 62 } //20 $0d0d344b-07ce-496e-8038-d9a80692376b
		$a_81_3 = {24 63 36 37 30 62 63 64 39 2d 38 31 37 34 2d 34 37 39 37 2d 62 34 34 32 2d 32 63 31 32 39 64 32 35 34 38 62 66 } //20 $c670bcd9-8174-4797-b442-2c129d2548bf
		$a_81_4 = {45 73 70 69 6f 6e 61 67 65 5f 53 6f 72 74 65 72 2e 4d 79 2e 52 65 73 6f 75 72 63 65 73 } //1 Espionage_Sorter.My.Resources
		$a_81_5 = {53 71 6c 46 6f 72 6d 61 74 74 65 72 2e 50 72 6f 70 65 72 74 69 65 73 2e 52 65 73 6f 75 72 63 65 73 } //1 SqlFormatter.Properties.Resources
		$a_81_6 = {4d 61 6e 64 65 6c 62 72 6f 74 45 78 70 6c 6f 72 65 72 2e 4d 79 2e 52 65 73 6f 75 72 63 65 73 } //1 MandelbrotExplorer.My.Resources
		$a_81_7 = {46 69 6c 65 5f 53 79 73 74 65 6d 5f 43 6f 6e 74 72 6f 6c 73 2e 4d 79 2e 52 65 73 6f 75 72 63 65 73 } //1 File_System_Controls.My.Resources
		$a_81_8 = {44 65 62 75 67 67 65 72 4e 6f 6e 55 73 65 72 43 6f 64 65 41 74 74 72 69 62 75 74 65 } //1 DebuggerNonUserCodeAttribute
		$a_81_9 = {44 65 62 75 67 67 65 72 42 72 6f 77 73 61 62 6c 65 41 74 74 72 69 62 75 74 65 } //1 DebuggerBrowsableAttribute
		$a_81_10 = {44 65 62 75 67 67 65 72 53 74 65 70 54 68 72 6f 75 67 68 41 74 74 72 69 62 75 74 65 } //1 DebuggerStepThroughAttribute
		$a_81_11 = {44 65 62 75 67 67 65 72 42 72 6f 77 73 61 62 6c 65 53 74 61 74 65 } //1 DebuggerBrowsableState
		$a_81_12 = {44 65 62 75 67 67 65 72 48 69 64 64 65 6e 41 74 74 72 69 62 75 74 65 } //1 DebuggerHiddenAttribute
		$a_81_13 = {44 65 62 75 67 67 61 62 6c 65 41 74 74 72 69 62 75 74 65 } //1 DebuggableAttribute
		$a_81_14 = {44 65 62 75 67 67 69 6e 67 4d 6f 64 65 73 } //1 DebuggingModes
		$a_81_15 = {43 72 65 61 74 65 49 6e 73 74 61 6e 63 65 } //1 CreateInstance
		$a_81_16 = {41 63 74 69 76 61 74 6f 72 } //1 Activator
	condition:
		((#a_81_0  & 1)*20+(#a_81_1  & 1)*20+(#a_81_2  & 1)*20+(#a_81_3  & 1)*20+(#a_81_4  & 1)*1+(#a_81_5  & 1)*1+(#a_81_6  & 1)*1+(#a_81_7  & 1)*1+(#a_81_8  & 1)*1+(#a_81_9  & 1)*1+(#a_81_10  & 1)*1+(#a_81_11  & 1)*1+(#a_81_12  & 1)*1+(#a_81_13  & 1)*1+(#a_81_14  & 1)*1+(#a_81_15  & 1)*1+(#a_81_16  & 1)*1) >=25
 
}

rule Trojan_BAT_AgentTesla_DGB_MTB{
	meta:
		description = "Trojan:BAT/AgentTesla.DGB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,12 00 12 00 0c 00 00 "
		
	strings :
		$a_01_0 = {24 62 38 34 31 30 38 65 63 2d 66 32 35 63 2d 34 66 65 61 2d 62 65 63 36 2d 65 31 32 66 35 37 63 34 32 30 38 62 } //10 $b84108ec-f25c-4fea-bec6-e12f57c4208b
		$a_01_1 = {24 66 35 37 32 39 61 61 34 2d 31 32 39 62 2d 34 65 30 37 2d 61 33 30 62 2d 64 63 31 65 61 62 62 39 33 64 34 33 } //10 $f5729aa4-129b-4e07-a30b-dc1eabb93d43
		$a_01_2 = {24 31 33 39 35 30 61 38 66 2d 63 30 32 39 2d 34 63 31 66 2d 38 36 34 33 2d 32 37 66 32 39 34 65 61 39 61 37 36 } //10 $13950a8f-c029-4c1f-8643-27f294ea9a76
		$a_01_3 = {24 34 30 64 31 33 33 37 38 2d 39 61 64 39 2d 34 63 62 33 2d 39 64 32 36 2d 35 64 63 64 63 35 66 36 62 66 34 37 } //10 $40d13378-9ad9-4cb3-9d26-5dcdc5f6bf47
		$a_01_4 = {46 72 6f 6d 42 61 73 65 36 34 53 74 72 69 6e 67 } //1 FromBase64String
		$a_01_5 = {47 5a 69 70 53 74 72 65 61 6d } //1 GZipStream
		$a_01_6 = {43 6f 6d 70 72 65 73 73 69 6f 6e 4d 6f 64 65 } //1 CompressionMode
		$a_01_7 = {47 65 74 54 79 70 65 46 72 6f 6d 48 61 6e 64 6c 65 } //1 GetTypeFromHandle
		$a_01_8 = {47 65 74 4d 65 74 68 6f 64 } //1 GetMethod
		$a_01_9 = {44 65 62 75 67 67 69 6e 67 4d 6f 64 65 73 } //1 DebuggingModes
		$a_01_10 = {44 65 62 75 67 67 61 62 6c 65 41 74 74 72 69 62 75 74 65 } //1 DebuggableAttribute
		$a_01_11 = {44 65 62 75 67 67 65 72 4e 6f 6e 55 73 65 72 43 6f 64 65 41 74 74 72 69 62 75 74 65 } //1 DebuggerNonUserCodeAttribute
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1) >=18
 
}

rule Trojan_BAT_LockScreen_MA_MTB{
	meta:
		description = "Trojan:BAT/LockScreen.MA!MTB,SIGNATURE_TYPE_PEHSTR,02 00 02 00 03 00 00 "
		
	strings :
		$a_01_0 = {24 61 36 35 66 30 61 65 34 2d 34 62 39 66 2d 34 34 65 35 2d 38 38 33 39 2d 35 35 37 39 30 39 38 64 38 38 39 38 } //1 $a65f0ae4-4b9f-44e5-8839-5579098d8898
		$a_01_1 = {74 72 6f 6c 6c 5f 76 69 72 75 73 } //1 troll_virus
		$a_01_2 = {68 00 65 00 72 00 6f 00 62 00 72 00 69 00 6e 00 65 00 } //1 herobrine
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=2
 
}
rule Trojan_BAT_LockScreen_MA_MTB_2{
	meta:
		description = "Trojan:BAT/LockScreen.MA!MTB,SIGNATURE_TYPE_PEHSTR,08 00 08 00 05 00 00 "
		
	strings :
		$a_01_0 = {44 00 69 00 73 00 61 00 62 00 6c 00 65 00 54 00 61 00 73 00 6b 00 4d 00 67 00 72 00 } //1 DisableTaskMgr
		$a_01_1 = {74 00 61 00 73 00 6b 00 6b 00 69 00 6c 00 6c 00 } //1 taskkill
		$a_01_2 = {73 00 68 00 75 00 74 00 64 00 6f 00 77 00 6e 00 } //1 shutdown
		$a_01_3 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 5c 00 52 00 75 00 6e 00 } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\Run
		$a_01_4 = {41 6c 70 68 69 2e 65 78 65 } //5 Alphi.exe
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*5) >=8
 
}
rule Trojan_BAT_LockScreen_MA_MTB_3{
	meta:
		description = "Trojan:BAT/LockScreen.MA!MTB,SIGNATURE_TYPE_PEHSTR,0a 00 0a 00 07 00 00 "
		
	strings :
		$a_01_0 = {4c 6f 63 6b 65 72 2e 65 78 65 } //2 Locker.exe
		$a_01_1 = {44 00 69 00 73 00 61 00 62 00 6c 00 65 00 41 00 6e 00 74 00 69 00 53 00 70 00 79 00 77 00 61 00 72 00 65 00 } //1 DisableAntiSpyware
		$a_01_2 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 5c 00 57 00 69 00 6e 00 6c 00 6f 00 67 00 6f 00 6e 00 } //7 SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
		$a_01_3 = {21 00 53 00 63 00 72 00 65 00 65 00 6e 00 4c 00 6f 00 63 00 6b 00 21 00 } //1 !ScreenLock!
		$a_01_4 = {24 62 39 32 34 63 65 33 61 2d 35 30 38 34 2d 34 63 36 65 2d 38 63 61 38 2d 64 30 32 38 65 63 36 35 37 66 62 32 } //9 $b924ce3a-5084-4c6e-8ca8-d028ec657fb2
		$a_01_5 = {4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5c 00 53 00 74 00 61 00 72 00 74 00 20 00 4d 00 65 00 6e 00 75 00 5c 00 50 00 72 00 6f 00 67 00 72 00 61 00 6d 00 73 00 5c 00 53 00 74 00 61 00 72 00 74 00 75 00 70 00 } //1 Microsoft\Windows\Start Menu\Programs\Startup
		$a_01_6 = {24 36 36 66 35 61 61 61 64 2d 31 31 31 65 2d 34 66 33 62 2d 62 31 30 32 2d 37 39 61 62 61 34 39 37 39 38 39 62 } //9 $66f5aaad-111e-4f3b-b102-79aba497989b
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*1+(#a_01_2  & 1)*7+(#a_01_3  & 1)*1+(#a_01_4  & 1)*9+(#a_01_5  & 1)*1+(#a_01_6  & 1)*9) >=10
 
}
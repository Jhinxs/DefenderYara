
rule Trojan_BAT_SnakeKeylogger_ED_MTB{
	meta:
		description = "Trojan:BAT/SnakeKeylogger.ED!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1b 00 1b 00 06 00 00 "
		
	strings :
		$a_03_0 = {14 0b 14 0c 28 ?? ?? ?? 06 74 ?? ?? ?? 1b 0c 08 17 28 ?? ?? ?? 06 a2 08 18 72 ?? ?? ?? 70 a2 08 16 28 ?? ?? ?? 06 a2 02 7b ?? ?? ?? 04 08 28 ?? ?? ?? 0a 26 08 0a 2b 00 06 2a } //20
		$a_81_1 = {24 66 33 31 39 39 33 63 64 2d 64 37 39 63 2d 34 66 66 39 2d 38 39 38 64 2d 61 62 62 39 39 61 61 33 66 30 63 32 } //5 $f31993cd-d79c-4ff9-898d-abb99aa3f0c2
		$a_81_2 = {24 36 34 62 32 33 39 36 31 2d 63 65 64 37 2d 34 38 65 65 2d 61 36 34 33 2d 39 61 62 33 35 61 36 35 35 65 65 33 } //5 $64b23961-ced7-48ee-a643-9ab35a655ee3
		$a_81_3 = {24 45 43 33 34 34 46 46 42 2d 34 35 31 36 2d 34 35 30 44 2d 42 46 37 34 2d 36 37 44 39 41 36 30 33 33 38 31 31 } //5 $EC344FFB-4516-450D-BF74-67D9A6033811
		$a_81_4 = {57 5f 5f 5f 5f 5f 5f 5f 5f 5f 5f 57 } //1 W__________W
		$a_81_5 = {58 5f 5f 5f 5f 5f 5f 5f 5f 5f 5f 58 } //1 X__________X
	condition:
		((#a_03_0  & 1)*20+(#a_81_1  & 1)*5+(#a_81_2  & 1)*5+(#a_81_3  & 1)*5+(#a_81_4  & 1)*1+(#a_81_5  & 1)*1) >=27
 
}

rule Trojan_BAT_Stealerc_AMMF_MTB{
	meta:
		description = "Trojan:BAT/Stealerc.AMMF!MTB,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 04 00 00 "
		
	strings :
		$a_03_0 = {13 04 11 04 15 7e ?? 00 00 04 16 8f ?? 00 00 01 7e ?? 00 00 04 8e 69 1f 40 12 00 6f ?? ?? 00 06 26 16 13 08 11 06 } //2
		$a_00_1 = {56 00 69 00 72 00 74 00 75 00 61 00 6c 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00 45 00 78 00 } //1 VirtualProtectEx
		$a_00_2 = {57 00 61 00 69 00 74 00 46 00 6f 00 72 00 53 00 69 00 6e 00 67 00 6c 00 65 00 4f 00 62 00 6a 00 65 00 63 00 74 00 } //1 WaitForSingleObject
		$a_00_3 = {43 00 72 00 65 00 61 00 74 00 65 00 54 00 68 00 72 00 65 00 61 00 64 00 } //1 CreateThread
	condition:
		((#a_03_0  & 1)*2+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1) >=5
 
}
rule Trojan_BAT_Stealerc_AMMF_MTB_2{
	meta:
		description = "Trojan:BAT/Stealerc.AMMF!MTB,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 05 00 00 "
		
	strings :
		$a_01_0 = {64 00 20 00 a0 12 20 00 1d 12 20 00 35 12 20 00 1b 12 20 00 eb 12 20 00 1d 12 20 00 e8 12 20 00 1d 12 20 00 0b 12 20 00 28 13 20 00 60 12 20 00 41 00 20 00 6f 00 20 00 65 12 20 00 2d 12 20 00 00 13 20 00 62 12 20 00 2d 12 20 00 c8 12 20 00 e8 12 20 00 01 12 20 00 3b 12 20 00 4c 00 20 00 } //2
		$a_01_1 = {65 00 70 00 20 00 79 00 20 00 54 00 20 00 74 00 20 00 70 12 20 00 62 12 20 00 2d 12 20 00 f5 12 20 00 54 13 } //2
		$a_01_2 = {43 72 65 61 74 65 44 65 63 72 79 70 74 6f 72 } //1 CreateDecryptor
		$a_01_3 = {53 74 72 52 65 76 65 72 73 65 } //1 StrReverse
		$a_01_4 = {52 65 70 6c 61 63 65 } //1 Replace
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=7
 
}
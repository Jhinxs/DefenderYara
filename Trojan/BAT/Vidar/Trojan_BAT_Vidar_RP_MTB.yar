
rule Trojan_BAT_Vidar_RP_MTB{
	meta:
		description = "Trojan:BAT/Vidar.RP!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1c 00 1c 00 0a 00 00 "
		
	strings :
		$a_01_0 = {4d 41 4b 35 49 44 37 48 36 53 46 38 41 44 47 47 48 4a 46 4b 49 4c 4f 4f } //10 MAK5ID7H6SF8ADGGHJFKILOO
		$a_01_1 = {50 41 49 53 44 4a 53 46 38 33 37 34 4a 53 4b 46 48 47 35 4a 47 46 4c 39 53 4d } //10 PAISDJSF8374JSKFHG5JGFL9SM
		$a_01_2 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 31 36 2d 31 } //1 $$method0x6000316-1
		$a_01_3 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 32 65 2d 31 } //1 $$method0x600032e-1
		$a_01_4 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 32 65 2d 32 } //1 $$method0x600032e-2
		$a_01_5 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 33 63 2d 31 } //1 $$method0x600033c-1
		$a_01_6 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 33 63 2d 32 } //1 $$method0x600033c-2
		$a_01_7 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 34 66 2d 31 } //1 $$method0x600034f-1
		$a_01_8 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 33 38 65 2d 31 } //1 $$method0x600038e-1
		$a_01_9 = {24 24 6d 65 74 68 6f 64 30 78 36 30 30 30 35 61 62 2d 31 } //1 $$method0x60005ab-1
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1) >=28
 
}
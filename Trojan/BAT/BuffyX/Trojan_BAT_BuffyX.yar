
rule Trojan_BAT_BuffyX{
	meta:
		description = "Trojan:BAT/BuffyX,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 0f 00 00 "
		
	strings :
		$a_02_0 = {0d 09 2d 02 16 0a 03 28 ?? ?? ?? ?? 13 04 03 28 ?? ?? ?? ?? 13 05 11 04 72 ?? ?? ?? ?? 11 05 72 ?? ?? ?? ?? 28 ?? ?? ?? ?? 13 06 11 06 28 ?? ?? ?? ?? 13 07 11 07 09 16 09 8e 69 6f ?? ?? ?? ?? de 0c } //1
		$a_02_1 = {02 8e 69 0a 02 06 1b 59 91 0b 16 0c 1a 8d 67 00 00 01 0d 16 13 04 14 13 05 14 13 06 14 13 07 03 2c 36 28 ?? ?? ?? ?? 03 6f ?? ?? ?? ?? 13 08 11 08 13 0e 16 13 0f 2b 16 11 0e 11 0f 91 13 09 08 07 11 09 61 d2 61 d2 0c 11 0f 17 58 13 0f 11 0f 11 0e 8e 69 32 e2 2b 02 07 0c 16 13 0a 2b 12 09 11 0a 02 06 1a 59 11 0a 58 91 9c 11 0a 17 58 13 0a 11 0a 1a 32 e9 09 28 ?? ?? ?? ?? 13 04 02 06 11 04 59 06 28 ?? ?? ?? ?? 13 05 16 13 0b 11 05 8e 69 8d 67 00 00 01 13 07 11 05 13 10 16 13 11 2b 1c 11 10 11 11 91 13 0c 11 07 11 0b 25 17 58 13 0b 11 0c 08 61 d2 9c 11 11 17 58 13 11 11 11 11 10 8e 69 32 dc 11 07 28 ?? ?? ?? ?? 13 06 11 06 13 0d de 09 26 14 13 06 de 00 11 06 2a 11 0d 2a } //1
		$a_01_2 = {43 6c 6f 75 64 43 6c 69 6d 62 } //1 CloudClimb
		$a_01_3 = {69 61 6d 67 65 42 75 66 66 65 72 } //1 iamgeBuffer
		$a_01_4 = {49 6d 61 67 65 49 6e 66 6f 48 69 64 65 6e } //1 ImageInfoHiden
		$a_01_5 = {4c 6f 61 64 49 6d 61 67 65 } //1 LoadImage
		$a_01_6 = {50 72 6f 63 65 73 73 54 68 72 65 61 64 } //1 ProcessThread
		$a_01_7 = {52 75 6e 42 79 4d 4c } //1 RunByML
		$a_01_8 = {55 6e 41 70 70 65 6e 64 44 6c 6c 42 79 74 65 73 } //1 UnAppendDllBytes
		$a_01_9 = {55 6e 50 61 63 6b } //1 UnPack
		$a_01_10 = {56 55 4c 69 62 4d 65 } //1 VULibMe
		$a_00_11 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 69 00 6d 00 61 00 67 00 65 00 73 00 2e 00 74 00 69 00 6d 00 65 00 6b 00 61 00 72 00 64 00 2e 00 63 00 6f 00 6d 00 2f 00 64 00 65 00 66 00 61 00 75 00 6c 00 74 00 2e 00 70 00 6e 00 67 00 } //1 http://images.timekard.com/default.png
		$a_00_12 = {61 00 62 00 63 00 64 00 65 00 66 00 67 00 } //1 abcdefg
		$a_00_13 = {5f 00 68 00 69 00 64 00 65 00 6e 00 2e 00 62 00 6d 00 70 00 } //1 _hiden.bmp
		$a_00_14 = {5f 00 6f 00 75 00 74 00 2e 00 64 00 6c 00 6c 00 } //1 _out.dll
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1) >=12
 
}
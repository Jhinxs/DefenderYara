
rule Trojan_BAT_Barys_PSTE_MTB{
	meta:
		description = "Trojan:BAT/Barys.PSTE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0d 00 0d 00 0d 00 00 "
		
	strings :
		$a_01_0 = {36 46 44 43 31 44 42 44 } //1 6FDC1DBD
		$a_01_1 = {32 33 36 45 37 38 34 44 } //1 236E784D
		$a_01_2 = {34 43 30 36 30 44 34 39 } //1 4C060D49
		$a_01_3 = {33 39 45 38 33 31 43 36 } //1 39E831C6
		$a_01_4 = {32 34 32 43 30 35 36 42 } //1 242C056B
		$a_01_5 = {32 35 30 34 37 36 32 39 } //1 25047629
		$a_01_6 = {43 6f 6d 70 75 74 65 48 61 73 68 } //1 ComputeHash
		$a_01_7 = {44 6f 77 6e 6c 6f 61 64 53 74 72 69 6e 67 } //1 DownloadString
		$a_01_8 = {46 72 6f 6d 42 61 73 65 36 34 53 74 72 69 6e 67 } //1 FromBase64String
		$a_01_9 = {47 65 74 45 78 65 63 75 74 69 6e 67 41 73 73 65 6d 62 6c 79 } //1 GetExecutingAssembly
		$a_01_10 = {57 72 69 74 65 49 6e 74 36 34 } //1 WriteInt64
		$a_01_11 = {67 65 74 5f 55 54 46 38 } //1 get_UTF8
		$a_01_12 = {42 6c 6f 63 6b 43 6f 70 79 } //1 BlockCopy
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1) >=13
 
}
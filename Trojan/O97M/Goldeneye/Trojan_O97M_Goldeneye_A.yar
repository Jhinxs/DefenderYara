
rule Trojan_O97M_Goldeneye_A{
	meta:
		description = "Trojan:O97M/Goldeneye.A,SIGNATURE_TYPE_MACROHSTR_EXT,28 00 28 00 04 00 00 "
		
	strings :
		$a_01_0 = {20 3d 20 22 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 22 } //10  = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
		$a_01_1 = {2e 4c 61 6e 67 75 61 67 65 20 3d 20 43 68 72 28 37 34 29 20 26 20 43 68 72 28 38 33 29 20 26 20 43 68 72 28 39 39 29 20 26 20 43 68 72 28 31 31 34 29 20 26 20 43 68 72 28 31 30 35 29 20 26 20 43 68 72 28 31 31 32 29 20 26 20 43 68 72 28 31 31 36 29 } //10 .Language = Chr(74) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116)
		$a_01_2 = {20 3d 20 43 72 65 61 74 65 4f 62 6a 65 63 74 28 43 68 72 28 37 37 29 20 26 20 43 68 72 28 38 33 29 20 26 20 43 68 72 28 38 33 29 20 26 20 43 68 72 28 39 39 29 20 26 20 43 68 72 28 31 31 34 29 20 26 20 43 68 72 28 31 30 35 29 20 26 20 43 68 72 28 31 31 32 29 20 26 20 43 68 72 28 31 31 36 29 20 26 20 43 68 72 28 36 37 29 20 26 20 43 68 72 28 31 31 31 29 20 26 20 43 68 72 28 31 31 30 29 } //10  = CreateObject(Chr(77) & Chr(83) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(67) & Chr(111) & Chr(110)
		$a_01_3 = {64 6f 63 45 6c 65 6d 65 6e 74 2e 74 65 78 74 20 3d 20 27 41 41 41 41 41 41 41 41 41 41 41 } //10 docElement.text = 'AAAAAAAAAAA
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10) >=40
 
}
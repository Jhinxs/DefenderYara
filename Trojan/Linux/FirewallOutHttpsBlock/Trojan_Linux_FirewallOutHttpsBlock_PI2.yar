
rule Trojan_Linux_FirewallOutHttpsBlock_PI2{
	meta:
		description = "Trojan:Linux/FirewallOutHttpsBlock.PI2,SIGNATURE_TYPE_CMDHSTR_EXT,2d 00 2d 00 10 00 00 "
		
	strings :
		$a_81_0 = {69 70 74 61 62 6c 65 73 20 } //5 iptables 
		$a_81_1 = {69 70 36 74 61 62 6c 65 73 20 } //5 ip6tables 
		$a_81_2 = {20 4f 55 54 50 55 54 20 } //10  OUTPUT 
		$a_81_3 = {20 2d 70 20 74 63 70 20 } //10  -p tcp 
		$a_81_4 = {70 6f 72 74 20 34 34 33 20 } //10 port 443 
		$a_81_5 = {2d 6a 20 44 52 4f 50 } //10 -j DROP
		$a_81_6 = {73 70 6f 72 74 20 34 34 33 20 } //-10 sport 443 
		$a_81_7 = {20 2d 64 20 31 } //-20  -d 1
		$a_81_8 = {20 2d 64 20 32 } //-20  -d 2
		$a_81_9 = {20 2d 64 20 33 } //-20  -d 3
		$a_81_10 = {20 2d 64 20 34 } //-20  -d 4
		$a_81_11 = {20 2d 64 20 35 } //-20  -d 5
		$a_81_12 = {20 2d 64 20 36 } //-20  -d 6
		$a_81_13 = {20 2d 64 20 37 } //-20  -d 7
		$a_81_14 = {20 2d 64 20 38 } //-20  -d 8
		$a_81_15 = {20 2d 64 20 39 } //-20  -d 9
	condition:
		((#a_81_0  & 1)*5+(#a_81_1  & 1)*5+(#a_81_2  & 1)*10+(#a_81_3  & 1)*10+(#a_81_4  & 1)*10+(#a_81_5  & 1)*10+(#a_81_6  & 1)*-10+(#a_81_7  & 1)*-20+(#a_81_8  & 1)*-20+(#a_81_9  & 1)*-20+(#a_81_10  & 1)*-20+(#a_81_11  & 1)*-20+(#a_81_12  & 1)*-20+(#a_81_13  & 1)*-20+(#a_81_14  & 1)*-20+(#a_81_15  & 1)*-20) >=45
 
}

rule Trojan_Win64_TreeTrunk_B_dha{
	meta:
		description = "Trojan:Win64/TreeTrunk.B!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 13 00 00 "
		
	strings :
		$a_01_0 = {44 6f 73 43 6f 6d 6d 61 6e 64 54 68 72 65 61 64 } //1 DosCommandThread
		$a_00_1 = {2f 00 69 00 6e 00 64 00 65 00 78 00 2e 00 6a 00 73 00 70 00 } //1 /index.jsp
		$a_00_2 = {57 00 69 00 6e 00 44 00 44 00 4b 00 2e 00 37 00 36 00 30 00 30 00 } //1 WinDDK.7600
		$a_00_3 = {37 00 31 00 34 00 37 00 33 00 44 00 30 00 34 00 42 00 41 00 44 00 31 00 34 00 30 00 38 00 39 00 39 00 38 00 } //1 71473D04BAD1408998
		$a_00_4 = {37 00 33 00 38 00 35 00 32 00 41 00 } //1 73852A
		$a_00_5 = {37 00 34 00 46 00 35 00 38 00 35 00 33 00 36 00 39 00 32 00 33 00 33 00 45 00 32 00 36 00 37 00 42 00 33 00 44 00 38 00 46 00 45 00 41 00 37 00 } //1 74F585369233E267B3D8FEA7
		$a_00_6 = {37 00 36 00 35 00 37 00 46 00 31 00 43 00 31 00 42 00 34 00 42 00 44 00 44 00 32 00 42 00 39 00 43 00 35 00 37 00 36 00 } //1 7657F1C1B4BDD2B9C576
		$a_00_7 = {37 00 36 00 35 00 37 00 46 00 31 00 43 00 31 00 42 00 34 00 42 00 37 00 41 00 35 00 37 00 34 00 31 00 32 00 46 00 35 00 43 00 35 00 35 00 38 00 } //1 7657F1C1B4B7A57412F5C558
		$a_00_8 = {37 00 36 00 35 00 37 00 46 00 31 00 43 00 31 00 42 00 35 00 44 00 32 00 46 00 46 00 43 00 34 00 46 00 35 00 35 00 41 00 } //1 7657F1C1B5D2FFC4F55A
		$a_00_9 = {37 00 36 00 35 00 37 00 46 00 31 00 43 00 31 00 41 00 35 00 46 00 41 00 34 00 30 00 32 00 44 00 35 00 37 00 31 00 46 00 } //1 7657F1C1A5FA402D571F
		$a_00_10 = {37 00 37 00 37 00 35 00 41 00 39 00 30 00 31 00 30 00 34 00 41 00 32 00 36 00 42 00 34 00 46 00 41 00 45 00 34 00 30 00 36 00 44 00 32 00 37 00 30 00 35 00 } //1 7775A90104A26B4FAE406D2705
		$a_00_11 = {37 00 37 00 37 00 35 00 41 00 39 00 30 00 31 00 30 00 34 00 41 00 32 00 36 00 42 00 34 00 38 00 36 00 44 00 32 00 45 00 30 00 38 00 39 00 32 00 35 00 35 00 } //1 7775A90104A26B486D2E089255
		$a_00_12 = {37 00 37 00 37 00 35 00 41 00 39 00 30 00 36 00 45 00 43 00 32 00 37 00 } //1 7775A906EC27
		$a_00_13 = {37 00 37 00 37 00 35 00 41 00 39 00 30 00 36 00 45 00 43 00 32 00 36 00 32 00 45 00 } //1 7775A906EC262E
		$a_00_14 = {37 00 37 00 37 00 35 00 41 00 39 00 30 00 34 00 38 00 38 00 36 00 39 00 35 00 41 00 30 00 44 00 38 00 39 00 41 00 35 00 36 00 45 00 } //1 7775A90488695A0D89A56E
		$a_00_15 = {37 00 37 00 37 00 35 00 41 00 39 00 31 00 32 00 32 00 46 00 39 00 34 00 39 00 36 00 38 00 41 00 36 00 32 00 46 00 39 00 } //1 7775A9122F94968A62F9
		$a_00_16 = {37 00 39 00 44 00 41 00 37 00 33 00 45 00 32 00 45 00 35 00 32 00 43 00 36 00 34 00 38 00 46 00 42 00 44 00 41 00 34 00 33 00 33 00 45 00 39 00 36 00 45 00 46 00 41 00 34 00 44 00 42 00 44 00 45 00 36 00 } //1 79DA73E2E52C648FBDA433E96EFA4DBDE6
		$a_00_17 = {37 00 39 00 44 00 41 00 37 00 33 00 45 00 32 00 45 00 35 00 32 00 43 00 36 00 34 00 38 00 46 00 42 00 44 00 41 00 34 00 33 00 33 00 45 00 45 00 37 00 35 00 46 00 30 00 44 00 33 00 36 00 35 00 37 00 34 00 } //1 79DA73E2E52C648FBDA433EE75F0D36574
		$a_00_18 = {37 00 42 00 33 00 31 00 43 00 39 00 41 00 35 00 36 00 42 00 31 00 35 00 41 00 45 00 41 00 38 00 46 00 43 00 36 00 30 00 33 00 32 00 } //1 7B31C9A56B15AEA8FC6032
	condition:
		((#a_01_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1+(#a_00_16  & 1)*1+(#a_00_17  & 1)*1+(#a_00_18  & 1)*1) >=4
 
}
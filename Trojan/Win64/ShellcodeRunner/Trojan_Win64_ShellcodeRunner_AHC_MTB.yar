
rule Trojan_Win64_ShellcodeRunner_AHC_MTB{
	meta:
		description = "Trojan:Win64/ShellcodeRunner.AHC!MTB,SIGNATURE_TYPE_PEHSTR_EXT,32 00 32 00 04 00 00 "
		
	strings :
		$a_03_0 = {b9 04 01 00 00 48 89 c7 48 89 d6 f3 48 a5 c6 85 ?? 07 00 00 42 48 c7 85 ?? 07 00 00 20 08 00 00 48 8b 85 ?? 07 00 00 41 b9 40 00 00 00 41 b8 00 30 00 00 } //20
		$a_01_1 = {b9 04 01 00 00 48 89 c7 48 89 d6 f3 48 a5 48 b8 01 02 03 04 05 06 07 08 48 ba 09 0a 0b 0c 0d 0e 0f 10 } //20
		$a_03_2 = {48 01 d0 0f b6 00 48 8b 8d ?? 07 00 00 48 8b 95 ?? 07 00 00 48 01 ca 32 85 ?? 07 00 00 88 02 } //30
		$a_01_3 = {8b 85 7c 08 00 00 48 98 0f b6 44 05 30 32 85 57 08 00 00 89 c2 8b 85 7c 08 00 00 48 98 88 54 05 30 } //30
	condition:
		((#a_03_0  & 1)*20+(#a_01_1  & 1)*20+(#a_03_2  & 1)*30+(#a_01_3  & 1)*30) >=50
 
}
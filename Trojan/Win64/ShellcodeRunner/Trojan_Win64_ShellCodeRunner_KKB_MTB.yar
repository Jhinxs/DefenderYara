
rule Trojan_Win64_ShellCodeRunner_KKB_MTB{
	meta:
		description = "Trojan:Win64/ShellCodeRunner.KKB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0f 00 0f 00 04 00 00 "
		
	strings :
		$a_01_0 = {48 89 c2 48 8d 45 a0 b9 3a 08 00 00 4c 8b 00 4c 89 02 41 89 c8 49 01 d0 4d 8d 48 08 41 89 c8 49 01 c0 49 83 c0 08 4d 8b 40 f0 4d 89 41 f0 4c 8d 42 08 49 83 e0 f8 4c 29 c2 48 29 d0 01 d1 83 e1 f8 c1 e9 03 89 ca 89 d2 4c 89 c7 48 89 c6 48 89 d1 f3 48 a5 } //10
		$a_01_1 = {8b 85 fc 07 00 00 48 98 0f b6 44 05 a0 8b 95 fc 07 00 00 48 63 ca 48 8b 95 f0 07 00 00 48 01 ca 32 85 fb 07 00 00 88 02 83 85 fc 07 00 00 01 8b 85 fc 07 00 00 3d 39 08 00 00 76 } //10
		$a_03_2 = {41 b9 40 00 00 00 41 b8 00 30 00 00 ba 3a 08 00 00 b9 00 00 00 00 48 8b 05 ?? ?? ?? ?? ff d0 48 89 85 } //3
		$a_03_3 = {48 89 84 24 87 00 00 00 48 b8 41 64 64 72 65 73 73 00 48 89 84 24 8e 00 00 00 c7 84 24 81 00 00 00 ?? ?? ?? ?? 66 c7 84 24 85 00 00 00 70 00 48 b8 45 78 69 74 50 72 6f 63 48 89 44 24 75 c7 44 24 7d ?? ?? ?? ?? 48 b8 57 73 32 5f 33 32 2e 64 48 89 44 24 6a c7 44 24 71 ?? ?? ?? ?? 48 b8 57 53 41 } //2
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_03_2  & 1)*3+(#a_03_3  & 1)*2) >=15
 
}
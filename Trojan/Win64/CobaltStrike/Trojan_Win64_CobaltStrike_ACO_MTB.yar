
rule Trojan_Win64_CobaltStrike_ACO_MTB{
	meta:
		description = "Trojan:Win64/CobaltStrike.ACO!MTB,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 02 00 00 "
		
	strings :
		$a_01_0 = {88 14 01 33 d2 8b 44 24 28 f7 74 24 54 8b c2 8b c0 48 63 4c 24 28 48 8b 54 24 58 0f b6 44 04 40 88 04 0a } //2
		$a_01_1 = {b8 41 00 00 00 66 89 44 24 48 b8 33 00 00 00 66 89 44 24 4a b8 43 00 00 00 66 89 44 24 4c b8 38 00 00 00 66 89 44 24 4e b8 32 00 00 00 66 89 44 24 50 b8 31 00 00 00 66 89 44 24 52 b8 37 00 00 00 66 89 44 24 54 b8 30 00 00 00 66 89 44 24 56 33 c0 66 89 44 24 58 c7 44 24 60 08 00 00 00 ff 15 } //3
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*3) >=5
 
}
rule Trojan_Win64_CobaltStrike_ACO_MTB_2{
	meta:
		description = "Trojan:Win64/CobaltStrike.ACO!MTB,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {66 c7 85 40 06 00 00 6c 00 66 c7 85 42 06 00 00 6c 00 66 c7 85 44 06 00 00 64 00 66 c7 85 46 06 00 00 2e 00 66 c7 85 48 06 00 00 32 00 66 c7 85 4a 06 00 00 33 00 66 c7 85 4c 06 00 00 6c 00 66 c7 85 4e 06 00 00 65 00 66 c7 85 50 06 00 00 6e 00 66 c7 85 52 06 00 00 72 00 66 c7 85 54 06 00 00 65 00 66 c7 85 56 06 00 00 4b 00 } //1
		$a_01_1 = {66 c7 85 20 06 00 00 6c 00 66 c7 85 22 06 00 00 6c 00 66 c7 85 24 06 00 00 64 00 66 c7 85 26 06 00 00 2e 00 66 c7 85 28 06 00 00 6c 00 66 c7 85 2a 06 00 00 6c 00 66 c7 85 2c 06 00 00 64 00 66 c7 85 2e 06 00 00 74 00 66 c7 85 30 06 00 00 6e 00 } //1
		$a_01_2 = {89 c2 48 8b 45 10 48 01 d0 0f b7 00 66 89 45 f6 0f b7 55 f6 8b 45 f8 c1 c8 08 01 d0 31 45 f8 8b 55 fc 48 8b 45 10 48 01 d0 0f b6 00 84 c0 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
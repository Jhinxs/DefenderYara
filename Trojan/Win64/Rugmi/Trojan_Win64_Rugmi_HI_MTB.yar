
rule Trojan_Win64_Rugmi_HI_MTB{
	meta:
		description = "Trojan:Win64/Rugmi.HI!MTB,SIGNATURE_TYPE_PEHSTR_EXT,15 00 15 00 06 00 00 "
		
	strings :
		$a_23_0 = {d0 48 89 c7 90 01 01 8b 05 90 00 14 } //20
		$a_ff_1 = {48 89 df 90 01 01 8b 1d 90 00 14 00 0c 23 ff d1 48 89 cf 90 01 01 8b 0d 90 00 01 00 11 03 48 63 40 3c 8b } //3072
		$a_00_2 = {00 00 90 01 01 8b 90 00 01 00 11 03 48 63 5b 3c 8b 9c 1e 88 00 00 00 90 01 01 8b 90 00 01 00 11 03 48 63 49 3c 8b 8c 0e 88 00 00 00 90 01 01 8b 90 00 00 00 5d 04 00 00 23 10 07 80 5c 27 00 00 24 10 07 80 00 00 01 00 08 00 11 00 ac 21 41 6d 64 65 79 52 75 6e 6e 65 72 21 72 66 6e 00 00 06 40 05 82 70 00 04 00 67 16 00 00 ad 19 d7 03 a6 ed b6 b1 d1 9a d9 1e 00 00 0e 00 01 20 51 4d 7d 6d 67 16 00 00 39 ce f0 } //1668
		$a_4b_3 = {97 e8 f6 11 ba 54 33 00 01 20 30 5e 57 2d 67 16 00 00 39 ce f0 d5 45 1a cd f7 97 e8 f6 11 b3 4a 33 00 01 20 91 00 7a d4 67 16 00 00 39 ce f0 d5 88 47 49 00 97 e8 f6 11 66 55 33 00 01 20 aa fb 13 e0 67 16 00 00 39 ce f0 d5 9f ce 3b c0 97 e8 f6 11 b3 4a 33 00 01 20 30 3e b0 98 67 16 00 00 39 } //6101
		$a_f6_4 = {bc 58 97 e8 f6 11 c2 54 33 00 01 20 77 36 e1 d0 5d 04 00 00 24 10 07 80 5c 29 00 00 25 10 07 80 00 00 01 00 04 00 13 00 89 21 43 6f 69 6e 4d 69 6e 65 72 2e 4c 55 4a 21 4d 54 42 00 00 01 40 05 82 5c 00 04 00 29 55 00 00 00 01 00 ff ff ff ff 4a 00 00 00 79 75 68 73 6d 67 6e 69 74 74 7a 6d 65 74 6b 7a 22 5f 26 22 7a 64 6e 6a 64 77 71 79 7a 67 78 6b 72 31 70 77 79 6b 64 77 65 6b 78 74 74 6e 7a 69 75 7a 6c 74 74 64 6a 6f 63 75 78 74 76 6a 72 61 75 74 30 39 69 69 61 6b 90 00 5d 04 00 00 25 10 07 80 5c 25 00 00 26 10 07 80 00 00 01 00 08 00 0f 00 ad 41 52 65 6d 63 6f 73 52 41 54 21 4d 54 42 00 00 0d 40 05 82 70 00 04 00 67 16 00 00 a5 6d } //-3890
		$a_46_5 = {e5 d6 02 d0 fe 95 83 00 00 00 20 d6 02 d0 fe 67 16 00 00 28 54 b2 0b 4c 39 70 39 19 11 b0 55 5b 83 00 00 00 20 19 11 b0 55 67 16 00 00 84 83 8d 0e 95 3b 11 40 8f 4d 58 91 bc 83 00 00 00 20 8f 4d 58 91 67 16 00 00 0d a3 57 1d 79 b2 d2 06 d5 7a 69 f8 cd 16 00 00 00 20 d5 7a 69 f8 67 16 00 00 8f 95 64 2d 7b fa f9 1b 75 ce af 20 73 83 00 00 00 20 75 ce af 20 67 16 00 00 1c 5e d5 33 91 ba db } //412
	condition:
		((#a_23_0  & 1)*20+(#a_ff_1  & 1)*3072+(#a_00_2  & 1)*1668+(#a_4b_3  & 1)*6101+(#a_f6_4  & 1)*-3890+(#a_46_5  & 1)*412) >=21
 
}
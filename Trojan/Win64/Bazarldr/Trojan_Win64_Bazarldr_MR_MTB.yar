
rule Trojan_Win64_Bazarldr_MR_MTB{
	meta:
		description = "Trojan:Win64/Bazarldr.MR!MTB,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 08 00 00 "
		
	strings :
		$a_02_0 = {48 89 5c 24 20 ff 15 [0-04] 85 c0 [0-06] ff d3 48 8d [0-03] c7 45 [0-05] c7 45 [0-05] ff 15 [0-04] 4d 85 [0-03] 75 } //6
		$a_00_1 = {00 6b 65 72 6e 65 6c 33 32 2e 64 6c 6c 00 00 00 00 46 69 6e 64 52 65 73 6f 75 72 63 65 41 00 00 00 53 69 7a 65 6f 66 52 65 73 6f 75 72 63 65 } //3
		$a_00_2 = {4c 8b 02 8b 4a 08 4c 89 00 89 48 08 c3 } //1
		$a_00_3 = {8b 02 48 8b 4a 04 41 89 02 49 89 4a 04 49 8b c3 c3 } //1
		$a_00_4 = {4c 8b 02 8b 4a 08 44 0f b6 4a 0c 4c 89 00 89 48 08 44 88 48 0c c3 } //1
		$a_00_5 = {48 0f b6 02 8b 4a 01 48 8b 52 05 41 88 02 41 89 4a 01 49 89 52 05 49 8b c3 c3 } //1
		$a_00_6 = {4c 8b 02 8b 4a 08 44 0f b7 4a 0c 4c 89 00 89 48 08 66 44 89 48 0c c3 } //1
		$a_00_7 = {48 0f b7 02 8b 4a 02 48 8b 52 06 66 41 89 02 41 89 4a 02 49 89 52 06 49 8b c3 c3 } //1
	condition:
		((#a_02_0  & 1)*6+(#a_00_1  & 1)*3+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1) >=12
 
}
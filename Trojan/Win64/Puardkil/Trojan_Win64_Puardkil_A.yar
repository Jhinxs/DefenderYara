
rule Trojan_Win64_Puardkil_A{
	meta:
		description = "Trojan:Win64/Puardkil.A,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_01_0 = {48 8b 89 08 01 00 00 48 8b 40 18 48 33 c1 } //1
		$a_01_1 = {50 61 74 68 20 2d 20 50 61 74 63 68 47 75 61 72 64 20 63 6f 6e 74 65 78 74 20 65 6e 74 72 79 70 6f 69 6e 74 20 6e 6f 74 20 66 6f 75 6e 64 } //1 Path - PatchGuard context entrypoint not found
		$a_00_2 = {62 39 20 30 31 20 30 30 20 30 30 20 30 30 20 34 34 20 30 66 20 32 32 20 63 31 20 34 38 20 38 62 20 31 34 20 32 34 20 34 38 20 38 62 20 34 63 20 32 34 20 30 38 } //1 b9 01 00 00 00 44 0f 22 c1 48 8b 14 24 48 8b 4c 24 08
		$a_00_3 = {34 38 20 38 44 20 30 35 20 3f 3f 20 3f 3f 20 3f 3f 20 3f 3f 20 3f 3f 20 38 39 20 3f 3f 20 30 38 20 30 31 20 30 30 20 30 30 } //1 48 8D 05 ?? ?? ?? ?? ?? 89 ?? 08 01 00 00
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1) >=3
 
}
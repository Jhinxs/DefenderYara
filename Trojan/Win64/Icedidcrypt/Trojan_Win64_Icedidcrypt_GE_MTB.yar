
rule Trojan_Win64_Icedidcrypt_GE_MTB{
	meta:
		description = "Trojan:Win64/Icedidcrypt.GE!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 03 00 00 "
		
	strings :
		$a_02_0 = {8a 03 0f b6 8d ?? ?? ?? ?? 41 88 01 c7 85 ?? ?? ?? ?? d3 93 1a 00 8b 85 ?? ?? ?? ?? 8b 85 ?? ?? ?? ?? 25 03 00 00 80 41 3b c5 8b 85 ?? ?? ?? ?? 74 ?? 25 03 00 00 80 83 f8 02 8b 85 ?? ?? ?? ?? 75 } //10
		$a_02_1 = {25 03 00 00 80 83 f8 03 75 ?? 8b 85 ?? ?? ?? ?? 2b c8 8b 85 ?? ?? ?? ?? [0-08] 4d 03 cd 0f b6 8d ?? ?? ?? ?? c7 85 ?? ?? ?? ?? d3 93 1a 00 8b 85 ?? ?? ?? ?? 8b 85 ?? ?? ?? ?? 25 03 00 00 80 41 3b c5 8b 85 ?? ?? ?? ?? 0f 84 } //10
		$a_80_2 = {44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 } //DllRegisterServer  10
	condition:
		((#a_02_0  & 1)*10+(#a_02_1  & 1)*10+(#a_80_2  & 1)*10) >=30
 
}
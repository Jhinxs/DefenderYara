
rule Trojan_Win64_StrelaStealer_ASI_MTB{
	meta:
		description = "Trojan:Win64/StrelaStealer.ASI!MTB,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 10 00 00 "
		
	strings :
		$a_03_0 = {21 f2 44 09 ?? 09 ?? 31 ?? 43 88 0c 10 } //4
		$a_03_1 = {21 f3 44 09 ?? 09 ?? 31 ?? 43 88 0c 10 } //4
		$a_01_2 = {21 ca 83 f7 ff 41 21 ff 44 09 fa 43 88 14 10 c7 44 24 7c } //4
		$a_01_3 = {21 f1 09 cb 43 88 1c 10 c7 44 24 7c } //4
		$a_01_4 = {21 f2 44 09 f9 41 09 d3 44 31 d9 43 88 0c 10 c7 44 24 7c } //4
		$a_01_5 = {21 f1 44 09 fa 41 09 cb 44 31 da 43 88 14 10 c7 44 24 7c } //4
		$a_01_6 = {21 ce 45 09 f3 47 88 1c 10 } //4
		$a_01_7 = {21 d1 31 d7 09 f9 43 88 0c 10 } //4
		$a_01_8 = {21 ca 31 cf 09 fa 43 88 14 10 c7 44 24 7c } //4
		$a_01_9 = {21 f1 09 cb 43 88 1c 10 c7 84 24 } //4
		$a_01_10 = {41 21 f6 09 ca 45 09 f3 44 31 da 43 88 14 10 } //4
		$a_01_11 = {21 f2 09 d3 43 88 1c 10 c7 84 24 } //4
		$a_01_12 = {45 21 de 44 09 f2 43 88 14 10 c7 84 24 } //4
		$a_01_13 = {21 f5 44 09 d9 09 ea 31 d1 43 88 0c 10 } //4
		$a_01_14 = {44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 } //1 DllRegisterServer
		$a_03_15 = {41 b8 04 00 00 00 e8 ?? ?? 00 00 48 8d 0d ?? ?? 00 00 48 89 ca 48 81 c2 14 27 00 00 48 81 c1 04 00 00 00 } //1
	condition:
		((#a_03_0  & 1)*4+(#a_03_1  & 1)*4+(#a_01_2  & 1)*4+(#a_01_3  & 1)*4+(#a_01_4  & 1)*4+(#a_01_5  & 1)*4+(#a_01_6  & 1)*4+(#a_01_7  & 1)*4+(#a_01_8  & 1)*4+(#a_01_9  & 1)*4+(#a_01_10  & 1)*4+(#a_01_11  & 1)*4+(#a_01_12  & 1)*4+(#a_01_13  & 1)*4+(#a_01_14  & 1)*1+(#a_03_15  & 1)*1) >=6
 
}
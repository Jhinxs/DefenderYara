
rule Trojan_Win64_Lazy_SXB_MTB{
	meta:
		description = "Trojan:Win64/Lazy.SXB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,2d 00 2d 00 03 00 00 "
		
	strings :
		$a_03_0 = {48 8b 85 00 07 00 00 48 8b 48 48 8b 85 c4 06 00 00 48 63 d0 48 89 d0 48 01 c0 48 01 d0 48 c1 e0 ?? 48 01 c8 48 8b 00 48 8b 95 c0 05 00 00 48 89 c1 e8 ?? ?? ?? ?? 85 c0 75 31 48 8b 85 00 07 00 00 48 8b 48 48 8b 85 c4 06 00 00 48 63 d0 48 89 d0 48 01 c0 48 01 d0 48 c1 e0 ?? 48 01 c8 48 8b 40 08 48 89 85 c8 06 00 00 eb 1d 83 85 c4 06 00 00 01 48 8b 85 00 07 00 00 8b 40 50 39 85 c4 06 00 00 } //20
		$a_03_1 = {89 c2 89 d1 b8 ?? ?? ?? ?? 48 0f af c1 48 c1 e8 20 c1 e8 0d 69 c8 ?? ?? ?? ?? 89 d0 29 c8 01 d8 89 85 18 05 00 00 8b 85 18 05 00 00 89 c1 } //15
		$a_03_2 = {48 63 d0 48 89 d0 48 01 c0 48 01 d0 48 c1 e0 03 48 83 e8 18 48 01 c1 48 8b 85 f0 04 00 00 48 8b 95 f8 04 00 00 48 89 01 48 89 51 08 48 8b 85 00 05 00 00 48 89 41 10 48 8b 95 ?? 05 00 00 48 8d 85 c0 00 00 00 49 89 d1 4c 8d 05 ?? ?? ?? ?? ba 00 01 00 00 48 89 c1 } //10
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*15+(#a_03_2  & 1)*10) >=45
 
}
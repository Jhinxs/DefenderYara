
rule Trojan_Win64_SneakyGrunt_A_dha{
	meta:
		description = "Trojan:Win64/SneakyGrunt.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,0e 00 0e 00 06 00 00 "
		
	strings :
		$a_01_0 = {33 61 66 33 62 65 67 62 2e 30 61 6b } //10 3af3begb.0ak
		$a_01_1 = {7b 00 22 00 47 00 55 00 49 00 44 00 22 00 3a 00 22 00 7b 00 30 00 7d 00 22 00 2c 00 22 00 54 00 79 00 70 00 65 00 22 00 3a 00 7b 00 31 00 7d 00 2c 00 22 00 4d 00 65 00 74 00 61 00 22 00 3a 00 22 00 7b 00 32 00 7d 00 22 00 2c 00 22 00 49 00 56 00 22 00 3a 00 22 00 7b 00 33 00 7d 00 22 00 2c 00 22 00 45 00 6e 00 63 00 72 00 79 00 70 00 74 00 65 00 64 00 4d 00 65 00 73 00 73 00 61 00 67 00 65 00 22 00 3a 00 22 00 7b 00 34 00 7d 00 22 00 2c 00 22 00 48 00 4d 00 41 00 43 00 22 00 3a 00 22 00 7b 00 35 00 7d 00 22 00 7d 00 } //10 {"GUID":"{0}","Type":{1},"Meta":"{2}","IV":"{3}","EncryptedMessage":"{4}","HMAC":"{5}"}
		$a_01_2 = {74 6f 6b 65 6e 5f 74 79 70 65 } //1 token_type
		$a_01_3 = {61 63 63 65 73 73 5f 74 6f 6b 65 6e } //1 access_token
		$a_01_4 = {65 78 70 69 72 65 73 5f 69 6e } //1 expires_in
		$a_01_5 = {72 65 66 72 65 73 68 5f 74 6f 6b 65 6e } //1 refresh_token
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=14
 
}
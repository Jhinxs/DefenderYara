
rule Trojan_Win64_ReverseShell_SX_MTB{
	meta:
		description = "Trojan:Win64/ReverseShell.SX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,2d 00 2d 00 04 00 00 "
		
	strings :
		$a_03_0 = {48 89 ea 48 c7 44 24 20 00 00 00 00 4d 89 e1 ff 15 ?? ?? ?? ?? 48 8b 1d ?? ?? ?? ?? 4c 89 e9 ff d3 31 c0 b9 1a 00 00 00 48 89 ef f3 ab c7 44 24 70 68 00 00 00 ff 15 } //15
		$a_01_1 = {45 31 c9 45 31 c0 4c 89 f1 48 89 c2 48 8d 44 24 70 4c 89 64 24 48 48 89 44 24 40 48 c7 44 24 38 00 00 00 00 48 c7 44 24 30 00 00 00 00 c7 44 24 28 00 00 00 00 c7 44 24 20 00 00 00 00 ff 15 } //15
		$a_01_2 = {31 f6 48 8b 7c 24 58 b9 7e 00 00 00 45 31 c9 48 89 f0 41 b8 00 04 00 00 48 89 ea 48 c7 84 24 d0 02 00 00 00 00 00 00 f3 48 ab 4c 89 f1 48 c7 84 24 d8 02 00 00 00 00 00 00 ff 15 } //10
		$a_01_3 = {25 73 5f 25 30 38 58 2e 65 78 65 } //5 %s_%08X.exe
	condition:
		((#a_03_0  & 1)*15+(#a_01_1  & 1)*15+(#a_01_2  & 1)*10+(#a_01_3  & 1)*5) >=45
 
}
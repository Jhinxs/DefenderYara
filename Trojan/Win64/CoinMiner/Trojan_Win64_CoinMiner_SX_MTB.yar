
rule Trojan_Win64_CoinMiner_SX_MTB{
	meta:
		description = "Trojan:Win64/CoinMiner.SX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,32 00 32 00 03 00 00 "
		
	strings :
		$a_03_0 = {48 c7 44 24 38 08 00 00 00 48 8b 44 24 38 48 89 44 24 48 48 c7 44 24 40 00 00 00 00 48 8d 44 24 40 48 89 44 24 20 4c 8b 4c 24 48 4c 8d 44 24 78 48 8b 54 24 50 48 8b 84 24 80 00 00 00 48 8b 08 ff 15 ?? ?? ?? ?? 85 c0 75 17 } //20
		$a_03_1 = {48 c7 c0 ff ff ff ff e9 ?? ?? ?? ?? c7 44 24 78 00 00 00 00 48 c7 44 24 20 00 00 00 00 4c 8d 4c 24 78 44 8b 84 24 b0 00 00 00 48 8b 94 24 a8 00 00 00 48 8b 4c 24 60 ff 15 ?? ?? ?? ?? 85 c0 75 46 } //20
		$a_01_2 = {57 6b 44 44 48 69 54 68 78 7a 61 76 } //10 WkDDHiThxzav
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*20+(#a_01_2  & 1)*10) >=50
 
}
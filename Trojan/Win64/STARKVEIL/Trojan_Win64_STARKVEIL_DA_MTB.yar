
rule Trojan_Win64_STARKVEIL_DA_MTB{
	meta:
		description = "Trojan:Win64/STARKVEIL.DA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,69 00 69 00 19 00 00 "
		
	strings :
		$a_03_0 = {41 00 49 00 5f 00 32 00 30 00 32 00 35 00 [0-02] 5f 00 [0-19] 5f 00 [0-0f] 2e 00 70 00 64 00 62 00 } //100
		$a_03_1 = {41 49 5f 32 30 32 35 [0-02] 5f [0-19] 5f [0-0f] 2e 70 64 62 } //100
		$a_03_2 = {46 00 69 00 6c 00 65 00 5f 00 41 00 49 00 5f 00 [0-19] 5f 00 [0-0f] 2e 00 70 00 64 00 62 00 } //100
		$a_03_3 = {46 69 6c 65 5f 41 49 5f [0-19] 5f [0-0f] 2e 70 64 62 } //100
		$a_03_4 = {4c 00 75 00 6d 00 61 00 5f 00 32 00 30 00 32 00 35 00 5f 00 [0-19] 2e 00 70 00 64 00 62 00 } //100
		$a_03_5 = {4c 75 6d 61 5f 32 30 32 35 5f [0-19] 2e 70 64 62 } //100
		$a_03_6 = {4c 00 75 00 6d 00 61 00 41 00 49 00 5f 00 [0-19] 5f 00 [0-0f] 2e 00 70 00 64 00 62 00 } //100
		$a_03_7 = {4c 75 6d 61 41 49 5f [0-19] 5f [0-0f] 2e 70 64 62 } //100
		$a_03_8 = {4c 00 75 00 6d 00 61 00 6c 00 61 00 62 00 73 00 61 00 69 00 5f 00 [0-19] 5f 00 [0-0f] 2e 00 70 00 64 00 62 00 } //100
		$a_03_9 = {4c 75 6d 61 6c 61 62 73 61 69 5f [0-19] 5f [0-0f] 2e 70 64 62 } //100
		$a_03_10 = {4c 00 75 00 6d 00 61 00 44 00 72 00 65 00 61 00 6d 00 5f 00 [0-19] 5f 00 [0-0f] 2e 00 70 00 64 00 62 00 } //100
		$a_03_11 = {4c 75 6d 61 44 72 65 61 6d 5f [0-19] 5f [0-0f] 2e 70 64 62 } //100
		$a_03_12 = {4c 00 75 00 6d 00 61 00 6c 00 61 00 62 00 73 00 5f 00 [0-19] 5f 00 [0-0f] 2e 00 70 00 64 00 62 00 } //100
		$a_03_13 = {4c 75 6d 61 6c 61 62 73 5f [0-19] 5f [0-0f] 2e 70 64 62 } //100
		$a_03_14 = {4f 00 4e 00 45 00 4f 00 41 00 49 00 5f 00 4d 00 50 00 34 00 5f 00 [0-19] 2e 00 70 00 64 00 62 00 } //100
		$a_03_15 = {4f 4e 45 4f 41 49 5f 4d 50 34 5f [0-19] 2e 70 64 62 } //100
		$a_03_16 = {49 00 6e 00 76 00 69 00 64 00 5f 00 48 00 51 00 5f 00 [0-19] 2e 00 70 00 64 00 62 00 } //100
		$a_03_17 = {49 6e 76 69 64 5f 48 51 5f [0-19] 2e 70 64 62 } //100
		$a_03_18 = {4c 00 55 00 4d 00 41 00 [0-0f] 5f 00 4d 00 50 00 34 00 5f 00 [0-19] 2e 00 70 00 64 00 62 00 } //100
		$a_03_19 = {4c 55 4d 41 [0-0f] 5f 4d 50 34 5f [0-19] 2e 70 64 62 } //100
		$a_81_20 = {53 63 72 65 65 6e 54 6f 43 6c 69 65 6e 74 } //1 ScreenToClient
		$a_81_21 = {47 65 74 4b 65 79 62 6f 61 72 64 53 74 61 74 65 } //1 GetKeyboardState
		$a_81_22 = {53 65 74 43 61 70 74 75 72 65 } //1 SetCapture
		$a_81_23 = {52 65 76 6f 6b 65 44 72 61 67 44 72 6f 70 } //1 RevokeDragDrop
		$a_81_24 = {72 75 73 74 5f 70 61 6e 69 63 } //1 rust_panic
	condition:
		((#a_03_0  & 1)*100+(#a_03_1  & 1)*100+(#a_03_2  & 1)*100+(#a_03_3  & 1)*100+(#a_03_4  & 1)*100+(#a_03_5  & 1)*100+(#a_03_6  & 1)*100+(#a_03_7  & 1)*100+(#a_03_8  & 1)*100+(#a_03_9  & 1)*100+(#a_03_10  & 1)*100+(#a_03_11  & 1)*100+(#a_03_12  & 1)*100+(#a_03_13  & 1)*100+(#a_03_14  & 1)*100+(#a_03_15  & 1)*100+(#a_03_16  & 1)*100+(#a_03_17  & 1)*100+(#a_03_18  & 1)*100+(#a_03_19  & 1)*100+(#a_81_20  & 1)*1+(#a_81_21  & 1)*1+(#a_81_22  & 1)*1+(#a_81_23  & 1)*1+(#a_81_24  & 1)*1) >=105
 
}

rule Trojan_Win64_Rozena_NIT_MTB{
	meta:
		description = "Trojan:Win64/Rozena.NIT!MTB,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 06 00 00 "
		
	strings :
		$a_01_0 = {c7 44 24 74 04 00 00 00 c7 44 24 78 00 10 00 00 c7 44 24 7c 40 00 00 00 48 8d 84 24 d0 00 00 00 48 8b f8 33 c0 b9 68 00 00 00 f3 aa 48 8d 84 24 a8 00 00 00 48 8b f8 33 c0 b9 18 00 00 00 f3 aa } //2
		$a_01_1 = {48 8d 84 24 a8 00 00 00 48 89 44 24 48 48 8d 84 24 d0 00 00 00 48 89 44 24 40 48 c7 44 24 38 00 00 00 00 48 c7 44 24 30 00 00 00 00 c7 44 24 28 04 00 00 00 c7 44 24 20 00 00 00 00 45 33 c9 45 33 c0 33 d2 } //2
		$a_01_2 = {56 69 72 74 75 61 6c 41 6c 6c 6f 63 45 78 } //1 VirtualAllocEx
		$a_01_3 = {57 72 69 74 65 50 72 6f 63 65 73 73 4d 65 6d 6f 72 79 } //1 WriteProcessMemory
		$a_01_4 = {51 75 65 75 65 55 73 65 72 41 50 43 } //1 QueueUserAPC
		$a_01_5 = {52 65 73 75 6d 65 54 68 72 65 61 64 } //1 ResumeThread
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=8
 
}
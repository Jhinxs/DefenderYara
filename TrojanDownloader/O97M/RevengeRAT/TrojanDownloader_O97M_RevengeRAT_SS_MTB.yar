
rule TrojanDownloader_O97M_RevengeRAT_SS_MTB{
	meta:
		description = "TrojanDownloader:O97M/RevengeRAT.SS!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {53 65 74 20 77 62 52 65 73 75 6c 74 73 20 3d 20 57 6f 72 6b 62 6f 6f 6b 73 2e 4f 70 65 6e 28 46 69 6c 65 4e 61 6d 65 3a 3d 2e 46 6f 75 6e 64 46 69 6c 65 73 28 6c 43 6f 75 6e 74 29 2c 20 55 70 64 61 74 65 4c 69 6e 6b 73 3a 3d 30 29 } //1 Set wbResults = Workbooks.Open(FileName:=.FoundFiles(lCount), UpdateLinks:=0)
		$a_03_1 = {2e 4c 6f 6f 6b 49 6e 20 3d 20 70 63 50 39 4d 73 73 6a 6c 28 [0-1f] 28 22 34 46 35 36 37 43 34 42 37 32 38 31 36 46 35 35 36 38 37 37 35 38 35 35 22 29 2c 20 [0-1f] 28 22 33 37 22 29 29 } //1
		$a_03_2 = {27 4d 73 67 42 6f 78 20 28 70 63 50 39 4d 73 73 6a 6c 28 [0-1f] 28 22 35 35 37 32 36 30 37 37 35 38 37 30 34 46 35 30 35 36 37 37 36 31 35 41 37 42 36 42 35 30 36 30 36 44 36 41 35 39 36 43 36 43 35 37 32 37 32 37 32 37 38 31 37 36 34 45 38 30 35 43 36 44 35 41 37 42 35 35 22 29 2c [0-1f] 28 22 33 37 22 29 29 29 } //1
		$a_01_3 = {41 44 6f 41 4c 77 41 76 41 47 59 41 61 51 42 79 41 47 55 41 59 67 42 68 41 48 4d 41 5a 51 42 7a 41 48 51 41 62 77 42 79 41 47 45 41 5a 77 42 6c 41 43 34 41 5a 77 42 76 41 47 38 41 5a 77 42 73 41 47 55 41 59 51 42 77 41 47 6b 41 63 77 41 75 41 47 4d 41 62 77 42 74 41 43 38 41 64 67 41 77 41 43 38 41 59 67 41 76 41 48 4d 41 63 41 42 68 41 47 30 41 4c 51 42 6a 41 44 49 41 4e 77 41 7a 41 47 45 41 4c 67 42 68 41 48 41 41 63 41 42 7a 41 48 41 41 62 77 42 30 41 43 34 41 59 77 42 76 41 47 30 41 } //1 ADoALwAvAGYAaQByAGUAYgBhAHMAZQBzAHQAbwByAGEAZwBlAC4AZwBvAG8AZwBsAGUAYQBwAGkAcwAuAGMAbwBtAC8AdgAwAC8AYgAvAHMAcABhAG0ALQBjADIANwAzAGEALgBhAHAAcABzAHAAbwB0AC4AYwBvAG0A
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
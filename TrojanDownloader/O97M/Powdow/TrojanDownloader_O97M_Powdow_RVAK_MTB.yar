
rule TrojanDownloader_O97M_Powdow_RVAK_MTB{
	meta:
		description = "TrojanDownloader:O97M/Powdow.RVAK!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {3d 20 49 6e 74 32 53 74 72 28 22 30 33 32 31 30 34 31 31 36 31 31 36 31 31 32 30 35 38 30 34 37 30 34 37 31 31 39 31 31 39 31 31 39 30 34 36 31 30 36 30 34 36 31 30 39 31 31 32 30 34 37 22 29 } //1 = Int2Str("032104116116112058047047119119119046106046109112047")
		$a_01_1 = {45 6e 76 69 72 6f 6e 28 49 6e 74 32 53 74 72 28 22 30 38 30 30 38 35 30 36 36 30 37 36 30 37 33 30 36 37 22 29 29 20 26 20 49 6e 74 32 53 74 72 28 22 30 39 32 31 31 32 31 30 31 31 30 31 31 30 31 30 34 36 30 39 39 31 31 31 31 30 39 22 29 20 2b 20 6d 6f 6b 61 20 2b 20 73 65 65 } //1 Environ(Int2Str("080085066076073067")) & Int2Str("092112101101101046099111109") + moka + see
		$a_01_2 = {47 65 74 4f 62 6a 65 63 74 28 49 6e 74 32 53 74 72 28 22 31 31 39 31 30 35 31 31 30 31 30 39 31 30 33 31 30 39 31 31 36 31 31 35 30 35 38 22 29 29 2e 47 65 74 28 49 6e 74 32 53 74 72 28 22 30 38 37 31 30 35 31 31 30 30 35 31 30 35 30 30 39 35 30 38 30 31 31 34 31 31 31 30 39 39 31 30 31 31 31 35 31 31 35 22 29 29 2e 43 72 65 61 74 65 } //1 GetObject(Int2Str("119105110109103109116115058")).Get(Int2Str("087105110051050095080114111099101115115")).Create
		$a_01_3 = {49 20 3d 20 31 20 54 6f 20 4c 65 6e 28 73 54 65 78 74 29 20 53 74 65 70 20 33 } //1 I = 1 To Len(sText) Step 3
		$a_01_4 = {73 4e 61 6d 65 20 3d 20 4d 69 64 28 73 54 65 78 74 2c 20 49 2c 20 33 29 } //1 sName = Mid(sText, I, 3)
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
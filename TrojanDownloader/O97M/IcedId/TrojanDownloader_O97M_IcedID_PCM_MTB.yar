
rule TrojanDownloader_O97M_IcedID_PCM_MTB{
	meta:
		description = "TrojanDownloader:O97M/IcedID.PCM!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,07 00 07 00 09 00 00 "
		
	strings :
		$a_02_0 = {41 73 20 53 74 72 69 6e 67 20 3d 20 22 70 ?? 3a ?? 5c ?? 6a ?? 76 ?? 61 ?? 71 ?? 62 ?? 6a ?? 66 } //1
		$a_02_1 = {41 73 20 53 74 72 69 6e 67 20 3d 20 22 50 ?? 3a ?? 5c ?? 68 ?? 66 ?? 72 ?? 65 ?? 66 } //1
		$a_02_2 = {41 73 20 53 74 72 69 6e 67 20 3d 20 22 50 [0-16] 5c ?? 63 ?? 68 ?? 6f ?? 79 ?? 76 ?? 70 ?? 5c 78 39 30 01 01 76 ?? 61 } //1
		$a_00_3 = {46 69 6c 65 4e 75 6d 62 65 72 20 3d 20 46 72 65 65 46 69 6c 65 } //1 FileNumber = FreeFile
		$a_02_4 = {23 46 69 6c 65 4e 75 6d 62 65 72 2c 20 53 70 63 28 [0-0f] 29 } //1
		$a_02_5 = {49 66 20 28 [0-0a] 20 3e 20 36 34 20 41 6e 64 20 [0-0a] 20 3c 20 39 31 29 20 4f 72 20 28 [0-0a] 20 3e 20 39 36 20 41 6e 64 20 [0-0a] 20 3c 20 31 32 33 29 } //1
		$a_02_6 = {4d 69 64 24 28 [0-0a] 24 2c 20 [0-0a] 2c 20 31 29 20 3d 20 43 68 72 24 28 [0-0a] 29 } //1
		$a_02_7 = {3c 20 39 37 20 41 6e 64 20 [0-0a] 20 3e 20 38 33 20 54 68 65 6e } //1
		$a_02_8 = {45 6c 73 65 49 66 20 [0-0a] 20 3c 20 36 35 20 54 68 65 6e } //1
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1+(#a_00_3  & 1)*1+(#a_02_4  & 1)*1+(#a_02_5  & 1)*1+(#a_02_6  & 1)*1+(#a_02_7  & 1)*1+(#a_02_8  & 1)*1) >=7
 
}
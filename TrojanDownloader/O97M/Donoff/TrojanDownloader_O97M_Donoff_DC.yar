
rule TrojanDownloader_O97M_Donoff_DC{
	meta:
		description = "TrojanDownloader:O97M/Donoff.DC,SIGNATURE_TYPE_MACROHSTR_EXT,0b 00 0b 00 05 00 00 "
		
	strings :
		$a_03_0 = {54 68 69 73 57 6f 72 6b 62 6f 6f 6b 2e 50 61 73 73 77 6f 72 64 20 3d 20 22 [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] 22 } //1
		$a_03_1 = {41 63 74 69 76 65 44 6f 63 75 6d 65 6e 74 2e 50 61 73 73 77 6f 72 64 20 3d 20 22 [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] 22 } //1
		$a_03_2 = {53 68 65 6c 6c 20 90 05 12 03 61 2d 7a 28 90 05 0e 03 61 2d 7a 29 2c 20 30 } //3
		$a_03_3 = {46 6f 72 20 [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] 20 3d 20 31 20 54 6f 20 4c 65 6e 28 90 05 15 03 61 2d 7a 29 } //4
		$a_03_4 = {3d 20 49 6e 53 74 72 52 65 76 28 22 90 05 0d 09 61 2d 7a 41 2d 5a 30 2d 39 22 2c 20 [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] [61-7a] 29 } //3
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*3+(#a_03_3  & 1)*4+(#a_03_4  & 1)*3) >=11
 
}
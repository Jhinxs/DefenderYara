
rule TrojanDownloader_O97M_Donoff_AF{
	meta:
		description = "TrojanDownloader:O97M/Donoff.AF,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 09 00 00 "
		
	strings :
		$a_01_0 = {28 22 73 69 72 6c 65 74 68 6c 70 2e 22 29 29 } //1 ("sirlethlp."))
		$a_01_1 = {26 20 22 4e 6c 45 43 45 63 53 44 2e 65 78 65 22 } //1 & "NlECEcSD.exe"
		$a_02_2 = {3d 20 52 65 70 6c 61 63 65 28 90 05 20 06 61 2d 7a 30 2d 39 2c 20 43 68 72 24 28 30 29 2c 20 22 22 29 } //1
		$a_01_3 = {28 22 3d 62 70 77 75 2f 6f 71 2f 78 31 } //1 ("=bpwu/oq/x1
		$a_00_4 = {22 68 73 70 63 65 2e 73 74 77 72 69 22 29 20 26 20 22 6c 6c 22 29 } //1 "hspce.stwri") & "ll")
		$a_00_5 = {65 74 64 70 6c 3a 3d 70 22 29 } //1 etdpl:=p")
		$a_01_6 = {28 22 63 73 70 77 74 72 69 22 29 } //1 ("cspwtri")
		$a_02_7 = {3d 20 30 20 54 6f 20 [0-30] 28 90 05 20 06 61 2d 7a 30 2d 39 29 20 3d 20 46 69 78 28 28 90 05 20 06 61 2d 7a 30 2d 39 20 2b 20 31 29 20 2a 20 52 6e 64 29 } //1
		$a_02_8 = {3d 20 30 20 54 6f 20 [0-30] 3d 20 90 05 20 06 61 2d 7a 30 2d 39 20 2b 20 90 05 20 06 61 2d 7a 30 2d 39 28 90 05 20 06 61 2d 7a 30 2d 39 29 [0-10] 4e 65 78 74 20 [0-20] 52 6e 64 20 2d 31 [0-10] 52 61 6e 64 6f 6d 69 7a 65 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_02_2  & 1)*1+(#a_01_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_01_6  & 1)*1+(#a_02_7  & 1)*1+(#a_02_8  & 1)*1) >=3
 
}

rule TrojanDownloader_O97M_Donoff_gen_E{
	meta:
		description = "TrojanDownloader:O97M/Donoff.gen!E,SIGNATURE_TYPE_MACROHSTR_EXT,65 00 65 00 0d 00 00 "
		
	strings :
		$a_02_0 = {3d 20 22 22 [0-01] 2b [0-01] 22 22 [0-01] 90 04 01 02 26 2b [0-01] 22 54 65 22 [0-01] 90 04 01 02 26 2b [0-01] 22 6d 70 22 [0-01] 90 04 01 02 26 2b [0-01] 22 22 } //100
		$a_02_1 = {3d 20 22 54 65 22 20 90 04 01 02 26 2b 20 22 6d 70 22 } //100
		$a_02_2 = {43 68 72 28 38 34 29 20 90 04 01 02 26 2b 20 22 65 6d 22 20 2b 20 22 70 22 } //100
		$a_02_3 = {22 55 53 45 22 [0-01] 90 04 01 02 26 2b [0-01] 22 52 50 52 4f 46 49 4c 45 22 } //100
		$a_02_4 = {3d 20 22 22 [0-01] 26 [0-01] 22 68 74 22 [0-01] 26 [0-01] 22 74 22 [0-01] 26 [0-01] 22 70 3a 2f 2f 22 [0-01] 26 [0-01] 22 22 } //100
		$a_02_5 = {22 68 74 22 20 90 04 01 02 26 2b 20 22 74 22 20 90 04 01 02 26 2b 20 22 70 3a 2f 22 20 90 04 01 02 26 2b 20 22 2f 22 } //100
		$a_00_6 = {22 68 74 22 20 26 20 22 74 22 20 26 20 22 22 20 26 20 22 70 22 20 26 20 22 3a 22 20 26 20 22 2f 2f 22 } //100 "ht" & "t" & "" & "p" & ":" & "//"
		$a_02_7 = {3d 20 43 68 72 28 34 36 29 [0-10] 3d 20 43 68 72 28 31 30 31 29 [0-10] 3d 20 [0-10] 26 [0-10] 26 [0-01] 22 78 65 22 } //100
		$a_02_8 = {2b 20 43 68 72 28 35 30 [0-01] 2d [0-01] 34 29 [0-01] 2b [0-01] 22 76 22 [0-01] 2b [0-01] 22 22 [0-01] 2b [0-01] 22 22 [0-01] 26 [0-01] 22 62 22 [0-01] 26 [0-01] 22 22 [0-01] 26 [0-10] 26 [0-01] 22 22 } //100
		$a_02_9 = {43 44 44 44 20 3d 20 22 90 05 15 03 30 2d 39 2e 74 78 74 22 } //1
		$a_00_10 = {3d 20 22 6c 6e 73 2e 74 78 74 22 } //1 = "lns.txt"
		$a_00_11 = {3d 20 22 6b 61 6b 61 2e 74 78 74 22 } //1 = "kaka.txt"
		$a_02_12 = {43 44 44 44 20 3d 20 22 90 05 15 03 30 2d 39 22 20 2b 20 54 53 54 53 } //1
	condition:
		((#a_02_0  & 1)*100+(#a_02_1  & 1)*100+(#a_02_2  & 1)*100+(#a_02_3  & 1)*100+(#a_02_4  & 1)*100+(#a_02_5  & 1)*100+(#a_00_6  & 1)*100+(#a_02_7  & 1)*100+(#a_02_8  & 1)*100+(#a_02_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_02_12  & 1)*1) >=101
 
}

rule TrojanDownloader_O97M_Donoff_DZ{
	meta:
		description = "TrojanDownloader:O97M/Donoff.DZ,SIGNATURE_TYPE_MACROHSTR_EXT,1a 00 1a 00 0f 00 00 "
		
	strings :
		$a_02_0 = {41 72 72 61 79 28 4a 6f 69 6e 28 41 72 72 61 79 28 90 1d 10 00 29 28 30 29 2c 20 22 22 29 29 28 30 29 90 0c 02 00 90 1d 10 00 2e 52 75 6e 20 90 1d 10 00 2c 20 76 62 48 69 64 65 } //20
		$a_00_1 = {22 63 4d 22 29 28 31 29 } //1 "cM")(1)
		$a_00_2 = {22 44 2e 22 29 28 31 29 } //1 "D.")(1)
		$a_00_3 = {22 2f 73 22 29 28 31 29 } //1 "/s")(1)
		$a_00_4 = {22 65 61 22 29 28 31 29 } //1 "ea")(1)
		$a_00_5 = {22 72 63 22 29 28 31 29 } //1 "rc")(1)
		$a_00_6 = {22 68 2e 22 29 28 31 29 } //1 "h.")(1)
		$a_00_7 = {22 70 68 22 29 28 31 29 } //1 "ph")(1)
		$a_00_8 = {22 70 27 22 29 28 31 29 } //1 "p'")(1)
		$a_00_9 = {22 44 6f 22 29 28 31 29 } //1 "Do")(1)
		$a_00_10 = {22 57 6e 22 29 28 31 29 } //1 "Wn")(1)
		$a_00_11 = {22 46 69 22 29 28 31 29 } //1 "Fi")(1)
		$a_00_12 = {22 4c 65 22 29 28 31 29 } //1 "Le")(1)
		$a_00_13 = {22 68 74 22 29 28 31 29 } //1 "ht")(1)
		$a_00_14 = {22 74 70 22 29 28 31 29 } //1 "tp")(1)
	condition:
		((#a_02_0  & 1)*20+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1) >=26
 
}
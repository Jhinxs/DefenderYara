
rule TrojanDownloader_O97M_Donoff_DRB_MTB{
	meta:
		description = "TrojanDownloader:O97M/Donoff.DRB!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {49 54 68 56 36 51 77 49 5a 33 56 53 45 68 46 75 55 49 75 6e 77 48 33 4e 74 61 34 64 51 67 78 } //1 IThV6QwIZ3VSEhFuUIunwH3Nta4dQgx
		$a_01_1 = {70 5a 48 5f 5f 66 5f 47 69 46 68 74 61 43 39 4a 38 73 6a 58 4e 79 6b 54 4d 75 67 6d 5f 70 74 74 73 43 5a 49 5f 69 72 54 5f 61 54 6c 58 56 42 38 37 5a 6b 66 77 70 6d } //1 pZH__f_GiFhtaC9J8sjXNykTMugm_pttsCZI_irT_aTlXVB87Zkfwpm
		$a_01_2 = {64 5f 5f 5f 66 73 61 28 31 30 39 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 30 35 29 20 26 20 64 5f 5f 5f 66 73 61 28 38 39 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 33 36 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 32 37 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 33 34 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 33 38 29 20 26 20 64 5f 5f 5f 66 73 61 28 36 38 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 33 37 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 32 36 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 32 33 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 33 30 29 20 26 20 64 5f 5f 5f 66 73 61 28 31 33 30 29 } //1 d___fsa(109) & d___fsa(105) & d___fsa(89) & d___fsa(136) & d___fsa(127) & d___fsa(134) & d___fsa(138) & d___fsa(68) & d___fsa(137) & d___fsa(126) & d___fsa(123) & d___fsa(130) & d___fsa(130)
		$a_01_3 = {2e 52 75 6e 28 76 78 62 57 55 41 42 53 44 5f 57 5f 44 39 2c 20 72 34 75 43 57 6b 5f 63 34 78 37 51 59 35 29 } //1 .Run(vxbWUABSD_W_D9, r4uCWk_c4x7QY5)
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
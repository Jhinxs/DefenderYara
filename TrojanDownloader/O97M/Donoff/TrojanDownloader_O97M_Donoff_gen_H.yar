
rule TrojanDownloader_O97M_Donoff_gen_H{
	meta:
		description = "TrojanDownloader:O97M/Donoff.gen!H,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 06 00 00 "
		
	strings :
		$a_02_0 = {28 22 6b 77 77 73 3d 32 32 [0-40] 22 29 2c 20 45 6e 76 69 72 6f 6e 28 22 74 [0-05] 65 6d 70 22 29 20 26 } //1
		$a_00_1 = {31 68 7b 68 22 29 2c 20 22 22 2c 20 76 62 4e 75 6c 6c 53 74 72 69 6e 67 2c 20 76 62 4e 6f 72 6d 61 6c 46 6f 63 75 73 } //1 1h{h"), "", vbNullString, vbNormalFocus
		$a_00_2 = {31 68 7b 68 22 29 2c 20 30 2c 20 30 0d 0a } //1
		$a_00_3 = {20 30 2c 20 22 6f 70 65 6e 22 2c 20 45 6e 76 69 72 6f 6e 24 28 22 74 6d 70 22 29 20 26 } //1  0, "open", Environ$("tmp") &
		$a_02_4 = {28 22 6b 77 77 73 3d 32 32 [0-40] 31 68 7b 68 22 29 2c 20 45 6e 76 69 72 6f 6e 28 22 } //2
		$a_02_5 = {30 2c 20 22 6f 70 65 6e 22 2c 20 45 6e 76 69 72 6f 6e 24 28 [0-20] 29 20 26 20 [0-20] 28 22 [0-10] 31 68 7b 68 22 29 2c 20 22 22 2c 20 76 62 4e 75 6c 6c 53 74 72 69 6e 67 } //1
	condition:
		((#a_02_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_02_4  & 1)*2+(#a_02_5  & 1)*1) >=3
 
}
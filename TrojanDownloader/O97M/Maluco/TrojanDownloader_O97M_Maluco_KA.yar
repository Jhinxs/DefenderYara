
rule TrojanDownloader_O97M_Maluco_KA{
	meta:
		description = "TrojanDownloader:O97M/Maluco.KA,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_03_0 = {4f 70 65 6e 20 65 6e 76 20 26 20 22 50 73 69 43 6f 6e 74 65 6e 74 5c 22 20 26 20 22 [0-1e] 22 20 26 20 22 2e 62 61 74 22 } //1
		$a_00_1 = {45 6e 76 69 72 6f 6e 24 28 43 68 72 24 28 36 35 29 20 26 20 43 68 72 24 28 31 31 32 29 20 26 20 43 68 72 24 28 31 31 32 29 20 26 20 43 68 72 24 28 36 38 29 20 26 20 43 68 72 24 28 39 37 29 20 26 20 43 68 72 24 28 31 31 36 29 20 26 20 43 68 72 24 28 39 37 29 29 20 26 20 43 68 72 24 28 39 32 29 } //1 Environ$(Chr$(65) & Chr$(112) & Chr$(112) & Chr$(68) & Chr$(97) & Chr$(116) & Chr$(97)) & Chr$(92)
		$a_03_2 = {54 68 69 73 44 6f 63 75 6d 65 6e 74 2e 44 65 66 61 75 6c 74 54 61 72 67 65 74 46 72 61 6d 65 20 26 20 22 6f 6d 2f 77 70 2d 63 6f 6e 74 65 6e 74 2f 70 6c 75 67 69 6e 73 2f 61 70 69 6b 65 79 2f [0-14] 2e 70 6e 67 27 2c 20 27 43 3a 5c 50 73 69 43 6f 6e 74 65 6e 74 5c [0-14] 2e 65 78 65 27 29 22 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_00_1  & 1)*1+(#a_03_2  & 1)*1) >=3
 
}

rule TrojanDownloader_O97M_Obfuse_KD{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.KD,SIGNATURE_TYPE_MACROHSTR_EXT,1e 00 14 00 03 00 00 "
		
	strings :
		$a_01_0 = {73 55 52 4c 20 3d 20 43 68 72 28 26 48 36 38 29 20 26 20 43 68 72 28 26 48 37 34 29 20 26 20 43 68 72 28 26 48 37 34 29 20 26 20 43 68 72 28 26 48 37 30 29 20 26 20 43 68 72 28 26 48 33 41 29 20 26 20 43 68 72 28 26 48 32 46 29 20 26 20 43 68 72 28 26 48 32 46 29 20 26 20 } //10 sURL = Chr(&H68) & Chr(&H74) & Chr(&H74) & Chr(&H70) & Chr(&H3A) & Chr(&H2F) & Chr(&H2F) & 
		$a_01_1 = {73 55 52 4c 44 6f 63 20 3d 20 43 68 72 28 26 48 36 38 29 20 26 20 43 68 72 28 26 48 37 34 29 20 26 20 43 68 72 28 26 48 37 34 29 20 26 20 43 68 72 28 26 48 37 30 29 20 26 20 43 68 72 28 26 48 33 41 29 20 26 20 43 68 72 28 26 48 32 46 29 20 26 20 43 68 72 28 26 48 32 46 29 20 26 20 } //10 sURLDoc = Chr(&H68) & Chr(&H74) & Chr(&H74) & Chr(&H70) & Chr(&H3A) & Chr(&H2F) & Chr(&H2F) & 
		$a_01_2 = {2e 52 75 6e 20 28 22 72 65 67 73 76 72 33 32 2e 65 78 65 20 2f 73 20 2f 69 20 22 20 26 20 } //10 .Run ("regsvr32.exe /s /i " & 
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10) >=20
 
}
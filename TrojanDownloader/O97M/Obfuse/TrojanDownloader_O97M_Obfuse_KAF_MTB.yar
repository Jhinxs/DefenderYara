
rule TrojanDownloader_O97M_Obfuse_KAF_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.KAF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {6b 61 6f 73 6b 2e 63 6f 70 79 66 69 6c 65 20 49 6e 74 32 53 74 72 28 22 30 36 37 30 35 38 30 39 32 30 38 37 31 30 35 31 31 30 31 30 30 31 31 31 31 31 39 31 31 35 30 39 32 30 38 33 31 32 31 31 31 35 31 31 36 31 30 31 31 30 39 30 35 31 30 35 30 30 39 32 31 30 39 31 31 35 31 30 34 31 31 36 30 39 37 30 34 36 31 30 31 31 32 30 31 30 31 22 29 2c 20 45 6e 76 69 72 6f 6e 24 28 49 6e 74 32 53 74 72 28 22 30 38 30 30 38 35 30 36 36 30 37 36 30 37 33 30 36 37 22 29 29 20 26 20 49 6e 74 32 53 74 72 28 22 30 39 32 31 31 32 31 30 31 31 30 31 31 30 31 30 34 36 30 39 39 31 31 31 31 30 39 22 29 2c 20 54 72 75 65 } //1 kaosk.copyfile Int2Str("067058092087105110100111119115092083121115116101109051050092109115104116097046101120101"), Environ$(Int2Str("080085066076073067")) & Int2Str("092112101101101046099111109"), True
		$a_01_1 = {6b 6f 6b 6f 6b 61 73 64 20 3d 20 45 6e 76 69 72 6f 6e 24 28 49 6e 74 32 53 74 72 28 22 31 31 32 30 38 35 30 36 36 30 37 36 30 37 33 30 36 37 22 29 29 20 26 20 49 6e 74 32 53 74 72 28 22 30 39 32 30 36 38 30 37 36 30 36 35 30 38 33 30 36 38 30 37 36 31 30 38 31 30 36 31 30 30 30 39 37 31 31 37 31 30 30 31 31 39 31 31 31 31 30 37 31 31 35 31 30 36 31 30 30 30 39 37 31 31 37 31 30 30 31 31 39 31 31 31 31 30 37 31 31 35 31 30 36 31 30 30 30 39 37 31 31 37 31 30 30 31 31 39 31 31 31 31 30 37 31 31 35 30 34 38 31 30 38 31 31 31 31 30 38 30 33 32 31 30 34 31 31 36 31 31 36 31 31 32 31 31 35 30 35 38 31 31 } //1 kokokasd = Environ$(Int2Str("112085066076073067")) & Int2Str("09206807606508306807610810610009711710011911110711510610009711710011911110711510610009711710011911110711504810811110803210411611611211505811
		$a_01_2 = {61 64 6a 61 69 77 64 6a 69 61 73 6b 64 20 3d 20 49 6e 74 32 53 74 72 28 22 30 34 38 30 34 39 31 31 30 30 35 30 31 30 33 30 35 30 31 31 36 31 30 37 31 31 31 31 30 37 31 31 31 31 30 37 30 39 37 31 31 35 31 30 30 30 35 38 22 29 } //1 adjaiwdjiaskd = Int2Str("048049110050103050116107111107111107097115100058")
		$a_01_3 = {61 6b 73 64 6f 6b 61 73 6f 64 6b 6f 61 6b 73 64 20 3d 20 49 6e 74 32 53 74 72 28 22 30 39 37 31 30 37 31 31 35 31 30 30 31 31 31 31 30 37 30 39 37 31 31 35 31 31 31 31 30 30 31 30 37 31 31 31 30 39 37 31 30 37 31 31 35 31 30 30 30 35 33 31 31 30 31 31 31 31 31 31 31 31 31 30 39 35 30 38 30 31 31 34 31 31 31 30 39 39 31 30 31 30 35 34 30 35 34 22 29 } //1 aksdokasodkoaksd = Int2Str("097107115100111107097115111100107111097107115100053110111111111095080114111099101054054")
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
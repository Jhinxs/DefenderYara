
rule TrojanDownloader_O97M_Obfuse_SR_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.SR!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,06 00 06 00 09 00 00 "
		
	strings :
		$a_01_0 = {6b 61 73 6f 64 6b 6f 6b 20 3d 20 22 74 70 3a 2f 2f 25 37 34 38 32 33 37 25 37 32 38 37 34 38 40 6a 2e 6d 70 2f } //2 kasodkok = "tp://%748237%728748@j.mp/
		$a_01_1 = {6a 73 61 64 6a 6a 6a 20 3d 20 22 61 6a 73 64 61 } //1 jsadjjj = "ajsda
		$a_01_2 = {6b 6d 6d 6d 6d 6d 20 3d 20 6b 61 73 6f 64 6b 6f 6b 20 2b 20 6a 73 61 64 6a 6a 6a } //1 kmmmmm = kasodkok + jsadjjj
		$a_01_3 = {6e 6d 6e 61 6b 77 64 6a 31 20 3d 20 22 73 22 } //1 nmnakwdj1 = "s"
		$a_01_4 = {6e 6d 6e 61 6b 77 64 6a 32 20 3d 20 22 68 22 } //1 nmnakwdj2 = "h"
		$a_01_5 = {6e 6d 6e 61 6b 77 64 6a 33 20 3d 20 22 74 22 20 2b 20 22 61 20 68 74 22 } //1 nmnakwdj3 = "t" + "a ht"
		$a_01_6 = {6e 30 74 20 3d 20 22 6d 73 22 20 2b 20 22 68 22 20 2b 20 22 74 61 22 20 2b 20 22 20 68 74 22 20 2b 20 22 74 70 3a 2f 22 20 2b 20 22 2f 68 6f 74 22 20 2b 20 22 65 6c 6c 65 22 20 2b 20 22 6f 6e 61 72 22 20 2b 20 22 64 6f 64 61 22 20 2b 20 22 76 69 22 20 2b 20 22 6e 63 69 2e 22 20 2b 20 22 63 6c 2f 70 22 20 2b 20 22 6e 67 2f 70 22 20 2b 20 22 30 2e 68 22 20 2b 20 22 74 61 } //6 n0t = "ms" + "h" + "ta" + " ht" + "tp:/" + "/hot" + "elle" + "onar" + "doda" + "vi" + "nci." + "cl/p" + "ng/p" + "0.h" + "ta
		$a_01_7 = {6c 6f 72 61 31 20 3d 20 22 74 70 3a 2f 2f 25 37 34 38 32 33 37 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 25 37 32 38 37 34 38 40 6a 2e 6d 70 2f } //6 lora1 = "tp://%748237%728748%728748%728748%728748%728748%728748%728748%728748%728748%728748%728748%728748%728748%728748%728748@j.mp/
		$a_01_8 = {68 74 22 20 2b 20 22 74 70 3a 2f 22 20 2b 20 22 2f 68 6f 74 22 20 2b 20 22 65 6c 6c 65 22 20 2b 20 22 6f 6e 61 72 22 20 2b 20 22 64 6f 64 61 22 20 2b 20 22 76 69 22 20 2b 20 22 6e 63 69 2e 22 20 2b 20 22 63 6c 2f 70 22 20 2b 20 22 6e 67 2f 70 22 20 2b 20 22 30 2e 68 22 20 2b 20 22 74 61 } //6 ht" + "tp:/" + "/hot" + "elle" + "onar" + "doda" + "vi" + "nci." + "cl/p" + "ng/p" + "0.h" + "ta
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*6+(#a_01_7  & 1)*6+(#a_01_8  & 1)*6) >=6
 
}

rule TrojanDownloader_O97M_Obfuse_RVE_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.RVE!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_00_0 = {43 72 65 61 74 65 4f 62 6a 65 63 74 28 22 57 53 63 22 20 2b 20 43 68 72 28 31 31 34 20 2b 20 57 44 47 63 52 20 2b 20 4f 77 69 30 77 29 20 2b 20 22 69 70 74 2e 22 20 2b 20 43 68 72 24 28 37 39 20 2b 20 4f 75 77 6f 4b 20 2b 20 5a 6e 78 57 6c 20 2b 20 34 29 20 2b 20 22 68 65 6c 6c 22 29 } //1 CreateObject("WSc" + Chr(114 + WDGcR + Owi0w) + "ipt." + Chr$(79 + OuwoK + ZnxWl + 4) + "hell")
		$a_00_1 = {64 61 79 20 3d 20 44 61 74 65 56 61 6c 75 65 28 22 31 32 20 2f 20 31 32 20 2f 20 32 31 32 31 22 29 } //1 day = DateValue("12 / 12 / 2121")
		$a_00_2 = {44 61 74 2e 52 75 6e 20 70 61 73 73 77 6f 72 64 2c 20 30 } //1 Dat.Run password, 0
		$a_00_3 = {43 68 72 28 38 31 20 2b 20 54 57 68 7a 4e 20 2b 20 31 38 20 2b 20 32 20 2b 20 6f 47 75 52 53 20 2b 20 47 55 73 71 69 29 20 2b 20 43 68 72 28 33 32 20 2b 20 32 30 20 2b 20 31 33 20 2b 20 32 33 20 2b 20 31 20 2b 20 38 29 20 2b 20 22 72 74 68 2e 22 20 2b 20 43 68 72 28 32 38 20 2b 20 34 33 20 2b 20 32 37 29 20 2b 20 43 68 72 57 28 36 36 20 2b 20 79 5a 6a 72 50 20 2b 20 32 36 20 2b 20 35 20 2b 20 41 38 6d 77 64 29 20 2b 20 22 74 22 20 26 20 43 68 72 28 33 34 29 } //1 Chr(81 + TWhzN + 18 + 2 + oGuRS + GUsqi) + Chr(32 + 20 + 13 + 23 + 1 + 8) + "rth." + Chr(28 + 43 + 27) + ChrW(66 + yZjrP + 26 + 5 + A8mwd) + "t" & Chr(34)
		$a_00_4 = {53 75 62 20 41 75 74 6f 4f 70 65 6e 28 29 } //1 Sub AutoOpen()
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=5
 
}
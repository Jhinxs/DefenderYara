
rule TrojanDownloader_O97M_Obfuse_DE_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.DE!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 06 00 00 "
		
	strings :
		$a_03_0 = {6c 75 6c 75 2e 62 72 65 66 75 6c 2e 75 73 2f [0-06] 2f [0-0b] 2e 65 78 65 90 0a 2d 00 68 74 74 70 3a 2f 2f } //2
		$a_03_1 = {6d 69 2e 63 65 63 65 6c 69 61 6e 73 61 6e 64 65 72 73 2e 75 73 2f [0-06] 2f [0-0b] 2e 65 78 65 90 0a 2d 00 68 74 74 70 3a 2f 2f } //2
		$a_03_2 = {67 61 6c 69 2e 6b 65 69 70 74 61 2e 75 73 2f [0-12] 2e 65 78 65 90 0a 2d 00 68 74 74 70 3a 2f 2f } //2
		$a_03_3 = {25 74 65 6d 70 25 5c [0-28] 2e 65 78 65 27 29 3b 73 74 61 72 74 20 25 74 65 6d 70 25 } //1
		$a_00_4 = {6f 62 6a 2e 44 6f 63 75 6d 65 6e 74 2e 41 70 70 6c 69 63 61 74 69 6f 6e 2e 53 68 65 6c 6c 45 78 65 63 75 74 65 20 22 63 6d 64 2e 65 78 65 20 22 2c 20 22 2f 63 20 22 20 26 20 22 20 22 } //1 obj.Document.Application.ShellExecute "cmd.exe ", "/c " & " "
		$a_03_5 = {56 42 41 2e 43 6f 6d 6d 61 6e 64 28 [0-0a] 2c 20 52 69 67 68 74 28 52 69 67 68 74 28 4d 69 64 28 22 } //1
	condition:
		((#a_03_0  & 1)*2+(#a_03_1  & 1)*2+(#a_03_2  & 1)*2+(#a_03_3  & 1)*1+(#a_00_4  & 1)*1+(#a_03_5  & 1)*1) >=5
 
}
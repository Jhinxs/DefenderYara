
rule TrojanDownloader_O97M_Obfuse_RVAR_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.RVAR!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {3d 20 47 65 74 4f 62 6a 65 63 74 28 22 22 20 2b 20 22 6e 22 20 2b 20 22 65 22 20 2b 20 22 77 22 20 2b 20 22 3a 22 20 2b 20 22 46 39 33 22 20 2b 20 22 35 22 20 2b 20 22 44 22 20 2b 20 22 43 22 20 2b 20 22 32 22 20 2b 20 22 32 22 20 2b 20 22 2d 22 20 2b 20 22 31 22 20 2b 20 22 43 22 20 2b 20 22 46 22 20 2b 20 22 30 2d 31 22 20 2b 20 22 31 44 30 2d 41 44 42 39 2d 22 20 2b 20 22 30 30 43 30 34 22 20 2b 20 22 46 44 22 20 2b 20 22 35 22 20 2b 20 22 38 22 20 2b 20 22 41 22 20 2b 20 22 30 22 20 2b 20 22 42 22 29 } //1 = GetObject("" + "n" + "e" + "w" + ":" + "F93" + "5" + "D" + "C" + "2" + "2" + "-" + "1" + "C" + "F" + "0-1" + "1D0-ADB9-" + "00C04" + "FD" + "5" + "8" + "A" + "0" + "B")
		$a_01_1 = {6d 65 69 6e 6b 6f 6e 68 75 6e 31 2e 45 58 45 43 20 6c 69 73 74 65 6e 31 20 2b 20 6d 61 64 61 72 32 20 2b 20 6a 61 6e 75 33 20 2b 20 6a 61 6e 75 34 20 2b 20 66 61 6b 69 72 34 } //1 meinkonhun1.EXEC listen1 + madar2 + janu3 + janu4 + fakir4
		$a_01_2 = {22 6d 22 20 2b 20 22 73 22 20 2b 20 22 68 22 20 2b 20 22 74 22 20 2b 20 22 61 20 68 22 20 2b 20 22 74 22 20 2b 20 22 74 22 20 2b 20 22 70 22 20 2b 20 22 73 22 20 2b 20 22 3a 2f 2f } //1 "m" + "s" + "h" + "t" + "a h" + "t" + "t" + "p" + "s" + "://
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
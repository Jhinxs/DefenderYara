
rule TrojanDownloader_O97M_Obfuse_AL_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.AL!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {22 20 68 22 20 2b 20 22 74 22 20 2b 20 22 74 22 20 2b 20 22 70 22 20 2b 20 22 3a 22 20 2b 20 22 2f 22 20 2b 20 22 2f 22 20 2b 20 22 31 22 20 2b 20 22 32 22 20 2b 20 22 33 22 20 2b 20 22 30 22 20 2b 20 22 39 22 20 2b 20 22 34 22 20 2b 20 22 38 22 } //1 " h" + "t" + "t" + "p" + ":" + "/" + "/" + "1" + "2" + "3" + "0" + "9" + "4" + "8"
		$a_01_1 = {22 25 22 20 2b 20 22 31 22 20 2b 20 22 32 22 20 2b 20 22 33 22 20 2b 20 22 30 22 20 2b 20 22 39 22 20 2b 20 22 34 22 20 2b 20 22 38 22 20 2b 20 22 40 22 20 2b 20 22 6a 22 20 2b 20 22 2e 22 20 2b 20 22 6d 22 20 2b 20 22 70 22 20 2b 20 22 2f 22 } //1 "%" + "1" + "2" + "3" + "0" + "9" + "4" + "8" + "@" + "j" + "." + "m" + "p" + "/"
		$a_01_2 = {53 68 65 6c 6c 20 22 70 69 22 20 2b 20 22 6e 67 22 } //1 Shell "pi" + "ng"
		$a_01_3 = {53 68 65 6c 6c 20 22 63 22 20 2b 20 22 6d 22 20 2b 20 22 64 20 2f 22 20 2b 20 22 63 20 6d 22 20 2b 20 22 73 22 20 2b 20 22 68 22 20 2b 20 22 74 22 20 2b 20 22 61 22 } //1 Shell "c" + "m" + "d /" + "c m" + "s" + "h" + "t" + "a"
		$a_01_4 = {22 6a 61 73 69 64 6a 22 20 2b 20 22 64 6a 73 61 6c 73 64 61 22 20 2b 20 22 64 68 6e 6a 6b 73 61 22 } //1 "jasidj" + "djsalsda" + "dhnjksa"
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}

rule TrojanDownloader_O97M_Emotet_VCSM_MTB{
	meta:
		description = "TrojanDownloader:O97M/Emotet.VCSM!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,01 00 01 00 04 00 00 "
		
	strings :
		$a_01_0 = {76 22 26 22 69 70 22 26 22 74 65 22 26 22 63 6b 2e 63 22 26 22 6f 22 26 22 6d 2f 77 22 26 22 70 2d 61 22 26 22 64 6d 22 26 22 69 6e 2f 75 22 26 22 73 65 22 26 22 72 2f 42 22 26 22 38 64 22 26 22 36 6a 22 26 22 72 34 22 26 22 70 42 22 26 22 4e 44 22 26 22 32 48 22 26 22 45 78 22 26 22 41 6d 22 26 22 49 2f 6c 4a 22 26 22 57 61 22 26 22 39 35 22 26 22 56 6c 22 26 22 51 2f } //1 v"&"ip"&"te"&"ck.c"&"o"&"m/w"&"p-a"&"dm"&"in/u"&"se"&"r/B"&"8d"&"6j"&"r4"&"pB"&"ND"&"2H"&"Ex"&"Am"&"I/lJ"&"Wa"&"95"&"Vl"&"Q/
		$a_01_1 = {73 22 26 22 61 6c 22 26 22 6c 65 22 26 22 64 65 22 26 22 6d 6f 22 26 22 64 65 2e 63 22 26 22 6f 22 26 22 6d 2f 74 22 26 22 67 72 22 26 22 6f 75 22 26 22 70 2e 67 22 26 22 65 2f 78 22 26 22 34 62 22 26 22 63 32 22 26 22 6b 4c 22 26 22 34 42 22 26 22 7a 47 22 26 22 41 65 22 26 22 55 73 22 26 22 56 69 2f } //1 s"&"al"&"le"&"de"&"mo"&"de.c"&"o"&"m/t"&"gr"&"ou"&"p.g"&"e/x"&"4b"&"c2"&"kL"&"4B"&"zG"&"Ae"&"Us"&"Vi/
		$a_01_2 = {61 22 26 22 69 72 22 26 22 6c 69 22 26 22 66 74 22 26 22 6c 69 22 26 22 6d 6f 2e 63 22 26 22 6f 22 26 22 6d 2f 77 22 26 22 70 2d 61 22 26 22 64 6d 22 26 22 69 6e 2f 69 22 26 22 4d 22 26 22 63 2f } //1 a"&"ir"&"li"&"ft"&"li"&"mo.c"&"o"&"m/w"&"p-a"&"dm"&"in/i"&"M"&"c/
		$a_01_3 = {6b 22 26 22 61 62 22 26 22 65 6f 22 26 22 6e 65 22 26 22 74 2e 70 22 26 22 6c 2f 77 22 26 22 70 2d 61 22 26 22 64 6d 22 26 22 69 6e 2f 56 22 26 22 57 6c 22 26 22 41 7a 22 26 22 35 76 22 26 22 57 4a 22 26 22 4e 48 22 26 22 44 62 2f } //1 k"&"ab"&"eo"&"ne"&"t.p"&"l/w"&"p-a"&"dm"&"in/V"&"Wl"&"Az"&"5v"&"WJ"&"NH"&"Db/
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=1
 
}
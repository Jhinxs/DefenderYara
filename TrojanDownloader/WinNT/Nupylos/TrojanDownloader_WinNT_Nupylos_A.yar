
rule TrojanDownloader_WinNT_Nupylos_A{
	meta:
		description = "TrojanDownloader:WinNT/Nupylos.A,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 0b 00 00 "
		
	strings :
		$a_01_0 = {5c 00 3f 00 3f 00 5c 00 25 00 77 00 73 00 5c 00 53 00 79 00 73 00 74 00 65 00 6d 00 33 00 32 00 5c 00 44 00 52 00 49 00 56 00 45 00 52 00 53 00 5c 00 6e 00 75 00 70 00 2e 00 73 00 79 00 73 00 } //1 \??\%ws\System32\DRIVERS\nup.sys
		$a_01_1 = {5c 00 44 00 65 00 76 00 69 00 63 00 65 00 5c 00 4d 00 79 00 44 00 52 00 56 00 53 00 } //1 \Device\MyDRVS
		$a_01_2 = {5c 00 44 00 6f 00 73 00 44 00 65 00 76 00 69 00 63 00 65 00 73 00 5c 00 4d 00 79 00 44 00 52 00 56 00 53 00 } //1 \DosDevices\MyDRVS
		$a_01_3 = {25 73 3f 69 64 3d 25 77 73 26 64 6f 77 6e 6c 6f 61 64 3d 25 30 32 2e 38 58 20 48 54 54 50 2f 31 2e 30 0d 0a 48 6f 73 74 3a 20 25 73 0d 0a } //1
		$a_01_4 = {25 73 3f 69 64 3d 25 77 73 20 48 54 54 50 2f 31 2e 30 0d 0a 48 6f 73 74 3a 20 25 73 0d 0a } //1
		$a_01_5 = {2f 73 70 6d 2f 69 6e 64 65 78 2e 70 68 70 } //1 /spm/index.php
		$a_01_6 = {6d 79 72 78 38 2e 6e 65 74 } //1 myrx8.net
		$a_80_7 = {25 77 73 2e 25 30 32 2e 38 58 2e 64 6c 6c } //%ws.%02.8X.dll  1
		$a_01_8 = {75 f5 35 26 80 ac c8 74 0a 41 3b 4a 18 75 e1 33 c0 eb 1b } //2
		$a_01_9 = {c1 e0 02 8b 52 1c 03 d3 8b 04 02 03 c3 8b 5d 08 ff 33 ff d0 b8 de c0 ad de } //2
		$a_03_10 = {80 7f 09 32 0f 85 ?? 00 00 00 80 7f 0a 30 0f 85 ?? 00 00 00 80 7f 0b 30 } //2
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_80_7  & 1)*1+(#a_01_8  & 1)*2+(#a_01_9  & 1)*2+(#a_03_10  & 1)*2) >=6
 
}
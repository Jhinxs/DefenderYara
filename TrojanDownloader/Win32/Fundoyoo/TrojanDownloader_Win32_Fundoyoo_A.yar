
rule TrojanDownloader_Win32_Fundoyoo_A{
	meta:
		description = "TrojanDownloader:Win32/Fundoyoo.A,SIGNATURE_TYPE_PEHSTR_EXT,2b 00 2b 00 0f 00 00 "
		
	strings :
		$a_00_0 = {5c 4d 69 63 72 6f 73 6f 66 74 5c 69 64 2e 74 78 74 } //10 \Microsoft\id.txt
		$a_00_1 = {53 4f 46 54 57 41 52 45 5c 42 6f 72 6c 61 6e 64 5c 44 65 6c 70 68 69 5c 52 54 4c } //10 SOFTWARE\Borland\Delphi\RTL
		$a_00_2 = {68 74 74 70 3a 2f 2f 62 6f 73 63 75 6d 69 78 2e 63 6f 6d 2f 6f 70 74 69 6d 61 2f 69 6e 64 65 78 2e 70 68 70 } //10 http://boscumix.com/optima/index.php
		$a_02_3 = {6a 00 6a 00 68 ?? ?? 40 00 8b cb ba 00 04 00 00 33 c0 e8 ?? ?? ff ff 6a 00 6a 00 68 ?? ?? 40 00 8b cb ba 00 04 00 00 33 c0 e8 ?? ?? ff ff 6a 00 6a 00 68 ?? ?? 40 00 8b cb ba 00 04 00 00 33 c0 e8 ?? ?? ff ff 6a 00 6a 00 68 ?? ?? 40 00 8b cb ba 00 04 00 00 33 c0 e8 ?? ?? ff ff 6a 00 6a 00 68 ?? ?? 40 00 8b cb ba 00 04 00 00 33 c0 e8 ?? ?? ff ff 6a 00 } //10
		$a_00_4 = {4d 6f 7a 69 6c 6c 61 2f 34 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d 53 49 45 20 35 2e 30 3b 20 57 69 6e 64 6f 77 73 20 32 30 30 30 29 20 4f 70 65 72 61 20 36 2e 30 33 20 5b 65 6e 5d } //1 Mozilla/4.0 (compatible; MSIE 5.0; Windows 2000) Opera 6.03 [en]
		$a_00_5 = {4d 6f 7a 69 6c 6c 61 2f 34 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d 53 49 45 20 36 2e 30 3b 20 41 6d 65 72 69 63 61 20 4f 6e 6c 69 6e 65 20 42 72 6f 77 73 65 72 20 31 2e 31 3b 20 72 65 76 31 2e 35 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 35 2e 31 3b 29 } //1 Mozilla/4.0 (compatible; MSIE 6.0; America Online Browser 1.1; rev1.5; Windows NT 5.1;)
		$a_00_6 = {4d 6f 7a 69 6c 6c 61 2f 34 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d 53 49 45 20 36 2e 30 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 35 2e 31 3b 20 41 76 61 6e 74 20 42 72 6f 77 73 65 72 20 5b 61 76 61 6e 74 62 72 6f 77 73 65 72 2e 63 6f 6d 5d 3b 20 69 4f 70 75 73 2d 49 2d 4d 3b 20 51 58 57 30 33 34 31 36 3b 20 2e 4e 45 54 20 43 4c 52 20 31 2e 31 2e 34 33 32 32 29 } //1 Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; Avant Browser [avantbrowser.com]; iOpus-I-M; QXW03416; .NET CLR 1.1.4322)
		$a_00_7 = {4d 6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 57 69 6e 64 6f 77 73 3b 20 55 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 35 2e 31 3b 20 65 6e 2d 55 53 29 20 41 70 70 6c 65 57 65 62 4b 69 74 2f 35 32 35 2e 31 39 20 28 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b 6f 29 20 43 68 72 6f 6d 65 2f 30 2e 34 2e 31 35 34 2e 32 35 20 53 61 66 61 72 69 2f 35 32 35 2e 31 39 20 } //1 Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.19 (KHTML, like Gecko) Chrome/0.4.154.25 Safari/525.19 
		$a_00_8 = {4d 6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 58 31 31 3b 20 55 3b 20 4c 69 6e 75 78 20 69 36 38 36 20 28 78 38 36 5f 36 34 29 3b 20 65 6e 2d 55 53 3b 20 72 76 3a 31 2e 38 2e 31 2e 36 29 20 47 65 63 6b 6f 2f 32 30 30 37 30 37 32 33 30 30 20 49 63 65 77 65 61 73 65 6c 2f 32 2e 30 2e 30 2e 36 20 28 44 65 62 69 61 6e 2d 32 2e 30 2e 30 2e 36 2d 30 65 74 63 68 31 2b 6c 65 6e 6e 79 31 29 } //1 Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-US; rv:1.8.1.6) Gecko/2007072300 Iceweasel/2.0.0.6 (Debian-2.0.0.6-0etch1+lenny1)
		$a_00_9 = {4d 6f 7a 69 6c 6c 61 2f 34 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d 53 49 45 20 37 2e 30 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 36 2e 30 29 } //1 Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)
		$a_00_10 = {4d 6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4b 6f 6e 71 75 65 72 6f 72 2f 33 2e 35 3b 20 4c 69 6e 75 78 20 32 2e 36 2e 31 35 2d 31 2e 32 30 35 34 5f 46 43 35 3b 20 58 31 31 3b 20 69 36 38 36 3b 20 65 6e 5f 55 53 29 20 4b 48 54 4d 4c 2f 33 2e 35 2e 34 20 28 6c 69 6b 65 20 47 65 63 6b 6f 29 } //1 Mozilla/5.0 (compatible; Konqueror/3.5; Linux 2.6.15-1.2054_FC5; X11; i686; en_US) KHTML/3.5.4 (like Gecko)
		$a_00_11 = {4d 6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 57 69 6e 64 6f 77 73 3b 20 55 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 35 2e 31 3b 20 72 75 3b 20 72 76 3a 31 2e 38 2e 31 2e 31 39 29 20 47 65 63 6b 6f 2f 32 30 30 38 31 32 30 31 20 46 69 72 65 66 6f 78 2f 32 2e 30 2e 30 2e 31 39 20 } //1 Mozilla/5.0 (Windows; U; Windows NT 5.1; ru; rv:1.8.1.19) Gecko/20081201 Firefox/2.0.0.19 
		$a_00_12 = {4d 6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 58 31 31 3b 20 55 3b 20 4c 69 6e 75 78 20 69 36 38 36 3b 20 65 6e 2d 55 53 3b 20 72 76 3a 31 2e 38 2e 30 2e 32 29 20 47 65 63 6b 6f 2f 32 30 30 36 30 33 30 38 20 46 69 72 65 66 6f 78 2f 31 2e 35 2e 30 2e 32 } //1 Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.2) Gecko/20060308 Firefox/1.5.0.2
		$a_00_13 = {4d 6f 7a 69 6c 6c 61 2f 34 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d 53 49 45 20 38 2e 30 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 36 2e 30 3b 20 57 4f 57 36 34 3b 20 54 72 69 64 65 6e 74 2f 34 2e 30 3b 20 53 4c 43 43 31 3b 20 2e 4e 45 54 20 43 4c 52 20 32 2e 30 2e 35 30 37 32 37 3b 20 2e 4e 45 54 20 43 4c 52 20 33 2e 35 2e 32 31 30 32 32 3b 20 2e 4e 45 54 20 43 4c 52 20 33 2e 35 2e 33 30 37 32 39 3b 20 2e 4e 45 54 20 43 4c 52 20 33 2e 30 2e 33 30 36 31 38 29 } //1 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; WOW64; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 3.5.21022; .NET CLR 3.5.30729; .NET CLR 3.0.30618)
		$a_00_14 = {5c 74 6d 70 2e 65 78 65 } //1 \tmp.exe
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_02_3  & 1)*10+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1) >=43
 
}

rule TrojanDownloader_Win32_PsDow_A_MTB{
	meta:
		description = "TrojanDownloader:Win32/PsDow.A!MTB,SIGNATURE_TYPE_PEHSTR_EXT,18 00 18 00 0c 00 00 "
		
	strings :
		$a_01_0 = {67 42 54 41 48 51 41 59 51 42 79 41 48 51 41 4c 51 42 54 41 47 77 41 5a 51 42 6c 41 48 41 41 49 41 41 74 41 46 4d 41 5a 51 42 6a 41 47 38 41 62 67 42 6b 41 48 4d 41 49 41 41 32 41 44 41 41 } //2 gBTAHQAYQByAHQALQBTAGwAZQBlAHAAIAAtAFMAZQBjAG8AbgBkAHMAIAA2ADAA
		$a_01_1 = {41 43 41 41 51 51 42 6b 41 47 51 41 4c 51 42 4e 41 48 41 41 55 41 42 79 41 47 55 41 5a 67 42 6c 41 48 49 41 5a 51 42 75 41 47 4d 41 5a 51 41 } //2 ACAAQQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQA
		$a_01_2 = {41 74 41 45 55 41 65 41 42 6a 41 47 77 41 64 51 42 7a 41 47 6b 41 62 77 42 75 41 46 41 41 59 51 42 30 41 47 67 41 49 41 42 41 41 43 67 41 4a 41 42 6c 41 47 34 41 64 67 41 36 41 46 55 41 63 77 42 6c 41 48 49 41 55 41 42 79 41 47 38 41 } //2 AtAEUAeABjAGwAdQBzAGkAbwBuAFAAYQB0AGgAIABAACgAJABlAG4AdgA6AFUAcwBlAHIAUAByAG8A
		$a_01_3 = {5a 67 42 70 41 47 77 41 5a 51 41 73 41 43 51 41 5a 51 42 75 41 48 59 41 4f 67 42 54 41 48 6b 41 63 77 42 30 41 47 55 41 62 51 42 45 41 48 49 41 61 51 42 32 41 47 55 41 4b 51 } //2 ZgBpAGwAZQAsACQAZQBuAHYAOgBTAHkAcwB0AGUAbQBEAHIAaQB2AGUAKQ
		$a_01_4 = {41 41 74 41 45 59 41 62 77 42 79 41 47 4d 41 5a 51 41 } //2 AAtAEYAbwByAGMAZQA
		$a_01_5 = {41 6f 41 45 34 41 5a 51 42 33 41 43 30 41 54 77 42 69 41 47 6f 41 5a 51 42 6a 41 48 51 41 49 41 42 54 41 48 6b 41 63 77 42 30 41 47 55 41 62 51 41 75 41 45 34 41 5a 51 42 30 41 43 34 } //2 AoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAE4AZQB0AC4
		$a_01_6 = {41 56 77 42 6c 41 47 49 41 51 77 42 73 41 47 6b 41 5a 51 42 75 41 48 51 41 4b 51 41 75 41 45 51 41 62 77 42 33 41 47 34 41 62 41 42 76 41 47 45 41 5a 41 42 47 41 47 6b 41 62 41 42 6c 41 43 } //2 AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAEQAbwB3AG4AbABvAGEAZABGAGkAbABlAC
		$a_01_7 = {41 4c 51 42 44 41 47 67 41 61 51 42 73 41 47 51 41 55 41 42 68 41 48 51 41 61 41 41 } //2 ALQBDAGgAaQBsAGQAUABhAHQAaAA
		$a_01_8 = {41 41 6f 41 45 6f 41 62 77 42 70 41 47 34 41 4c 51 42 51 41 47 45 41 64 41 42 6f 41 43 41 41 4c 51 42 51 41 47 45 41 64 41 42 6f 41 43 41 41 4a 41 42 6c 41 47 34 41 64 67 41 36 41 46 51 41 5a 51 42 74 41 48 41 41 49 } //2 AAoAEoAbwBpAG4ALQBQAGEAdABoACAALQBQAGEAdABoACAAJABlAG4AdgA6AFQAZQBtAHAAI
		$a_01_9 = {41 46 4d 41 64 41 42 68 41 48 49 41 64 41 41 74 41 46 41 41 63 67 42 76 41 47 4d 41 5a 51 42 7a 41 48 4d 41 49 41 41 74 41 45 59 41 61 51 42 73 41 47 55 41 55 41 42 68 41 48 51 41 61 41 41 } //2 AFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIAAtAEYAaQBsAGUAUABhAHQAaAA
		$a_01_10 = {70 6f 77 65 72 73 68 65 6c 6c } //2 powershell
		$a_01_11 = {2d 45 6e 63 6f 64 65 64 43 6f 6d 6d 61 6e 64 } //2 -EncodedCommand
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_01_6  & 1)*2+(#a_01_7  & 1)*2+(#a_01_8  & 1)*2+(#a_01_9  & 1)*2+(#a_01_10  & 1)*2+(#a_01_11  & 1)*2) >=24
 
}
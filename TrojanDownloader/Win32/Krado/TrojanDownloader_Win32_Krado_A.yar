
rule TrojanDownloader_Win32_Krado_A{
	meta:
		description = "TrojanDownloader:Win32/Krado.A,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 08 00 00 "
		
	strings :
		$a_03_0 = {50 ff 75 0c 8b 45 08 8d 88 00 20 00 00 51 (53|ff 75 ?? [0-03] ff 50 4)c } //1
		$a_03_1 = {50 ff 75 0c 8d (81|83) 00 20 00 00 50 90 03 05 01 ff 75 ?? 57 ff (|) 51 53 4c } //1
		$a_03_2 = {8b 5d 08 8d 83 00 20 00 00 50 ff 75 ?? ff 53 4c } //1
		$a_03_3 = {68 00 00 08 00 8d 90 04 01 05 81 83 86 87 88 00 20 00 00 (50|51) ff 75 ?? ff 90 04 01 05 50 51 53 56 57 60 } //1
		$a_03_4 = {68 00 00 08 00 8d 90 04 01 05 81 83 86 87 88 00 20 00 00 (50|51) [0-04] ff 75 ?? [0-0a] ff 90 04 01 05 50 51 53 56 57 60 85 c0 74 ?? 8b 45 ?? 89 45 } //1
		$a_03_5 = {68 00 00 08 00 05 00 20 00 00 (50|51) ff 75 ?? [0-0c] ff 90 04 01 05 50 51 53 56 57 60 85 c0 74 ?? 8b 45 ?? 89 45 } //1
		$a_03_6 = {fa 65 00 78 00 90 09 03 00 c7 44 90 04 01 05 41 42 43 46 47 } //10
		$a_03_7 = {fe 65 00 00 00 90 09 03 00 c7 44 90 04 01 04 41 43 46 47 } //10
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*10+(#a_03_7  & 1)*10) >=20
 
}
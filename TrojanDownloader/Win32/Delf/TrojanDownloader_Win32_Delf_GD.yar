
rule TrojanDownloader_Win32_Delf_GD{
	meta:
		description = "TrojanDownloader:Win32/Delf.GD,SIGNATURE_TYPE_PEHSTR_EXT,1a 00 1a 00 1a 00 00 "
		
	strings :
		$a_02_0 = {68 74 74 70 3a 2f 2f [0-20] 2f [0-04] 2e 65 78 65 } //1
		$a_00_1 = {5c 73 76 63 68 31 73 74 2e 65 78 65 } //1 \svch1st.exe
		$a_00_2 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 65 78 70 6c 6f 72 65 72 5c 61 64 76 61 6e 63 65 64 5c 66 6f 6c 64 65 72 5c 68 69 64 64 65 6e 5c 73 68 6f 77 61 6c 6c } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\advanced\folder\hidden\showall
		$a_00_3 = {5c 73 6e 6f 77 2e 65 78 65 } //1 \snow.exe
		$a_00_4 = {63 6d 64 2e 65 78 65 20 2f 63 20 64 61 74 65 20 32 30 30 32 2d 30 38 2d 32 38 } //1 cmd.exe /c date 2002-08-28
		$a_00_5 = {5c 77 69 6e 73 73 2e 73 79 73 } //1 \winss.sys
		$a_00_6 = {72 61 76 6d 6f 6e 2e 65 78 65 } //1 ravmon.exe
		$a_00_7 = {72 61 76 6d 6f 6e 64 2e 65 78 65 } //1 ravmond.exe
		$a_00_8 = {61 76 70 2e 65 78 65 } //1 avp.exe
		$a_00_9 = {61 76 70 2e 63 6f 6d } //1 avp.com
		$a_00_10 = {63 63 65 6e 74 65 72 2e 65 78 65 } //1 ccenter.exe
		$a_00_11 = {33 36 30 53 61 66 65 2e 65 78 65 } //1 360Safe.exe
		$a_00_12 = {33 36 30 74 72 61 79 2e 65 78 65 } //1 360tray.exe
		$a_00_13 = {56 73 54 73 6b 4d 67 72 2e 65 78 65 } //1 VsTskMgr.exe
		$a_00_14 = {41 53 54 2e 45 58 45 } //1 AST.EXE
		$a_00_15 = {6b 76 73 72 76 78 70 2e 65 78 65 } //1 kvsrvxp.exe
		$a_00_16 = {73 63 61 6e 33 32 2e 65 78 65 } //1 scan32.exe
		$a_00_17 = {41 76 4d 6f 6e 69 74 6f 72 2e 65 78 65 } //1 AvMonitor.exe
		$a_00_18 = {41 4e 54 49 41 52 50 2e 65 78 65 } //1 ANTIARP.exe
		$a_00_19 = {79 61 68 6f 6f 6d 65 73 73 65 6e 67 65 72 } //1 yahoomessenger
		$a_00_20 = {74 72 69 6c 6c 69 61 6e 2e 65 78 65 } //1 trillian.exe
		$a_00_21 = {73 6b 79 70 65 2e } //1 skype.
		$a_00_22 = {67 6f 6f 67 6c 65 74 61 6c 6b 2e } //1 googletalk.
		$a_00_23 = {55 00 52 00 4c 00 4c 00 57 00 49 00 4e 00 53 00 53 00 } //1 URLLWINSS
		$a_02_24 = {6a 00 6a 00 68 ?? ?? 40 00 a1 ?? ?? 40 00 50 6a 00 e8 ?? ?? ff ff 6a 00 68 ?? ?? 40 00 e8 ?? ?? ff ff 6a 00 6a 00 68 ?? ?? 40 00 a1 ?? ?? 40 00 50 6a 00 e8 ?? ?? ff ff 6a 00 68 ?? ?? 40 00 e8 ?? ?? ff ff 6a 00 6a 00 68 ?? ?? 40 00 a1 ?? ?? 40 00 50 6a 00 e8 ?? ?? ff ff 6a 00 68 ?? ?? 40 00 e8 ?? ?? ff ff 6a 00 } //1
		$a_00_25 = {53 4f 46 54 57 41 52 45 5c 42 6f 72 6c 61 6e 64 5c 44 65 6c 70 68 69 5c 52 54 4c } //1 SOFTWARE\Borland\Delphi\RTL
	condition:
		((#a_02_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1+(#a_00_16  & 1)*1+(#a_00_17  & 1)*1+(#a_00_18  & 1)*1+(#a_00_19  & 1)*1+(#a_00_20  & 1)*1+(#a_00_21  & 1)*1+(#a_00_22  & 1)*1+(#a_00_23  & 1)*1+(#a_02_24  & 1)*1+(#a_00_25  & 1)*1) >=26
 
}
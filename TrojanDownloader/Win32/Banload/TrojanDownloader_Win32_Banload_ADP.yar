
rule TrojanDownloader_Win32_Banload_ADP{
	meta:
		description = "TrojanDownloader:Win32/Banload.ADP,SIGNATURE_TYPE_PEHSTR_EXT,05 00 04 00 05 00 00 "
		
	strings :
		$a_01_0 = {8b 4d c8 0f bf d0 51 52 ff 15 a4 10 40 00 8b 35 e8 10 40 00 8b d0 8d 4d c0 ff d6 50 ff 15 2c 10 40 00 } //2
		$a_01_1 = {78 41 44 00 e2 00 e8 00 d5 00 7f 00 9d 00 a3 00 c9 00 b1 00 53 01 d8 00 d7 00 b4 00 de 00 d6 00 d4 00 } //2
		$a_01_2 = {42 00 75 00 67 00 2e 00 65 00 78 00 65 00 } //1 Bug.exe
		$a_01_3 = {6a 00 73 00 63 00 72 00 69 00 70 00 74 00 2e 00 65 00 78 00 65 00 } //1 jscript.exe
		$a_01_4 = {5c 00 44 00 65 00 73 00 6b 00 74 00 6f 00 70 00 5c 00 4c 00 6f 00 61 00 64 00 65 00 72 00 } //1 \Desktop\Loader
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=4
 
}
rule TrojanDownloader_Win32_Banload_ADP_2{
	meta:
		description = "TrojanDownloader:Win32/Banload.ADP,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0a 00 0a 00 00 "
		
	strings :
		$a_01_0 = {37 37 34 33 38 30 30 31 39 39 31 36 34 44 42 34 41 33 41 35 46 38 39 32 31 38 34 46 34 38 43 43 34 36 44 43 46 46 } //4 7743800199164DB4A3A5F892184F48CC46DCFF
		$a_01_1 = {37 32 38 32 35 38 38 33 32 34 37 30 34 39 31 34 31 37 46 36 33 46 36 32 34 31 39 32 43 33 36 30 41 39 34 43 42 42 37 46 31 37 46 32 33 31 45 45 } //4 728258832470491417F63F624192C360A94CBB7F17F231EE
		$a_01_2 = {33 35 39 38 39 31 38 35 32 31 30 31 37 44 42 39 37 45 42 32 44 43 32 32 38 30 33 33 42 45 36 41 43 39 } //2 3598918521017DB97EB2DC228033BE6AC9
		$a_01_3 = {32 32 35 37 32 35 31 35 32 37 37 34 37 44 30 36 37 30 39 39 34 33 31 46 37 30 46 39 33 38 32 45 } //2 2257251527747D067099431F70F9382E
		$a_01_4 = {38 32 36 32 38 35 32 30 36 37 36 34 34 42 39 31 32 34 45 36 39 43 45 35 31 33 36 37 } //2 8262852067644B9124E69CE51367
		$a_01_5 = {37 31 35 35 33 37 34 32 35 36 35 37 37 46 38 43 36 45 32 32 37 30 31 45 32 38 } //2 7155374256577F8C6E22701E28
		$a_01_6 = {34 32 35 34 39 38 34 30 36 34 32 37 37 38 41 32 36 42 34 34 31 38 36 46 46 42 37 32 32 46 36 33 32 32 35 46 30 32 39 39 34 45 39 } //2 42549840642778A26B44186FFB722F63225F02994E9
		$a_01_7 = {38 33 37 38 33 33 30 39 38 38 39 35 35 37 45 32 31 33 42 30 42 41 42 41 46 34 38 46 46 46 31 43 39 43 46 37 46 32 32 31 36 36 } //2 83783309889557E213B0BABAF48FFF1C9CF7F22166
		$a_01_8 = {31 36 38 37 37 32 37 33 39 31 38 38 34 31 46 37 34 36 34 37 44 44 41 33 36 37 41 32 32 35 31 36 43 41 31 42 32 43 30 33 32 42 43 46 41 33 37 37 43 32 } //1 16877273918841F74647DDA367A22516CA1B2C032BCFA377C2
		$a_01_9 = {31 36 39 36 33 36 31 32 39 31 39 38 34 31 35 37 37 36 32 31 37 32 38 45 43 36 33 42 45 35 35 37 37 32 33 46 32 31 } //1 16963612919841577621728EC63BE557723F21
	condition:
		((#a_01_0  & 1)*4+(#a_01_1  & 1)*4+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_01_6  & 1)*2+(#a_01_7  & 1)*2+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1) >=10
 
}

rule TrojanDownloader_Win32_Hancitor_A_{
	meta:
		description = "TrojanDownloader:Win32/Hancitor.A!!Hancitor.gen!A,SIGNATURE_TYPE_ARHSTR_EXT,06 00 06 00 12 00 00 "
		
	strings :
		$a_80_0 = {47 55 49 44 3d 25 49 36 34 75 26 42 55 49 4c 44 3d 25 73 26 49 4e 46 4f 3d 25 73 } //GUID=%I64u&BUILD=%s&INFO=%s  2
		$a_80_1 = {26 49 50 3d 25 73 26 54 59 50 45 3d 31 26 57 49 4e 3d 25 64 2e 25 64 28 } //&IP=%s&TYPE=1&WIN=%d.%d(  2
		$a_80_2 = {7a 7a 7a 7a 7a 65 78 70 6c 6f 72 65 72 2e } //zzzzzexplorer.  1
		$a_80_3 = {28 57 69 6e 64 6f 77 73 20 4e 54 20 36 2e 31 3b 20 57 69 6e 36 34 3b 20 78 36 34 3b 20 54 72 69 64 65 6e 74 2f 37 2e 30 3b 20 72 76 3a 31 31 2e 30 29 } //(Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0)  1
		$a_80_4 = {61 70 69 2e 69 70 69 66 79 2e 6f 72 67 } //api.ipify.org  1
		$a_01_5 = {f6 45 f8 44 74 1d 8b 4f 10 33 c0 85 c9 74 09 80 34 30 } //1
		$a_03_6 = {72 da 5f 3b c8 73 0b 8b ff 80 34 31 ?? 41 3b c8 72 f7 } //1
		$a_01_7 = {8b 5d 14 8a 0e 8d 95 00 fe ff ff 8b c6 80 f9 } //1
		$a_03_8 = {72 26 80 3f ?? 75 21 80 7f 01 ?? 75 1b 80 7f 02 ?? 75 15 80 7f 03 ?? 75 0f } //1
		$a_03_9 = {8b 4d 08 80 79 01 ?? 75 ?? 0f be 01 83 c0 ?? 83 f8 ?? 77 } //1
		$a_01_10 = {8d 45 f8 50 68 11 00 28 00 ff 75 fc 68 01 68 00 00 } //1
		$a_01_11 = {8a 08 8b 55 08 80 f9 7c 74 14 84 c9 74 10 40 88 0a } //1
		$a_01_12 = {8b 45 08 80 78 01 3a 75 25 8a 00 3c 72 74 18 } //1
		$a_03_13 = {83 f8 04 ba 00 31 88 84 8d 85 ?? ?? ff ff be 00 01 08 84 50 51 0f 44 f2 } //1
		$a_03_14 = {68 60 ea 00 00 ff d6 e9 ?? ?? ff ff cc 55 8b ec 8b 45 08 80 38 4d } //1
		$a_03_15 = {85 c0 74 14 8d 4d ?? 51 ff d0 33 c0 66 83 7d ?? 09 } //1
		$a_01_16 = {8b 4d 08 6a 00 6a 01 51 8b 41 3c 8b 44 08 28 03 c1 ff d0 } //1
		$a_01_17 = {30 04 31 41 3b ca 72 f0 8d 45 fc 50 8d 42 f8 50 8d 46 08 50 53 57 6a 02 ff 15 } //1
	condition:
		((#a_80_0  & 1)*2+(#a_80_1  & 1)*2+(#a_80_2  & 1)*1+(#a_80_3  & 1)*1+(#a_80_4  & 1)*1+(#a_01_5  & 1)*1+(#a_03_6  & 1)*1+(#a_01_7  & 1)*1+(#a_03_8  & 1)*1+(#a_03_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_03_13  & 1)*1+(#a_03_14  & 1)*1+(#a_03_15  & 1)*1+(#a_01_16  & 1)*1+(#a_01_17  & 1)*1) >=6
 
}
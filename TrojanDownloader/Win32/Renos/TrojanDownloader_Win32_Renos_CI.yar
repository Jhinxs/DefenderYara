
rule TrojanDownloader_Win32_Renos_CI{
	meta:
		description = "TrojanDownloader:Win32/Renos.CI,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1e 00 0e 00 00 "
		
	strings :
		$a_00_0 = {43 3a 5c 50 72 6f 67 72 61 6d 20 46 69 6c 65 73 5c 4f 6e 6c 69 6e 65 47 75 61 72 64 5c 4f 6e 6c 69 6e 65 47 75 61 72 64 2e 65 78 65 } //10 C:\Program Files\OnlineGuard\OnlineGuard.exe
		$a_00_1 = {48 6f 73 74 3a 20 64 6f 77 6e 6c 6f 61 64 2e 4f 6e 6c 69 6e 65 2d 47 75 61 72 64 2e 6e 65 74 } //10 Host: download.Online-Guard.net
		$a_02_2 = {47 45 54 20 2f 6d 68 61 62 68 66 64 62 2e 70 68 70 3f 26 61 64 76 69 64 3d 30 30 30 30 ?? ?? ?? ?? 26 75 3d 30 26 70 3d 31 32 33 37 30 32 30 26 6c 61 6e 67 3d 5f 5f 5f 5f 5f 5f 5f 5f 26 76 73 3d 30 26 59 5a 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 59 20 48 54 54 50 2f 31 2e 30 } //1
		$a_02_3 = {47 45 54 20 2f 6d 68 61 62 68 66 64 62 2e 70 68 70 3f 26 61 64 76 69 64 3d 30 30 30 30 ?? ?? ?? ?? 26 75 3d 25 75 26 70 3d 25 75 26 6c 61 6e 67 3d 5f 5f 5f 5f 5f 5f 5f 5f 26 76 73 3d 25 75 26 25 73 20 48 54 54 50 2f 31 2e 30 } //1
		$a_02_4 = {47 45 54 20 68 74 74 70 3a 2f 2f 25 73 2f 70 6f 69 65 68 72 67 62 2e 70 68 70 3f 26 61 64 76 69 64 3d 30 30 30 30 ?? ?? ?? ?? 26 75 3d 25 75 26 70 3d 25 75 26 6c 61 6e 67 3d 5f 5f 5f 5f 5f 5f 5f 5f 26 76 73 3d 25 75 26 25 73 20 48 54 54 50 2f 31 2e 30 } //1
		$a_00_5 = {57 69 6e 64 6f 77 73 20 75 70 64 61 74 65 20 6c 6f 61 64 65 72 } //1 Windows update loader
		$a_00_6 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 52 75 6e } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\Run
		$a_00_7 = {4e 6f 48 54 4d 4c 57 61 6c 6c 50 61 70 65 72 } //1 NoHTMLWallPaper
		$a_00_8 = {4e 6f 43 68 61 6e 67 69 6e 67 57 61 6c 6c 70 61 70 65 72 } //1 NoChangingWallpaper
		$a_00_9 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 41 63 74 69 76 65 44 65 73 6b 74 6f 70 } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\ActiveDesktop
		$a_00_10 = {4e 6f 44 65 73 6b 74 6f 70 } //1 NoDesktop
		$a_00_11 = {43 6c 61 73 73 69 63 53 68 65 6c 6c } //1 ClassicShell
		$a_00_12 = {4e 6f 41 63 74 69 76 65 44 65 73 6b 74 6f 70 } //1 NoActiveDesktop
		$a_00_13 = {46 6f 72 63 65 41 63 74 69 76 65 44 65 73 6b 74 6f 70 4f 6e } //1 ForceActiveDesktopOn
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_02_2  & 1)*1+(#a_02_3  & 1)*1+(#a_02_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1) >=30
 
}
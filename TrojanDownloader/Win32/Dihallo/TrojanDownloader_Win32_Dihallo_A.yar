
rule TrojanDownloader_Win32_Dihallo_A{
	meta:
		description = "TrojanDownloader:Win32/Dihallo.A,SIGNATURE_TYPE_PEHSTR_EXT,2a 00 28 00 09 00 00 "
		
	strings :
		$a_00_0 = {49 6e 74 65 72 6e 65 74 43 6f 6e 6e 65 63 74 41 } //10 InternetConnectA
		$a_00_1 = {52 61 73 45 6e 75 6d 44 65 76 69 63 65 73 41 } //10 RasEnumDevicesA
		$a_00_2 = {45 32 33 33 31 39 45 34 2d 33 31 45 41 2d 34 32 32 31 2d 38 44 44 44 2d 39 39 30 45 32 37 43 42 37 35 35 46 } //7 E23319E4-31EA-4221-8DDD-990E27CB755F
		$a_00_3 = {26 6c 69 64 3d 30 78 25 78 26 73 6c 69 64 3d 30 78 25 78 26 76 6d 3d 25 64 26 64 3d 25 23 30 34 64 25 23 30 32 64 25 23 30 32 64 26 74 3d 25 23 30 32 64 25 23 30 32 64 25 23 30 32 64 26 62 3d 25 64 26 64 64 31 3d 25 73 } //5 &lid=0x%x&slid=0x%x&vm=%d&d=%#04d%#02d%#02d&t=%#02d%#02d%#02d&b=%d&dd1=%s
		$a_00_4 = {6a 65 78 65 31 } //5 jexe1
		$a_00_5 = {6d 6f 64 65 6d } //1 modem
		$a_00_6 = {69 73 64 6e } //1 isdn
		$a_01_7 = {43 3a 5c 54 45 4d 50 5c 64 2e 62 61 74 } //3 C:\TEMP\d.bat
		$a_01_8 = {26 6c 73 63 61 6c 3d 25 23 30 34 64 25 23 30 32 64 25 23 30 32 64 25 23 30 32 64 25 23 30 32 64 25 23 30 32 64 } //5 &lscal=%#04d%#02d%#02d%#02d%#02d%#02d
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*7+(#a_00_3  & 1)*5+(#a_00_4  & 1)*5+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_01_7  & 1)*3+(#a_01_8  & 1)*5) >=40
 
}
rule TrojanDownloader_Win32_Dihallo_A_2{
	meta:
		description = "TrojanDownloader:Win32/Dihallo.A,SIGNATURE_TYPE_PEHSTR,3e 00 3c 00 08 00 00 "
		
	strings :
		$a_01_0 = {45 32 33 33 31 39 45 34 2d 33 31 45 41 2d 34 32 32 31 2d 38 44 44 44 2d 39 39 30 45 32 37 43 42 37 35 35 46 } //20 E23319E4-31EA-4221-8DDD-990E27CB755F
		$a_01_1 = {68 61 6c 6c 6f } //20 hallo
		$a_01_2 = {49 6e 74 65 72 6e 65 74 43 6f 6e 6e 65 63 74 41 } //5 InternetConnectA
		$a_01_3 = {52 61 73 45 6e 75 6d 44 65 76 69 63 65 73 41 } //5 RasEnumDevicesA
		$a_01_4 = {26 6c 69 64 3d 30 78 25 78 26 73 6c 69 64 3d 30 78 25 78 26 76 6d 3d 25 64 26 64 3d 25 23 30 34 64 25 23 30 32 64 25 23 30 32 64 26 74 3d 25 23 30 32 64 25 23 30 32 64 25 23 30 32 64 26 62 3d 25 64 26 64 64 31 3d 25 73 } //5 &lid=0x%x&slid=0x%x&vm=%d&d=%#04d%#02d%#02d&t=%#02d%#02d%#02d&b=%d&dd1=%s
		$a_01_5 = {6a 65 78 65 31 } //5 jexe1
		$a_01_6 = {6d 6f 64 65 6d } //1 modem
		$a_01_7 = {69 73 64 6e } //1 isdn
	condition:
		((#a_01_0  & 1)*20+(#a_01_1  & 1)*20+(#a_01_2  & 1)*5+(#a_01_3  & 1)*5+(#a_01_4  & 1)*5+(#a_01_5  & 1)*5+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=60
 
}
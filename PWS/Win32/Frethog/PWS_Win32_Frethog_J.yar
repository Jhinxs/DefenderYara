
rule PWS_Win32_Frethog_J{
	meta:
		description = "PWS:Win32/Frethog.J,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 09 00 00 "
		
	strings :
		$a_02_0 = {81 ec 1c 01 00 00 53 56 57 33 db 89 5d e4 53 53 53 53 68 00 10 00 10 ff 15 ?? ?? 00 10 8b f8 89 7d e0 89 5d fc 3b fb 74 52 53 68 00 00 00 80 53 53 8b 45 08 50 57 ff 15 ?? ?? 00 10 8b f0 89 75 dc c7 45 fc 01 00 00 00 3b f3 74 27 8d 8d d4 fe ff ff 51 68 04 01 00 00 8d 95 d8 fe ff ff 52 56 ff 15 ?? ?? 00 10 85 c0 74 09 8d 85 d8 fe ff ff 89 45 e4 89 5d fc e8 14 00 00 00 c7 45 fc ff ff ff ff e8 13 00 00 00 eb 19 8b 7d e0 8b 75 dc } //1
		$a_02_1 = {57 68 00 04 00 00 6a 40 ff 15 ?? ?? 00 10 89 45 e4 33 db 53 53 53 53 68 00 10 00 10 ff 15 ?? ?? 00 10 8b f8 89 7d dc 89 5d fc 3b fb 74 3f 53 68 00 00 00 80 53 53 8b 45 08 50 57 ff 15 ?? ?? 00 10 8b f0 89 75 e0 c7 45 fc 01 00 00 00 3b f3 74 14 8d 4d d8 51 68 00 04 00 00 8b 55 e4 52 56 ff 15 ?? ?? 00 10 89 5d fc e8 14 00 00 00 c7 45 fc ff ff ff ff e8 13 00 00 00 eb 19 8b 7d dc 8b 75 e0 56 } //1
		$a_02_2 = {64 89 25 00 00 00 00 81 ec 1c 01 00 00 53 56 57 33 ff 89 7d e4 57 57 57 57 68 00 ?? 00 10 ff 15 ?? ?? 00 10 89 45 e0 89 7d fc 3b c7 0f 84 88 00 00 00 57 68 00 00 00 80 57 57 8b 4d 08 51 50 ff 15 ?? ?? 00 10 8b f0 89 75 dc c7 45 fc 01 00 00 00 3b f7 74 5d 8d 95 d4 fe ff ff 52 68 04 01 00 00 8d 85 d8 fe ff ff 50 56 ff 15 ?? ?? 00 10 85 c0 74 3f } //1
		$a_01_3 = {53 65 44 65 62 75 67 50 72 69 76 69 6c 65 67 65 } //1 SeDebugPrivilege
		$a_00_4 = {45 78 70 6c 6f 72 65 72 2e 65 78 65 } //1 Explorer.exe
		$a_01_5 = {6c 69 6e 2e 61 73 70 00 } //1
		$a_01_6 = {49 6e 74 65 72 6e 65 74 4f 70 65 6e 41 } //1 InternetOpenA
		$a_01_7 = {49 6e 74 65 72 6e 65 74 4f 70 65 6e 55 72 6c 41 } //1 InternetOpenUrlA
		$a_01_8 = {49 6e 74 65 72 6e 65 74 52 65 61 64 46 69 6c 65 } //1 InternetReadFile
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1+(#a_01_3  & 1)*1+(#a_00_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1) >=7
 
}

rule PWS_Win32_Lineage_gen_I{
	meta:
		description = "PWS:Win32/Lineage.gen!I,SIGNATURE_TYPE_PEHSTR_EXT,64 00 50 00 04 00 00 "
		
	strings :
		$a_02_0 = {68 0d 19 00 00 6a 00 6a 04 6a 00 6a ff e8 [0-04] 8b 15 [0-04] 89 02 6a 00 6a 00 6a 00 68 1f 00 0f 00 a1 [0-04] 8b 00 50 e8 [0-04] 8b 15 [0-04] 89 02 a1 [0-04] 8b 00 8b 40 04 } //30
		$a_02_1 = {85 c0 74 39 8d 45 f8 50 68 80 00 00 00 6a 04 53 e8 [0-08] 50 6a 04 8d 45 14 50 53 e8 [0-04] 50 e8 [0-08] 8d 45 f4 50 8b 45 f8 50 6a 04 53 e8 } //30
		$a_00_2 = {8b da 3b 3b 0f 94 c0 f6 d8 1b c0 83 f8 01 1b c9 41 84 c9 75 24 8b 0b 3b 0d b4 13 41 00 76 1a 8b 0b 8a 09 3a 0d ac 13 41 00 75 0e 8b 03 40 8b d8 3b 3b 0f 94 c0 f6 d8 1b c0 } //30
		$a_02_3 = {46 69 6e 64 4e 65 78 74 46 69 6c 65 41 [0-04] 6b 65 72 6e 65 6c 33 32 2e 64 6c 6c [0-04] 46 69 6e 64 4e 65 78 74 46 69 6c 65 57 [0-04] 4e 74 51 75 65 72 79 53 79 73 74 65 6d 49 6e 66 6f 72 6d 61 74 69 6f 6e [0-04] 6e 74 64 6c 6c 2e 64 6c 6c } //20
	condition:
		((#a_02_0  & 1)*30+(#a_02_1  & 1)*30+(#a_00_2  & 1)*30+(#a_02_3  & 1)*20) >=80
 
}
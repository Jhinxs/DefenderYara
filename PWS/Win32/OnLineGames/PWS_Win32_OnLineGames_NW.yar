
rule PWS_Win32_OnLineGames_NW{
	meta:
		description = "PWS:Win32/OnLineGames.NW,SIGNATURE_TYPE_PEHSTR_EXT,04 01 ffffff96 00 0d 00 00 "
		
	strings :
		$a_01_0 = {65 68 73 6e 69 66 66 65 72 2e 65 78 65 } //10 ehsniffer.exe
		$a_01_1 = {65 74 68 65 72 65 61 6c 2e 65 78 65 } //10 ethereal.exe
		$a_01_2 = {3a 44 3a 5c 42 61 63 6b 75 70 5c } //10 :D:\Backup\
		$a_01_3 = {65 78 70 6c 6f 72 65 72 2e 65 78 65 } //10 explorer.exe
		$a_01_4 = {7b 33 43 33 37 34 41 34 31 2d 42 41 45 34 2d 31 31 63 66 2d 62 66 37 64 2d 30 30 61 61 30 30 36 39 34 36 65 65 7d } //10 {3C374A41-BAE4-11cf-bf7d-00aa006946ee}
		$a_01_5 = {74 75 69 67 75 61 6e 67 69 64 } //10 tuiguangid
		$a_01_6 = {50 6f 77 65 72 52 65 6d 69 6e 64 2e 65 78 65 } //10 PowerRemind.exe
		$a_01_7 = {74 61 73 6b 6d 67 72 2e 65 78 65 } //10 taskmgr.exe
		$a_01_8 = {2e 65 78 65 3b } //5 .exe;
		$a_01_9 = {41 63 63 65 70 74 2d 4c 61 6e 67 75 61 67 65 3a 20 7a 68 2d 63 6e } //5 Accept-Language: zh-cn
		$a_01_10 = {50 72 6f 63 65 73 73 33 32 4e 65 78 74 } //5 Process32Next
		$a_03_11 = {3f 73 7a 63 6c 69 65 6e 74 69 64 3d 25 73 [0-15] 26 73 7a 6d 61 63 3d 25 73 [0-15] 26 73 7a 75 73 65 72 6e 61 6d 65 3d 25 73 } //100
		$a_03_12 = {26 73 7a 76 65 72 3d 25 73 [0-15] 26 6d 6f 64 65 3d 25 64 [0-15] 26 76 61 6c 75 65 3d 25 64 [0-15] 26 73 79 73 74 79 70 65 3d 25 64 [0-15] 26 73 7a 6e 61 6d 65 3d 25 73 [0-15] 26 73 7a 70 61 6e 61 6d 65 3d 25 73 [0-15] 26 70 61 6c 65 6e 3d 25 64 } //100
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*10+(#a_01_6  & 1)*10+(#a_01_7  & 1)*10+(#a_01_8  & 1)*5+(#a_01_9  & 1)*5+(#a_01_10  & 1)*5+(#a_03_11  & 1)*100+(#a_03_12  & 1)*100) >=150
 
}
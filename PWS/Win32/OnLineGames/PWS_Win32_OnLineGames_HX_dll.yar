
rule PWS_Win32_OnLineGames_HX_dll{
	meta:
		description = "PWS:Win32/OnLineGames.HX!dll,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 06 00 00 "
		
	strings :
		$a_01_0 = {28 00 2a 00 5e 00 5f 00 5f 00 5e 00 2a 00 29 00 } //1 (*^__^*)
		$a_01_1 = {3f 00 64 00 38 00 30 00 3d 00 32 00 26 00 64 00 31 00 30 00 3d 00 } //1 ?d80=2&d10=
		$a_01_2 = {26 00 68 00 3d 00 25 00 64 00 26 00 6d 00 3d 00 25 00 64 00 } //1 &h=%d&m=%d
		$a_01_3 = {3f 00 61 00 3d 00 25 00 73 00 26 00 62 00 3d 00 25 00 73 00 26 00 63 00 3d 00 25 00 73 00 26 00 65 00 3d 00 25 00 73 00 26 00 64 00 3d 00 25 00 64 00 26 00 66 00 3d 00 25 00 64 00 26 00 6c 00 3d 00 25 00 73 00 26 00 6d 00 62 00 68 00 3d 00 25 00 73 00 } //1 ?a=%s&b=%s&c=%s&e=%s&d=%d&f=%d&l=%s&mbh=%s
		$a_01_4 = {3f 00 61 00 3d 00 25 00 73 00 26 00 62 00 3d 00 25 00 73 00 26 00 63 00 3d 00 25 00 73 00 26 00 6d 00 62 00 68 00 3d 00 } //1 ?a=%s&b=%s&c=%s&mbh=
		$a_01_5 = {26 00 25 00 73 00 3d 00 25 00 73 00 26 00 25 00 73 00 3d 00 25 00 73 00 26 00 25 00 73 00 3d 00 25 00 73 00 } //1 &%s=%s&%s=%s&%s=%s
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=6
 
}
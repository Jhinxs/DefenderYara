
rule PWS_Win32_Mmosteal{
	meta:
		description = "PWS:Win32/Mmosteal,SIGNATURE_TYPE_PEHSTR_EXT,15 00 15 00 06 00 00 "
		
	strings :
		$a_01_0 = {48 6f 6f 6b 44 6c 6c 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 44 6c 6c 55 6e 72 65 67 69 73 74 65 72 53 65 72 76 65 72 00 } //5
		$a_01_1 = {53 74 61 72 74 48 6f 6f 6b 00 53 74 6f 70 48 6f 6f 6b } //5 瑓牡䡴潯k瑓灯潈歯
		$a_01_2 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 45 78 70 6c 6f 72 65 72 5c 53 68 65 6c 6c 45 78 65 63 75 74 65 48 6f 6f 6b 73 } //5 SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks
		$a_01_3 = {55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 46 69 6c 65 41 } //5 URLDownloadToFileA
		$a_01_4 = {7b 35 39 35 30 32 34 31 36 2d 36 34 33 36 2d 34 43 45 39 2d 42 43 30 36 2d 33 43 31 31 35 36 46 43 33 35 34 32 7d } //1 {59502416-6436-4CE9-BC06-3C1156FC3542}
		$a_01_5 = {7b 35 45 45 44 37 30 35 36 2d 42 38 39 44 2d 34 44 45 38 2d 41 30 36 30 2d 44 32 38 35 45 41 37 34 36 37 39 39 7d } //1 {5EED7056-B89D-4DE8-A060-D285EA746799}
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*5+(#a_01_2  & 1)*5+(#a_01_3  & 1)*5+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=21
 
}
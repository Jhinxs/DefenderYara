
rule PWS_Win32_Savnut_D{
	meta:
		description = "PWS:Win32/Savnut.D,SIGNATURE_TYPE_PEHSTR_EXT,2a 00 28 00 0e 00 00 "
		
	strings :
		$a_01_0 = {46 00 72 00 6f 00 6d 00 41 00 63 00 74 00 69 00 76 00 65 00 58 00 25 00 30 00 38 00 58 00 25 00 30 00 38 00 58 00 5f 00 25 00 30 00 38 00 64 00 5f 00 25 00 73 00 00 00 } //10
		$a_01_1 = {46 00 72 00 6f 00 6d 00 4a 00 61 00 76 00 61 00 25 00 30 00 38 00 58 00 25 00 30 00 38 00 58 00 5f 00 25 00 30 00 38 00 64 00 5f 00 25 00 49 00 73 00 00 00 } //10
		$a_01_2 = {25 73 6e 65 74 62 61 6e 6b 65 5f 25 73 5f 25 73 } //10 %snetbanke_%s_%s
		$a_01_3 = {25 73 5c 66 66 63 5f 25 73 25 64 40 25 73 2e 66 66 78 } //10 %s\ffc_%s%d@%s.ffx
		$a_01_4 = {6c 6f 64 75 70 67 64 2e 6a 70 67 } //10 lodupgd.jpg
		$a_01_5 = {3d 45 53 50 5f 74 55 3d 41 55 54 5f 74 4e 3d 43 4f 4c 5f 74 47 3d 41 52 47 5f 74 40 3d 50 45 52 5f 74 39 3d 43 48 4c 5f 74 32 3d 45 43 55 5f 74 2b 3d 50 41 4e 5f 74 24 3d 46 49 4e 5f 74 } //10 =ESP_tU=AUT_tN=COL_tG=ARG_t@=PER_t9=CHL_t2=ECU_t+=PAN_t$=FIN_t
		$a_01_6 = {26 76 65 72 3d } //2 &ver=
		$a_01_7 = {26 64 61 74 61 5f 74 79 70 65 3d } //2 &data_type=
		$a_01_8 = {26 64 61 74 61 5f 63 6f 6e 74 65 6e 74 3d } //2 &data_content=
		$a_01_9 = {26 63 68 65 63 6b 3d 63 68 65 6b } //2 &check=chek
		$a_01_10 = {5c 75 72 68 74 70 73 2e 64 61 74 } //5 \urhtps.dat
		$a_01_11 = {62 61 6e 6b 6f 66 61 6d 65 72 69 63 61 2a } //2 bankofamerica*
		$a_01_12 = {62 61 6e 6b 63 68 61 6e 67 65 68 6f 73 74 } //2 bankchangehost
		$a_01_13 = {41 63 74 69 76 61 74 65 50 72 6f 78 79 } //2 ActivateProxy
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*10+(#a_01_6  & 1)*2+(#a_01_7  & 1)*2+(#a_01_8  & 1)*2+(#a_01_9  & 1)*2+(#a_01_10  & 1)*5+(#a_01_11  & 1)*2+(#a_01_12  & 1)*2+(#a_01_13  & 1)*2) >=40
 
}
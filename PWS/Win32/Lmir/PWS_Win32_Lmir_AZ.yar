
rule PWS_Win32_Lmir_AZ{
	meta:
		description = "PWS:Win32/Lmir.AZ,SIGNATURE_TYPE_PEHSTR_EXT,0d 00 0d 00 0d 00 00 "
		
	strings :
		$a_00_0 = {53 4f 46 54 57 41 52 45 5c 42 6f 72 6c 61 6e 64 5c 44 65 6c 70 68 69 5c 52 54 4c } //1 SOFTWARE\Borland\Delphi\RTL
		$a_00_1 = {43 68 61 6e 67 65 4e 75 6d 52 65 61 64 } //1 ChangeNumRead
		$a_00_2 = {44 6f 46 75 6e 63 74 69 6f 6e } //1 DoFunction
		$a_00_3 = {48 6f 6f 6b 50 72 6f 63 } //1 HookProc
		$a_00_4 = {49 6e 73 74 61 6c 6c 48 6f 6f 6b } //1 InstallHook
		$a_00_5 = {4f 70 65 6e 46 6f 72 6d } //1 OpenForm
		$a_00_6 = {52 65 63 50 61 63 6b } //1 RecPack
		$a_00_7 = {53 77 53 65 6e 64 } //1 SwSend
		$a_00_8 = {55 6e 48 6f 6f 6b } //1 UnHook
		$a_02_9 = {77 73 32 5f 33 32 2e 64 6c 6c 00 00 73 65 6e 64 00 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 55 68 65 79 64 } //1
		$a_00_10 = {4d 59 44 4c 4c 44 41 54 41 } //1 MYDLLDATA
		$a_02_11 = {25 2e 32 58 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 42 65 65 70 20 4f 6e ?? ?? ?? ?? ?? ?? ?? ?? ?? 42 65 65 70 20 4f 66 66 } //1
		$a_02_12 = {6a 00 6a 00 6a 00 68 1f 00 0f 00 53 e8 ?? ?? fb ff 89 06 8b 06 c6 40 1b 58 8b 06 c6 40 1c 00 8b 06 c6 40 22 00 8b 06 c6 40 25 00 8b 06 c6 40 1d 00 8b 06 c6 40 1e 00 8b 06 80 78 1f 39 74 06 8b 06 c6 40 1f 58 8b 06 c6 40 05 58 8b 06 c6 40 21 00 8b 06 c6 40 23 01 8b 06 c6 40 32 01 8b 06 66 c7 40 34 01 09 8b 06 c6 40 37 fd 8b 06 c6 40 45 00 8b 06 c6 40 36 ff 83 3e 00 75 19 53 } //1
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_02_9  & 1)*1+(#a_00_10  & 1)*1+(#a_02_11  & 1)*1+(#a_02_12  & 1)*1) >=13
 
}
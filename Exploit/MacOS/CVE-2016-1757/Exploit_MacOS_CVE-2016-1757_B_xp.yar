
rule Exploit_MacOS_CVE-2016-1757_B_xp{
	meta:
		description = "Exploit:MacOS/CVE-2016-1757.B!xp,SIGNATURE_TYPE_MACHOHSTR_EXT,02 00 02 00 05 00 00 "
		
	strings :
		$a_00_0 = {48 8d 35 86 0a 00 00 48 8b 05 73 0d 00 00 48 8b 0d 7c 0d 00 00 48 8d 95 30 ff ff ff 48 89 95 20 ff ff ff 48 8b 95 20 ff ff ff c7 02 13 14 00 00 48 8b 95 20 ff ff ff 8b 3a 81 cf 00 00 00 80 89 3a 48 8b 95 20 ff ff ff c7 42 04 28 00 00 00 8b bd 18 ff ff ff 48 8b 95 20 ff ff ff 89 7a 08 8b bd 1c ff ff ff 48 8b 95 20 ff ff ff 89 7a 0c 48 8b 95 20 ff ff ff c7 42 10 00 00 00 00 48 8b 95 20 ff ff ff c7 42 14 90 01 00 00 c7 85 48 ff ff ff 01 00 00 00 8b 39 89 bd 4c ff ff ff 8b bd 54 ff ff ff 81 e7 ff ff 00 ff 81 cf 00 00 13 00 89 bd 54 ff ff ff 8b bd 54 ff ff ff 81 e7 ff ff ff 00 89 bd 54 ff ff ff c7 85 14 ff ff ff 01 00 00 00 48 8b 38 } //1
		$a_00_1 = {41 b0 02 49 c1 e0 18 49 83 c8 17 31 ff 4c 89 c0 0f 05 eb 12 5f 49 83 c0 24 4c 89 c0 48 31 d2 52 57 48 89 e6 0f 05 e8 e9 ff ff ff 2f 62 69 6e 2f 2f 73 68 } //1
		$a_00_2 = {31 c0 50 50 b0 17 cd 80 eb 0c 5b 31 c0 50 50 53 b0 3b 50 cd 80 c3 e8 ef ff ff ff 2f 62 69 6e 2f 73 68 } //1
		$a_00_3 = {63 6f 6d 2e 70 75 74 2e 61 73 2e 6d 61 63 68 5f 72 61 63 65 } //1 com.put.as.mach_race
		$a_00_4 = {54 61 72 67 65 74 20 65 6e 74 72 79 70 6f 69 6e 74 20 69 73 20 30 78 25 6c 6c 78 } //1 Target entrypoint is 0x%llx
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=2
 
}
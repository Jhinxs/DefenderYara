
rule Exploit_MacOS_WeightBufs_B_MTB{
	meta:
		description = "Exploit:MacOS/WeightBufs.B!MTB,SIGNATURE_TYPE_MACHOHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {63 6f 6d 2e 6f 70 61 33 33 34 2e 77 65 69 67 68 74 42 75 66 73 } //1 com.opa334.weightBufs
		$a_01_1 = {67 72 6f 6f 6d 5f 6b 65 72 6e 65 6c 5f 6d 61 70 } //1 groom_kernel_map
		$a_01_2 = {68 77 78 5f 70 61 74 63 68 5f 6d 6f 64 65 6c } //1 hwx_patch_model
		$a_01_3 = {5f 6c 6f 6f 6b 75 70 5f 73 63 72 61 74 63 68 65 64 5f 73 68 6d 65 6d } //1 _lookup_scratched_shmem
		$a_01_4 = {2f 77 65 69 67 68 74 42 75 66 73 2e 66 72 61 6d 65 77 6f 72 6b 2f 77 65 69 67 68 74 42 75 66 73 } //1 /weightBufs.framework/weightBufs
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
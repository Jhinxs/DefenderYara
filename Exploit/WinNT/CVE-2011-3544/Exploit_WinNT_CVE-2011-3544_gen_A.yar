
rule Exploit_WinNT_CVE-2011-3544_gen_A{
	meta:
		description = "Exploit:WinNT/CVE-2011-3544.gen!A,SIGNATURE_TYPE_JAVAHSTR_EXT,0c 00 0c 00 07 00 00 "
		
	strings :
		$a_01_0 = {4a 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b } //1 J(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
		$a_01_1 = {4c 6a 61 76 61 2f 6c 61 6e 67 2f 42 6f 6f 6c 65 61 6e 3b } //1 Ljava/lang/Boolean;
		$a_01_2 = {6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 42 75 69 6c 64 65 72 } //1 java/lang/StringBuilder
		$a_01_3 = {6f 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 3b 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b } //1 o(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/String;[Ljava/lang/Class;[Ljava/lang/Object;)Ljava/lang/Object;
		$a_01_4 = {6a 61 76 61 78 2f 73 63 72 69 70 74 2f 53 63 72 69 70 74 45 6e 67 69 6e 65 4d 61 6e 61 67 65 72 } //2 javax/script/ScriptEngineManager
		$a_01_5 = {03 04 59 58 b8 3a 03 04 59 58 b8 3a 04 04 59 58 bd 04 59 58 59 03 04 59 58 12 53 3a 03 04 59 58 } //3
		$a_01_6 = {04 59 58 b8 3a 04 04 59 58 bd 04 59 58 59 03 04 59 58 12 53 3a 03 04 59 58 b8 3a 03 04 59 58 b8 } //3
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*2+(#a_01_5  & 1)*3+(#a_01_6  & 1)*3) >=12
 
}
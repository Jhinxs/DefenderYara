
rule Exploit_WinNT_CVE-2010-0094_GJ{
	meta:
		description = "Exploit:WinNT/CVE-2010-0094.GJ,SIGNATURE_TYPE_JAVAHSTR_EXT,19 00 19 00 05 00 00 "
		
	strings :
		$a_01_0 = {6a 61 76 61 2f 72 6d 69 2f 4d 61 72 73 68 61 6c 6c 65 64 4f 62 6a 65 63 74 } //5 java/rmi/MarshalledObject
		$a_01_1 = {6a 61 76 61 78 2f 6d 61 6e 61 67 65 6d 65 6e 74 2f 72 65 6d 6f 74 65 2f 72 6d 69 2f 52 4d 49 4a 52 4d 50 53 65 72 76 65 72 49 6d 70 6c } //5 javax/management/remote/rmi/RMIJRMPServerImpl
		$a_01_2 = {6a 61 76 61 78 2f 6d 61 6e 61 67 65 6d 65 6e 74 2f 72 65 6d 6f 74 65 2f 72 6d 69 2f 52 4d 49 43 6f 6e 6e 65 63 74 69 6f 6e 49 6d 70 6c } //5 javax/management/remote/rmi/RMIConnectionImpl
		$a_01_3 = {6a 61 76 61 78 2f 6d 61 6e 61 67 65 6d 65 6e 74 2f 4d 42 65 61 6e 53 65 72 76 65 72 } //5 javax/management/MBeanServer
		$a_01_4 = {19 bb 59 b7 b6 10 36 bb 59 19 12 b8 01 01 01 b7 } //5
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*5+(#a_01_2  & 1)*5+(#a_01_3  & 1)*5+(#a_01_4  & 1)*5) >=25
 
}
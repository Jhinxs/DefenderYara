
rule Exploit_WinNT_CVE-2012-4681_HG{
	meta:
		description = "Exploit:WinNT/CVE-2012-4681.HG,SIGNATURE_TYPE_JAVAHSTR_EXT,0c 00 0c 00 05 00 00 "
		
	strings :
		$a_03_0 = {03 33 10 4d a0 00 ?? 19 ?? 04 33 10 5a a0 00 } //10
		$a_01_1 = {53 b6 2a b8 04 bd 59 03 2b 53 b6 b0 } //2
		$a_01_2 = {6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e } //1 java/security/ProtectionDomain
		$a_03_3 = {6a 61 76 61 (2f|2e 6c) 61 6e 67 90 03 01 02 2f 2e 43 6c 61 73 73 4c 6f 61 64 65 72 } //1
		$a_00_4 = {72 65 67 73 76 72 33 32 20 2d 73 20 22 25 73 22 } //2 regsvr32 -s "%s"
	condition:
		((#a_03_0  & 1)*10+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_03_3  & 1)*1+(#a_00_4  & 1)*2) >=12
 
}
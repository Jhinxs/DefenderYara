
rule Exploit_WinNT_Blacole_AHN{
	meta:
		description = "Exploit:WinNT/Blacole.AHN,SIGNATURE_TYPE_JAVAHSTR_EXT,15 00 15 00 09 00 00 "
		
	strings :
		$a_03_0 = {bb 59 bb 59 2a [0-02] 2b b7 90 04 01 02 2c 19 b7 b0 } //1
		$a_03_1 = {bb 59 bb 59 bb 59 b2 90 04 01 02 10 04 32 b8 b7 03 bd b7 2a b7 b0 } //1
		$a_03_2 = {bb 59 bb 59 bb 59 b2 [03-06] 32 b8 b7 2c b7 2d b7 3a 2a b2 90 04 01 03 0[b 03 2b b] e 19 b6 3a 19 b6 57 a7 4c b1 } //1
		$a_03_3 = {bb 59 bb 59 bb 59 19 b7 2c b7 2d b7 3a 2a b2 90 04 01 04 03 2d 08 10 32 2b 03 2b be 19 b6 [0-02] b6 57 a7 4c b1 } //1
		$a_03_4 = {03 19 be 19 c0 b6 3a [0-04] 03 bd 3a 19 04 bd 59 03 13 53 b6 3a [0-04] 19 04 bd 59 03 2b 53 b6 57 [0-04] a7 3a 03 b8 b1 } //1
		$a_01_5 = {bb 59 bb 59 b2 b8 03 bd 04 59 58 b7 2a b7 4c 2b b0 57 4b 01 b0 } //1
		$a_01_6 = {03 bd 3a 03 bd 3a 12 b8 12 b8 04 bd 59 03 13 53 12 b8 05 bd 59 03 13 53 59 04 13 53 b8 04 bd 59 03 05 bd 59 } //1
		$a_01_7 = {1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e } //10
		$a_01_8 = {18 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 43 6f 64 65 53 6f 75 72 63 65 } //10
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*10+(#a_01_8  & 1)*10) >=21
 
}

rule Exploit_Win64_Mopone_A_dha{
	meta:
		description = "Exploit:Win64/Mopone.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,0e 00 0e 00 07 00 00 "
		
	strings :
		$a_80_0 = {63 3a 5c 77 69 6e 64 6f 77 73 5c 73 79 73 74 65 6d 33 32 5c 46 4e 54 43 41 43 48 45 2e 64 61 74 } //c:\windows\system32\FNTCACHE.dat  10
		$a_80_1 = {5c 77 65 72 5f 72 61 63 65 5f 64 61 63 6c 5c } //\wer_race_dacl\  10
		$a_80_2 = {43 3a 5c 50 72 6f 67 72 61 6d 44 61 74 61 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 57 45 52 5c 52 65 70 6f 72 74 51 75 65 75 65 5c } //C:\ProgramData\Microsoft\Windows\WER\ReportQueue\  1
		$a_80_3 = {53 43 48 54 41 53 4b 53 20 2f 52 75 6e 20 2f 54 6e 20 22 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 57 69 6e 64 6f 77 73 20 45 72 72 6f 72 20 52 65 70 6f 72 74 69 6e 67 5c 51 75 65 75 65 52 65 70 6f 72 74 69 6e 67 22 } //SCHTASKS /Run /Tn "Microsoft\Windows\Windows Error Reporting\QueueReporting"  2
		$a_80_4 = {5c 52 65 70 6f 72 74 2e 77 65 72 } //\Report.wer  1
		$a_00_5 = {5c 00 4a 00 75 00 6e 00 63 00 32 00 00 00 } //1
		$a_00_6 = {72 00 65 00 73 00 74 00 6f 00 72 00 65 00 00 00 42 00 41 00 4b 00 2e 00 64 00 61 00 74 00 00 00 } //2
	condition:
		((#a_80_0  & 1)*10+(#a_80_1  & 1)*10+(#a_80_2  & 1)*1+(#a_80_3  & 1)*2+(#a_80_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*2) >=14
 
}
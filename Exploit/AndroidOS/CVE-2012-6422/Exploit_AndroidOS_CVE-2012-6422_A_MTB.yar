
rule Exploit_AndroidOS_CVE-2012-6422_A_MTB{
	meta:
		description = "Exploit:AndroidOS/CVE-2012-6422.A!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_00_0 = {41 74 74 65 6d 70 74 20 66 62 20 6d 65 6d 20 65 78 70 6c 6f 69 74 2e 2e 2e } //1 Attempt fb mem exploit...
		$a_00_1 = {67 65 74 20 72 6f 6f 74 20 73 75 63 63 65 73 73 2e } //1 get root success.
		$a_00_2 = {6f 70 65 6e 20 2f 70 72 6f 63 2f 6b 61 6c 6c 73 79 6d 73 20 64 75 65 20 74 6f 20 25 73 2e } //1 open /proc/kallsyms due to %s.
		$a_00_3 = {63 72 65 61 74 65 20 72 6f 6f 74 65 64 20 66 69 6c 65 20 66 61 69 6c 65 64 21 21 } //1 create rooted file failed!!
		$a_00_4 = {67 65 74 20 73 79 73 5f 73 65 74 72 65 73 75 69 64 20 61 64 64 72 65 73 73 20 64 75 65 20 74 6f 20 25 73 } //1 get sys_setresuid address due to %s
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=5
 
}
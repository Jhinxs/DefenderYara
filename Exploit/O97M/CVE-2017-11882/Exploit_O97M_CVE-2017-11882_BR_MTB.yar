
rule Exploit_O97M_CVE-2017-11882_BR_MTB{
	meta:
		description = "Exploit:O97M/CVE-2017-11882.BR!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {6f 6f 6a 69 68 75 67 79 67 66 74 66 64 74 66 74 66 67 79 68 75 79 74 72 74 72 64 72 66 67 33 34 20 3d 20 22 } //1 oojihugygftfdtftfgyhuytrtrdrfg34 = "
		$a_01_1 = {41 70 70 6c 69 63 61 74 69 6f 6e 2e 45 76 61 6c 20 28 62 74 74 74 74 74 74 74 74 67 67 67 67 67 67 67 67 34 2e 52 75 6e 28 50 61 74 68 20 2b 20 54 58 54 46 69 6c 65 2c 20 79 75 36 37 66 72 65 35 34 6b 6a 69 2c 20 77 61 69 74 4f 6e 52 65 74 75 72 6e 29 29 } //1 Application.Eval (bttttttttgggggggg4.Run(Path + TXTFile, yu67fre54kji, waitOnReturn))
		$a_01_2 = {62 67 66 6a 65 72 79 68 6a 35 37 72 36 75 6a 35 35 6a 72 79 36 6a 72 20 2b 20 22 22 36 34 22 22 20 22 20 2b 20 76 62 43 72 4c 66 20 27 30 30 30 30 } //1 bgfjeryhj57r6uj55jry6jr + ""64"" " + vbCrLf '0000
		$a_01_3 = {63 62 34 69 6a 65 75 72 20 3d 20 63 62 34 69 6a 65 75 72 20 2b 20 22 45 78 65 63 75 74 65 } //1 cb4ijeur = cb4ijeur + "Execute
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
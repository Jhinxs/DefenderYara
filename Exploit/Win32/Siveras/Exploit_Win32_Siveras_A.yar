
rule Exploit_Win32_Siveras_A{
	meta:
		description = "Exploit:Win32/Siveras.A,SIGNATURE_TYPE_PEHSTR_EXT,19 00 0f 00 03 00 00 "
		
	strings :
		$a_00_0 = {05 00 0b 03 10 00 00 00 48 00 00 00 01 00 00 00 b8 10 b8 10 00 00 00 00 01 00 00 00 00 00 01 00 a4 c2 ab 50 4d 57 b3 40 9d 66 ee 4f d5 fb a0 76 05 00 00 00 04 5d 88 8a eb 1c c9 11 9f e8 08 00 2b 10 48 60 02 00 00 00 } //10
		$a_02_1 = {05 00 00 03 10 00 00 00 [0-02] 00 00 01 00 00 00 [0-02] 00 00 } //5
		$a_00_2 = {8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e5 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 03 2c 8b 89 6c 24 1c 61 c3 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 40 08 5e 68 8e 4e 0e ec 50 ff d6 66 53 66 68 33 32 } //10
	condition:
		((#a_00_0  & 1)*10+(#a_02_1  & 1)*5+(#a_00_2  & 1)*10) >=15
 
}
rule Exploit_Win32_Siveras_A_2{
	meta:
		description = "Exploit:Win32/Siveras.A,SIGNATURE_TYPE_PEHSTR_EXT,19 00 0f 00 03 00 00 "
		
	strings :
		$a_02_0 = {05 00 0b 03 10 00 00 00 48 00 00 00 01 00 00 00 [0-04] 00 00 00 00 01 00 00 00 00 00 01 00 a4 c2 ab 50 4d 57 b3 40 9d 66 ee 4f d5 fb a0 76 05 00 00 00 04 5d 88 8a eb 1c c9 11 9f e8 08 00 2b 10 48 60 02 00 00 00 } //10
		$a_02_1 = {05 00 00 03 10 00 00 00 [0-02] 00 00 01 00 00 00 [0-02] 00 00 } //5
		$a_00_2 = {8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e5 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 03 2c 8b 89 6c 24 1c 61 c3 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 40 08 5e 68 8e 4e 0e ec 50 ff d6 66 53 66 68 33 32 } //10
	condition:
		((#a_02_0  & 1)*10+(#a_02_1  & 1)*5+(#a_00_2  & 1)*10) >=15
 
}
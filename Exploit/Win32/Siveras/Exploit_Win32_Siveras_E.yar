
rule Exploit_Win32_Siveras_E{
	meta:
		description = "Exploit:Win32/Siveras.E,SIGNATURE_TYPE_PEHSTR_EXT,19 00 0f 00 07 00 00 "
		
	strings :
		$a_00_0 = {05 00 0b 03 10 00 00 00 48 00 00 00 01 00 00 00 b8 10 b8 10 00 00 00 00 01 00 00 00 00 00 01 00 6a 28 19 39 0c b1 d0 11 9b a8 00 c0 4f d9 2e f5 00 00 00 00 04 5d 88 8a eb 1c c9 11 9f e8 08 00 2b 10 48 60 02 00 00 00 } //10
		$a_00_1 = {5c 5c 25 73 5c 70 69 70 65 5c 62 72 6f 77 73 65 72 } //2 \\%s\pipe\browser
		$a_00_2 = {53 65 6e 64 69 6e 67 20 70 61 79 6c 6f 61 64 32 2e 2e 2e 66 69 6e 69 73 68 } //2 Sending payload2...finish
		$a_00_3 = {53 65 6e 64 69 6e 67 20 70 61 79 6c 6f 61 64 31 2e 2e 2e 66 69 6e 69 73 68 } //3 Sending payload1...finish
		$a_00_4 = {77 61 69 74 74 69 6e 67 20 63 6f 6e 6e 65 63 74 69 6f 6e 73 20 2e 2e 2e } //3 waitting connections ...
		$a_02_5 = {05 00 00 03 10 00 00 00 [0-02] 00 00 01 00 00 00 [0-02] 00 00 } //5
		$a_00_6 = {8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e5 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 03 2c 8b 89 6c 24 1c 61 c3 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 40 08 5e 68 8e 4e 0e ec 50 ff d6 66 53 66 68 33 32 } //10
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*2+(#a_00_2  & 1)*2+(#a_00_3  & 1)*3+(#a_00_4  & 1)*3+(#a_02_5  & 1)*5+(#a_00_6  & 1)*10) >=15
 
}
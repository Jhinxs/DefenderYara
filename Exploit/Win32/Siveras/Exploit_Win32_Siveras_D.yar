
rule Exploit_Win32_Siveras_D{
	meta:
		description = "Exploit:Win32/Siveras.D,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 19 00 07 00 00 "
		
	strings :
		$a_02_0 = {05 00 0b 03 10 00 00 00 48 00 00 00 01 00 00 00 [0-04] 00 00 00 00 01 00 00 00 00 00 01 00 a4 c2 ab 50 4d 57 b3 40 9d 66 ee 4f d5 fb a0 76 05 00 00 00 04 5d 88 8a eb 1c c9 11 9f e8 08 00 2b 10 48 60 02 } //20
		$a_00_1 = {8b 75 3c 8b 74 35 78 03 f5 56 8b 76 20 03 f5 33 c9 49 41 ad } //5
		$a_02_2 = {75 72 6c 6d 6f 6e 2e 64 6c 6c 00 43 3a 5c [0-05] 2e 65 78 65 } //5
		$a_00_3 = {74 08 c1 cb 0d 03 da 40 eb ef 3b df 75 e7 } //5
		$a_00_4 = {5c 5c 25 73 5c 69 70 63 24 } //2 \\%s\ipc$
		$a_00_5 = {5c 5c 25 73 5c 70 69 70 65 5c 62 72 6f 77 73 65 72 } //2 \\%s\pipe\browser
		$a_00_6 = {65 78 70 6c 6f 69 74 } //1 exploit
	condition:
		((#a_02_0  & 1)*20+(#a_00_1  & 1)*5+(#a_02_2  & 1)*5+(#a_00_3  & 1)*5+(#a_00_4  & 1)*2+(#a_00_5  & 1)*2+(#a_00_6  & 1)*1) >=25
 
}
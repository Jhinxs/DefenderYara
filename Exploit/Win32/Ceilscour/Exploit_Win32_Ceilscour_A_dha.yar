
rule Exploit_Win32_Ceilscour_A_dha{
	meta:
		description = "Exploit:Win32/Ceilscour.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 06 00 00 "
		
	strings :
		$a_01_0 = {65 72 72 6f 72 20 69 6e 20 6f 73 6c 65 61 6b 3a 3a 6c 65 61 6b 5f 66 69 6c 65 5f 6f 62 6a 65 63 74 5f 70 74 72 } //1 error in osleak::leak_file_object_ptr
		$a_01_1 = {38 33 20 37 39 20 37 38 20 30 30 20 34 63 20 38 62 20 63 31 20 37 35 20 3f 3f 20 34 38 20 38 42 20 35 31 20 36 30 20 38 41 20 34 31 20 36 38 20 38 38 20 30 32 } //1 83 79 78 00 4c 8b c1 75 ?? 48 8B 51 60 8A 41 68 88 02
		$a_01_2 = {5b 25 2e 34 64 2e 25 2e 32 64 2e 25 2e 32 64 20 25 2e 32 64 3a 25 2e 32 64 3a 25 2e 32 64 3a 25 2e 34 64 5d 5b 25 63 5d 20 25 73 3a } //1 [%.4d.%.2d.%.2d %.2d:%.2d:%.2d:%.4d][%c] %s:
		$a_01_3 = {43 43 6c 66 73 52 69 70 65 64 3a 3a 43 6c 66 73 45 6e 63 6f 64 65 42 6c 6f 63 6b } //1 CClfsRiped::ClfsEncodeBlock
		$a_01_4 = {6e 70 66 73 3a 3a 63 72 65 61 74 65 5f 6e 61 6d 65 64 70 69 70 65 } //1 npfs::create_namedpipe
		$a_01_5 = {6f 73 5f 76 65 72 73 69 6f 6e 20 2d 20 25 78 2c 20 6f 73 5f 73 75 62 76 65 72 73 69 6f 6e 20 2d 20 25 78 2c 20 63 61 63 68 65 5f 6c 69 6e 65 5f 73 69 7a 65 } //1 os_version - %x, os_subversion - %x, cache_line_size
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=5
 
}
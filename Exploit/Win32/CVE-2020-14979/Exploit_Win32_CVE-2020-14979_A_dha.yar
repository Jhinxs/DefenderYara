
rule Exploit_Win32_CVE-2020-14979_A_dha{
	meta:
		description = "Exploit:Win32/CVE-2020-14979.A!dha,SIGNATURE_TYPE_PEHSTR,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {5b 21 5d 20 46 61 69 6c 65 64 20 74 6f 20 67 65 74 20 68 61 6e 64 6c 65 20 74 6f 20 57 69 6e 52 69 6e 67 30 } //1 [!] Failed to get handle to WinRing0
		$a_01_1 = {5b 2b 5d 20 53 75 63 63 65 73 73 66 75 6c 6c 79 20 72 65 61 64 20 4d 53 52 20 4c 53 54 41 52 20 76 61 6c 75 65 3a 20 30 78 25 6c 6c 78 } //1 [+] Successfully read MSR LSTAR value: 0x%llx
		$a_01_2 = {5b 2a 5d 20 53 59 53 52 45 54 20 67 61 64 67 65 74 20 61 74 20 30 78 25 6c 6c 78 } //1 [*] SYSRET gadget at 0x%llx
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
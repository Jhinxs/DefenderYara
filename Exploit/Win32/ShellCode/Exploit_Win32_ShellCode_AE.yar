
rule Exploit_Win32_ShellCode_AE{
	meta:
		description = "Exploit:Win32/ShellCode.AE,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_01_0 = {c7 44 24 48 6b 65 72 6e c7 44 24 4c 65 6c 33 32 } //1
		$a_01_1 = {c6 45 c9 77 c6 45 ca 62 c6 45 cb 65 } //1
		$a_01_2 = {c6 45 a0 70 c6 45 a1 6f c6 45 a2 77 } //1
		$a_01_3 = {c7 45 f8 2e 65 78 65 c6 45 fc 00 8d 55 f8 84 c0 74 25 57 8b fa 8b f1 2b f7 5f 3c 2e } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=3
 
}
rule Exploit_Win32_ShellCode_AE_2{
	meta:
		description = "Exploit:Win32/ShellCode.AE,SIGNATURE_TYPE_ARHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_01_0 = {c7 44 24 48 6b 65 72 6e c7 44 24 4c 65 6c 33 32 } //1
		$a_01_1 = {c6 45 c9 77 c6 45 ca 62 c6 45 cb 65 } //1
		$a_01_2 = {c6 45 a0 70 c6 45 a1 6f c6 45 a2 77 } //1
		$a_01_3 = {c7 45 f8 2e 65 78 65 c6 45 fc 00 8d 55 f8 84 c0 74 25 57 8b fa 8b f1 2b f7 5f 3c 2e } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=3
 
}
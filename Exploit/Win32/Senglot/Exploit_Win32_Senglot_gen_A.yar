
rule Exploit_Win32_Senglot_gen_A{
	meta:
		description = "Exploit:Win32/Senglot.gen!A,SIGNATURE_TYPE_PEHSTR_EXT,ffffff89 13 ffffff89 13 0b 00 00 "
		
	strings :
		$a_02_0 = {66 81 38 4d 5a 74 08 83 c8 ff e9 ?? ?? 00 00 8b 50 3c 8d 0c 02 53 56 0f b7 71 14 03 f2 0f b7 51 06 8d 44 06 18 33 f6 66 3b d7 76 1d 8d 48 10 0f b7 da 8b 11 3b d7 74 0b 8b 41 04 03 c2 3b c6 76 02 8b f0 83 c1 28 4b 75 e9 68 04 01 00 00 } //2500
		$a_02_1 = {57 68 80 00 00 00 6a 03 57 57 68 00 00 00 80 8d 85 ?? ?? ff ff 50 ff 15 ?? ?? ?? ?? 8b d8 83 fb ff 74 77 57 57 56 53 ff 15 ?? ?? ?? ?? 3b f0 75 48 57 53 ff 15 ?? ?? ?? ?? 3b c6 76 3c 6a 40 2b c6 68 00 10 00 00 8b f0 56 57 ff 15 ?? ?? ?? ?? 57 8d 8d ?? ?? ff ff 51 56 50 53 } //2500
		$a_00_2 = {68 74 74 70 3a 2f 2f 76 70 6e 62 6f 78 2e 6e 65 74 2f 31 2e 65 78 65 } //1 http://vpnbox.net/1.exe
		$a_00_3 = {68 74 74 70 3a 2f 2f 32 32 31 2e 32 2e 35 36 2e 35 30 2f 61 64 6d 69 6e 2f 70 61 74 63 68 2e 65 78 65 } //1 http://221.2.56.50/admin/patch.exe
		$a_00_4 = {68 74 74 70 3a 2f 2f 6c 73 6b 64 66 6a 6c 65 72 6a 76 6d 2e 63 6f 6d 2f 61 72 6d 2f 65 78 65 2e 70 68 70 } //1 http://lskdfjlerjvm.com/arm/exe.php
		$a_00_5 = {68 74 74 70 3a 2f 2f 6c 73 6b 64 66 6a 6c 65 72 6a 76 6d 2e 63 6f 6d 2f 61 72 6d 33 2f 65 78 65 2e 70 68 70 } //1 http://lskdfjlerjvm.com/arm3/exe.php
		$a_00_6 = {68 74 74 70 3a 2f 2f 6b 61 73 73 70 65 72 73 6b 79 6c 61 62 73 2e 63 6e 2f 73 70 6c 2f 65 78 65 2e 70 68 70 } //1 http://kassperskylabs.cn/spl/exe.php
		$a_00_7 = {32 31 39 2e 31 33 36 2e 32 35 32 2e 31 33 33 2f 6a 69 61 6f 2e 65 78 65 } //1 219.136.252.133/jiao.exe
		$a_00_8 = {68 74 74 70 3a 2f 2f 73 65 61 6c 2e 77 31 31 35 2e 34 38 38 38 61 2e 63 6f 6d 2f 33 2e 65 78 65 } //1 http://seal.w115.4888a.com/3.exe
		$a_00_9 = {68 74 74 70 3a 2f 2f 77 77 77 2e 68 61 63 6b 30 30 36 2e 63 6f 6d 2f 6d 75 6d 61 2e 65 78 65 } //1 http://www.hack006.com/muma.exe
		$a_00_10 = {68 74 74 70 3a 2f 2f 77 65 62 2e 35 39 63 6e 2e 63 6e 2f 6c 65 69 79 69 6e 67 2f 31 31 2e 65 78 65 } //1 http://web.59cn.cn/leiying/11.exe
	condition:
		((#a_02_0  & 1)*2500+(#a_02_1  & 1)*2500+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1) >=5001
 
}
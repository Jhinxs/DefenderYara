
rule Exploit_Linux_Madvise_gen_A{
	meta:
		description = "Exploit:Linux/Madvise.gen!A,SIGNATURE_TYPE_ELFHSTR_EXT,07 00 07 00 03 00 00 "
		
	strings :
		$a_01_0 = {74 72 79 69 6e 67 20 74 6f 20 65 78 70 6c 6f 69 74 20 25 73 } //3 trying to exploit %s
		$a_01_1 = {2f 70 72 6f 63 2f 73 65 6c 66 2f 65 6e 76 69 72 6f 6e } //1 /proc/self/environ
		$a_01_2 = {75 73 61 67 65 3a 20 62 69 6e 61 72 79 20 3c 62 69 67 20 66 69 6c 65 20 6e 61 6d 65 3e } //3 usage: binary <big file name>
	condition:
		((#a_01_0  & 1)*3+(#a_01_1  & 1)*1+(#a_01_2  & 1)*3) >=7
 
}
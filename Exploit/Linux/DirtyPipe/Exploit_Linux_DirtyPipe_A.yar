
rule Exploit_Linux_DirtyPipe_A{
	meta:
		description = "Exploit:Linux/DirtyPipe.A,SIGNATURE_TYPE_ELFHSTR_EXT,05 00 05 00 03 00 00 "
		
	strings :
		$a_00_0 = {5b 2b 5d 20 70 6f 70 70 69 6e 67 20 72 6f 6f 74 20 73 68 65 6c 6c 2e 2e } //5 [+] popping root shell..
		$a_00_1 = {5b 2b 5d 20 68 69 6a 61 63 6b 69 6e 67 20 73 75 69 64 20 62 69 6e 61 72 79 2e 2e } //5 [+] hijacking suid binary..
		$a_00_2 = {5b 2b 5d 20 64 72 6f 70 70 69 6e 67 20 73 75 69 64 20 73 68 65 6c 6c 2e 2e } //5 [+] dropping suid shell..
	condition:
		((#a_00_0  & 1)*5+(#a_00_1  & 1)*5+(#a_00_2  & 1)*5) >=5
 
}
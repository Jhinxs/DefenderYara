
rule Exploit_Linux_DirtyCow_AA{
	meta:
		description = "Exploit:Linux/DirtyCow.AA,SIGNATURE_TYPE_ELFHSTR_EXT,0a 00 0a 00 05 00 00 "
		
	strings :
		$a_00_0 = {75 73 61 67 65 20 25 73 20 2f 64 65 66 61 75 6c 74 2e 70 72 6f 70 20 2f 64 61 74 61 2f 6c 6f 63 61 6c 2f 74 6d 70 2f 64 65 66 61 75 6c 74 2e 70 72 6f 70 } //5 usage %s /default.prop /data/local/tmp/default.prop
		$a_00_1 = {5b 2a 5d 20 65 78 70 6c 6f 69 74 20 28 25 73 29 } //5 [*] exploit (%s)
		$a_00_2 = {5b 2a 5d 20 63 75 72 72 65 6e 74 6c 79 20 25 70 3d 25 6c 78 } //5 [*] currently %p=%lx
		$a_00_3 = {5b 2a 5d 20 65 78 70 6c 6f 69 74 65 64 20 25 70 3d 25 6c 78 } //5 [*] exploited %p=%lx
		$a_00_4 = {5b 2a 5d 20 6d 61 64 76 69 73 65 20 3d 20 25 70 20 25 64 } //5 [*] madvise = %p %d
	condition:
		((#a_00_0  & 1)*5+(#a_00_1  & 1)*5+(#a_00_2  & 1)*5+(#a_00_3  & 1)*5+(#a_00_4  & 1)*5) >=10
 
}
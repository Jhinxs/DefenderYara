
rule Exploit_Linux_Dirtycow_A_{
	meta:
		description = "Exploit:Linux/Dirtycow.A!!Caroody.A,SIGNATURE_TYPE_ARHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_00_0 = {6d 61 64 76 69 73 65 } //1 madvise
		$a_03_1 = {7f 45 4c 46 02 01 01 [0-11] 78 00 40 00 [0-5c] 48 31 ff 6a 69 58 0f 05 6a 3b 58 99 48 bb 2f 62 69 6e 2f 73 68 00 53 48 89 e7 68 2d 63 00 00 48 89 e6 52 e8 0a 00 00 00 2f 62 69 6e 2f 62 61 73 68 00 56 57 48 89 e6 0f 05 } //2
		$a_03_2 = {7f 45 4c 46 01 01 01 [0-11] 54 80 04 08 34 00 00 00 [0-40] 66 68 2d 63 89 e7 68 2f 73 68 00 68 2f 62 69 6e 89 e3 52 e8 0a 00 00 00 2f 62 69 6e 2f 62 61 73 68 00 57 53 89 e1 cd 80 } //2
	condition:
		((#a_00_0  & 1)*1+(#a_03_1  & 1)*2+(#a_03_2  & 1)*2) >=3
 
}
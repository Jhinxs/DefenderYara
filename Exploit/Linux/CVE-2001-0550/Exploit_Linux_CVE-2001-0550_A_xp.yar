
rule Exploit_Linux_CVE-2001-0550_A_xp{
	meta:
		description = "Exploit:Linux/CVE-2001-0550.A!xp,SIGNATURE_TYPE_ELFHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {73 65 6e 64 69 6e 67 20 62 69 67 62 75 66 20 2b 20 66 61 6b 65 63 68 75 6e 6b } //1 sending bigbuf + fakechunk
		$a_01_1 = {66 74 70 5f 65 73 63 61 70 65 } //1 ftp_escape
		$a_01_2 = {52 68 6e 2f 73 68 68 2f 2f 62 69 } //1 Rhn/shh//bi
		$a_01_3 = {68 76 61 44 6d 74 3a 75 3a 70 3a 64 3a 4c 3a 41 3a } //1 hvaDmt:u:p:d:L:A:
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
rule Exploit_Linux_CVE-2001-0550_A_xp_2{
	meta:
		description = "Exploit:Linux/CVE-2001-0550.A!xp,SIGNATURE_TYPE_ELFHSTR_EXT,07 00 07 00 07 00 00 "
		
	strings :
		$a_00_0 = {73 65 74 72 65 75 69 64 2f 63 68 72 6f 6f 74 2f 65 78 65 63 76 65 20 73 68 65 6c 6c 63 6f 64 65 } //1 setreuid/chroot/execve shellcode
		$a_00_1 = {68 76 61 44 6d 74 3a 75 3a 70 3a 64 3a 4c 3a 41 3a } //1 hvaDmt:u:p:d:L:A:
		$a_00_2 = {50 57 44 20 70 61 74 68 20 28 25 6c 75 29 3a 20 25 73 } //1 PWD path (%lu): %s
		$a_00_3 = {78 38 36 5f 6c 6e 78 5f 73 68 65 6c 6c } //1 x86_lnx_shell
		$a_00_4 = {66 74 70 5f 72 65 63 76 5f 75 6e 74 69 6c } //1 ftp_recv_until
		$a_00_5 = {78 70 5f 62 75 69 6c 64 63 68 75 6e 6b } //1 xp_buildchunk
		$a_00_6 = {78 38 36 5f 6c 6e 78 5f 65 78 65 63 76 65 } //1 x86_lnx_execve
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1) >=7
 
}

rule Exploit_Linux_Raptor_gen_A{
	meta:
		description = "Exploit:Linux/Raptor.gen!A,SIGNATURE_TYPE_ELFHSTR_EXT,07 00 07 00 02 00 00 "
		
	strings :
		$a_01_0 = {45 72 72 6f 72 3a 20 4e 6f 74 20 76 75 6c 6e 65 72 61 62 6c 65 3f 20 53 65 65 20 63 6f 6d 6d 65 6e 74 73 2e } //2 Error: Not vulnerable? See comments.
		$a_01_1 = {65 63 68 6f 20 22 6d 61 69 6e 28 29 7b 73 65 74 75 69 64 28 30 29 3b 73 65 74 67 69 64 28 30 29 3b 73 79 73 74 65 6d 28 5c 22 2f 62 69 6e 2f 73 68 5c 22 29 3b 7d 22 20 3e 20 2f 74 6d 70 2f 70 77 6e 65 64 2e 63 3b 20 67 63 63 20 2f 74 6d 70 2f 70 77 6e 65 64 2e 63 20 2d 6f 20 2f 74 6d 70 2f 70 77 6e 65 64 20 26 3e 2f 64 65 76 2f 6e 75 6c 6c 3b 20 72 6d 20 2d 66 20 2f 74 6d 70 2f 70 77 6e 65 64 2e 63 } //5 echo "main(){setuid(0);setgid(0);system(\"/bin/sh\");}" > /tmp/pwned.c; gcc /tmp/pwned.c -o /tmp/pwned &>/dev/null; rm -f /tmp/pwned.c
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*5) >=7
 
}

rule Exploit_Linux_EDB-40049_A_xp{
	meta:
		description = "Exploit:Linux/EDB-40049.A!xp,SIGNATURE_TYPE_ELFHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_00_0 = {65 78 70 6c 6f 69 74 20 62 79 20 76 6e 69 6b } //1 exploit by vnik
		$a_00_1 = {44 65 63 72 65 6d 65 6e 74 69 6e 67 20 74 68 65 20 72 65 66 63 6f 75 6e 74 2e 20 54 68 69 73 20 6d 61 79 20 74 61 6b 65 20 61 20 77 68 69 6c 65 2e 2e 2e } //1 Decrementing the refcount. This may take a while...
		$a_00_2 = {6d 65 73 73 61 67 65 20 28 65 76 65 6e 20 69 66 20 79 6f 75 27 6c 6c 20 67 65 74 20 74 68 65 20 70 72 6f 6d 70 74 20 62 61 63 6b } //1 message (even if you'll get the prompt back
		$a_00_3 = {2f 74 6d 70 2f 6f 6b 44 6a 54 46 53 53 } //1 /tmp/okDjTFSS
		$a_00_4 = {83 ec 08 c7 40 24 01 00 00 00 c7 40 54 01 00 00 00 c7 40 28 7f 00 01 00 c7 40 20 00 00 00 00 ba b4 00 00 00 6a 00 6a 00 b8 4a 00 00 00 6a 32 6a 07 bb 00 00 80 00 68 00 10 00 00 68 00 00 01 00 66 89 96 b6 00 00 00 66 89 86 b4 00 00 00 c7 86 ce 00 00 00 69 63 6d 70 c6 86 d2 00 00 00 00 e8 6e fd ff ff 83 c4 14 c7 40 58 0d e1 1d 82 c7 40 5c ff ff ff ff 68 14 89 04 08 b9 ff ff ff ff } //1
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=5
 
}

rule Exploit_Linux_Pwnkit_A{
	meta:
		description = "Exploit:Linux/Pwnkit.A,SIGNATURE_TYPE_ELFHSTR_EXT,12 00 12 00 06 00 00 "
		
	strings :
		$a_00_0 = {70 77 6e 6b 69 74 2d 64 72 79 2d 72 75 6e 2e 63 } //8 pwnkit-dry-run.c
		$a_00_1 = {73 65 74 75 69 64 } //4 setuid
		$a_00_2 = {73 65 74 67 69 64 } //4 setgid
		$a_00_3 = {67 63 6f 6e 76 5f 69 6e 69 74 } //2 gconv_init
		$a_00_4 = {2f 62 69 6e 2f 73 68 } //2 /bin/sh
		$a_00_5 = {50 41 54 48 3d 2f 75 73 72 2f 6c 6f 63 61 6c 2f 73 62 69 6e 3a 2f 75 73 72 2f 6c 6f 63 61 6c 2f 62 69 6e 3a 2f 75 73 72 2f 73 62 69 6e 3a 2f 75 73 72 2f 62 69 6e 3a 2f 73 62 69 6e 3a 2f 62 69 6e 3a 2f 75 73 72 2f 67 61 6d 65 73 3a 2f 75 73 72 2f 6c 6f 63 61 6c 2f 67 61 6d 65 73 3a 2f 73 6e 61 70 2f 62 69 6e } //2 PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
	condition:
		((#a_00_0  & 1)*8+(#a_00_1  & 1)*4+(#a_00_2  & 1)*4+(#a_00_3  & 1)*2+(#a_00_4  & 1)*2+(#a_00_5  & 1)*2) >=18
 
}
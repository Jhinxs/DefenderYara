
rule Exploit_Linux_CVE-2016-5195_M_MTB{
	meta:
		description = "Exploit:Linux/CVE-2016-5195.M!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_00_0 = {eb 4a 48 8b 05 36 08 20 00 48 89 c1 8b 45 ec ba 00 00 00 00 48 89 ce 89 c7 e8 d9 fd ff ff 48 8b 45 f0 48 89 c7 e8 9d fd ff ff 48 89 c2 48 8b 4d f0 8b 45 ec 48 89 ce 89 c7 e8 79 fd ff ff 89 c2 8b 45 f8 01 d0 89 45 f8 83 45 fc 01 81 7d fc ff e0 f5 05 } //1
		$a_00_1 = {74 1e 0f 1f 84 00 00 00 00 00 4c 89 ea 4c 89 f6 44 89 ff 41 ff 14 dc 48 83 c3 01 48 39 eb 75 ea 48 83 c4 08 } //1
		$a_00_2 = {64 69 72 74 79 63 30 77 20 74 61 72 67 65 74 5f 66 69 6c 65 20 6e 65 77 5f 63 6f 6e 74 65 6e 74 } //1 dirtyc0w target_file new_content
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1) >=3
 
}
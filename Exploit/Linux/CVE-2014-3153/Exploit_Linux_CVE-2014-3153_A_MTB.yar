
rule Exploit_Linux_CVE-2014-3153_A_MTB{
	meta:
		description = "Exploit:Linux/CVE-2014-3153.A!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_03_0 = {47 6f 6f 64 20 6d 61 67 69 63 20 66 6f 75 6e 64 [0-02] 48 61 63 6b 69 6e 67 2e 2e 2e } //1
		$a_00_1 = {76 6f 6c 75 6e 74 61 72 79 5f 63 74 78 74 5f 73 77 69 74 63 68 65 73 } //1 voluntary_ctxt_switches
		$a_00_2 = {2f 70 72 6f 63 2f 73 65 6c 66 2f 74 61 73 6b 2f 25 64 2f 73 74 61 74 75 73 } //1 /proc/self/task/%d/status
		$a_00_3 = {43 68 65 63 6b 69 6e 67 20 77 68 65 74 68 65 72 20 65 78 70 6c 6f 69 74 61 62 6c 65 2e 2e } //1 Checking whether exploitable..
		$a_00_4 = {54 68 72 65 61 64 20 25 64 20 66 61 69 6c 65 64 20 69 6e 20 77 72 69 74 69 6e 67 20 40 20 25 70 20 3a 20 25 64 20 25 64 } //1 Thread %d failed in writing @ %p : %d %d
	condition:
		((#a_03_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=5
 
}
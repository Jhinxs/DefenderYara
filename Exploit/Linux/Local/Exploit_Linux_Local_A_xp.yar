
rule Exploit_Linux_Local_A_xp{
	meta:
		description = "Exploit:Linux/Local.A!xp,SIGNATURE_TYPE_ELFHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_00_0 = {68 6f 61 67 69 65 5f 75 64 70 5f 73 65 6e 64 6d 73 67 2e 63 20 2d 20 6c 69 6e 75 78 20 72 6f 6f 74 20 3c 3d 20 32 2e 36 2e 31 39 20 6c 6f 63 61 6c } //1 hoagie_udp_sendmsg.c - linux root <= 2.6.19 local
		$a_00_1 = {2d 61 6e 64 69 20 2f 20 76 6f 69 64 2e 61 74 } //1 -andi / void.at
		$a_00_2 = {73 65 74 5f 63 75 72 72 65 6e 74 5f 74 61 73 6b 5f 75 69 64 73 5f 67 69 64 73 5f 74 6f 5f 7a 65 72 6f } //1 set_current_task_uids_gids_to_zero
		$a_00_3 = {66 89 45 ca 8d 45 c8 89 45 d8 c7 45 dc 10 00 00 00 c7 44 24 14 00 00 00 00 c7 44 24 10 00 00 00 00 c7 44 24 0c 32 00 00 00 } //1
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1) >=4
 
}
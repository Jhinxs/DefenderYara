
rule Exploit_Linux_CVE-2021-3156_A_MTB{
	meta:
		description = "Exploit:Linux/CVE-2021-3156.A!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,04 00 04 00 07 00 00 "
		
	strings :
		$a_00_0 = {43 56 45 2d 32 30 32 31 2d 33 31 35 36 20 50 6f 43 20 62 79 } //1 CVE-2021-3156 PoC by
		$a_00_1 = {70 72 61 79 20 66 6f 72 20 79 6f 75 72 20 72 6f 6f 74 73 68 65 6c 6c 2e 2e } //1 pray for your rootshell..
		$a_00_2 = {58 2f 50 30 50 5f 53 48 33 4c 4c 5a 5f } //1 X/P0P_SH3LLZ_
		$a_00_3 = {2f 75 73 72 2f 62 69 6e 2f 73 75 64 6f 65 64 69 74 } //1 /usr/bin/sudoedit
		$a_00_4 = {74 61 72 67 65 74 20 66 69 6c 65 20 68 61 73 20 61 20 42 52 55 48 20 4d 4f 4d 45 4e 54 21 21 21 21 20 53 55 43 43 65 73 73 3f 3f 3f } //1 target file has a BRUH MOMENT!!!! SUCCess???
		$a_00_5 = {6f 68 20 6e 6f 20 62 61 62 79 20 77 68 61 74 20 61 72 65 20 79 6f 75 20 64 6f 69 6e 67 20 3a 28 } //1 oh no baby what are you doing :(
		$a_00_6 = {2e 2f 6d 65 6d 65 20 3c 74 61 72 67 65 74 20 66 69 6c 65 3e 20 3c 73 72 63 20 66 69 6c 65 3e } //1 ./meme <target file> <src file>
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1) >=4
 
}
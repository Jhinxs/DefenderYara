
rule Exploit_iPhoneOS_Vortex_F_MTB{
	meta:
		description = "Exploit:iPhoneOS/Vortex.F!MTB,SIGNATURE_TYPE_MACHOHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_00_0 = {2f 2e 63 79 64 69 61 5f 6e 6f 5f 73 74 61 73 68 } //1 /.cydia_no_stash
		$a_00_1 = {4c 61 75 6e 63 68 44 61 65 6d 6f 6e 73 2f 64 72 6f 70 62 65 61 72 2e 70 6c 69 73 74 } //1 LaunchDaemons/dropbear.plist
		$a_00_2 = {73 6d 6f 6b 65 63 72 61 63 6b 2f 65 78 70 6c 6f 69 74 2e 6d } //1 smokecrack/exploit.m
		$a_00_3 = {2f 2e 69 6e 73 74 61 6c 6c 65 64 5f 79 61 6c 75 58 } //1 /.installed_yaluX
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1) >=3
 
}
rule Exploit_iPhoneOS_Vortex_F_MTB_2{
	meta:
		description = "Exploit:iPhoneOS/Vortex.F!MTB,SIGNATURE_TYPE_MACHOHSTR_EXT,06 00 06 00 06 00 00 "
		
	strings :
		$a_00_0 = {72 75 6e 6e 69 6e 67 20 65 78 70 6c 6f 69 74 } //1 running exploit
		$a_00_1 = {2f 55 73 65 72 73 2f 73 78 78 2f 47 69 74 50 72 6f 6a 65 63 74 2f 73 6f 63 6b 48 33 6c 69 78 2f 73 6f 63 6b 48 33 6c 69 78 2f 73 6f 63 6b 5f 70 6f 72 74 5f 65 78 70 6c 6f 69 74 2e 63 } //1 /Users/sxx/GitProject/sockH3lix/sockH3lix/sock_port_exploit.c
		$a_00_2 = {28 62 61 73 68 20 2d 63 20 22 73 75 20 2d 63 20 75 69 63 61 63 68 65 20 6d 6f 62 69 6c 65 3b 6b 69 6c 6c 61 6c 6c 20 62 61 63 6b 62 6f 61 72 64 64 3b 22 29 26 } //1 (bash -c "su -c uicache mobile;killall backboardd;")&
		$a_00_3 = {45 78 74 72 61 63 74 69 6e 67 20 43 79 64 69 61 2e 2e 2e } //1 Extracting Cydia...
		$a_00_4 = {6b 65 78 65 63 3a 20 61 6c 6c 6f 63 61 74 69 6e 67 20 66 61 6b 65 20 63 6c 69 65 6e 74 } //1 kexec: allocating fake client
		$a_00_5 = {65 78 74 72 61 63 74 50 61 79 6c 6f 61 64 46 72 6f 6d 49 4d 34 50 } //1 extractPayloadFromIM4P
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=6
 
}
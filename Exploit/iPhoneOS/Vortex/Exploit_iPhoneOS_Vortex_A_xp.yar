
rule Exploit_iPhoneOS_Vortex_A_xp{
	meta:
		description = "Exploit:iPhoneOS/Vortex.A!xp,SIGNATURE_TYPE_MACHOHSTR_EXT,05 00 05 00 06 00 00 "
		
	strings :
		$a_00_0 = {2f 6d 65 72 69 64 69 61 6e 2f 6c 6f 67 73 2f 25 40 2d 25 6c 75 } //1 /meridian/logs/%@-%lu
		$a_00_1 = {70 72 6f 63 65 73 73 20 73 70 61 77 6e 65 64 20 77 69 74 68 20 70 69 64 20 25 64 } //1 process spawned with pid %d
		$a_00_2 = {5b 69 6e 6a 65 63 74 5d 20 66 6f 75 6e 64 20 61 74 3a 20 25 6c 6c 78 } //1 [inject] found at: %llx
		$a_00_3 = {50 61 79 6c 6f 61 64 20 69 6e 6a 65 63 74 65 64 20 73 75 63 63 65 73 73 66 75 6c 6c 79 } //1 Payload injected successfully
		$a_00_4 = {72 75 6e 6e 69 6e 67 20 76 30 72 74 65 78 } //1 running v0rtex
		$a_00_5 = {65 78 70 6f 72 74 20 50 41 54 48 3d 2f 6d 65 72 69 64 69 61 6e 2f 62 69 6e 73 3a 24 50 41 54 48 } //1 export PATH=/meridian/bins:$PATH
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=5
 
}

rule Exploit_iPhoneOS_VortexKFD_A_MTB{
	meta:
		description = "Exploit:iPhoneOS/VortexKFD.A!MTB,SIGNATURE_TYPE_MACHOHSTR_EXT,06 00 06 00 09 00 00 "
		
	strings :
		$a_00_0 = {72 65 73 74 61 72 74 20 73 70 72 69 6e 67 62 6f 61 72 64 } //1 restart springboard
		$a_00_1 = {45 78 70 6c 6f 69 74 4d 61 6e 61 67 65 72 } //1 ExploitManager
		$a_00_2 = {4a 41 49 4c 42 52 45 41 4b 5f 52 45 54 55 52 4e 5f 53 54 41 54 55 53 } //1 JAILBREAK_RETURN_STATUS
		$a_00_3 = {2f 54 61 75 72 69 6e 65 2f 65 78 70 6c 6f 69 74 2f 6b 66 64 2f 6c 69 62 6b 66 64 } //1 /Taurine/exploit/kfd/libkfd
		$a_00_4 = {6b 66 64 2d 3e 69 6e 66 6f 2e 6b 65 72 6e 65 6c 2e 6b 65 72 6e 65 6c 5f 74 61 73 6b } //1 kfd->info.kernel.kernel_task
		$a_00_5 = {6c 69 62 6b 66 64 2f 6b 72 6b 77 2f 6b 77 72 69 74 65 2f 6b 77 72 69 74 65 5f 64 75 70 2e 68 } //1 libkfd/krkw/kwrite/kwrite_dup.h
		$a_00_6 = {74 61 75 72 69 6e 65 2f 6c 61 75 6e 63 68 6a 61 69 6c 62 72 65 61 6b } //1 taurine/launchjailbreak
		$a_00_7 = {61 70 74 20 69 6e 73 74 61 6c 6c 20 2d 66 79 } //1 apt install -fy
		$a_00_8 = {75 69 63 61 63 68 65 20 2d 70 20 2f 41 70 70 6c 69 63 61 74 69 6f 6e 73 2f 53 69 6c 65 6f 2e 61 70 70 } //1 uicache -p /Applications/Sileo.app
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1) >=6
 
}

rule Exploit_iPhoneOS_CVE-2018-4243_B_MTB{
	meta:
		description = "Exploit:iPhoneOS/CVE-2018-4243.B!MTB,SIGNATURE_TYPE_MACHOHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_00_0 = {72 65 70 6c 61 63 65 72 20 66 64 20 69 6e 64 65 78 20 25 64 20 69 73 20 61 74 20 74 68 65 20 70 69 70 65 5f 74 61 72 67 65 74 5f 6b 61 64 64 72 } //1 replacer fd index %d is at the pipe_target_kaddr
		$a_00_1 = {43 72 65 61 74 65 64 20 66 61 6b 65 5f 63 6c 69 65 6e 74 20 61 74 20 25 30 31 36 6c 6c 78 } //1 Created fake_client at %016llx
		$a_00_2 = {2f 76 61 72 2f 6c 6f 67 2f 6a 61 69 6c 62 72 65 61 6b 64 2d 73 74 64 6f 75 74 2e 6c 6f 67 } //1 /var/log/jailbreakd-stdout.log
		$a_00_3 = {6b 65 65 70 20 68 6f 6c 64 20 6f 66 20 61 20 73 65 6e 64 20 72 69 67 68 74 20 74 6f 20 69 74 3b 20 64 6f 6e 27 74 20 65 78 70 65 63 74 20 74 68 69 73 20 65 78 70 6c 6f 69 74 20 74 6f 20 77 6f 72 6b 20 61 67 61 69 6e 20 77 69 74 68 6f 75 74 20 61 20 72 65 62 6f 6f 74 } //1 keep hold of a send right to it; don't expect this exploit to work again without a reboot
		$a_00_4 = {68 6f 70 65 66 75 6c 6c 79 20 70 72 65 70 61 72 65 64 20 61 20 66 61 6b 65 20 74 66 70 30 21 } //1 hopefully prepared a fake tfp0!
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=5
 
}
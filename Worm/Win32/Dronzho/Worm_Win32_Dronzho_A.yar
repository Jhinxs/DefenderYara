
rule Worm_Win32_Dronzho_A{
	meta:
		description = "Worm:Win32/Dronzho.A,SIGNATURE_TYPE_PEHSTR_EXT,1a 00 19 00 11 00 00 "
		
	strings :
		$a_00_0 = {75 70 64 61 74 65 5f 6d 79 73 65 6c 66 } //1 update_myself
		$a_00_1 = {73 74 61 72 74 5f 66 72 6f 6d 5f 68 65 72 65 } //1 start_from_here
		$a_00_2 = {66 75 63 6b 2e 61 6c 6c 2e 6d 61 6c 2e 70 72 6f } //1 fuck.all.mal.pro
		$a_00_3 = {53 65 4c 6f 61 64 44 72 69 76 65 72 50 72 69 76 69 6c 65 67 65 } //1 SeLoadDriverPrivilege
		$a_00_4 = {5a 77 4c 6f 61 64 44 72 69 76 65 72 } //1 ZwLoadDriver
		$a_00_5 = {25 73 5c 5f 5f 70 6f 77 65 72 5f 5f } //1 %s\__power__
		$a_00_6 = {50 65 72 73 6f 6e 61 6c 42 61 6e 6b } //1 PersonalBank
		$a_00_7 = {5b 41 75 74 6f 52 75 6e 5d } //1 [AutoRun]
		$a_02_8 = {73 68 65 6c 6c 5c 6f 70 65 6e 5c 43 6f 6d 6d 61 6e 64 3d 22 2e 2e 2e 5c [0-08] 2e 65 78 65 20 6f 5f 64 69 73 6b } //1
		$a_02_9 = {73 68 65 6c 6c 5c 65 78 70 6c 6f 72 65 5c 43 6f 6d 6d 61 6e 64 3d 22 2e 2e 2e 5c [0-08] 2e 65 78 65 20 6f 5f 64 69 73 6b } //1
		$a_02_10 = {73 68 65 6c 6c 65 78 65 63 75 74 65 3d 22 2e 2e 2e 5c [0-08] 2e 65 78 65 20 6f 5f 64 69 73 6b } //1
		$a_00_11 = {53 79 73 74 65 6d 5c 43 75 72 72 65 6e 74 43 6f 6e 74 72 6f 6c 53 65 74 5c 53 65 72 76 69 63 65 73 5c 25 73 } //1 System\CurrentControlSet\Services\%s
		$a_00_12 = {4d 41 49 4c 20 46 72 6f 6d 3a 20 3c 25 73 3e } //1 MAIL From: <%s>
		$a_00_13 = {25 00 73 00 3a 00 5c 00 41 00 75 00 74 00 6f 00 52 00 75 00 6e 00 2e 00 69 00 6e 00 66 00 } //1 %s:\AutoRun.inf
		$a_00_14 = {25 00 73 00 5c 00 64 00 6c 00 6c 00 63 00 61 00 63 00 68 00 65 00 5c 00 63 00 5f 00 32 00 30 00 } //1 %s\dllcache\c_20
		$a_00_15 = {2e 00 6e 00 6c 00 73 00 } //1 .nls
		$a_02_16 = {8d 95 00 fc ff ff 52 68 ?? ?? 42 00 8d 8d 00 f8 ff ff 51 e8 ?? ?? 01 00 83 c4 0c 8d 85 00 fc ff ff 50 68 ?? ?? 42 00 8d 95 00 f4 ff ff 52 e8 ?? ?? 01 00 83 c4 0c 68 80 00 00 00 8d 8d 00 f4 ff ff 51 e8 ?? ?? 02 00 6a 00 8d 85 00 f4 ff ff 50 8d 95 00 f8 ff ff 52 e8 ?? ?? 02 00 8d 8d 00 f4 ff ff 51 } //10
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_02_8  & 1)*1+(#a_02_9  & 1)*1+(#a_02_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1+(#a_02_16  & 1)*10) >=25
 
}
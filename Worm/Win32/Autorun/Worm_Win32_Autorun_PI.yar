
rule Worm_Win32_Autorun_PI{
	meta:
		description = "Worm:Win32/Autorun.PI,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 08 00 00 "
		
	strings :
		$a_03_0 = {f7 d8 1b c0 40 23 f0 f7 de 1b f6 f7 de 8b ?? ?? ?? 41 00 } //3
		$a_03_1 = {b8 04 00 02 80 89 85 ?? ff ff ff b9 0a 00 00 00 89 8d ?? ff ff ff 83 ec 10 8b d4 89 0a 8b 8d ?? ff ff ff 89 4a 04 89 42 08 8b 85 ?? ff ff ff 89 42 0c } //3
		$a_00_2 = {61 00 72 00 71 00 75 00 69 00 76 00 6f 00 73 00 2e 00 65 00 78 00 65 00 } //1 arquivos.exe
		$a_00_3 = {4e 00 65 00 77 00 20 00 44 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 6f 00 20 00 64 00 6f 00 20 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 20 00 57 00 6f 00 72 00 64 00 2e 00 65 00 78 00 65 00 } //1 New Documento do Microsoft Word.exe
		$a_00_4 = {6c 00 73 00 74 00 43 00 4d 00 44 00 2e 00 74 00 78 00 74 00 } //1 lstCMD.txt
		$a_00_5 = {66 00 74 00 70 00 5f 00 72 00 65 00 6d 00 6f 00 74 00 65 00 5f 00 70 00 6f 00 72 00 74 00 } //1 ftp_remote_port
		$a_00_6 = {66 00 74 00 70 00 5f 00 70 00 61 00 73 00 73 00 77 00 6f 00 72 00 64 00 } //1 ftp_password
		$a_00_7 = {77 00 35 00 33 00 33 00 35 00 61 00 30 00 2e 00 61 00 74 00 68 00 2e 00 63 00 78 00 } //1 w5335a0.ath.cx
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*3+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1) >=6
 
}
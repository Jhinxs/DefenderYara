
rule Worm_Win32_Pykspa_E{
	meta:
		description = "Worm:Win32/Pykspa.E,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 07 00 00 "
		
	strings :
		$a_03_0 = {45 00 d0 15 ed 4a 73 0a e8 ?? ?? ?? ?? a3 ?? ?? 45 00 bf c8 32 00 00 66 39 3d ?? ?? 45 00 73 1b e8 ?? ?? ?? ?? 99 b9 50 c3 00 00 f7 f9 03 d7 66 89 15 ?? ?? 45 00 } //3
		$a_03_1 = {68 80 cb a4 00 ff 15 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? eb e9 90 09 0a 00 e8 ?? ?? ?? ?? e8 } //2
		$a_01_2 = {53 6b 79 70 65 2d 41 50 49 2d 54 65 73 74 2d 00 53 6b 79 70 65 43 6f 6e 74 72 6f 6c 41 50 49 44 69 73 63 6f 76 65 72 00 53 6b 79 70 65 43 6f 6e 74 72 6f 6c 41 50 49 41 74 74 61 63 68 00 } //1 歓灹ⵥ偁ⵉ敔瑳-歓灹䍥湯牴汯偁䑉獩潣敶r歓灹䍥湯牴汯偁䅉瑴捡h
		$a_01_3 = {47 45 54 20 50 52 4f 46 49 4c 45 20 46 55 4c 4c 4e 41 4d 45 00 00 00 00 47 45 54 20 50 52 4f 46 49 4c 45 20 50 53 54 4e 5f 42 41 4c 41 4e 43 45 } //1
		$a_01_4 = {47 45 54 20 55 53 45 52 20 25 73 20 4f 4e 4c 49 4e 45 53 54 41 54 55 53 00 00 00 00 47 45 54 20 55 53 45 52 20 25 73 20 4d 4f 4f 44 5f 54 45 58 54 } //1
		$a_01_5 = {73 6b 79 70 65 00 00 00 20 2d 20 00 74 6f 6f 6c 74 69 70 73 5f 63 6c 61 73 73 33 32 00 00 00 00 74 77 69 74 74 65 72 00 } //2
		$a_01_6 = {00 49 46 20 00 43 43 00 00 44 54 00 00 41 54 00 } //1 䤀⁆䌀C䐀T䄀T
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*2+(#a_01_6  & 1)*1) >=6
 
}
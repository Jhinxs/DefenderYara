
rule Worm_Win32_Pakabot{
	meta:
		description = "Worm:Win32/Pakabot,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 0d 00 00 "
		
	strings :
		$a_01_0 = {68 65 68 20 68 65 68 20 68 65 68 20 3a 6b 61 6b 61 70 } //3 heh heh heh :kakap
		$a_01_1 = {68 02 20 00 00 ff 15 } //1
		$a_01_2 = {6a 00 6a 01 6a 00 6a 11 ff } //2
		$a_01_3 = {6a 00 6a 00 6a 00 6a 0d ff } //1
		$a_01_4 = {41 2d 9e 24 dd 44 64 4d 9b 6b d5 fd 76 } //2
		$a_01_5 = {6a 00 6a 03 6a 2d 6a 11 ff } //2
		$a_01_6 = {53 65 74 43 6c 69 70 62 6f 61 72 64 44 61 74 61 } //1 SetClipboardData
		$a_03_7 = {6a 00 6a 00 6a 00 6a ff ff 15 ?? ?? ?? ?? 85 c0 74 } //1
		$a_01_8 = {8b 55 08 03 55 fc 8a 02 32 45 0c 8b 4d 08 03 4d fc 88 01 eb } //5
		$a_01_9 = {83 3d 40 01 80 7c 00 75 } //5
		$a_01_10 = {a1 40 01 80 7c 85 c0 75 } //5
		$a_03_11 = {6a 0a ff 15 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 89 85 ?? ?? ff ff 6a 0a ff 15 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 89 85 ?? ?? ff ff 8b 85 ?? ?? ff ff 2b (45 ?? 85 ??|?? ff ff 83 f8 0a) 73 ?? 8b 8d ?? ?? ff ff 2b 90 03 04 06 4d ?? 8d ?? ?? ff ff 83 f9 14 73 } //6
		$a_03_12 = {6a 0a 8b d8 ff d5 ff d7 6a 0a 8b f0 ff d5 ff d7 2b f3 5d 83 fe 0a 73 ?? 2b c3 83 f8 14 73 } //6
	condition:
		((#a_01_0  & 1)*3+(#a_01_1  & 1)*1+(#a_01_2  & 1)*2+(#a_01_3  & 1)*1+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_01_6  & 1)*1+(#a_03_7  & 1)*1+(#a_01_8  & 1)*5+(#a_01_9  & 1)*5+(#a_01_10  & 1)*5+(#a_03_11  & 1)*6+(#a_03_12  & 1)*6) >=11
 
}
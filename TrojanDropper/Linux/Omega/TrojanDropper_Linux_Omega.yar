
rule TrojanDropper_Linux_Omega{
	meta:
		description = "TrojanDropper:Linux/Omega,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_00_0 = {62 6d 6c 30 56 58 4a 73 49 44 6f 67 4a 32 46 69 62 33 56 30 4f 6d 4a 73 59 57 35 72 4a 79 77 4e 43 67 6c 71 62 58 42 56 63 6d 78 4d 61 58 4e 30 49 44 6f 67 57 79 64 6f 64 48 52 77 4f 69 38 76 62 57 46 70 62 43 35 32 61 58 52 68 62 57 6c 75 62 57 46 70 62 69 35 70 62 6d 5a 76 4c 32 6c 75 59 7a 45 75 } //1 bml0VXJsIDogJ2Fib3V0OmJsYW5rJywNCglqbXBVcmxMaXN0IDogWydodHRwOi8vbWFpbC52aXRhbWlubWFpbi5pbmZvL2luYzEu
		$a_00_1 = {63 47 68 77 4a 79 77 6e 61 48 52 30 63 44 6f 76 4c 7a 45 33 4e 69 34 35 4c 6a 45 35 4e 43 34 78 4d 6a 51 76 61 57 35 6a 4d 53 35 77 61 48 41 6e 4c 43 64 6f 64 48 52 77 4f 69 38 76 61 58 52 77 4d 7a 41 77 4c 6e 56 7a 59 79 35 6c 5a 48 55 76 5a 47 56 75 64 43 39 30 5a 58 4e 30 4d 69 35 77 61 48 41 6e } //1 cGhwJywnaHR0cDovLzE3Ni45LjE5NC4xMjQvaW5jMS5waHAnLCdodHRwOi8vaXRwMzAwLnVzYy5lZHUvZGVudC90ZXN0Mi5waHAn
		$a_00_2 = {5a 57 35 30 4c 6d 52 76 59 33 56 74 5a 57 35 30 52 57 78 6c 62 57 56 75 64 43 6c 37 56 31 4e 6a 63 6d 6c 77 64 43 35 54 62 47 56 6c 63 43 67 78 4d 44 41 77 4b 54 74 39 44 51 6f 4a 43 51 6b 4e 43 67 6b 4a 43 57 5a 76 63 69 67 37 4f 79 6c 37 44 51 6f 4a 43 51 6b 4a 56 31 4e 6a 63 6d 6c 77 64 43 35 54 } //1 ZW50LmRvY3VtZW50RWxlbWVudCl7V1NjcmlwdC5TbGVlcCgxMDAwKTt9DQoJCQkNCgkJCWZvcig7Oyl7DQoJCQkJV1NjcmlwdC5T
		$a_00_3 = {62 47 56 6c 63 43 67 78 4d 44 49 30 4b 54 73 4e 43 67 6b 4a 43 51 6c 32 59 58 49 67 63 32 35 6b 49 44 30 67 64 47 68 70 63 79 35 4a 52 53 35 6b 62 32 4e 31 62 57 56 75 64 43 35 6e 5a 58 52 46 62 47 56 74 5a 57 35 30 51 6e 6c 4a 5a 43 67 69 63 32 35 6b 49 69 6b 37 44 51 6f 4a 43 51 6b 4a 64 6d 46 79 } //1 bGVlcCgxMDI0KTsNCgkJCQl2YXIgc25kID0gdGhpcy5JRS5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic25kIik7DQoJCQkJdmFy
		$a_00_4 = {49 48 4a 6a 64 69 41 39 49 48 52 6f 61 58 4d 75 53 55 55 75 5a 47 39 6a 64 57 31 6c 62 6e 51 75 5a 32 56 30 52 57 78 6c 62 57 56 75 64 45 4a 35 53 57 51 6f 49 6e 4a 6a 64 69 49 70 4f 77 30 4b 43 51 6b 4a 43 57 6c 6d 4b 48 4e 75 5a 43 41 6d 4a 69 42 79 59 33 59 70 44 51 6f 4a 43 51 6b 4a 65 77 30 4b } //1 IHJjdiA9IHRoaXMuSUUuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJjdiIpOw0KCQkJCWlmKHNuZCAmJiByY3YpDQoJCQkJew0K
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1) >=5
 
}
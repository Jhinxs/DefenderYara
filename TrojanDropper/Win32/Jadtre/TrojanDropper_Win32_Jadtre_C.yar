
rule TrojanDropper_Win32_Jadtre_C{
	meta:
		description = "TrojanDropper:Win32/Jadtre.C,SIGNATURE_TYPE_PEHSTR_EXT,1d 00 18 00 07 00 00 "
		
	strings :
		$a_01_0 = {0f b6 50 09 c1 e1 08 0b ca 0f b6 50 0c c1 e1 08 0b ca 89 4d fc 8a 48 0a 32 48 05 3a 48 02 74 04 83 65 fc 00 b9 09 00 00 00 d3 4d fc } //20
		$a_03_1 = {56 6a 04 8d 45 fc 50 68 39 24 22 00 ff 35 ?? ?? 40 00 ff 15 ?? ?? 40 00 eb 02 } //10
		$a_01_2 = {c7 40 fb e9 00 00 00 8b 45 dc 03 45 e0 8b 4d e4 2b c8 8b 45 dc 03 45 e0 89 48 fc 8b 45 dc ff e0 } //5
		$a_01_3 = {5c 5c 2e 5c 47 75 6e 74 69 6f 72 00 } //5 屜尮畇瑮潩r
		$a_01_4 = {5c 5c 2e 5c 70 69 70 65 5c 7b 35 45 37 33 45 38 32 42 2d 39 38 39 34 2d 34 39 33 62 2d 41 34 32 34 2d 36 37 36 38 30 38 46 38 41 34 35 45 7d } //2 \\.\pipe\{5E73E82B-9894-493b-A424-676808F8A45E}
		$a_01_5 = {5c 7b 36 35 42 34 42 32 46 30 2d 32 38 31 30 2d 34 64 66 35 2d 42 44 30 46 2d 30 43 45 34 33 35 41 36 31 31 30 32 7d } //2 \{65B4B2F0-2810-4df5-BD0F-0CE435A61102}
		$a_01_6 = {5c 4b 42 32 35 33 36 32 37 36 36 36 36 2e 6c 6f 67 } //2 \KB2536276666.log
	condition:
		((#a_01_0  & 1)*20+(#a_03_1  & 1)*10+(#a_01_2  & 1)*5+(#a_01_3  & 1)*5+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_01_6  & 1)*2) >=24
 
}

rule TrojanDropper_Win32_Slingshot_A_dll{
	meta:
		description = "TrojanDropper:Win32/Slingshot.A.dll!dha,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 10 00 00 "
		
	strings :
		$a_03_0 = {75 20 8b 54 24 0c 8b 87 ?? ?? ?? ?? 8d 8b ?? ?? ?? ?? 51 52 ff d0 8b 5c 24 18 8b 74 24 10 85 c0 75 12 5e 5d b8 39 01 00 c0 } //1
		$a_01_1 = {b9 32 00 00 00 b8 6e 00 00 00 66 89 44 24 06 66 89 4c 24 0e ba 2e 00 00 00 b9 6c 00 00 00 66 89 54 24 10 b8 33 00 00 00 } //2
		$a_01_2 = {8d 34 02 8b 41 1c 2b c2 8d 44 30 fc 3b f0 73 0e 90 81 3e c0 e8 05 24 74 0a 46 3b f0 72 f3 } //2
		$a_01_3 = {8a 10 8b 4c 24 14 53 55 56 57 33 ff 88 11 } //1
		$a_03_4 = {80 3b 50 75 24 80 7b 01 45 75 1e 80 7b 02 4d 75 18 80 7b 03 43 75 12 80 7b 04 52 75 0c 80 7b 05 54 75 06 8b 54 24 ?? 89 32 85 f6 75 13 85 c9 75 0f } //2
		$a_03_5 = {66 83 f8 09 72 ?? 75 0a 66 83 be ?? ?? 00 00 04 72 ?? c6 45 f8 5a c6 45 f9 2a c6 45 fa d7 c6 45 fb 39 c6 45 fc 25 c6 45 fd ae c6 45 fe 18 } //2
		$a_80_6 = {00 4c 6f 61 64 50 61 79 6c 6f 61 64 00 } //  1
		$a_80_7 = {25 68 73 20 2d 70 20 30 78 25 70 20 2d 73 20 25 64 } //%hs -p 0x%p -s %d  1
		$a_80_8 = {61 3a 73 3a 6f 3a 6c 3a 72 3a 7a 3a } //a:s:o:l:r:z:  1
		$a_80_9 = {2e 62 69 6e 6c 69 6e 65 73 } //.binlines  1
		$a_80_10 = {2d 35 30 30 5c 49 4e 46 4f 35 } //-500\INFO5  1
		$a_80_11 = {00 5c 73 79 6d 73 00 } //  1
		$a_03_12 = {53 00 73 00 20 00 2d 00 61 00 20 00 [0-10] 20 00 2d 00 73 00 20 00 [0-10] 20 00 2d 00 6f 00 } //2
		$a_03_13 = {53 73 20 2d 61 20 [0-10] 20 2d 73 20 [0-10] 20 2d 6f } //2
		$a_03_14 = {6d 65 70 67 90 09 04 00 c7 44 24 } //2
		$a_03_15 = {0d d0 ad 2b 90 09 03 00 c7 45 } //2
	condition:
		((#a_03_0  & 1)*1+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*1+(#a_03_4  & 1)*2+(#a_03_5  & 1)*2+(#a_80_6  & 1)*1+(#a_80_7  & 1)*1+(#a_80_8  & 1)*1+(#a_80_9  & 1)*1+(#a_80_10  & 1)*1+(#a_80_11  & 1)*1+(#a_03_12  & 1)*2+(#a_03_13  & 1)*2+(#a_03_14  & 1)*2+(#a_03_15  & 1)*2) >=5
 
}
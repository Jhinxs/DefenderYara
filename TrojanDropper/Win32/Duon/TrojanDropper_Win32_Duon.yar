
rule TrojanDropper_Win32_Duon{
	meta:
		description = "TrojanDropper:Win32/Duon,SIGNATURE_TYPE_PEHSTR,14 00 0f 00 09 00 00 "
		
	strings :
		$a_01_0 = {5b 00 55 00 6e 00 44 00 6f 00 5f 00 43 00 72 00 79 00 70 00 74 00 5d 00 } //5 [UnDo_Crypt]
		$a_01_1 = {5b 00 32 00 31 00 73 00 70 00 61 00 63 00 65 00 5d 00 } //1 [21space]
		$a_01_2 = {5b 00 32 00 33 00 73 00 70 00 61 00 63 00 65 00 5d 00 } //1 [23space]
		$a_01_3 = {5b 00 31 00 30 00 73 00 70 00 61 00 63 00 65 00 5d 00 } //1 [10space]
		$a_01_4 = {5b 00 31 00 39 00 73 00 70 00 61 00 63 00 65 00 5d 00 } //1 [19space]
		$a_01_5 = {5b 00 31 00 38 00 73 00 70 00 61 00 63 00 65 00 5d 00 } //1 [18space]
		$a_01_6 = {2d 43 30 30 30 2d 64 65 63 72 79 70 74 65 72 } //5 -C000-decrypter
		$a_01_7 = {6d 6f 64 53 70 61 63 65 52 65 6d 6f 76 65 } //5 modSpaceRemove
		$a_01_8 = {4d 61 69 6e 4d 4f 44 } //5 MainMOD
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*5+(#a_01_7  & 1)*5+(#a_01_8  & 1)*5) >=15
 
}

rule TrojanDropper_Win32_Zegost_G{
	meta:
		description = "TrojanDropper:Win32/Zegost.G,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_02_0 = {46 75 63 6b 59 6f 75 [0-10] 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 20 4e 54 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 53 76 63 68 6f 73 74 [0-10] 46 75 63 6b 59 6f 75 } //2
		$a_00_1 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 74 20 2f 69 6d 20 5a 68 75 44 6f 6e 67 46 61 6e 67 59 75 2e 65 78 65 } //1 taskkill /f /t /im ZhuDongFangYu.exe
		$a_03_2 = {80 04 11 7a 03 ca 8b ?? ?? 80 34 11 19 03 ca 42 3b ?? 7c } //1
		$a_02_3 = {25 73 3a 5c 44 6f 63 75 6d 65 6e 74 73 20 61 6e 64 20 53 65 74 74 69 6e 67 73 5c 4c 6f 63 61 6c 20 53 65 72 76 65 72 [0-10] 57 69 6e 64 73 } //1
		$a_01_4 = {8a 14 01 80 c2 7a 80 f2 19 88 14 01 41 3b ce } //1
	condition:
		((#a_02_0  & 1)*2+(#a_00_1  & 1)*1+(#a_03_2  & 1)*1+(#a_02_3  & 1)*1+(#a_01_4  & 1)*1) >=4
 
}
rule TrojanDropper_Win32_Zegost_G_2{
	meta:
		description = "TrojanDropper:Win32/Zegost.G,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 11 00 00 "
		
	strings :
		$a_03_0 = {68 3f 00 0f 00 8d 4d ?? 6a 00 ?? 68 02 00 00 80 c6 45 ?? 4f c6 45 ?? 46 c6 45 ?? 54 c6 45 ?? 57 c6 45 ?? 41 c6 45 ?? 52 c6 45 ?? 45 c6 45 ?? 33 c6 45 ?? 36 } //5
		$a_03_1 = {53 50 ff 75 ?? c6 45 ?? 6e c6 45 ?? 65 c6 45 ?? 74 c6 45 ?? 73 c6 45 ?? 76 c6 45 ?? 63 c6 45 ?? 73 88 5d ?? ff 15 } //4
		$a_01_2 = {25 50 72 6f 67 72 61 6d 46 69 6c 65 73 25 5c 47 6f 6f 67 6c 65 5c } //1 %ProgramFiles%\Google\
		$a_80_3 = {25 73 5c 25 64 5f 72 65 73 2e 74 6d 70 } //%s\%d_res.tmp  1
		$a_80_4 = {6e 65 74 73 76 63 73 5f 30 78 25 64 } //netsvcs_0x%d  1
		$a_01_5 = {25 53 79 73 74 65 6d 52 6f 6f 74 25 5c 53 79 73 74 65 6d 33 32 5c 73 76 63 68 6f 73 74 2e 65 78 65 20 2d 6b 20 6e 65 74 73 76 63 73 } //1 %SystemRoot%\System32\svchost.exe -k netsvcs
		$a_01_6 = {43 3a 5c 73 76 63 68 65 73 74 25 69 25 69 25 69 2e 5a 69 70 } //2 C:\svchest%i%i%i.Zip
		$a_00_7 = {25 00 73 00 25 00 64 00 5f 00 72 00 65 00 73 00 2e 00 74 00 6d 00 70 00 } //1 %s%d_res.tmp
		$a_80_8 = {25 73 5c 25 73 65 78 2e 64 6c 6c } //%s\%sex.dll  2
		$a_00_9 = {53 00 59 00 53 00 54 00 45 00 4d 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 43 00 6f 00 6e 00 74 00 72 00 6f 00 6c 00 53 00 65 00 74 00 5c 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 73 00 5c 00 25 00 73 00 00 00 00 00 25 00 73 00 5c 00 69 00 65 00 73 00 65 00 76 00 65 00 72 00 5f 00 78 00 78 00 00 00 25 00 73 00 5c 00 55 00 70 00 64 00 61 00 74 00 65 00 } //3
		$a_00_10 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 20 4e 54 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 53 76 63 68 6f 73 74 } //1 SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost
		$a_03_11 = {6a 02 6a 00 68 00 fc ff ff 56 ff 15 ?? ?? ?? ?? 68 00 04 00 00 e8 } //3
		$a_80_12 = {25 73 5c 25 73 33 32 2e 64 6c 6c } //%s\%s32.dll  1
		$a_03_13 = {68 02 00 00 80 c7 45 ?? 20 01 00 00 c6 45 ?? 54 c6 45 ?? 79 c6 45 ?? 70 c6 45 ?? 65 c6 45 ?? 00 e8 } //3
		$a_03_14 = {00 80 b8 7f 75 ?? 8b 44 24 ?? 85 c0 75 } //2
		$a_03_15 = {00 08 f5 7f 75 ?? 8b 44 24 ?? 85 c0 75 } //2
		$a_03_16 = {6a 00 50 c6 44 24 ?? 73 c6 44 24 ?? 74 c6 44 24 ?? 61 c6 44 24 ?? 6c c6 44 24 ?? 6c c6 44 24 ?? 4d c6 44 24 ?? 6f c6 44 24 ?? 64 c6 44 24 ?? 75 c6 44 24 ?? 6c 88 5c 24 } //2
	condition:
		((#a_03_0  & 1)*5+(#a_03_1  & 1)*4+(#a_01_2  & 1)*1+(#a_80_3  & 1)*1+(#a_80_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*2+(#a_00_7  & 1)*1+(#a_80_8  & 1)*2+(#a_00_9  & 1)*3+(#a_00_10  & 1)*1+(#a_03_11  & 1)*3+(#a_80_12  & 1)*1+(#a_03_13  & 1)*3+(#a_03_14  & 1)*2+(#a_03_15  & 1)*2+(#a_03_16  & 1)*2) >=7
 
}
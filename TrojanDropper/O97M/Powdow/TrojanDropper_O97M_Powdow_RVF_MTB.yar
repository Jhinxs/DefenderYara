
rule TrojanDropper_O97M_Powdow_RVF_MTB{
	meta:
		description = "TrojanDropper:O97M/Powdow.RVF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {3d 20 43 72 65 61 74 65 4f 62 6a 65 63 74 28 22 77 53 43 72 69 50 54 2e 73 68 45 4c 6c 22 29 } //1 = CreateObject("wSCriPT.shELl")
		$a_01_1 = {2e 67 65 54 73 50 65 43 69 61 4c 46 6f 4c 64 65 52 28 32 29 20 26 20 22 5c 4c 30 65 65 37 32 31 35 64 36 33 31 63 39 34 36 31 37 38 31 38 33 35 63 37 62 38 63 39 2e 65 78 65 22 } //1 .geTsPeCiaLFoLdeR(2) & "\L0ee7215d631c9461781835c7b8c9.exe"
		$a_01_2 = {53 74 72 52 65 76 65 72 73 65 28 22 20 65 64 6f 63 65 64 2d 20 6c 69 74 75 74 72 65 63 22 29 20 26 20 58 65 65 36 63 37 36 35 39 32 35 33 36 38 35 32 65 33 64 37 65 20 26 20 } //1 StrReverse(" edoced- litutrec") & Xee6c76592536852e3d7e & 
		$a_01_3 = {2e 52 75 6e 20 41 39 38 30 36 31 31 34 30 66 33 66 32 62 30 63 36 34 32 33 30 65 38 36 35 33 61 61 39 38 38 32 37 2c 20 30 2c 20 31 } //1 .Run A98061140f3f2b0c64230e8653aa98827, 0, 1
		$a_01_4 = {44 6f 63 75 6d 65 6e 74 5f 4f 70 65 6e 28 29 } //1 Document_Open()
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
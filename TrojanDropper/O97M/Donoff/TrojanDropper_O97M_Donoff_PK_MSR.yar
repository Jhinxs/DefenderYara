
rule TrojanDropper_O97M_Donoff_PK_MSR{
	meta:
		description = "TrojanDropper:O97M/Donoff.PK!MSR,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 03 00 06 00 00 "
		
	strings :
		$a_00_0 = {3d 20 22 73 22 20 26 20 22 63 22 20 26 20 22 68 65 22 20 26 20 22 64 75 22 20 26 20 22 6c 65 22 20 26 20 22 2e 22 20 26 20 22 73 22 20 26 20 22 65 22 20 26 20 22 72 22 20 26 20 22 76 69 63 22 20 26 20 22 65 22 } //1 = "s" & "c" & "he" & "du" & "le" & "." & "s" & "e" & "r" & "vic" & "e"
		$a_00_1 = {3d 20 22 2e 22 20 26 20 22 65 22 } //1 = "." & "e"
		$a_00_2 = {3d 20 77 72 69 74 65 54 6f 46 69 6c 65 28 70 20 26 20 22 62 2e 64 6f 63 22 2c 20 74 4f 75 74 29 } //1 = writeToFile(p & "b.doc", tOut)
		$a_00_3 = {3d 20 22 78 22 20 26 20 22 65 22 } //1 = "x" & "e"
		$a_00_4 = {3d 20 70 75 62 6c 69 63 70 61 74 68 20 26 20 62 73 6c 61 73 68 20 26 20 22 64 6f 22 20 26 20 22 63 22 20 26 20 22 75 22 20 26 20 22 6d 22 20 26 20 22 65 22 20 26 20 22 6e 74 22 20 26 20 22 73 22 20 26 20 62 73 6c 61 73 68 } //1 = publicpath & bslash & "do" & "c" & "u" & "m" & "e" & "nt" & "s" & bslash
		$a_00_5 = {3d 20 53 74 72 43 6f 6e 76 28 22 50 46 26 35 4e 51 4b 2a 6d 52 5e 78 39 34 47 45 36 48 61 55 3e 25 4d 3b 4c 7b 31 37 2f 7d 40 6c 44 58 67 57 71 2c 6f 76 69 74 6a 60 73 7e 24 66 41 53 79 4a 63 4f 64 20 3a 72 54 38 62 56 33 2d 30 22 2c 20 76 62 46 72 6f 6d 55 6e 69 63 6f 64 65 29 } //1 = StrConv("PF&5NQK*mR^x94GE6HaU>%M;L{17/}@lDXgWq,ovitj`s~$fASyJcOd :rT8bV3-0", vbFromUnicode)
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=3
 
}
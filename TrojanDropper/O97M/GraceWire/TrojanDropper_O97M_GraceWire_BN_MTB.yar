
rule TrojanDropper_O97M_GraceWire_BN_MTB{
	meta:
		description = "TrojanDropper:O97M/GraceWire.BN!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_03_0 = {46 6f 72 20 69 20 3d 20 31 20 54 6f 20 4c 65 6e 28 43 6f 6d 6d 61 2e 6e 64 24 29 [0-15] 63 20 3d 20 4d 69 2e 64 24 28 43 6f 6d 6d 61 2e 6e 64 24 2c 20 69 2c 20 31 29 } //1
		$a_03_1 = {50 75 62 6c 69 63 52 65 73 75 6d 45 72 61 73 65 42 79 41 72 72 61 79 4c 69 73 74 20 63 74 61 63 6b 50 6f 70 2c 20 63 74 61 63 6b 50 69 70 2c 20 6f 66 62 6c [0-10] 56 69 73 74 61 51 20 63 74 61 63 6b 50 75 70 } //1
		$a_01_2 = {45 6c 73 65 49 66 20 74 6f 6f 6f 6c 73 65 74 43 68 75 6e 6b 49 20 41 6e 64 20 4e 6f 74 20 74 6f 6f 6f 6c 73 65 74 43 68 75 6e 6b 51 20 54 68 65 6e } //1 ElseIf tooolsetChunkI And Not tooolsetChunkQ Then
		$a_03_3 = {4e 65 78 74 [0-10] 46 6f 72 20 45 61 63 68 20 4b 65 79 20 49 6e 20 70 75 74 41 72 72 61 79 42 69 67 4c 69 73 74 [0-15] 4b 69 6c 6c 20 4b 65 79 [0-10] 4e 65 78 74 20 4b 65 79 [0-08] 4f 6e 20 45 72 72 6f 72 20 47 6f 54 6f 20 30 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_03_3  & 1)*1) >=4
 
}

rule TrojanDropper_O97M_Obfuse_SLB_MTB{
	meta:
		description = "TrojanDropper:O97M/Obfuse.SLB!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {2e 52 75 6e 4f 6e 6c 79 49 66 4e 65 74 77 6f 72 6b 41 76 61 69 6c 61 62 6c 65 20 3d 20 28 4c 65 6e 28 66 66 66 31 61 37 35 35 61 62 37 66 37 66 38 39 61 64 66 38 35 65 61 62 34 61 38 30 30 39 31 35 29 20 3d 20 43 49 6e 74 28 53 74 72 52 65 76 65 72 73 65 28 41 73 63 28 52 69 67 68 74 28 66 66 66 31 61 37 35 35 61 62 37 66 37 66 38 39 61 64 66 38 35 65 61 62 34 61 38 30 30 39 31 35 2c 20 31 29 29 20 2d 20 53 74 72 28 4d 69 64 28 66 66 66 31 61 37 35 35 61 62 37 66 37 66 38 39 61 64 66 38 35 65 61 62 34 61 38 30 30 39 31 35 2c 20 31 34 2c 20 31 29 29 29 29 29 } //1 .RunOnlyIfNetworkAvailable = (Len(fff1a755ab7f7f89adf85eab4a800915) = CInt(StrReverse(Asc(Right(fff1a755ab7f7f89adf85eab4a800915, 1)) - Str(Mid(fff1a755ab7f7f89adf85eab4a800915, 14, 1)))))
		$a_01_1 = {3d 20 52 65 70 6c 61 63 65 28 62 62 66 31 61 37 35 35 61 62 37 66 37 66 38 39 61 64 66 39 35 65 31 61 64 32 66 65 34 61 38 30 30 39 31 35 28 28 41 73 63 28 4d 69 64 28 52 69 67 68 74 28 66 66 66 31 61 37 35 35 61 62 37 66 37 66 38 39 61 64 66 38 35 65 61 62 34 61 38 30 30 39 31 35 2c 20 32 29 2c 20 31 2c 20 31 29 29 20 2d 20 41 73 63 28 4d 69 64 28 52 69 67 68 74 28 66 66 66 31 61 37 35 35 61 62 37 66 37 66 38 39 61 64 66 38 35 65 61 62 34 61 38 30 30 39 31 35 2c 20 33 29 2c 20 31 2c 20 31 29 29 29 } //1 = Replace(bbf1a755ab7f7f89adf95e1ad2fe4a800915((Asc(Mid(Right(fff1a755ab7f7f89adf85eab4a800915, 2), 1, 1)) - Asc(Mid(Right(fff1a755ab7f7f89adf85eab4a800915, 3), 1, 1)))
		$a_01_2 = {3d 20 62 32 31 31 61 63 35 35 61 62 37 66 36 38 39 61 64 66 35 30 61 64 31 61 61 34 61 38 31 32 39 31 36 20 58 6f 72 20 26 48 43 30 30 30 30 30 30 30 20 58 6f 72 20 62 32 31 31 61 63 35 35 61 62 37 66 36 38 39 61 64 66 35 30 61 64 31 61 61 34 61 38 31 30 39 31 36 38 20 58 6f 72 20 62 32 31 31 61 63 35 35 61 62 37 66 36 38 39 61 64 66 35 30 61 64 31 61 61 34 61 38 31 31 39 31 36 38 3a } //1 = b211ac55ab7f689adf50ad1aa4a812916 Xor &HC0000000 Xor b211ac55ab7f689adf50ad1aa4a8109168 Xor b211ac55ab7f689adf50ad1aa4a8119168:
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
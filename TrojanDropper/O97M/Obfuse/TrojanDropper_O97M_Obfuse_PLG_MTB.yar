
rule TrojanDropper_O97M_Obfuse_PLG_MTB{
	meta:
		description = "TrojanDropper:O97M/Obfuse.PLG!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {63 77 42 30 41 47 55 41 62 51 41 75 41 45 34 41 5a 51 42 30 41 43 34 41 56 77 42 6c 41 47 49 41 51 77 42 73 41 47 6b 41 5a 51 42 75 41 48 51 41 4b 51 41 75 41 45 51 41 62 77 42 33 41 47 34 41 62 41 42 76 41 47 45 41 5a 41 42 47 } //1 cwB0AGUAbQAuAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAEQAbwB3AG4AbABvAGEAZABG
		$a_01_1 = {41 47 6b 41 62 41 42 6c 41 43 67 41 49 67 42 6f 41 48 51 41 64 41 42 77 41 44 6f 41 4c 77 41 76 41 47 4d 41 62 77 42 68 41 47 4d 41 61 41 42 6a 41 47 45 41 63 67 42 74 41 47 55 41 62 67 42 33 41 47 6b 41 62 41 42 73 41 47 6b 41 } //1 AGkAbABlACgAIgBoAHQAdABwADoALwAvAGMAbwBhAGMAaABjAGEAcgBtAGUAbgB3AGkAbABsAGkA
		$a_01_2 = {59 51 42 74 41 48 4d 41 4c 67 42 6a 41 47 38 41 62 51 41 76 41 44 45 41 4e 51 42 42 41 44 67 41 4e 77 42 69 41 47 38 41 62 51 42 45 41 47 77 41 57 51 42 78 41 48 41 41 53 41 41 79 41 44 41 41 4d 77 41 32 41 44 63 41 62 41 42 71 } //1 YQBtAHMALgBjAG8AbQAvADEANQBBADgANwBiAG8AbQBEAGwAWQBxAHAASAAyADAAMwA2ADcAbABq
		$a_01_3 = {42 6b 63 62 79 68 61 6e 70 70 61 71 72 66 77 2e 62 61 74 } //1 Bkcbyhanppaqrfw.bat
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
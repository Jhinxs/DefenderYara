
rule VirTool_Win64_RevShellSim_D{
	meta:
		description = "VirTool:Win64/RevShellSim.D,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 07 00 00 "
		
	strings :
		$a_03_0 = {41 b8 10 00 00 00 48 89 c1 48 8b ?? ?? ?? ?? ?? ff d0 85 c0 } //1
		$a_03_1 = {c7 44 24 28 00 00 00 00 c7 44 24 20 00 00 00 00 41 b9 00 00 00 00 41 b8 ?? ?? ?? ?? ba 01 00 00 00 b9 02 00 00 00 48 8b 05 ?? ?? ?? ?? ff d0 48 8b 95 70 01 00 00 48 89 02 48 8b 85 70 01 00 00 48 8b 00 } //1
		$a_03_2 = {48 c7 44 24 28 00 00 00 00 c7 44 24 20 00 00 00 00 41 b9 00 00 00 00 ?? ?? ?? ?? ?? ?? ?? ba 00 00 00 00 b9 00 00 00 00 48 8b 05 ?? ?? ?? ?? ff d0 } //1
		$a_03_3 = {48 89 44 24 40 48 c7 44 24 38 00 00 00 00 48 c7 44 24 30 00 00 00 00 c7 44 24 28 ?? ?? ?? ?? c7 44 24 20 ?? ?? ?? ?? 41 b9 00 00 00 00 41 b8 00 00 00 00 ?? ?? ?? ?? ?? ?? ?? 48 89 c2 b9 00 00 00 00 48 8b 05 ?? ?? ?? ?? ff d0 } //1
		$a_01_4 = {46 50 5f 4e 4f 5f 48 4f 53 54 5f 43 48 45 43 4b } //1 FP_NO_HOST_CHECK
		$a_01_5 = {5c 5c 2e 5c 70 69 70 65 5c } //1 \\.\pipe\
		$a_01_6 = {53 44 4c 5f 44 72 61 77 4c 69 6e 65 28 29 } //1 SDL_DrawLine()
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1) >=7
 
}
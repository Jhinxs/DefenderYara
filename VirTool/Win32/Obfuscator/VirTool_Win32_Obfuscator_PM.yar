
rule VirTool_Win32_Obfuscator_PM{
	meta:
		description = "VirTool:Win32/Obfuscator.PM,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 1f 00 00 "
		
	strings :
		$a_01_0 = {f7 75 10 8b 45 0c 0f b6 0c 10 } //1
		$a_01_1 = {f7 75 10 8b 4d 0c 0f b6 14 11 03 } //1
		$a_01_2 = {8b 45 08 0f b6 14 10 03 ca 81 e1 ff 00 00 00 } //1
		$a_01_3 = {8b 55 08 0f b6 0c 0a 03 c1 25 ff 00 00 00 } //1
		$a_01_4 = {8b 4d 08 0f b6 04 01 03 d0 81 e2 ff 00 00 00 } //1
		$a_01_5 = {0f b6 08 03 d1 81 e2 ff 00 00 00 8b 45 08 0f b6 0c 10 8b 55 14 } //1
		$a_03_6 = {8b 45 08 8b 75 08 8a 0c 0e 88 0c 10 0f b6 ?? ?? 2b 15 ?? ?? ?? ?? 89 15 } //1
		$a_03_7 = {8b 55 e8 81 ea 01 08 00 00 89 55 f8 a1 ?? ?? ?? ?? 3b 05 ?? ?? ?? ?? 7d } //1
		$a_03_8 = {0f b6 14 10 03 ca 88 4d ?? 0f b6 45 ?? 8b 4d 08 8a 14 01 88 55 } //1
		$a_03_9 = {8a 02 88 01 8b 4d 08 03 4d ?? 8a 55 ?? 88 11 8b 45 08 } //1
		$a_03_10 = {8b 55 0c 03 55 ?? 0f b6 02 8b 4d 08 03 4d ?? 0f b6 11 33 d0 8b 45 08 } //1
		$a_03_11 = {78 38 42 4d 08 8a 14 01 88 55 ?? 0f b6 45 ?? 0f b6 4d ?? 8b 55 08 8b 75 08 8a 04 06 } //1
		$a_03_12 = {8b 45 08 8b 75 08 8a 0c 0e 88 0c 10 0f b6 55 ?? 8b 45 08 8a 4d ?? 88 0c 10 } //1
		$a_03_13 = {8b 45 08 0f b6 14 10 03 ca 88 4d ?? 0f b6 45 ?? 8b 4d 08 } //1
		$a_03_14 = {8b 55 08 0f b6 0c 0a 03 c1 88 45 ?? 0f b6 55 ?? 8b 45 08 } //1
		$a_03_15 = {8b 4d 08 0f b6 04 01 03 d0 88 55 ?? 0f b6 4d ?? 8b 55 08 } //1
		$a_01_16 = {0f b6 02 03 c8 81 e1 ff 00 00 00 8b 55 08 0f b6 04 0a 8b 4d 14 } //1
		$a_01_17 = {68 00 b0 42 00 e8 } //1
		$a_01_18 = {68 00 c0 42 00 e8 } //1
		$a_01_19 = {68 00 20 43 00 e8 } //1
		$a_01_20 = {68 00 d0 42 00 e8 } //1
		$a_01_21 = {68 00 10 43 00 e8 } //1
		$a_01_22 = {81 c2 59 3e 00 00 } //1
		$a_01_23 = {81 c1 59 3e 00 00 } //1
		$a_01_24 = {05 59 3e 00 00 } //1
		$a_01_25 = {05 59 35 00 00 } //1
		$a_01_26 = {81 c1 59 35 00 00 } //1
		$a_01_27 = {81 c2 59 35 00 00 } //1
		$a_01_28 = {81 c2 49 3e 00 00 } //1
		$a_01_29 = {81 c1 49 3e 00 00 } //1
		$a_01_30 = {05 49 3e 00 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_03_6  & 1)*1+(#a_03_7  & 1)*1+(#a_03_8  & 1)*1+(#a_03_9  & 1)*1+(#a_03_10  & 1)*1+(#a_03_11  & 1)*1+(#a_03_12  & 1)*1+(#a_03_13  & 1)*1+(#a_03_14  & 1)*1+(#a_03_15  & 1)*1+(#a_01_16  & 1)*1+(#a_01_17  & 1)*1+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1+(#a_01_23  & 1)*1+(#a_01_24  & 1)*1+(#a_01_25  & 1)*1+(#a_01_26  & 1)*1+(#a_01_27  & 1)*1+(#a_01_28  & 1)*1+(#a_01_29  & 1)*1+(#a_01_30  & 1)*1) >=4
 
}

rule VirTool_Win32_Obfuscator_ACV{
	meta:
		description = "VirTool:Win32/Obfuscator.ACV,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 01 00 04 00 00 "
		
	strings :
		$a_05_0 = {8b 55 0c 83 e2 07 83 fa 00 74 } //1
		$a_05_1 = {8b 4d 0c 83 e1 07 83 f9 00 74 } //1
		$a_05_2 = {8b 45 0c 83 e0 07 83 f8 00 74 } //1
		$a_05_3 = {8b 45 0c 23 45 c8 83 f8 00 74 05 e9 } //1
	condition:
		((#a_05_0  & 1)*1+(#a_05_1  & 1)*1+(#a_05_2  & 1)*1+(#a_05_3  & 1)*1) >=1
 
}
rule VirTool_Win32_Obfuscator_ACV_2{
	meta:
		description = "VirTool:Win32/Obfuscator.ACV,SIGNATURE_TYPE_PEHSTR_EXT,64 00 0b 00 06 00 00 "
		
	strings :
		$a_01_0 = {be 77 05 00 00 } //1
		$a_01_1 = {bb 77 05 00 00 } //1
		$a_01_2 = {bf 77 05 00 00 } //1
		$a_01_3 = {b9 77 05 00 00 } //1
		$a_03_4 = {77 05 00 00 90 09 06 00 c7 85 } //1
		$a_01_5 = {4a 3a 5c 38 37 35 36 6a 2e 70 64 62 } //10 J:\8756j.pdb
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_03_4  & 1)*1+(#a_01_5  & 1)*10) >=11
 
}
rule VirTool_Win32_Obfuscator_ACV_3{
	meta:
		description = "VirTool:Win32/Obfuscator.ACV,SIGNATURE_TYPE_PEHSTR_EXT,65 00 65 00 16 00 00 "
		
	strings :
		$a_03_0 = {c4 6a 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_1 = {68 4f 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_2 = {11 98 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_3 = {cc 9a 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_4 = {04 6b 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_5 = {dc 5d 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_6 = {b2 88 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_7 = {d4 24 02 00 90 09 03 00 c7 45 90 0a 40 00 55 8b ec 83 ec ?? c7 45 [0-f0] ff 75 ?? e8 [0-15] 8b e5 5d c2 10 00 } //100
		$a_03_8 = {c4 6a 02 00 8b 45 fc 8b e5 5d c3 90 09 09 00 55 8b ec 83 ec 04 c7 45 fc } //10
		$a_03_9 = {11 98 02 00 8b 45 fc 8b e5 5d c3 90 09 09 00 55 8b ec 83 ec 04 c7 45 fc } //10
		$a_03_10 = {b2 88 02 00 8b 45 fc 8b e5 5d c3 90 09 09 00 55 8b ec 83 ec 04 c7 45 fc } //10
		$a_03_11 = {04 6b 02 00 8b 45 fc 8b e5 5d c3 90 09 09 00 55 8b ec 83 ec 04 c7 45 fc } //10
		$a_03_12 = {ca 85 01 00 73 90 09 06 00 81 3d } //1
		$a_03_13 = {93 04 00 73 90 09 01 00 e0 90 09 07 00 81 3d } //1
		$a_03_14 = {86 01 00 73 90 09 01 00 a0 90 09 07 00 81 3d } //1
		$a_03_15 = {86 01 00 0f 83 90 09 01 00 a0 90 09 07 00 81 3d } //1
		$a_03_16 = {4f 02 00 75 05 e8 90 09 07 00 81 bd ?? ?? ?? ?? 68 } //1
		$a_03_17 = {6a 02 00 75 05 e8 90 09 04 00 81 7d ?? c4 } //1
		$a_03_18 = {4f 02 00 75 05 e8 90 09 04 00 81 7d ?? 68 } //1
		$a_03_19 = {9a 02 00 75 05 e8 90 09 04 00 81 7d ?? cc } //1
		$a_03_20 = {5d 02 00 75 05 e8 90 09 04 00 81 7d ?? dc } //1
		$a_03_21 = {24 02 00 75 05 e8 90 09 04 00 81 7d ?? d4 } //1
	condition:
		((#a_03_0  & 1)*100+(#a_03_1  & 1)*100+(#a_03_2  & 1)*100+(#a_03_3  & 1)*100+(#a_03_4  & 1)*100+(#a_03_5  & 1)*100+(#a_03_6  & 1)*100+(#a_03_7  & 1)*100+(#a_03_8  & 1)*10+(#a_03_9  & 1)*10+(#a_03_10  & 1)*10+(#a_03_11  & 1)*10+(#a_03_12  & 1)*1+(#a_03_13  & 1)*1+(#a_03_14  & 1)*1+(#a_03_15  & 1)*1+(#a_03_16  & 1)*1+(#a_03_17  & 1)*1+(#a_03_18  & 1)*1+(#a_03_19  & 1)*1+(#a_03_20  & 1)*1+(#a_03_21  & 1)*1) >=101
 
}
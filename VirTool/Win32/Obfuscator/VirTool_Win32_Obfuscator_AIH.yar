
rule VirTool_Win32_Obfuscator_AIH{
	meta:
		description = "VirTool:Win32/Obfuscator.AIH,SIGNATURE_TYPE_PEHSTR_EXT,64 00 03 00 03 00 00 "
		
	strings :
		$a_00_0 = {64 3a 5c 73 34 31 32 34 31 32 6c } //1 d:\s412412l
		$a_02_1 = {b9 53 00 00 00 8b 15 ?? ?? ?? 00 66 89 0a b8 4f 00 00 00 8b 0d ?? ?? ?? 00 66 89 41 02 ba 46 00 00 00 a1 ?? ?? 42 00 66 89 50 04 b9 54 00 00 00 8b 15 ?? ?? ?? 00 66 89 4a 06 b8 57 00 00 00 8b 0d ?? ?? ?? 00 66 89 41 08 ba 41 00 00 00 a1 ?? ?? ?? 00 66 89 50 0a b9 52 00 00 00 8b 15 ?? ?? ?? 00 66 89 4a 0c b8 45 00 00 00 8b 0d ?? ?? ?? 00 66 89 41 0e ba 43 00 00 00 a1 ?? ?? ?? 00 66 89 50 12 b9 6c 00 00 00 8b 15 ?? ?? ?? 00 66 89 4a 14 b8 61 00 00 00 8b 0d ?? ?? ?? 00 } //2
		$a_02_2 = {b8 53 00 00 00 8b 0d ?? ?? ?? 00 66 89 01 ba 4f 00 00 00 a1 ?? ?? ?? 00 66 89 50 02 b9 46 00 00 00 8b 15 ?? ?? ?? 00 66 89 4a 04 b8 54 00 00 00 8b 0d ?? ?? ?? 00 66 89 41 06 ba 57 00 00 00 a1 ?? ?? ?? 00 66 89 50 08 b9 41 00 00 00 8b 15 ?? ?? ?? 00 66 89 4a 0a b8 52 00 00 00 8b 0d ?? ?? ?? 00 66 89 41 0c ba 45 00 00 00 a1 ?? ?? ?? 00 66 89 50 0e b9 43 00 00 00 8b 15 ?? ?? ?? 00 66 89 4a 12 b8 6c 00 00 00 8b 0d ?? ?? ?? 00 66 89 41 14 ba 61 00 00 00 a1 ?? ?? ?? 00 } //2
	condition:
		((#a_00_0  & 1)*1+(#a_02_1  & 1)*2+(#a_02_2  & 1)*2) >=3
 
}
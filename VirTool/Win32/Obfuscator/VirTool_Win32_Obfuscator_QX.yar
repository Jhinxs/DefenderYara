
rule VirTool_Win32_Obfuscator_QX{
	meta:
		description = "VirTool:Win32/Obfuscator.QX,SIGNATURE_TYPE_PEHSTR_EXT,64 00 0b 00 07 00 00 "
		
	strings :
		$a_03_0 = {83 c0 04 89 45 ?? 81 7d 90 1b 00 ?? ?? 00 00 (0f 83|73) 90 09 10 00 8b 45 90 1b 00 } //1
		$a_03_1 = {83 c1 04 89 4d ?? 81 7d 90 1b 00 ?? ?? 00 00 (0f 83|73) 90 09 10 00 8b 4d 90 1b 00 } //1
		$a_03_2 = {83 c2 04 89 55 ?? 81 7d 90 1b 00 ?? ?? 00 00 (0f 83|73) 90 09 10 00 8b 55 90 1b 00 } //1
		$a_03_3 = {33 c0 66 8b 02 03 45 ?? 8b 4d ?? 03 4d ?? 66 89 01 90 09 06 00 8b 55 90 1b 01 03 55 90 1b 02 } //5
		$a_03_4 = {33 d2 66 8b 51 02 2b 55 ?? 8b 45 ?? 03 45 ?? 66 89 50 02 90 09 06 00 8b 4d 90 1b 01 03 4d 90 1b 02 } //5
		$a_03_5 = {33 c9 66 8b 48 02 2b 4d ?? 8b 55 ?? 03 55 ?? 66 89 4a 02 90 09 06 00 8b 45 90 1b 01 03 45 90 1b 02 } //5
		$a_03_6 = {33 c0 66 8b 42 02 2b 45 ?? 8b 4d ?? 03 4d ?? 66 89 41 02 90 09 06 00 8b 55 90 1b 01 03 55 90 1b 02 } //5
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*5+(#a_03_4  & 1)*5+(#a_03_5  & 1)*5+(#a_03_6  & 1)*5) >=11
 
}

rule VirTool_Win32_VBInject_gen_IF{
	meta:
		description = "VirTool:Win32/VBInject.gen!IF,SIGNATURE_TYPE_PEHSTR_EXT,10 00 10 00 05 00 00 "
		
	strings :
		$a_01_0 = {62 79 74 49 6e 00 00 00 62 79 74 50 61 73 73 77 6f 72 64 } //1
		$a_01_1 = {00 44 65 63 72 79 70 74 46 69 6c 65 00 44 65 63 72 79 70 74 42 79 74 65 00 45 6e 63 72 79 70 74 42 79 74 65 00 45 6e 63 72 79 70 74 53 74 72 69 6e 67 00 } //1
		$a_03_2 = {00 30 f5 04 00 00 00 6c ?? ?? 52 28 ?? ?? 40 00 f5 05 00 00 00 6c 90 09 03 00 28 } //5
		$a_03_3 = {f5 f8 00 00 00 aa f5 28 00 00 00 6c ?? ?? b2 aa } //5
		$a_00_4 = {f5 95 e3 35 69 } //5
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*5+(#a_03_3  & 1)*5+(#a_00_4  & 1)*5) >=16
 
}
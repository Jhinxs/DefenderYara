
rule VirTool_Win32_CeeInject_gen_J{
	meta:
		description = "VirTool:Win32/CeeInject.gen!J,SIGNATURE_TYPE_PEHSTR_EXT,6d 00 6d 00 1a 00 00 "
		
	strings :
		$a_00_0 = {43 72 65 61 74 65 50 72 6f 63 65 73 73 41 } //1 CreateProcessA
		$a_00_1 = {56 69 72 74 75 61 6c 41 6c 6c 6f 63 45 78 } //1 VirtualAllocEx
		$a_00_2 = {4c 6f 61 64 52 65 73 6f 75 72 63 65 } //1 LoadResource
		$a_00_3 = {46 69 6e 64 52 65 73 6f 75 72 63 65 41 } //1 FindResourceA
		$a_01_4 = {53 69 7a 65 6f 66 52 65 73 6f 75 72 63 65 } //1 SizeofResource
		$a_01_5 = {47 65 74 54 68 72 65 61 64 43 6f 6e 74 65 78 74 } //1 GetThreadContext
		$a_00_6 = {53 65 74 54 68 72 65 61 64 43 6f 6e 74 65 78 74 } //1 SetThreadContext
		$a_00_7 = {52 65 73 75 6d 65 54 68 72 65 61 64 } //1 ResumeThread
		$a_00_8 = {57 72 69 74 65 50 72 6f 63 65 73 73 4d 65 6d 6f 72 79 } //1 WriteProcessMemory
		$a_00_9 = {6d 5f 53 74 75 62 00 } //10
		$a_03_10 = {8a 10 32 91 ?? ?? ?? ?? 8b 45 ?? 03 45 ?? 88 10 eb } //10
		$a_01_11 = {81 e3 ff 00 00 80 79 08 4b 81 cb 00 ff ff ff 43 8a 5c 9c 14 30 1c 2a 42 3b d0 72 } //10
		$a_03_12 = {8b 45 08 03 85 ?? ?? ff ff 8a 10 32 94 8d ?? ?? ff ff 8b 45 08 03 85 ?? ?? ff ff 88 10 e9 } //10
		$a_03_13 = {8a 04 1f 8a 54 94 ?? 32 c2 88 04 1f 8b 84 24 ?? ?? 00 00 47 3b f8 72 } //10
		$a_03_14 = {99 f7 f9 8a 84 95 ?? ?? ff ff 30 07 ff 45 ?? 8b 45 ?? 3b 45 ?? 72 } //10
		$a_01_15 = {66 b9 ff ff eb 06 66 b8 00 4c cd 21 e2 f6 } //10
		$a_02_16 = {8a 14 31 8a 0c 07 32 ca 88 0c 07 ff d5 50 ff 15 ?? ?? ?? ?? a3 ?? ?? ?? ?? 8b 44 24 20 47 3b f8 0f 8c 2f ff ff ff } //10
		$a_01_17 = {6a 04 68 00 30 00 00 ff 73 50 ff 73 34 ff 75 e4 ff 15 } //100
		$a_03_18 = {6a 40 68 00 30 00 00 8b 48 50 8b 50 34 8b 44 24 ?? 51 52 50 ff } //100
		$a_03_19 = {6a 40 68 00 30 00 00 (8b 0d|a1) ?? ?? ?? ?? 8b (|) 51 48 50 (|) 52 51 90 03 01 02 a1 8b 15 ?? ?? ?? ?? 8b (|) 48 42 34 (|) 51 50 8b (|) 95 8d ?? ?? ff ff (|) 52 51 ff } //100
		$a_03_20 = {8b 48 50 51 8b 15 ?? ?? ?? ?? 8b 42 34 50 8b 4d ?? 51 ff 15 } //100
		$a_01_21 = {6a 40 68 00 30 00 00 8b 50 50 8b 40 34 52 50 51 ff } //100
		$a_03_22 = {6a 40 68 00 30 00 00 a1 ?? ?? ?? ?? 8b 4c 24 ?? 8b 50 50 8b 40 34 52 50 51 ff } //100
		$a_03_23 = {6a 40 68 00 30 00 00 8b 0d ?? ?? ?? ?? 8b 51 50 52 a1 ?? ?? ?? ?? 8b 48 34 51 8b 55 ?? 52 ff } //100
		$a_03_24 = {8b 50 50 8b 40 34 8b 4c 24 ?? 6a 40 68 00 30 00 00 52 50 51 ff } //100
		$a_02_25 = {6a 40 c1 e9 1f 03 d1 8b 4c 24 ?? 89 15 ?? ?? ?? ?? 8b 50 50 8b 40 34 68 00 30 00 00 52 50 51 ff 15 } //100
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*10+(#a_03_10  & 1)*10+(#a_01_11  & 1)*10+(#a_03_12  & 1)*10+(#a_03_13  & 1)*10+(#a_03_14  & 1)*10+(#a_01_15  & 1)*10+(#a_02_16  & 1)*10+(#a_01_17  & 1)*100+(#a_03_18  & 1)*100+(#a_03_19  & 1)*100+(#a_03_20  & 1)*100+(#a_01_21  & 1)*100+(#a_03_22  & 1)*100+(#a_03_23  & 1)*100+(#a_03_24  & 1)*100+(#a_02_25  & 1)*100) >=109
 
}
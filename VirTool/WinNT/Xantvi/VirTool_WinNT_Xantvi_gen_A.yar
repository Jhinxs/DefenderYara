
rule VirTool_WinNT_Xantvi_gen_A{
	meta:
		description = "VirTool:WinNT/Xantvi.gen!A,SIGNATURE_TYPE_PEHSTR_EXT,11 00 11 00 10 00 00 "
		
	strings :
		$a_02_0 = {8b 44 24 08 56 8b 70 28 6a 00 ff 15 ?? ?? 01 00 8d 4e 50 ff 15 ?? ?? 01 00 5e c2 10 00 } //5
		$a_02_1 = {01 00 8b 48 08 c1 e1 02 51 ff 30 6a 00 ff 15 ?? ?? 01 00 85 c0 a3 ?? ?? 01 00 75 06 b8 01 00 00 c0 c3 90 09 03 00 a1 } //5
		$a_02_2 = {50 56 56 56 8d 45 d4 50 68 3f 00 0f 00 8d 45 08 50 c7 45 d4 18 00 00 00 89 75 d8 c7 45 e0 40 02 00 00 89 75 e4 89 75 e8 ff 15 ?? ?? 01 00 85 c0 75 50 8b 45 0c 89 45 f0 8d 50 02 66 8b 08 40 } //10
		$a_02_3 = {8d 45 e8 50 ff 15 ?? ?? 01 00 8b 45 0c 89 45 f0 8d 45 f0 50 8d 45 d0 50 68 ff 0f 1f 00 8d 45 08 50 89 5d 08 89 5d f4 ff 15 ?? ?? 01 00 53 ff 75 08 ff 15 ?? ?? 01 00 47 8d 34 bd ?? ?? 01 00 39 1e 75 ad } //13
		$a_00_4 = {5c 00 52 00 65 00 67 00 69 00 73 00 74 00 72 00 79 00 5c 00 4d 00 61 00 63 00 68 00 69 00 6e 00 65 00 5c 00 53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 5c 00 52 00 75 00 6e 00 } //1 \Registry\Machine\Software\Microsoft\Windows\CurrentVersion\Run
		$a_00_5 = {5a 77 54 65 72 6d 69 6e 61 74 65 50 72 6f 63 65 73 73 } //1 ZwTerminateProcess
		$a_00_6 = {5a 77 4f 70 65 6e 50 72 6f 63 65 73 73 } //1 ZwOpenProcess
		$a_00_7 = {48 61 6c 4d 61 6b 65 42 65 65 70 } //1 HalMakeBeep
		$a_00_8 = {5c 61 76 70 2e 65 78 65 } //1 \avp.exe
		$a_00_9 = {5c 6b 61 76 2e 65 78 65 } //1 \kav.exe
		$a_00_10 = {5c 77 69 6e 63 6f 6d 33 32 2e 73 79 73 } //1 \wincom32.sys
		$a_00_11 = {5c 44 65 76 69 63 65 5c 42 65 65 70 } //1 \Device\Beep
		$a_00_12 = {5c 6d 70 66 69 72 65 77 61 6c 6c 2e 73 79 73 } //1 \mpfirewall.sys
		$a_00_13 = {5c 61 76 67 77 2e 65 78 65 } //1 \avgw.exe
		$a_00_14 = {5c 6d 73 6d 70 65 6e 67 2e 65 78 65 } //1 \msmpeng.exe
		$a_00_15 = {5c 6e 61 76 77 33 32 2e 65 78 65 } //1 \navw32.exe
	condition:
		((#a_02_0  & 1)*5+(#a_02_1  & 1)*5+(#a_02_2  & 1)*10+(#a_02_3  & 1)*13+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1) >=17
 
}

rule Spyware_Win32_MPSpyTestFile{
	meta:
		description = "Spyware:Win32/MPSpyTestFile,SIGNATURE_TYPE_PEHSTR,0c 00 06 00 0d 00 00 "
		
	strings :
		$a_01_0 = {4d 53 20 41 56 41 53 20 53 70 79 54 65 73 74 46 69 6c 65 2d 47 65 6e } //1 MS AVAS SpyTestFile-Gen
		$a_01_1 = {49 6e 74 65 72 6e 61 6c 20 74 65 73 74 20 6f 6e 6c 79 21 20 44 6f 20 6e 6f 74 20 64 69 73 74 72 69 62 75 74 65 20 6f 75 74 73 69 64 65 20 79 6f 75 72 20 74 65 61 6d 21 } //1 Internal test only! Do not distribute outside your team!
		$a_01_2 = {62 66 33 37 33 34 37 38 2d 31 31 64 38 2d 34 31 39 32 2d 38 36 62 35 2d 32 64 33 66 30 33 34 31 64 64 64 63 } //1 bf373478-11d8-4192-86b5-2d3f0341dddc
		$a_01_3 = {32 61 65 37 65 64 65 62 2d 33 32 62 34 2d 34 39 66 36 2d 62 62 66 33 2d 32 33 61 35 30 65 30 63 30 62 62 66 } //1 2ae7edeb-32b4-49f6-bbf3-23a50e0c0bbf
		$a_01_4 = {37 38 36 61 38 64 65 31 2d 64 64 34 63 2d 34 30 63 61 2d 62 34 66 34 2d 36 34 66 32 38 64 64 36 32 37 33 38 } //1 786a8de1-dd4c-40ca-b4f4-64f28dd62738
		$a_01_5 = {65 37 32 37 39 36 65 38 2d 33 66 66 34 2d 34 31 35 35 2d 38 37 30 64 2d 37 39 37 64 63 32 64 37 64 31 66 35 } //1 e72796e8-3ff4-4155-870d-797dc2d7d1f5
		$a_01_6 = {65 31 61 62 61 65 63 33 2d 63 34 39 30 2d 34 66 38 66 2d 39 38 38 35 2d 39 65 30 64 62 34 39 30 66 32 32 64 } //1 e1abaec3-c490-4f8f-9885-9e0db490f22d
		$a_01_7 = {36 65 31 64 31 33 35 30 2d 34 30 33 35 2d 34 32 66 61 2d 38 38 37 63 2d 32 63 30 64 64 37 31 36 62 32 66 35 } //1 6e1d1350-4035-42fa-887c-2c0dd716b2f5
		$a_01_8 = {62 62 33 64 32 63 34 34 2d 61 31 37 36 2d 34 37 30 39 2d 61 62 33 63 2d 34 36 65 32 62 32 38 64 66 38 32 32 } //1 bb3d2c44-a176-4709-ab3c-46e2b28df822
		$a_01_9 = {64 32 62 31 36 30 65 33 2d 66 65 38 37 2d 34 62 65 39 2d 62 63 35 35 2d 62 64 36 32 63 63 64 38 36 38 33 63 } //1 d2b160e3-fe87-4be9-bc55-bd62ccd8683c
		$a_01_10 = {37 35 30 33 36 36 37 63 2d 34 35 37 35 2d 34 64 30 34 2d 62 65 39 34 2d 36 32 63 38 39 64 63 66 65 34 32 63 } //1 7503667c-4575-4d04-be94-62c89dcfe42c
		$a_01_11 = {65 63 37 38 63 61 66 33 2d 62 36 35 34 2d 34 36 39 30 2d 62 30 38 36 2d 66 61 65 37 34 36 64 37 66 61 66 31 } //1 ec78caf3-b654-4690-b086-fae746d7faf1
		$a_01_12 = {38 66 66 66 61 62 39 62 2d 33 37 30 34 2d 34 62 63 63 2d 38 30 37 66 2d 30 33 62 65 64 39 34 30 63 39 66 39 } //1 8fffab9b-3704-4bcc-807f-03bed940c9f9
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1) >=6
 
}
rule Spyware_Win32_MPSpyTestFile_2{
	meta:
		description = "Spyware:Win32/MPSpyTestFile,SIGNATURE_TYPE_PEHSTR,0c 00 06 00 0f 00 00 "
		
	strings :
		$a_01_0 = {4d 53 20 41 56 41 53 20 53 70 79 54 65 73 74 46 69 6c 65 } //1 MS AVAS SpyTestFile
		$a_01_1 = {49 6e 74 65 72 6e 61 6c 20 74 65 73 74 20 6f 6e 6c 79 21 20 44 6f 20 6e 6f 74 20 64 69 73 74 72 69 62 75 74 65 20 6f 75 74 73 69 64 65 20 79 6f 75 72 20 74 65 61 6d 21 } //1 Internal test only! Do not distribute outside your team!
		$a_01_2 = {68 41 67 42 41 41 43 4a 42 6d 61 42 66 67 53 7a 31 77 2b 46 77 77 41 41 41 47 54 67 52 71 41 50 38 32 36 49 50 6d } //1 hAgBAACJBmaBfgSz1w+FwwAAAGTgRqAP826IPm
		$a_01_3 = {47 24 4d 65 5a 4d 53 72 4e 6b 48 4b 41 4d 4b 65 2d 2b 54 47 46 32 33 70 45 56 32 36 63 71 50 54 34 58 61 } //1 G$MeZMSrNkHKAMKe-+TGF23pEV26cqPT4Xa
		$a_01_4 = {71 58 63 42 66 44 72 32 28 32 58 66 69 4d 72 6d 61 6c 24 44 2d 2d 28 4b 71 48 51 42 40 24 55 49 71 60 26 5b 64 4a 23 39 } //1 qXcBfDr2(2XfiMrmal$D--(KqHQB@$UIq`&[dJ#9
		$a_01_5 = {4a 65 40 65 70 28 4b 71 6c 6c 5b 24 56 6b 40 49 50 58 61 4e 48 65 23 6b 32 23 48 56 6b 59 4b 5a } //1 Je@ep(Kqll[$Vk@IPXaNHe#k2#HVkYKZ
		$a_01_6 = {53 49 50 45 65 29 49 39 21 36 6b 25 2c 42 27 35 6c 72 25 61 31 48 5b 71 6a 6d 28 2a 4b } //1 SIPEe)I9!6k%,B'5lr%a1H[qjm(*K
		$a_01_7 = {64 26 58 6a 66 48 33 6c 36 4a 72 50 56 6a 5b 24 59 5a 2a 42 71 28 70 50 63 50 52 2d 62 6c 51 5a 62 } //1 d&XjfH3l6JrPVj[$YZ*Bq(pPcPR-blQZb
		$a_01_8 = {48 56 4e 4e 41 26 40 52 31 21 63 50 21 43 36 53 2d 38 34 64 49 4b 6b 2b 26 69 33 71 34 4a 4b 71 44 64 29 23 34 55 41 47 34 } //1 HVNNA&@R1!cP!C6S-84dIKk+&i3q4JKqDd)#4UAG4
		$a_01_9 = {2d 4d 5a 44 4c 43 72 30 30 6b 26 32 4e 4a 2a 6a 6b 38 21 2c 40 42 27 48 40 60 6b 6d 23 5a 31 60 2b 6b 69 23 5b 55 2d 23 59 } //1 -MZDLCr00k&2NJ*jk8!,@B'H@`km#Z1`+ki#[U-#Y
		$a_01_10 = {39 4d 48 71 4b 36 6d 5a 45 62 55 42 44 26 58 40 65 2a 7a 50 26 5b 41 34 51 4d 61 40 43 40 26 70 } //1 9MHqK6mZEbUBD&X@e*zP&[A4QMa@C@&p
		$a_01_11 = {49 6d 59 70 6a 52 72 52 6d 52 69 72 6d 5b 6d 49 33 72 5a 61 32 63 49 6a 49 65 42 52 6a 49 62 48 24 49 31 61 49 63 49 69 69 5a } //1 ImYpjRrRmRirm[mI3rZa2cIjIeBRjIbH$I1aIcIiiZ
		$a_01_12 = {4d 6a 4e 72 52 63 70 54 30 4e 44 24 66 63 61 62 47 21 38 28 4d 29 29 35 47 70 44 49 47 4b 50 56 5a } //1 MjNrRcpT0ND$fcabG!8(M))5GpDIGKPVZ
		$a_01_13 = {4d 65 64 20 73 65 76 65 72 69 74 79 20 73 70 79 77 61 72 65 20 74 65 73 74 20 66 69 6c 65 } //-100 Med severity spyware test file
		$a_01_14 = {4c 6f 77 20 73 65 76 65 72 69 74 79 20 73 70 79 77 61 72 65 20 74 65 73 74 20 66 69 6c 65 } //-100 Low severity spyware test file
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*-100+(#a_01_14  & 1)*-100) >=6
 
}
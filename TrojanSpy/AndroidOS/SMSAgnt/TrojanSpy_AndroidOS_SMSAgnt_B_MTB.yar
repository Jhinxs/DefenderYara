
rule TrojanSpy_AndroidOS_SMSAgnt_B_MTB{
	meta:
		description = "TrojanSpy:AndroidOS/SMSAgnt.B!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,03 00 03 00 08 00 00 "
		
	strings :
		$a_01_0 = {47 61 6c 6c 65 72 79 45 79 65 55 70 6c 6f 61 64 65 72 2e 6b 74 } //1 GalleryEyeUploader.kt
		$a_01_1 = {47 61 6c 6c 65 72 79 45 79 65 52 75 6e 74 69 6d 65 50 65 72 6d 69 73 73 69 6f 6e 73 2e 6b 74 } //1 GalleryEyeRuntimePermissions.kt
		$a_01_2 = {47 61 6c 6c 65 72 79 45 79 65 4d 61 69 6e 41 63 74 69 76 69 74 79 2e 6b 74 } //1 GalleryEyeMainActivity.kt
		$a_01_3 = {47 61 6c 6c 65 72 79 45 79 65 46 6f 72 65 67 72 6f 75 6e 64 53 65 72 76 69 63 65 2e 6b 74 } //1 GalleryEyeForegroundService.kt
		$a_01_4 = {61 62 79 73 73 61 6c 61 72 6d 79 2f 67 61 6c 6c 65 72 79 65 79 66 2f 47 61 6c 6c 65 72 79 45 79 65 55 74 69 6c 73 2f 47 61 6c 6c 65 72 79 45 79 65 52 75 6e 74 69 6d 65 50 65 72 6d 69 73 73 69 6f 6e 73 24 67 72 61 6e 74 50 65 72 6d 69 73 73 69 6f 6e 73 } //1 abyssalarmy/galleryeyf/GalleryEyeUtils/GalleryEyeRuntimePermissions$grantPermissions
		$a_01_5 = {14 00 b7 a9 c0 5a 08 01 2b 00 72 20 e8 64 01 00 0c 0c 1a 01 54 2b 71 20 86 66 1c 00 dd 01 0b 01 38 01 05 00 de 01 0d 06 28 11 dd 01 0d 0e 39 01 0d 00 72 20 be 64 ec 00 0a 01 38 01 04 00 12 41 28 02 12 21 b6 d1 28 02 } //1
		$a_01_6 = {dd 11 0b 40 38 11 0b 00 15 11 18 00 96 01 01 11 02 12 01 00 05 00 20 00 28 1b 15 11 38 00 95 11 0d 11 02 2b 01 00 05 00 20 00 39 11 10 00 72 30 bd 64 0c 01 0a 12 38 12 05 00 15 12 10 00 28 03 15 12 08 00 96 12 2b 12 } //1
		$a_01_7 = {02 02 22 00 d5 b3 00 01 38 03 09 00 15 03 00 06 96 12 12 03 05 0e 23 00 28 15 15 03 00 0e b5 d3 05 0e 23 00 39 03 0f 00 72 30 bd 64 ec 0f 0a 03 38 03 05 00 15 03 00 04 28 03 15 03 00 02 96 12 12 03 d5 b3 00 02 38 03 09 00 15 03 00 30 96 12 12 03 05 0e 25 00 28 15 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=3
 
}
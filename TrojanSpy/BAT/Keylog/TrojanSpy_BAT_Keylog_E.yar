
rule TrojanSpy_BAT_Keylog_E{
	meta:
		description = "TrojanSpy:BAT/Keylog.E,SIGNATURE_TYPE_PEHSTR_EXT,11 00 11 00 06 00 00 "
		
	strings :
		$a_01_0 = {00 44 41 43 68 72 6f 6d 65 00 } //1 䐀䍁牨浯e
		$a_01_1 = {00 44 41 4f 70 65 72 61 00 } //1
		$a_01_2 = {00 44 41 53 74 65 61 6d 00 } //1
		$a_01_3 = {00 44 41 4d 65 6c 74 00 } //1 䐀䵁汥t
		$a_01_4 = {00 44 41 53 74 61 72 74 75 70 00 } //1
		$a_01_5 = {00 4b 59 42 52 44 4c 43 4b 00 } //15 䬀䉙䑒䍌K
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*15) >=17
 
}
rule TrojanSpy_BAT_Keylog_E_2{
	meta:
		description = "TrojanSpy:BAT/Keylog.E,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 07 00 00 "
		
	strings :
		$a_02_0 = {00 59 61 68 6f 6f 53 70 [0-03] 64 64 6c 6c 00 } //1
		$a_02_1 = {00 53 6b 79 70 65 53 70 [0-03] 64 64 6c 6c 00 } //1
		$a_00_2 = {6b 00 5a 00 33 00 45 00 78 00 63 00 61 00 6b 00 77 00 38 00 72 00 49 00 79 00 4a 00 47 00 54 00 7a 00 63 00 65 00 34 00 6d 00 72 00 37 00 50 00 79 00 37 00 57 00 68 00 77 00 37 00 63 00 55 00 00 0d 2a 00 2e 00 70 00 6e 00 67 00 2a 00 00 } //1
		$a_00_3 = {72 53 74 75 62 5c 4c 69 6d 69 74 6c 65 73 73 4c 6f 67 67 65 72 53 74 75 62 5c 6f 62 6a 5c 78 38 36 5c 44 65 62 75 67 5c 4c 4c 53 2e 70 64 62 00 } //1 卲畴屢楌業汴獥䱳杯敧卲畴屢扯屪㡸尶敄畢屧䱌⹓摰b
		$a_00_4 = {6b 65 79 63 68 61 69 6e 00 53 61 66 47 65 74 00 44 65 63 72 79 70 74 50 61 73 73 77 6f 72 64 00 70 77 42 75 66 66 65 72 00 43 6f 6e 76 65 72 74 } //1 敫捹慨湩匀晡敇t敄牣灹側獡睳牯d睰畂晦牥䌀湯敶瑲
		$a_00_5 = {56 4b 43 4f 00 53 43 43 4f 00 46 4c 47 53 00 54 49 45 4d 00 44 57 45 58 49 4e 00 } //1
		$a_00_6 = {4b 59 42 52 44 4c 43 4b 00 43 6f 64 65 00 57 50 41 00 } //1 奋剂䱄䭃䌀摯e偗A
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1) >=3
 
}
rule TrojanSpy_BAT_Keylog_E_3{
	meta:
		description = "TrojanSpy:BAT/Keylog.E,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 03 00 00 "
		
	strings :
		$a_01_0 = {59 00 70 00 71 00 70 00 72 00 4b 00 6d 00 43 00 6c 00 71 00 2b 00 32 00 56 00 57 00 6d 00 6c 00 6f 00 61 00 53 00 68 00 65 00 36 00 4f 00 76 00 59 00 33 00 75 00 49 00 6f 00 4b 00 6c 00 39 00 56 00 54 00 41 00 3d 00 } //5 YpqprKmClq+2VWmloaShe6OvY3uIoKl9VTA=
		$a_01_1 = {6c 00 5a 00 47 00 64 00 70 00 4a 00 5a 00 33 00 6b 00 70 00 32 00 6b 00 6c 00 6e 00 65 00 53 00 6e 00 61 00 53 00 57 00 64 00 35 00 4b 00 64 00 70 00 4a 00 5a 00 33 00 6b 00 70 00 32 00 6b 00 6c 00 6e 00 65 00 53 00 6e 00 61 00 53 00 57 00 64 00 35 00 4b 00 64 00 70 00 4a 00 5a 00 33 00 6b 00 70 00 32 00 6b 00 6c 00 6e 00 65 00 53 00 6e 00 61 00 53 00 57 00 64 00 35 00 4b 00 64 00 70 00 4a 00 5a 00 33 00 6b 00 72 00 50 00 62 00 76 00 70 00 76 00 42 00 78 00 64 00 6e 00 4d 00 64 00 35 00 4b 00 64 00 70 00 4a 00 5a 00 33 00 6b 00 70 00 32 00 6b 00 6c 00 6e 00 65 00 53 00 6e 00 61 00 53 00 57 00 64 00 35 00 4b 00 } //5 lZGdpJZ3kp2klneSnaSWd5KdpJZ3kp2klneSnaSWd5KdpJZ3kp2klneSnaSWd5KdpJZ3krPbvpvBxdnMd5KdpJZ3kp2klneSnaSWd5K
		$a_01_2 = {00 4b 59 42 52 44 4c 43 4b 00 } //1 䬀䉙䑒䍌K
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*5+(#a_01_2  & 1)*1) >=6
 
}
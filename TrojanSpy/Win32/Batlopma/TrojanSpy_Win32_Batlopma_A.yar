
rule TrojanSpy_Win32_Batlopma_A{
	meta:
		description = "TrojanSpy:Win32/Batlopma.A,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 14 00 00 "
		
	strings :
		$a_01_0 = {46 44 31 36 31 33 32 37 33 38 33 33 30 36 30 34 30 37 31 46 35 31 43 41 35 37 45 39 34 46 33 44 43 44 36 39 45 34 37 45 39 42 41 42 42 42 45 33 31 39 30 45 31 38 32 33 32 38 33 38 43 35 33 43 42 42 38 38 38 44 45 41 36 42 43 43 35 39 46 30 36 44 46 } //2 FD16132738330604071F51CA57E94F3DCD69E47E9BABBBE3190E18232838C53CBB888DEA6BCC59F06DF
		$a_01_1 = {38 34 38 45 39 35 41 36 38 35 38 35 39 33 42 45 35 41 45 37 32 31 31 34 32 30 32 41 32 31 32 37 32 33 30 42 30 30 31 37 33 44 33 46 43 39 33 37 42 35 35 42 45 42 34 33 43 30 35 33 44 46 30 35 31 35 33 41 32 42 34 44 44 36 35 42 33 46 } //2 848E95A6858593BE5AE72114202A2127230B00173D3FC937B55BEB43C053DF05153A2B4DD65B3F
		$a_01_2 = {46 34 31 39 32 30 33 37 33 42 43 30 42 35 35 34 43 44 35 39 39 37 38 45 38 37 39 35 45 43 36 30 46 43 31 39 38 35 38 43 46 43 31 31 31 33 35 39 41 44 41 44 38 36 38 38 39 43 42 41 34 43 42 42 33 30 32 32 32 35 36 46 } //2 F41920373BC0B554CD59978E8795EC60FC19858CFC111359ADAD86889CBA4CBB3022256F
		$a_01_3 = {43 45 35 41 33 32 31 45 37 44 38 35 38 31 38 30 39 42 46 30 37 34 39 35 41 32 41 36 42 36 35 37 33 38 33 34 32 30 31 38 33 42 43 31 34 43 39 39 44 42 34 43 44 31 44 36 34 38 32 37 } //2 CE5A321E7D8581809BF07495A2A6B657383420183BC14C99DB4CD1D64827
		$a_01_4 = {34 33 32 46 30 37 37 35 44 36 36 42 45 46 31 31 33 34 31 46 34 30 44 43 37 38 38 32 39 41 42 34 39 42 39 37 42 46 38 37 38 41 39 32 41 33 44 30 43 45 } //2 432F0775D66BEF11341F40DC78829AB49B97BF878A92A3D0CE
		$a_01_5 = {38 30 45 39 34 32 32 45 30 44 31 35 33 31 44 30 37 34 44 46 30 36 31 45 32 32 33 45 30 37 31 39 31 31 37 39 39 42 38 37 39 43 41 42 34 35 42 36 43 43 34 37 43 31 34 43 34 34 35 39 45 42 32 43 } //2 80E9422E0D1531D074DF061E223E071911799B879CAB45B6CC47C14C4459EB2C
		$a_01_6 = {35 41 39 46 34 44 46 45 32 45 44 44 31 46 30 35 36 33 44 41 30 41 32 33 43 37 } //2 5A9F4DFE2EDD1F0563DA0A23C7
		$a_01_7 = {41 32 41 45 35 43 46 43 32 32 33 43 46 42 33 43 43 42 37 41 44 38 31 39 32 45 44 43 31 33 44 30 30 43 43 44 } //2 A2AE5CFC223CFB3CCB7AD8192EDC13D00CCD
		$a_01_8 = {38 34 38 31 42 42 36 34 39 42 34 46 43 41 36 41 38 44 42 42 31 34 44 32 30 45 31 34 32 30 44 46 30 30 33 41 45 41 } //2 8481BB649B4FCA6A8DBB14D20E1420DF003AEA
		$a_01_9 = {39 33 38 36 42 43 37 30 39 36 34 37 45 30 31 31 44 31 42 41 33 35 46 38 32 31 43 32 36 42 38 46 42 42 36 36 } //2 9386BC709647E011D1BA35F821C26B8FBB66
		$a_01_10 = {46 37 36 35 39 43 34 44 46 37 32 41 44 41 41 44 41 34 34 36 38 44 41 39 35 46 38 42 } //2 F7659C4DF72ADAADA4468DA95F8B
		$a_01_11 = {36 30 46 37 32 46 45 38 31 31 33 33 43 41 37 42 43 46 35 44 46 33 33 33 44 30 37 38 42 45 36 35 } //2 60F72FE81133CA7BCF5DF333D078BE65
		$a_01_12 = {43 44 34 34 43 44 35 42 45 39 37 39 45 46 } //1 CD44CD5BE979EF
		$a_01_13 = {34 42 32 33 43 44 36 45 41 31 } //1 4B23CD6EA1
		$a_01_14 = {30 30 32 45 43 37 37 41 41 36 35 43 39 30 41 42 34 43 32 37 36 33 39 39 34 46 } //1 002EC77AA65C90AB4C2763994F
		$a_01_15 = {37 38 45 37 31 32 33 32 45 36 30 32 37 37 43 45 41 37 35 30 34 37 } //1 78E71232E60277CEA75047
		$a_01_16 = {42 43 35 43 38 41 45 42 31 32 43 34 37 42 42 39 37 41 44 31 43 36 42 45 37 41 44 33 41 41 41 33 35 43 39 38 35 31 32 39 30 41 } //2 BC5C8AEB12C47BB97AD1C6BE7AD3AAA35C9851290A
		$a_01_17 = {36 34 45 32 36 43 46 45 30 39 31 41 33 36 44 35 37 36 44 44 33 38 32 42 30 33 37 44 39 46 42 45 39 31 42 32 34 31 45 31 30 32 32 46 44 42 37 36 45 42 34 42 46 42 33 42 46 30 } //2 64E26CFE091A36D576DD382B037D9FBE91B241E1022FDB76EB4BFB3BF0
		$a_01_18 = {36 42 45 35 36 46 38 33 38 44 39 36 38 41 38 31 39 39 46 32 31 37 30 38 36 30 43 30 35 33 46 32 35 43 46 37 33 39 46 33 33 33 45 31 30 32 30 38 35 44 38 34 41 32 } //2 6BE56F838D968A8199F2170860C053F25CF739F333E102085D84A2
		$a_01_19 = {39 34 42 32 42 42 34 45 44 41 36 38 45 34 36 36 45 36 34 43 34 45 43 31 41 39 39 37 42 39 35 35 33 41 45 38 30 42 32 35 44 41 30 30 32 41 39 41 46 38 30 46 43 43 37 44 } //2 94B2BB4EDA68E466E64C4EC1A997B9553AE80B25DA002A9AF80FCC7D
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_01_6  & 1)*2+(#a_01_7  & 1)*2+(#a_01_8  & 1)*2+(#a_01_9  & 1)*2+(#a_01_10  & 1)*2+(#a_01_11  & 1)*2+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_01_16  & 1)*2+(#a_01_17  & 1)*2+(#a_01_18  & 1)*2+(#a_01_19  & 1)*2) >=3
 
}
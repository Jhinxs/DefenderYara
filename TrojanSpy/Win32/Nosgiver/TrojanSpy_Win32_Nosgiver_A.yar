
rule TrojanSpy_Win32_Nosgiver_A{
	meta:
		description = "TrojanSpy:Win32/Nosgiver.A,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 06 00 00 "
		
	strings :
		$a_00_0 = {5c 5c 2e 5c 4b 45 52 4e 45 4c 44 52 49 56 45 52 } //1 \\.\KERNELDRIVER
		$a_00_1 = {23 00 5b 00 5b 00 25 00 73 00 5d 00 5d 00 23 00 } //1 #[[%s]]#
		$a_02_2 = {42 39 c2 7c f4 89 1c 24 b8 ?? ?? 41 00 89 44 24 04 e8 ?? ?? 00 00 a3 ?? ?? 41 00 83 ec 08 } //1
		$a_02_3 = {6b 65 72 6e 65 6c 64 72 69 76 65 72 5c [0-20] 5c 50 47 50 73 63 2e 70 64 62 } //1
		$a_00_4 = {25 00 73 00 5c 00 73 00 79 00 73 00 74 00 65 00 6d 00 33 00 32 00 5c 00 77 00 75 00 70 00 64 00 6d 00 67 00 72 00 2e 00 65 00 78 00 65 00 } //1 %s\system32\wupdmgr.exe
		$a_00_5 = {25 00 73 00 5c 00 73 00 79 00 73 00 74 00 65 00 6d 00 33 00 32 00 5c 00 73 00 69 00 67 00 76 00 65 00 72 00 69 00 } //1 %s\system32\sigveri
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_02_2  & 1)*1+(#a_02_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=6
 
}
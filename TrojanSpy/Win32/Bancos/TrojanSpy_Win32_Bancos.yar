
rule TrojanSpy_Win32_Bancos{
	meta:
		description = "TrojanSpy:Win32/Bancos,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 05 00 00 "
		
	strings :
		$a_01_0 = {62 61 6e 61 6d 65 78 2e 63 6f 6d } //1 banamex.com
		$a_01_1 = {63 6d 64 47 65 74 49 50 } //1 cmdGetIP
		$a_01_2 = {75 70 6c 6f 61 64 69 6e 66 6f } //1 uploadinfo
		$a_01_3 = {5c 00 47 00 65 00 74 00 49 00 50 00 41 00 64 00 64 00 72 00 65 00 73 00 4c 00 69 00 73 00 74 00 46 00 72 00 6f 00 6d 00 48 00 6f 00 73 00 74 00 5c 00 46 00 6f 00 72 00 52 00 6f 00 62 00 6f 00 74 00 5c 00 49 00 50 00 76 00 36 00 43 00 68 00 61 00 74 00 2e 00 76 00 62 00 70 00 } //5 \GetIPAddresListFromHost\ForRobot\IPv6Chat.vbp
		$a_01_4 = {2f 00 7e 00 73 00 6f 00 75 00 6c 00 65 00 72 00 69 00 61 00 2f 00 63 00 73 00 73 00 2f 00 61 00 2e 00 70 00 68 00 70 00 3f 00 61 00 3d 00 } //5 /~souleria/css/a.php?a=
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*5+(#a_01_4  & 1)*5) >=12
 
}
rule TrojanSpy_Win32_Bancos_2{
	meta:
		description = "TrojanSpy:Win32/Bancos,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 05 00 00 "
		
	strings :
		$a_01_0 = {66 72 6d 53 6e 69 66 66 } //5 frmSniff
		$a_01_1 = {3f 00 70 00 72 00 6f 00 63 00 65 00 73 00 6f 00 3d 00 6c 00 69 00 73 00 74 00 61 00 5f 00 63 00 75 00 65 00 6e 00 74 00 61 00 73 00 5f 00 6f 00 74 00 72 00 6f 00 73 00 5f 00 62 00 61 00 6e 00 63 00 6f 00 73 00 5f 00 70 00 72 00 } //5 ?proceso=lista_cuentas_otros_bancos_pr
		$a_01_2 = {26 00 61 00 63 00 63 00 69 00 6f 00 6e 00 3d 00 64 00 65 00 73 00 70 00 6c 00 69 00 65 00 67 00 61 00 5f 00 6d 00 61 00 72 00 63 00 6f 00 } //1 &accion=despliega_marco
		$a_01_3 = {26 00 61 00 63 00 63 00 69 00 6f 00 6e 00 3d 00 63 00 61 00 70 00 74 00 75 00 72 00 61 00 5f 00 64 00 61 00 74 00 6f 00 73 00 } //1 &accion=captura_datos
		$a_01_4 = {72 00 65 00 73 00 74 00 61 00 62 00 6c 00 65 00 63 00 65 00 72 00 6c 00 69 00 6e 00 6b 00 73 00 28 00 29 00 3b 00 } //1 restablecerlinks();
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*5+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=11
 
}
rule TrojanSpy_Win32_Bancos_3{
	meta:
		description = "TrojanSpy:Win32/Bancos,SIGNATURE_TYPE_PEHSTR_EXT,08 00 04 00 08 00 00 "
		
	strings :
		$a_01_0 = {45 38 44 43 37 43 31 46 46 39 42 32 37 45 32 42 45 34 44 32 38 33 34 32 34 43 43 36 38 43 37 38 37 37 43 31 41 38 37 33 33 36 31 34 44 36 39 34 35 45 33 34 45 32 42 32 37 34 37 33 44 42 42 41 36 } //1 E8DC7C1FF9B27E2BE4D283424CC68C7877C1A8733614D6945E34E2B27473DBBA6
		$a_01_1 = {46 31 44 37 37 42 32 36 46 32 42 42 36 37 32 30 45 44 41 44 38 41 34 42 35 33 43 46 38 37 34 37 37 45 43 41 42 31 37 41 33 44 45 44 44 31 39 44 34 37 33 33 45 42 38 39 37 33 37 41 43 30 41 33 36 } //1 F1D77B26F2BB6720EDAD8A4B53CF87477ECAB17A3DEDD19D4733EB89737AC0A36
		$a_01_2 = {45 30 38 34 41 35 36 34 30 37 43 37 38 30 37 31 32 45 45 37 39 33 34 44 32 42 30 38 44 34 39 39 34 30 30 42 43 31 38 35 37 45 37 35 43 30 42 39 36 41 32 37 30 39 44 37 39 43 30 42 32 30 43 38 42 } //1 E084A56407C780712EE7934D2B08D499400BC1857E75C0B96A2709D79C0B20C8B
		$a_01_3 = {43 30 32 35 31 46 45 42 39 36 33 34 41 38 39 43 30 37 44 33 37 46 39 41 45 36 44 32 31 31 39 44 38 44 46 34 46 30 41 43 44 46 30 33 36 31 36 43 45 38 45 34 34 37 34 33 36 46 30 41 33 30 39 32 36 } //1 C0251FEB9634A89C07D37F9AE6D2119D8DF4F0ACDF03616CE8E447436F0A30926
		$a_01_4 = {46 34 38 32 31 44 37 39 46 35 34 30 42 46 32 42 36 34 45 30 38 46 30 42 33 39 32 35 37 30 31 43 42 39 42 37 46 31 43 45 42 42 42 37 39 33 41 45 31 43 44 44 41 37 43 30 41 43 36 39 35 37 41 32 38 } //1 F4821D79F540BF2B64E08F0B3925701CB9B7F1CEBBB793AE1CDDA7C0AC6957A28
		$a_01_5 = {46 41 41 42 35 38 30 44 43 33 38 45 35 42 30 31 32 33 46 37 39 43 34 43 31 38 43 41 39 33 37 35 33 33 45 34 39 37 35 32 32 39 31 35 44 32 39 45 35 43 31 35 46 44 39 46 36 33 32 33 46 45 41 32 36 } //1 FAAB580DC38E5B0123F79C4C18CA937533E497522915D29E5C15FD9F6323FEA26
		$a_01_6 = {45 32 38 36 41 42 37 30 31 45 44 36 39 37 37 35 32 31 46 44 42 45 32 37 32 36 31 38 39 38 41 33 35 46 30 37 43 34 41 43 37 39 33 45 45 46 42 41 35 46 37 39 31 42 45 34 38 33 35 43 30 33 46 36 42 } //1 E286AB701ED6977521FDBE27261898A35F07C4AC793EEFBA5F791BE4835C03F6B
		$a_01_7 = {44 38 39 46 35 33 36 46 33 33 46 43 42 30 36 35 30 45 46 32 41 33 36 33 32 33 45 42 39 31 39 38 34 33 34 32 39 44 44 39 37 45 31 38 46 36 41 36 36 30 31 34 44 31 44 31 39 36 34 37 33 32 45 35 41 } //1 D89F536F33FCB0650EF2A36323EB919843429DD97E18F6A66014D1D1964732E5A
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=4
 
}
rule TrojanSpy_Win32_Bancos_4{
	meta:
		description = "TrojanSpy:Win32/Bancos,SIGNATURE_TYPE_PEHSTR,20 00 1f 00 05 00 00 "
		
	strings :
		$a_01_0 = {73 6f 66 74 77 61 72 65 5c 62 6f 72 6c 61 6e 64 5c 64 65 6c 70 68 69 5c 72 74 6c } //10 software\borland\delphi\rtl
		$a_01_1 = {72 33 74 6f 34 2e 70 61 73 } //10 r3to4.pas
		$a_01_2 = {68 74 74 70 73 3a 2f 2f 62 61 6e 6b 6c 69 6e 65 2e 69 74 61 75 2e 63 6f 6d 2e 62 72 2f 47 52 49 50 4e 45 54 2f 62 6b 6c 63 67 69 2e 65 78 65 } //10 https://bankline.itau.com.br/GRIPNET/bklcgi.exe
		$a_01_3 = {63 3a 5c 74 65 78 74 2e 74 78 74 } //1 c:\text.txt
		$a_01_4 = {6f 70 3d 37 42 43 33 43 33 46 44 42 32 36 43 36 39 36 31 46 38 37 39 41 36 46 46 35 39 38 33 46 41 36 32 34 43 35 45 31 39 34 42 38 37 37 39 32 41 44 37 44 44 43 46 30 46 46 39 42 39 42 46 31 37 } //1 op=7BC3C3FDB26C6961F879A6FF5983FA624C5E194B87792AD7DDCF0FF9B9BF17
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=31
 
}
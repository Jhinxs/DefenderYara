
rule TrojanSpy_Win32_Bancos_ML{
	meta:
		description = "TrojanSpy:Win32/Bancos.ML,SIGNATURE_TYPE_PEHSTR_EXT,ffffffb5 00 ffffff97 00 0e 00 00 "
		
	strings :
		$a_01_0 = {37 36 38 36 42 45 36 36 39 41 33 35 39 37 34 31 45 41 32 42 41 33 35 38 46 42 } //50 7686BE669A359741EA2BA358FB
		$a_01_1 = {43 36 34 33 45 37 31 46 44 46 36 35 46 35 32 33 43 34 31 33 35 33 46 38 31 41 42 35 31 35 44 46 30 36 35 39 38 38 44 35 36 37 39 31 35 33 38 33 43 34 30 42 33 30 43 31 34 36 45 33 30 45 43 43 30 34 33 38 45 44 30 42 33 31 46 36 33 44 46 31 32 43 44 39 37 41 45 46 32 39 44 36 30 45 33 30 39 36 42 41 31 39 32 33 33 46 45 38 30 46 42 46 37 38 39 35 34 32 33 37 33 36 41 39 32 35 41 31 33 30 45 37 34 32 44 39 37 36 41 42 35 35 46 45 34 30 38 37 44 31 } //50 C643E71FDF65F523C41353F81AB515DF065988D567915383C40B30C146E30ECC0438ED0B31F63DF12CD97AEF29D60E3096BA19233FE80FBF7895423736A925A130E742D976AB55FE4087D1
		$a_01_2 = {41 36 41 30 34 35 46 41 32 33 41 38 33 39 45 30 30 41 35 34 39 32 42 46 36 35 45 45 36 45 42 36 36 46 45 30 31 30 35 44 46 45 32 39 43 34 31 44 42 41 30 35 33 36 44 46 36 30 38 44 35 38 38 36 44 44 30 36 33 42 44 45 30 35 32 32 43 32 37 42 41 37 35 35 46 44 35 33 38 41 42 35 36 46 39 33 33 32 44 36 37 44 38 46 38 42 41 34 34 33 38 33 42 44 36 42 39 37 45 32 36 32 46 35 35 31 46 35 36 43 39 42 46 31 30 39 32 31 43 30 36 32 38 33 43 34 30 43 35 41 } //50 A6A045FA23A839E00A5492BF65EE6EB66FE0105DFE29C41DBA0536DF608D5886DD063BDE0522C27BA755FD538AB56F9332D67D8F8BA44383BD6B97E262F551F56C9BF10921C06283C40C5A
		$a_00_3 = {2c 00 00 00 4b 3a 5c 74 72 61 6d 70 6f 5c 69 65 68 65 6c 70 65 72 5c } //20
		$a_00_4 = {2b 00 00 00 4b 3a 5c 74 72 61 6d 70 6f 5c 69 65 68 65 6c 70 65 72 5c } //20
		$a_00_5 = {27 00 00 00 44 3a 5c 74 72 61 6d 70 6f 5c 69 65 68 65 6c 70 65 72 5c } //20
		$a_01_6 = {31 36 32 35 43 43 36 43 44 36 37 33 44 31 37 38 41 42 45 44 31 35 30 41 37 45 44 38 37 38 42 32 41 39 33 39 45 45 } //5 1625CC6CD673D178ABED150A7ED878B2A939EE
		$a_01_7 = {38 39 41 41 34 46 45 31 31 44 36 33 41 38 41 41 } //5 89AA4FE11D63A8AA
		$a_01_8 = {31 45 31 34 32 38 44 42 34 32 39 46 45 33 35 39 46 31 36 43 45 42 35 46 45 44 30 34 37 42 39 33 41 38 44 45 36 32 39 43 46 35 32 34 44 43 } //5 1E1428DB429FE359F16CEB5FED047B93A8DE629CF524DC
		$a_01_9 = {41 36 41 42 41 46 41 37 42 43 33 39 34 46 44 43 36 34 42 35 31 39 43 43 37 42 } //5 A6ABAFA7BC394FDC64B519CC7B
		$a_01_10 = {42 41 37 41 42 42 36 31 39 44 32 33 36 45 44 36 34 41 46 33 35 38 38 42 42 38 31 35 37 33 38 32 } //5 BA7ABB619D236ED64AF3588BB8157382
		$a_01_11 = {36 34 39 45 35 35 39 36 42 42 32 44 39 32 42 43 36 33 46 41 35 44 } //5 649E5596BB2D92BC63FA5D
		$a_00_12 = {41 6d 62 69 65 6e 74 65 20 53 65 67 75 72 6f 20 2d 20 49 6e 74 65 72 6e 65 74 20 42 61 6e 6b 69 6e 67 20 43 41 49 58 41 } //1 Ambiente Seguro - Internet Banking CAIXA
		$a_00_13 = {42 72 61 64 65 73 63 6f 20 4e 65 74 20 45 6d 70 72 65 73 61 20 2d 20 4d 69 63 72 6f 73 6f 66 74 20 49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 } //1 Bradesco Net Empresa - Microsoft Internet Explorer
	condition:
		((#a_01_0  & 1)*50+(#a_01_1  & 1)*50+(#a_01_2  & 1)*50+(#a_00_3  & 1)*20+(#a_00_4  & 1)*20+(#a_00_5  & 1)*20+(#a_01_6  & 1)*5+(#a_01_7  & 1)*5+(#a_01_8  & 1)*5+(#a_01_9  & 1)*5+(#a_01_10  & 1)*5+(#a_01_11  & 1)*5+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1) >=151
 
}
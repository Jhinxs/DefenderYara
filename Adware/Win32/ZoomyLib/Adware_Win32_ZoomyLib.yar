
rule Adware_Win32_ZoomyLib{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_01_0 = {49 6e 73 74 61 6c 6c 65 72 55 74 69 6c 73 2e 64 6c 6c 00 43 49 00 43 4e 47 00 48 52 4e 00 4b 42 73 00 52 53 00 57 41 4d 00 67 43 55 44 00 67 49 44 00 69 43 50 4f 00 6f 49 53 00 72 4f 41 00 72 56 46 00 73 49 44 46 00 75 44 47 00 75 50 56 00 } //1 湉瑳污敬啲楴獬搮汬䌀I乃G剈N䉋s卒圀䵁最啃D䥧D䍩佐漀卉爀䅏爀䙖猀䑉F䑵G偵V
	condition:
		((#a_01_0  & 1)*1) >=1
 
}
rule Adware_Win32_ZoomyLib_2{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 06 00 00 "
		
	strings :
		$a_01_0 = {61 64 62 6c 6f 63 6b 65 72 00 } //1 摡汢捯敫r
		$a_01_1 = {62 6f 6f 73 74 77 65 62 61 70 70 00 } //1 潢獯睴扥灡p
		$a_01_2 = {6e 65 74 73 70 65 65 64 61 70 70 00 } //1 敮獴数摥灡p
		$a_03_3 = {53 6f 66 74 77 61 72 65 5c 31 [30-39] [30-39] 5f 33 31 } //10
		$a_01_4 = {7b 39 31 39 31 39 31 39 2d 39 31 39 31 39 2d 39 31 39 31 39 2d 39 31 39 31 39 31 39 31 39 31 39 7d } //10 {9191919-91919-91919-91919191919}
		$a_01_5 = {6d 61 63 3d 31 31 32 32 33 33 34 34 35 35 36 36 } //10 mac=112233445566
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_03_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*10) >=31
 
}
rule Adware_Win32_ZoomyLib_3{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,09 00 09 00 06 00 00 "
		
	strings :
		$a_01_0 = {7a 6f 6f 6d 75 74 69 6c 33 32 2e 64 6c 6c } //1 zoomutil32.dll
		$a_01_1 = {61 70 70 75 74 69 6c 33 32 2e 64 6c 6c } //1 apputil32.dll
		$a_01_2 = {49 6e 20 43 61 6c 6c 4a 53 2e 49 6e 76 6f 6b 65 20 2d 3e 20 30 78 25 30 38 58 } //2 In CallJS.Invoke -> 0x%08X
		$a_01_3 = {4c 6f 61 64 49 45 42 67 57 49 6e 64 6f 77 } //2 LoadIEBgWIndow
		$a_01_4 = {63 6f 6e 74 65 6e 74 2f 64 67 6d 61 69 6e 2e 6a 73 } //2 content/dgmain.js
		$a_01_5 = {63 6f 6e 74 65 6e 74 2f 6a 71 75 65 72 79 34 74 6f 6f 6c 62 61 72 2e 6a 73 } //2 content/jquery4toolbar.js
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2) >=9
 
}
rule Adware_Win32_ZoomyLib_4{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {44 00 6f 00 73 00 44 00 65 00 76 00 69 00 63 00 65 00 73 00 5c 00 74 00 61 00 6d 00 6d 00 67 00 31 00 31 00 } //1 DosDevices\tammg11
		$a_01_1 = {83 7d 24 26 74 16 83 7d 24 03 74 10 83 7d 24 25 74 0a 83 7d 24 0c 0f 85 d7 02 00 00 8b 45 1c 89 85 f8 fb ff ff 83 a5 e8 fb ff ff 00 68 4f 46 49 52 68 00 04 00 00 6a 01 ff 15 } //1
		$a_03_2 = {55 8b ec 51 c7 45 fc 65 03 00 c0 e8 ?? ?? ?? ?? 0f b6 c0 85 c0 74 34 e8 ?? ?? ?? ?? 0f b6 c0 85 c0 74 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1) >=3
 
}
rule Adware_Win32_ZoomyLib_5{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_03_0 = {48 8b f8 ff 15 ?? ?? ?? ?? 8b d8 85 c0 74 10 ba 20 4e 00 00 48 8b cf ff 15 ?? ?? ?? ?? eb 05 e8 ?? ?? ?? ?? 85 db 75 db 33 c9 e8 ?? ?? ?? ?? cc 48 8b c4 55 48 8d a8 98 fc ff ff 48 81 ec 60 04 00 00 } //1
		$a_03_1 = {48 8b 5c 24 20 48 8b cb ff 15 ?? ?? ?? ?? 48 85 c0 74 18 48 8d 15 ?? ?? ?? ?? 48 8b c8 ff 15 ?? ?? ?? ?? 48 85 c0 74 03 ff d0 } //1
		$a_01_2 = {48 8d 53 e8 f0 83 42 10 ff 7f 16 48 8b 0a 48 8b 01 ff 50 08 eb 0b } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
rule Adware_Win32_ZoomyLib_6{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_03_0 = {8b 40 30 0f b6 40 02 89 45 fc 39 7d fc 74 0e 68 20 4e 00 00 56 ff 15 ?? ?? ?? ?? eb 05 e8 0c 00 00 00 39 7d fc 75 d3 57 e8 ?? ?? ?? ?? cc 55 81 ec 10 04 00 00 8d 6c 24 fc a1 ?? ?? ?? ?? 33 c5 89 85 10 04 00 00 6a 04 } //1
		$a_03_1 = {8b 75 f0 56 ff 15 ?? ?? ?? ?? 85 c0 74 12 68 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 85 c0 74 02 ff d0 } //1
		$a_01_2 = {83 c6 f0 83 c9 ff 89 4d fc 8d 46 0c f0 0f c1 08 49 85 c9 7f 08 8b 0e 56 8b 01 ff 50 04 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
rule Adware_Win32_ZoomyLib_7{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,15 00 15 00 05 00 00 "
		
	strings :
		$a_01_0 = {6b 6c 65 2e 61 75 73 74 72 69 65 73 2e 63 6f 6d 2f 61 6d 6d 2f 72 61 70 70 73 2f 25 73 5f 25 73 2f 25 73 2f 6c 6f 61 64 65 72 2e 6a 73 3f 64 3d 74 } //10 kle.austries.com/amm/rapps/%s_%s/%s/loader.js?d=t
		$a_01_1 = {5f 00 5f 00 41 00 47 00 54 00 5f 00 57 00 4e 00 44 00 43 00 4c 00 41 00 53 00 53 00 5f 00 50 00 58 00 5f 00 5f 00 } //10 __AGT_WNDCLASS_PX__
		$a_01_2 = {61 00 64 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 72 00 00 00 } //1
		$a_01_3 = {62 00 6f 00 6f 00 73 00 74 00 77 00 65 00 62 00 61 00 70 00 70 00 00 00 } //1
		$a_01_4 = {6e 00 65 00 74 00 73 00 70 00 65 00 65 00 64 00 61 00 70 00 70 00 00 00 } //1
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=21
 
}
rule Adware_Win32_ZoomyLib_8{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,09 00 09 00 06 00 00 "
		
	strings :
		$a_01_0 = {65 00 61 00 7a 00 79 00 7a 00 6f 00 6f 00 6d 00 00 00 } //1
		$a_01_1 = {6e 00 65 00 74 00 73 00 70 00 65 00 65 00 64 00 61 00 70 00 70 00 00 00 } //1
		$a_01_2 = {3f 00 74 00 79 00 70 00 65 00 3d 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 72 00 65 00 67 00 } //2 ?type=install_reg
		$a_01_3 = {44 00 6f 00 73 00 44 00 65 00 76 00 69 00 63 00 65 00 73 00 5c 00 74 00 61 00 6d 00 6d 00 67 00 46 00 31 00 31 00 } //2 DosDevices\tammgF11
		$a_01_4 = {41 00 47 00 20 00 46 00 69 00 6c 00 74 00 65 00 72 00 20 00 44 00 72 00 69 00 76 00 65 00 72 00 } //2 AG Filter Driver
		$a_01_5 = {74 00 61 00 6d 00 6d 00 67 00 2e 00 73 00 79 00 73 00 } //2 tammg.sys
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2) >=9
 
}
rule Adware_Win32_ZoomyLib_9{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,48 00 48 00 07 00 00 "
		
	strings :
		$a_01_0 = {4c 6f 61 64 49 45 42 67 57 49 6e 64 6f 77 } //1 LoadIEBgWIndow
		$a_01_1 = {5f 00 5f 00 41 00 47 00 54 00 5f 00 57 00 4e 00 44 00 43 00 4c 00 41 00 53 00 53 00 5f 00 50 00 58 00 5f 00 5f 00 } //1 __AGT_WNDCLASS_PX__
		$a_01_2 = {73 00 33 00 2e 00 7a 00 61 00 77 00 73 00 73 00 2e 00 69 00 6e 00 66 00 6f 00 2f 00 63 00 6c 00 69 00 65 00 6e 00 74 00 2d 00 63 00 6d 00 64 00 2f 00 63 00 72 00 2e 00 68 00 74 00 6d 00 6c 00 } //1 s3.zawss.info/client-cmd/cr.html
		$a_81_3 = {61 64 62 6c 6f 63 6b 65 72 00 } //8 摡汢捯敫r
		$a_81_4 = {62 6f 6f 73 74 77 65 62 61 70 70 00 } //8 潢獯睴扥灡p
		$a_81_5 = {6e 65 74 73 70 65 65 64 61 70 70 00 } //8 敮獴数摥灡p
		$a_03_6 = {74 61 6d 6d 67 31 [30-39] [30-39] 00 } //64
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_81_3  & 1)*8+(#a_81_4  & 1)*8+(#a_81_5  & 1)*8+(#a_03_6  & 1)*64) >=72
 
}
rule Adware_Win32_ZoomyLib_10{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 05 00 00 "
		
	strings :
		$a_01_0 = {70 00 65 00 6e 00 6e 00 79 00 62 00 65 00 65 00 } //10 pennybee
		$a_01_1 = {61 00 67 00 72 00 65 00 70 00 2f 00 62 00 68 00 6f 00 2f 00 72 00 65 00 70 00 6f 00 72 00 74 00 2e 00 70 00 68 00 70 00 } //1 agrep/bho/report.php
		$a_01_2 = {77 00 73 00 2e 00 78 00 63 00 6f 00 64 00 65 00 6c 00 69 00 62 00 2e 00 6e 00 65 00 74 00 } //1 ws.xcodelib.net
		$a_01_3 = {49 6e 20 43 61 6c 6c 4a 53 2e 49 6e 76 6f 6b 65 20 2d 3e 20 30 78 25 30 38 58 } //1 In CallJS.Invoke -> 0x%08X
		$a_01_4 = {28 43 68 61 6e 67 69 6e 67 20 55 52 4c 29 20 46 69 65 6c 64 20 4e 61 6d 65 3a 20 25 73 2c 20 55 52 4c 3a 20 25 73 2c 20 68 57 6e 64 3a 20 30 78 25 30 38 58 2c 20 45 76 65 6e 74 3a 20 30 78 25 30 38 58 } //1 (Changing URL) Field Name: %s, URL: %s, hWnd: 0x%08X, Event: 0x%08X
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=12
 
}
rule Adware_Win32_ZoomyLib_11{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 06 00 00 "
		
	strings :
		$a_01_0 = {49 6e 20 43 61 6c 6c 4a 53 2e 49 6e 76 6f 6b 65 20 2d 3e 20 30 78 25 30 38 58 } //1 In CallJS.Invoke -> 0x%08X
		$a_01_1 = {69 6e 20 44 69 73 70 49 6e 76 6f 6b 65 3a 20 53 65 61 72 63 68 69 6e 67 20 2d 3e 20 25 73 } //1 in DispInvoke: Searching -> %s
		$a_01_2 = {63 6f 6e 74 65 6e 74 2f 6a 71 75 65 72 79 34 74 6f 6f 6c 62 61 72 2e 6a 73 } //1 content/jquery4toolbar.js
		$a_01_3 = {5f 5f 47 4c 4f 42 41 4c 5f 49 4e 53 54 41 4c 4c 45 52 5f 43 50 50 5f 43 42 5f 46 55 4e 43 54 49 4f 4e 5f 5f } //1 __GLOBAL_INSTALLER_CPP_CB_FUNCTION__
		$a_01_4 = {54 72 61 79 49 63 6f 6e 73 2f 6c 6f 67 6f 2e 69 63 6f } //1 TrayIcons/logo.ico
		$a_03_5 = {83 4d fc ff 59 a1 ?? ?? ?? ?? 83 78 f4 00 75 1d 6a 02 59 e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 30 68 ?? ?? ?? ?? 56 e8 ?? ?? ?? ?? 83 c4 10 8b c6 e8 ?? ?? ?? ?? c3 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*1) >=5
 
}
rule Adware_Win32_ZoomyLib_12{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,2b 00 2b 00 06 00 00 "
		
	strings :
		$a_01_0 = {48 6f 6f 6b 65 64 5a 77 53 65 74 56 61 6c 75 65 4b 65 79 28 29 3a 20 72 65 61 64 20 6f 6e 6c 79 20 76 61 6c 75 65 20 70 61 74 68 20 25 73 } //10 HookedZwSetValueKey(): read only value path %s
		$a_01_1 = {48 6f 6f 6b 65 64 5a 77 43 72 65 61 74 65 46 69 6c 65 } //10 HookedZwCreateFile
		$a_01_2 = {53 65 72 76 69 63 65 49 64 46 72 6f 6d 46 6e 28 29 3a 20 42 6f 67 75 73 20 73 65 72 76 69 63 65 20 49 44 20 25 30 38 78 } //10 ServiceIdFromFn(): Bogus service ID %08x
		$a_01_3 = {48 6f 6f 6b 69 6e 67 20 53 53 54 20 25 78 20 49 6e 64 65 78 20 25 30 33 78 20 4f 6c 64 20 25 30 38 78 } //10 Hooking SST %x Index %03x Old %08x
		$a_01_4 = {31 32 30 25 73 20 25 73 20 28 25 64 29 2c 20 50 49 44 3d 25 75 3a } //2 120%s %s (%d), PID=%u:
		$a_01_5 = {63 3a 5c 77 65 62 77 6f 72 6b 5c 61 64 62 6c 6f 63 6b 65 72 5c 61 67 65 6e 74 5c 64 72 69 76 65 72 5c 33 32 62 69 74 5c 68 6f 6f 6b 73 73 72 76 2e 63 } //1 c:\webwork\adblocker\agent\driver\32bit\hookssrv.c
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*2+(#a_01_5  & 1)*1) >=43
 
}
rule Adware_Win32_ZoomyLib_13{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {6b 6c 65 2e 61 75 73 74 72 69 65 73 2e 63 6f 6d 2f 61 6d 6d 2f 72 61 70 70 73 2f 25 73 5f 25 73 2f 25 73 2f 6c 6f 61 64 65 72 2e 6a 73 3f 64 3d 74 } //1 kle.austries.com/amm/rapps/%s_%s/%s/loader.js?d=t
		$a_01_1 = {6d 61 63 3d 31 31 32 32 33 33 34 34 35 35 36 36 } //1 mac=112233445566
		$a_01_2 = {3c 73 63 72 69 70 74 20 74 79 70 65 3d 22 74 65 78 74 2f 6a 61 76 61 73 63 72 69 70 74 22 20 73 72 63 3d 22 25 73 22 20 69 64 3d 22 5f 5f 61 6d 6d 5f 30 31 22 20 63 68 61 72 73 65 74 3d 22 55 54 46 2d 38 22 3e 3c 2f 73 63 72 69 70 74 3e } //1 <script type="text/javascript" src="%s" id="__amm_01" charset="UTF-8"></script>
		$a_01_3 = {72 65 70 6c 61 63 65 2e 73 75 6e 69 3d 22 25 64 22 3b 20 72 65 70 6c 61 63 65 2e 64 73 72 3d 22 25 73 22 3b 20 72 65 70 6c 61 63 65 2e 70 67 64 3d 22 25 73 22 3b 20 72 65 70 6c 61 63 65 2e 74 74 20 3d 20 22 25 73 22 3b } //1 replace.suni="%d"; replace.dsr="%s"; replace.pgd="%s"; replace.tt = "%s";
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
rule Adware_Win32_ZoomyLib_14{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 05 00 00 "
		
	strings :
		$a_01_0 = {61 00 64 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 72 00 00 00 } //1
		$a_01_1 = {62 00 6f 00 6f 00 73 00 74 00 77 00 65 00 62 00 61 00 70 00 70 00 00 00 } //1
		$a_01_2 = {53 00 6f 00 66 00 74 00 25 00 73 00 69 00 63 00 72 00 6f 00 25 00 73 00 64 00 6f 00 77 00 73 00 5c 00 43 00 75 00 72 00 25 00 73 00 69 00 6f 00 6e 00 5c 00 52 00 25 00 73 00 } //10 Soft%sicro%sdows\Cur%sion\R%s
		$a_03_3 = {83 4d fc ff 59 a1 ?? ?? ?? ?? 83 78 f4 00 75 1d 6a 02 59 e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 30 68 ?? ?? ?? ?? 56 e8 ?? ?? ?? ?? 83 c4 10 8b c6 e8 ?? ?? ?? ?? c3 } //10
		$a_03_4 = {8d 44 24 10 50 57 57 68 ?? ?? ?? ?? 57 57 e8 ?? ?? ?? ?? 83 c4 18 b1 01 6a 02 5a e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 6a 01 57 ff 15 ?? ?? ?? ?? 8b d8 85 db 0f 84 b8 00 00 00 ff 15 ?? ?? ?? ?? 3d b7 00 00 00 } //10
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*10+(#a_03_3  & 1)*10+(#a_03_4  & 1)*10) >=31
 
}
rule Adware_Win32_ZoomyLib_15{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 04 00 00 "
		
	strings :
		$a_01_0 = {68 00 74 00 74 00 70 00 73 00 3a 00 2f 00 2f 00 73 00 2e 00 78 00 63 00 6f 00 64 00 65 00 6c 00 69 00 62 00 2e 00 6e 00 65 00 74 00 2f 00 75 00 70 00 64 00 61 00 74 00 65 00 73 00 2f 00 66 00 66 00 2f 00 61 00 70 00 70 00 73 00 2f 00 39 00 30 00 30 00 2f 00 31 00 30 00 30 00 31 00 30 00 30 00 34 00 35 00 2e 00 78 00 6d 00 6c 00 } //1 https://s.xcodelib.net/updates/ff/apps/900/10010045.xml
		$a_01_1 = {6c 00 79 00 72 00 69 00 63 00 73 00 67 00 69 00 7a 00 6d 00 6f 00 73 00 } //10 lyricsgizmos
		$a_01_2 = {7b 00 39 00 45 00 35 00 38 00 32 00 33 00 33 00 43 00 2d 00 36 00 42 00 31 00 30 00 2d 00 34 00 33 00 35 00 37 00 2d 00 42 00 43 00 46 00 34 00 2d 00 34 00 42 00 37 00 31 00 44 00 46 00 37 00 42 00 35 00 44 00 30 00 43 00 7d 00 } //10 {9E58233C-6B10-4357-BCF4-4B71DF7B5D0C}
		$a_01_3 = {74 00 62 00 40 00 6a 00 61 00 6d 00 62 00 6f 00 7a 00 2e 00 63 00 6f 00 6d 00 } //10 tb@jamboz.com
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10) >=31
 
}
rule Adware_Win32_ZoomyLib_16{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 06 00 00 "
		
	strings :
		$a_03_0 = {31 00 30 00 30 00 38 00 30 00 30 00 [30-39] 00 [30-39] 00 00[ 00 31 00]  39 00 00 00 31 00 30 00 30 00 38 00 } //4
		$a_81_1 = {77 73 2e 78 63 6f 64 65 6c 69 62 2e 6e 65 74 } //4 ws.xcodelib.net
		$a_81_2 = {7a 6f 2e 2e 6f 6d 69 2e 2e 66 79 } //1 zo..omi..fy
		$a_81_3 = {7a 6f 2e 2e 6f 6d 2e 2e 69 66 79 } //1 zo..om..ify
		$a_01_4 = {7b 00 37 00 32 00 33 00 35 00 31 00 42 00 34 00 35 00 2d 00 39 00 36 00 33 00 36 00 2d 00 34 00 46 00 39 00 39 00 2d 00 38 00 32 00 30 00 42 00 2d 00 37 00 43 00 35 00 35 00 32 00 44 00 32 00 37 00 38 00 39 00 37 00 44 00 7d 00 } //1 {72351B45-9636-4F99-820B-7C552D27897D}
		$a_01_5 = {7b 00 43 00 45 00 34 00 35 00 36 00 30 00 42 00 42 00 2d 00 38 00 46 00 37 00 33 00 2d 00 34 00 42 00 33 00 39 00 2d 00 38 00 31 00 33 00 35 00 2d 00 30 00 34 00 37 00 42 00 45 00 44 00 42 00 39 00 34 00 31 00 39 00 32 00 7d 00 } //1 {CE4560BB-8F73-4B39-8135-047BEDB94192}
	condition:
		((#a_03_0  & 1)*4+(#a_81_1  & 1)*4+(#a_81_2  & 1)*1+(#a_81_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=10
 
}
rule Adware_Win32_ZoomyLib_17{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,29 00 29 00 07 00 00 "
		
	strings :
		$a_01_0 = {61 00 64 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 72 00 00 00 } //1
		$a_01_1 = {62 00 6f 00 6f 00 73 00 74 00 77 00 65 00 62 00 61 00 70 00 70 00 00 00 } //1
		$a_01_2 = {6e 00 65 00 74 00 73 00 70 00 65 00 65 00 64 00 61 00 70 00 70 00 00 00 } //1
		$a_01_3 = {3f 00 74 00 79 00 70 00 65 00 3d 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 72 00 65 00 67 00 } //10 ?type=install_reg
		$a_01_4 = {3f 00 74 00 79 00 70 00 65 00 3d 00 61 00 63 00 74 00 69 00 76 00 65 00 26 00 63 00 6e 00 74 00 3d 00 25 00 64 00 26 00 70 00 72 00 76 00 74 00 6d 00 3d 00 25 00 73 00 26 00 64 00 6c 00 3d 00 25 00 64 00 } //10 ?type=active&cnt=%d&prvtm=%s&dl=%d
		$a_01_5 = {25 00 73 00 3f 00 74 00 79 00 70 00 65 00 3d 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 73 00 74 00 61 00 72 00 74 00 26 00 61 00 66 00 66 00 49 00 64 00 3d 00 25 00 73 00 26 00 70 00 75 00 62 00 49 00 64 00 3d 00 25 00 73 00 26 00 61 00 70 00 70 00 49 00 64 00 3d 00 25 00 73 00 26 00 61 00 67 00 76 00 65 00 72 00 3d 00 25 00 73 00 } //10 %s?type=install_start&affId=%s&pubId=%s&appId=%s&agver=%s
		$a_01_6 = {54 00 65 00 6d 00 70 00 6f 00 20 00 52 00 75 00 6e 00 6e 00 65 00 72 00 20 00 25 00 73 00 } //10 Tempo Runner %s
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*10+(#a_01_6  & 1)*10) >=41
 
}
rule Adware_Win32_ZoomyLib_18{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 0a 00 00 "
		
	strings :
		$a_81_0 = {65 61 7a 79 7a 6f 6f 6d 00 } //2
		$a_81_1 = {62 6f 62 79 7a 6f 6f 6d 00 } //2
		$a_81_2 = {77 65 62 73 6d 61 72 74 61 70 70 00 } //2 敷獢慭瑲灡p
		$a_81_3 = {6e 65 74 73 70 65 65 64 61 70 70 00 } //2 敮獴数摥灡p
		$a_01_4 = {2b 00 73 00 70 00 3d 00 25 00 73 00 20 00 2b 00 75 00 6e 00 3d 00 4e 00 54 00 20 00 41 00 55 00 54 00 48 00 4f 00 52 00 49 00 54 00 59 00 5c 00 53 00 59 00 53 00 54 00 45 00 4d 00 20 00 2b 00 63 00 6c 00 3d 00 2f 00 74 00 73 00 32 00 3d 00 31 00 } //1 +sp=%s +un=NT AUTHORITY\SYSTEM +cl=/ts2=1
		$a_01_5 = {73 00 33 00 2e 00 78 00 72 00 65 00 70 00 61 00 77 00 73 00 2e 00 63 00 6f 00 6d 00 2f 00 63 00 6c 00 69 00 65 00 6e 00 74 00 2d 00 63 00 6d 00 64 00 2f 00 63 00 72 00 2e 00 68 00 74 00 6d 00 6c 00 } //1 s3.xrepaws.com/client-cmd/cr.html
		$a_01_6 = {73 00 33 00 2e 00 78 00 61 00 6d 00 7a 00 61 00 77 00 73 00 2e 00 63 00 6f 00 6d 00 2f 00 63 00 6c 00 69 00 65 00 6e 00 74 00 2d 00 63 00 6d 00 64 00 2f 00 63 00 72 00 2e 00 68 00 74 00 6d 00 6c 00 } //1 s3.xamzaws.com/client-cmd/cr.html
		$a_01_7 = {63 6f 6e 74 65 6e 74 2f 6a 71 75 65 72 79 34 74 6f 6f 6c 62 61 72 2e 6a 73 } //1 content/jquery4toolbar.js
		$a_01_8 = {75 72 6c 22 3a 20 22 68 74 74 70 3a 2f 2f 6b 6c 65 2e 61 75 73 74 72 69 65 73 } //1 url": "http://kle.austries
		$a_03_9 = {74 61 6d 6d 67 52 31 31 [30-39] 00 } //10
	condition:
		((#a_81_0  & 1)*2+(#a_81_1  & 1)*2+(#a_81_2  & 1)*2+(#a_81_3  & 1)*2+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_03_9  & 1)*10) >=12
 
}
rule Adware_Win32_ZoomyLib_19{
	meta:
		description = "Adware:Win32/ZoomyLib,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 06 00 00 "
		
	strings :
		$a_01_0 = {68 00 74 00 74 00 70 00 73 00 3a 00 2f 00 2f 00 73 00 2e 00 78 00 63 00 6f 00 64 00 65 00 6c 00 69 00 62 00 2e 00 6e 00 65 00 74 00 2f 00 75 00 70 00 64 00 61 00 74 00 65 00 73 00 2f 00 66 00 66 00 2f 00 61 00 70 00 70 00 73 00 2f 00 31 00 31 00 39 00 2f 00 31 00 30 00 30 00 38 00 30 00 30 00 30 00 38 00 2e 00 78 00 6d 00 6c 00 } //1 https://s.xcodelib.net/updates/ff/apps/119/10080008.xml
		$a_01_1 = {68 00 74 00 74 00 70 00 73 00 3a 00 2f 00 2f 00 73 00 2e 00 78 00 63 00 6f 00 64 00 65 00 6c 00 69 00 62 00 2e 00 6e 00 65 00 74 00 2f 00 75 00 70 00 64 00 61 00 74 00 65 00 73 00 2f 00 66 00 66 00 2f 00 61 00 70 00 70 00 73 00 2f 00 31 00 31 00 39 00 2f 00 31 00 30 00 30 00 38 00 30 00 30 00 30 00 39 00 2e 00 78 00 6d 00 6c 00 } //1 https://s.xcodelib.net/updates/ff/apps/119/10080009.xml
		$a_03_2 = {31 00 30 00 30 00 38 00 30 00 30 00 [30-39] 00 [30-39] 00 00[ 00 31 00]  39 00 00 00 31 00 30 00 30 00 38 00 } //1
		$a_81_3 = {5a 6f 6f 6d 69 66 79 } //10 Zoomify
		$a_81_4 = {74 62 40 7a 6f 6f 6d 69 66 79 2e 63 6f 6d } //10 tb@zoomify.com
		$a_01_5 = {7b 00 37 00 32 00 33 00 35 00 31 00 42 00 34 00 35 00 2d 00 39 00 36 00 33 00 36 00 2d 00 34 00 46 00 39 00 39 00 2d 00 38 00 32 00 30 00 42 00 2d 00 37 00 43 00 35 00 35 00 32 00 44 00 32 00 37 00 38 00 39 00 37 00 44 00 7d 00 } //10 {72351B45-9636-4F99-820B-7C552D27897D}
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1+(#a_81_3  & 1)*10+(#a_81_4  & 1)*10+(#a_01_5  & 1)*10) >=31
 
}
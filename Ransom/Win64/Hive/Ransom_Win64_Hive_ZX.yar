
rule Ransom_Win64_Hive_ZX{
	meta:
		description = "Ransom:Win64/Hive.ZX,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 02 00 00 "
		
	strings :
		$a_03_0 = {48 81 ec d8 00 00 00 48 89 ce 0f 28 05 ?? ?? ?? ?? 0f 29 44 24 50 48 8b 05 ?? ?? ?? ?? 48 85 c0 74 6c 48 89 d7 b9 ff ff ff ff 49 39 c9 b9 ff ff ff ff 41 0f 42 c9 0f 57 c0 0f 11 44 24 38 4c 89 44 24 28 48 8d 54 24 50 48 89 54 24 20 89 4c 24 30 48 89 f9 31 d2 45 31 c0 45 31 c9 ff d0 3d 03 01 00 00 75 18 48 89 f9 ba ff ff ff ff e8 ?? ?? ?? ?? 8b 44 24 50 3d 03 01 00 00 } //10
		$a_03_1 = {b9 46 02 00 00 b2 01 e8 ?? ?? ?? ?? 48 89 [0-03] 90 17 03 07 07 07 48 89 [0-03] 31 c9 31 c9 48 89 [0-03] 49 89 [0-03] 31 c9 48 89 c2 41 b8 46 02 00 00 41 b9 02 00 00 00 e8 ?? ?? ?? ?? b9 46 02 00 00 b2 01 e8 ?? ?? ?? ?? 48 89 [0-03] 90 17 03 02 05 05 31 c9 49 89 [0-03] 48 89 [0-03] (31 c9|48 89 [0-03] 4)8 89 c2 41 b8 46 02 00 00 41 b9 02 00 00 00 e8 } //10
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*10) >=20
 
}
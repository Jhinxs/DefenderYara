
rule Ransom_Win32_Lockbit_SB{
	meta:
		description = "Ransom:Win32/Lockbit.SB,SIGNATURE_TYPE_PEHSTR_EXT,1e 00 1e 00 04 00 00 "
		
	strings :
		$a_00_0 = {4c 00 6f 00 63 00 6b 00 42 00 69 00 74 00 5f 00 32 00 5f 00 30 00 5f 00 52 00 61 00 6e 00 73 00 6f 00 6d 00 } //10 LockBit_2_0_Ransom
		$a_02_1 = {59 00 6f 00 75 00 20 00 63 00 61 00 6e 00 20 00 63 00 6f 00 6d 00 6d 00 75 00 6e 00 69 00 63 00 61 00 74 00 65 00 20 00 77 00 69 00 74 00 68 00 20 00 75 00 73 00 20 00 74 00 68 00 72 00 6f 00 75 00 67 00 68 00 20 00 74 00 68 00 65 00 20 00 54 00 6f 00 78 00 20 00 6d 00 65 00 73 00 73 00 65 00 6e 00 67 00 65 00 72 00 [0-06] 68 00 74 00 74 00 70 00 73 00 3a 00 2f 00 2f 00 74 00 6f 00 78 00 2e 00 63 00 68 00 61 00 74 00 2f 00 64 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 2e 00 68 00 74 00 6d 00 6c 00 } //10
		$a_02_2 = {2e 00 6f 00 6e 00 69 00 6f 00 6e 00 [0-60] 25 00 73 00 2e 00 62 00 6d 00 70 00 } //10
		$a_03_3 = {47 c6 84 24 ?? 00 00 00 44 c6 84 24 ?? 00 00 00 49 c6 84 24 ?? 00 00 00 50 c6 84 24 ?? 00 00 00 4c c6 84 24 ?? 00 00 00 55 c6 84 24 ?? 00 00 00 53 c6 84 24 ?? 00 00 00 0e c6 84 24 ?? 00 00 00 44 c6 84 24 ?? 00 00 00 4c c6 84 24 ?? 00 00 00 4c } //10
	condition:
		((#a_00_0  & 1)*10+(#a_02_1  & 1)*10+(#a_02_2  & 1)*10+(#a_03_3  & 1)*10) >=30
 
}

rule Ransom_Win32_Basta_B_ibt{
	meta:
		description = "Ransom:Win32/Basta.B!ibt,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 03 00 00 "
		
	strings :
		$a_00_0 = {56 69 73 69 62 6c 65 45 6e 74 72 79 } //4 VisibleEntry
		$a_03_1 = {55 8b ec 83 ec 08 53 8b 1d ?? ?? ?? ?? 56 57 85 db 74 5b 8b 43 3c 83 7c 18 7c 00 74 51 8b 44 18 78 03 c3 89 45 f8 8b 48 18 85 c9 74 41 83 78 14 00 74 3b 8b 70 20 33 ff 8b 40 24 03 f3 03 c3 89 45 fc 85 c9 74 28 8b 06 03 c3 74 22 50 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 08 85 c0 74 1d 8b 45 f8 47 83 45 fc 02 83 c6 04 3b 78 18 72 d8 33 c0 ff d0 5f 5e 33 c0 5b 8b e5 5d c3 8b 45 fc 0f b7 08 8b 45 f8 8b 40 1c 8d 04 88 8b 04 18 03 c3 ff d0 5f 5e 33 c0 5b 8b e5 5d c3 } //1
		$a_03_2 = {48 89 5c 24 08 48 89 6c 24 10 48 89 74 24 18 57 41 56 41 57 48 83 ec 20 48 8b 0d ?? ?? ?? ?? 48 85 ff 74 78 48 63 47 3c 83 bc 38 8c 00 00 00 00 74 6a 8b ac 38 88 00 00 00 48 03 ef 8b 45 18 85 c0 74 59 83 7d 14 00 74 53 8b 75 20 33 db 44 8b 7d 24 48 03 f7 4c 03 ff 44 8b f3 85 c0 74 3f 90 90 8b 16 48 03 d7 74 37 48 8d 0d ?? ?? ?? ?? e8 b9 9b 02 00 85 c0 74 13 41 ff c6 48 83 c6 04 49 83 c7 02 44 3b 75 18 72 d8 eb 14 8b 45 1c 41 0f b7 0f 48 03 c7 8b 1c 88 48 03 df eb 02 33 db ff d3 48 8b 5c 24 40 33 c0 48 8b 6c 24 48 48 8b 74 24 50 48 83 c4 20 41 5f 41 5e 5f c3 } //1
	condition:
		((#a_00_0  & 1)*4+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1) >=5
 
}
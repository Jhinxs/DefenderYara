
rule Ransom_Win32_Shade_C{
	meta:
		description = "Ransom:Win32/Shade.C,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 06 00 00 "
		
	strings :
		$a_02_0 = {83 c0 01 a3 ?? ?? ?? ?? 83 3d ?? ?? ?? ?? 31 73 21 8b 0d ?? ?? ?? ?? 03 0d ?? ?? ?? ?? 0f b6 11 83 ea 02 a1 ?? ?? ?? ?? 03 05 ?? ?? ?? ?? 88 10 eb c9 } //2
		$a_02_1 = {8b 11 89 15 ?? ?? ?? ?? a1 ?? ?? ?? ?? 2d 59 11 00 00 a3 ?? ?? ?? ?? 8b 15 ?? ?? ?? ?? 81 c2 59 11 00 00 a1 ?? ?? ?? ?? 8b ff 8b ca a3 ?? ?? ?? ?? 31 0d ?? ?? ?? ?? a1 ?? ?? ?? ?? 8b ff c7 05 ?? ?? ?? ?? 00 00 00 00 8b ff 01 05 ?? ?? ?? ?? 8b ff 8b 0d a0 7e 4f 00 8b 15 ?? ?? ?? ?? 89 11 } //2
		$a_00_2 = {74 33 34 72 66 73 65 54 64 67 66 51 31 31 31 } //1 t34rfseTdgfQ111
		$a_00_3 = {47 65 74 53 6f 64 75 2a 65 48 61 20 64 6c 65 47 } //1 GetSodu*eHa dleG
		$a_00_4 = {71 74 75 67 6c 50 72 69 74 65 63 7a } //1 qtuglPritecz
		$a_00_5 = {57 72 2f 74 65 46 2f 6c 65 } //1 Wr/teF/le
	condition:
		((#a_02_0  & 1)*2+(#a_02_1  & 1)*2+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=2
 
}

rule Ransom_Win32_Filecoder_PAGX_MTB{
	meta:
		description = "Ransom:Win32/Filecoder.PAGX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 05 00 00 "
		
	strings :
		$a_01_0 = {64 32 31 70 59 79 42 54 53 45 46 45 54 31 64 44 54 31 42 5a 49 45 52 46 54 45 56 55 52 54 73 4b 64 6e 4e 7a 59 57 52 74 61 57 34 67 52 47 56 73 5a 58 52 6c 49 46 4e 6f 59 57 52 76 64 33 4d 67 4c } //2 d21pYyBTSEFET1dDT1BZIERFTEVURTsKdnNzYWRtaW4gRGVsZXRlIFNoYWRvd3MgL
		$a_01_1 = {53 47 56 73 62 47 38 73 49 41 70 35 62 33 56 79 49 47 5a 70 62 47 56 7a 49 47 68 68 64 6d 55 67 59 6d 56 6c 62 69 42 6c 62 6d 4e 79 65 58 42 30 5a 57 51 68 49 46 52 76 49 48 4a 6c 64 48 56 79 62 } //2 SGVsbG8sIAp5b3VyIGZpbGVzIGhhdmUgYmVlbiBlbmNyeXB0ZWQhIFRvIHJldHVyb
		$a_01_2 = {49 47 4e 68 62 47 77 67 64 47 56 79 62 57 6c 75 59 58 52 6c 4f 77 70 69 59 32 52 6c 5a 47 6c 30 49 43 39 7a 5a 58 51 67 65 32 52 6c 5a 6d 46 31 62 48 52 39 49 48 4a 6c 59 32 39 32 5a 58 4a 35 5a } //1 IGNhbGwgdGVybWluYXRlOwpiY2RlZGl0IC9zZXQge2RlZmF1bHR9IHJlY292ZXJ5Z
		$a_01_3 = {57 35 68 59 6d 78 6c 5a 43 42 4f 62 7a 73 4b 59 6d 4e 6b 5a 57 52 70 64 43 41 76 63 32 56 30 49 48 74 6b 5a 57 5a 68 64 57 78 30 66 53 42 69 62 32 39 30 63 33 52 68 64 48 56 7a 63 47 39 73 61 57 } //1 W5hYmxlZCBObzsKYmNkZWRpdCAvc2V0IHtkZWZhdWx0fSBib290c3RhdHVzcG9saW
		$a_01_4 = {4e 35 49 47 6c 6e 62 6d 39 79 5a 57 46 73 62 47 5a 68 61 57 78 31 63 6d 56 7a 4f 77 3d 3d } //1 N5IGlnbm9yZWFsbGZhaWx1cmVzOw==
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=7
 
}
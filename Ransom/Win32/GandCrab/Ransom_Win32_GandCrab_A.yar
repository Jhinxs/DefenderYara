
rule Ransom_Win32_GandCrab_A{
	meta:
		description = "Ransom:Win32/GandCrab.A,SIGNATURE_TYPE_PEHSTR_EXT,19 00 19 00 0b 00 00 "
		
	strings :
		$a_03_0 = {6a 47 66 89 ?? ?? 58 6a 44 66 89 ?? ?? 58 6a 43 66 89 ?? ?? 58 6a 42 66 89 ?? ?? 58 66 89 } //25
		$a_03_1 = {6a 62 66 89 ?? ?? ?? 58 6a 76 66 89 ?? ?? ?? 58 6a 6a 66 89 ?? ?? ?? 66 89 ?? ?? ?? 5a 6a 79 66 89 ?? ?? ?? 66 89 ?? ?? ?? 66 89 ?? ?? ?? 59 6a 71 58 6a 37 } //25
		$a_00_2 = {33 c9 83 f8 0b 0f 44 c1 0f b6 4c 85 d4 40 30 8a } //15
		$a_80_3 = {67 64 63 62 67 68 76 6a 79 71 79 37 6a 63 6c 6b 2e 6f 6e 69 6f 6e 2e 74 6f 70 } //gdcbghvjyqy7jclk.onion.top  10
		$a_80_4 = {61 65 72 69 65 64 6a 44 23 73 68 61 } //aeriedjD#sha  10
		$a_80_5 = {6a 38 44 6f 41 41 41 41 6c 4d 4d 6f } //j8DoAAAAlMMo  10
		$a_02_6 = {6e 00 73 00 6c 00 6f 00 6f 00 6b 00 75 00 70 00 20 00 [0-20] 20 00 64 00 6e 00 73 00 31 00 2e 00 73 00 6f 00 70 00 72 00 6f 00 64 00 6e 00 73 00 2e 00 72 00 75 00 } //10
		$a_02_7 = {6e 00 73 00 6c 00 6f 00 6f 00 6b 00 75 00 70 00 20 00 [0-20] 20 00 61 00 2e 00 64 00 6e 00 73 00 70 00 6f 00 64 00 2e 00 63 00 6f 00 6d 00 } //10
		$a_80_8 = {50 52 49 44 55 52 41 53 48 4b 41 } //PRIDURASHKA  5
		$a_80_9 = {67 61 6e 64 63 72 61 62 2e 62 69 74 } //gandcrab.bit  5
		$a_80_10 = {6e 6f 6d 6f 72 65 72 61 6e 73 6f 6d 2e 63 6f 69 6e } //nomoreransom.coin  5
	condition:
		((#a_03_0  & 1)*25+(#a_03_1  & 1)*25+(#a_00_2  & 1)*15+(#a_80_3  & 1)*10+(#a_80_4  & 1)*10+(#a_80_5  & 1)*10+(#a_02_6  & 1)*10+(#a_02_7  & 1)*10+(#a_80_8  & 1)*5+(#a_80_9  & 1)*5+(#a_80_10  & 1)*5) >=25
 
}
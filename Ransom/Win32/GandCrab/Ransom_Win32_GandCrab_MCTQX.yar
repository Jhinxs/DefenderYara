
rule Ransom_Win32_GandCrab_MCTQX{
	meta:
		description = "Ransom:Win32/GandCrab.MCTQX,SIGNATURE_TYPE_PEHSTR_EXT,32 00 32 00 07 00 00 "
		
	strings :
		$a_03_0 = {66 0f 6f 0d f0 3c 41 00 b9 60 6a 41 00 ba 22 00 00 00 b8 20 02 00 00 eb 07 [0-10] 8d 49 10 f3 0f 6f 41 f0 66 0f ef c1 f3 0f 7f 41 f0 4a 75 ec eb 0a [0-10] 80 b0 60 6a 41 00 05 40 3d 22 02 00 00 } //20
		$a_00_1 = {05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 } //10 ԅԅԅԅԅԅԅԅတတတတတတတတ
		$a_03_2 = {19 04 00 00 c7 45 ?? 22 04 00 00 c7 45 ?? 23 04 00 00 c7 45 ?? 28 04 00 00 c7 45 ?? 2b 04 00 00 c7 45 ?? 2c 04 00 00 c7 45 ?? 37 04 00 00 c7 45 ?? 3f 04 00 00 c7 45 ?? 40 04 00 00 c7 45 ?? 42 04 00 00 c7 45 ?? 43 04 00 00 c7 45 ?? 44 04 00 00 c7 45 ?? 18 08 00 00 c7 45 ?? 19 08 00 00 c7 45 ?? 2c 08 00 00 c7 45 ?? 43 08 00 00 ff 15 } //20
		$a_03_3 = {81 f1 69 6e 65 49 8b 45 ?? 35 6e 74 65 6c 89 35 ?? ?? ?? ?? 0b c8 8b 45 ?? 35 47 65 6e 75 } //10
		$a_01_4 = {4b 00 52 00 41 00 42 00 2d 00 44 00 45 00 43 00 52 00 59 00 50 00 54 00 2e 00 74 00 78 00 74 00 } //10 KRAB-DECRYPT.txt
		$a_01_5 = {4b 00 52 00 41 00 42 00 2d 00 44 00 45 00 43 00 52 00 59 00 50 00 54 00 2e 00 68 00 74 00 6d 00 6c 00 } //10 KRAB-DECRYPT.html
		$a_01_6 = {25 00 73 00 2e 00 4b 00 52 00 41 00 42 00 } //10 %s.KRAB
	condition:
		((#a_03_0  & 1)*20+(#a_00_1  & 1)*10+(#a_03_2  & 1)*20+(#a_03_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*10+(#a_01_6  & 1)*10) >=50
 
}

rule Ransom_Win32_Fargo_ZZ{
	meta:
		description = "Ransom:Win32/Fargo.ZZ,SIGNATURE_TYPE_PEHSTR_EXT,1a 00 1a 00 04 00 00 "
		
	strings :
		$a_01_0 = {f1 d5 00 fa 4c 62 cc f4 0f 0b } //1
		$a_03_1 = {53 56 57 ff 15 ?? ?? ?? ?? 0f b7 c0 b9 19 04 00 00 66 3b c1 0f 84 ?? ?? ?? ?? 83 c1 26 66 3b c1 0f 84 ?? ?? ?? ?? b9 23 04 00 00 66 3b c1 0f 84 ?? ?? ?? ?? 49 66 3b c1 0f 84 ?? ?? ?? ?? b9 44 04 00 00 66 3b c1 0f 84 } //10
		$a_01_2 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 52 00 61 00 63 00 63 00 69 00 6e 00 65 00 } //5 SOFTWARE\Raccine
		$a_03_3 = {57 68 01 00 00 80 ff d6 57 bf 02 00 00 80 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 68 ?? ?? ?? ?? 57 ff d6 } //10
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*10+(#a_01_2  & 1)*5+(#a_03_3  & 1)*10) >=26
 
}

rule Ransom_Win32_Cryproto_A{
	meta:
		description = "Ransom:Win32/Cryproto.A,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 0e 00 00 "
		
	strings :
		$a_01_0 = {72 00 65 00 61 00 64 00 6d 00 65 00 2e 00 63 00 72 00 79 00 70 00 74 00 2e 00 74 00 78 00 74 00 00 00 } //2
		$a_00_1 = {44 00 45 00 53 00 4b 00 52 00 59 00 50 00 54 00 45 00 44 00 4e 00 38 00 31 00 40 00 47 00 4d 00 41 00 49 00 4c 00 2e 00 43 00 4f 00 4d 00 00 00 } //1
		$a_01_2 = {21 00 63 00 72 00 79 00 70 00 74 00 } //1 !crypt
		$a_01_3 = {21 00 2e 00 63 00 72 00 79 00 70 00 74 00 } //1 !.crypt
		$a_01_4 = {72 00 65 00 61 00 64 00 6d 00 65 00 2e 00 72 00 6f 00 74 00 6f 00 63 00 72 00 79 00 70 00 74 00 2e 00 74 00 78 00 74 00 00 00 } //1
		$a_00_5 = {44 00 49 00 52 00 45 00 43 00 54 00 4f 00 52 00 41 00 54 00 31 00 43 00 40 00 47 00 4d 00 41 00 49 00 4c 00 2e 00 43 00 4f 00 4d 00 00 00 } //1
		$a_00_6 = {5f 00 5f 00 5f 00 5f 00 5f 00 5f 00 43 00 52 00 59 00 50 00 54 00 4e 00 31 00 40 00 47 00 4d 00 41 00 49 00 4c 00 2e 00 43 00 4f 00 4d 00 00 00 } //1
		$a_01_7 = {2e 00 2d 00 2e 00 72 00 6f 00 74 00 6f 00 00 00 } //1
		$a_01_8 = {2e 00 72 00 6f 00 74 00 6f 00 00 00 } //1
		$a_01_9 = {5f 00 5f 00 5f 00 5f 00 5f 00 5f 00 5f 00 61 00 70 00 70 00 73 00 68 00 65 00 6c 00 70 00 40 00 6d 00 61 00 69 00 6c 00 2e 00 72 00 75 00 00 00 } //1
		$a_01_10 = {66 c7 44 7e 0c 74 00 66 c7 44 7e 0a 70 00 66 c7 44 7e 08 79 00 66 c7 44 7e 06 72 00 66 c7 44 7e 04 63 00 66 c7 44 7e 02 2e 00 66 c7 44 7e 0e 00 00 } //1
		$a_01_11 = {66 c7 44 7e 1c 78 00 66 89 4c 7e 18 66 c7 44 7e 14 70 00 66 c7 44 7e 12 79 00 66 c7 44 7e 10 72 00 66 c7 44 7e 0e 63 00 66 89 4c 7e 0c 66 89 44 7e 0a 66 c7 44 7e 08 6d 00 66 c7 44 7e 06 64 00 66 c7 44 7e 04 61 00 66 89 44 7e 02 } //1
		$a_01_12 = {c6 44 24 10 64 c6 44 24 0f 2e c6 44 24 0e 32 c6 44 24 0d 33 c6 44 24 0c 74 c6 44 24 0b 70 c6 44 24 0a 79 c6 44 24 09 72 } //1
		$a_01_13 = {66 c7 44 24 18 35 00 66 c7 44 24 16 63 00 66 c7 44 24 14 6c 00 66 c7 44 24 12 61 00 66 c7 44 24 10 43 00 } //1
	condition:
		((#a_01_0  & 1)*2+(#a_00_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1) >=3
 
}

rule Ransom_MSIL_Thanos_PA_MTB{
	meta:
		description = "Ransom:MSIL/Thanos.PA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_81_0 = {5a 47 56 73 5a 58 52 6c 49 43 4a 49 53 30 4e 56 58 46 4e 50 52 6c 52 58 51 56 4a 46 58 45 31 70 59 33 4a 76 63 32 39 6d 64 46 78 58 61 57 35 6b 62 33 64 7a 58 45 4e 31 63 6e 4a 6c 62 6e 52 57 5a 58 4a 7a 61 57 39 75 58 46 4a 31 62 69 49 67 4c 31 59 67 49 6c 4a 68 59 32 4e 70 62 6d 55 67 56 48 4a 68 65 53 49 67 4c 30 59 3d } //1 ZGVsZXRlICJIS0NVXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1biIgL1YgIlJhY2NpbmUgVHJheSIgL0Y=
		$a_81_1 = {55 32 56 30 4c 55 31 77 55 48 4a 6c 5a 6d 56 79 5a 57 35 6a 5a 53 41 74 52 57 35 68 59 6d 78 6c 51 32 39 75 64 48 4a 76 62 47 78 6c 5a 45 5a 76 62 47 52 6c 63 6b 46 6a 59 32 56 7a 63 79 42 45 61 58 4e 68 59 6d 78 6c 5a 41 3d 3d } //1 U2V0LU1wUHJlZmVyZW5jZSAtRW5hYmxlQ29udHJvbGxlZEZvbGRlckFjY2VzcyBEaXNhYmxlZA==
		$a_81_2 = {5c 52 45 53 54 4f 52 45 5f 46 49 4c 45 53 5f 49 4e 46 4f 2e } //1 \RESTORE_FILES_INFO.
		$a_81_3 = {74 6f 72 20 62 72 6f 77 73 65 72 } //1 tor browser
	condition:
		((#a_81_0  & 1)*1+(#a_81_1  & 1)*1+(#a_81_2  & 1)*1+(#a_81_3  & 1)*1) >=4
 
}
rule Ransom_MSIL_Thanos_PA_MTB_2{
	meta:
		description = "Ransom:MSIL/Thanos.PA!MTB,SIGNATURE_TYPE_PEHSTR_EXT,09 00 09 00 07 00 00 "
		
	strings :
		$a_01_0 = {57 6f 72 6b 65 72 43 72 79 70 74 65 72 } //1 WorkerCrypter
		$a_01_1 = {43 68 65 63 6b 52 65 6d 6f 74 65 44 65 62 75 67 67 65 72 50 72 65 73 65 6e 74 } //1 CheckRemoteDebuggerPresent
		$a_01_2 = {44 6f 77 6e 6c 6f 61 64 53 74 72 69 6e 67 } //1 DownloadString
		$a_01_3 = {46 72 6f 6d 42 61 73 65 36 34 53 74 72 69 6e 67 } //1 FromBase64String
		$a_01_4 = {53 00 57 00 35 00 6d 00 62 00 33 00 4a 00 74 00 59 00 58 00 52 00 70 00 62 00 32 00 34 00 75 00 4c 00 69 00 34 00 3d 00 } //1 SW5mb3JtYXRpb24uLi4=
		$a_01_5 = {55 00 53 00 45 00 52 00 4e 00 41 00 4d 00 45 00 } //1 USERNAME
		$a_01_6 = {51 00 57 00 78 00 73 00 49 00 48 00 6c 00 76 00 64 00 58 00 49 00 67 00 5a 00 6d 00 6c 00 73 00 5a 00 58 00 4d 00 67 00 64 00 32 00 56 00 79 00 5a 00 53 00 42 00 6c 00 62 00 6d 00 4e 00 79 00 65 00 58 00 42 00 30 00 5a 00 57 00 51 00 73 00 49 00 47 00 6c 00 6d 00 49 00 48 00 6c 00 76 00 64 00 53 00 42 00 33 00 59 00 57 00 35 00 30 00 49 00 48 00 52 00 76 00 49 00 47 00 64 00 6c 00 64 00 43 00 42 00 30 00 61 00 47 00 56 00 74 00 49 00 47 00 46 00 73 00 62 00 43 00 42 00 69 00 59 00 57 00 4e 00 72 00 4c 00 43 00 } //5 QWxsIHlvdXIgZmlsZXMgd2VyZSBlbmNyeXB0ZWQsIGlmIHlvdSB3YW50IHRvIGdldCB0aGVtIGFsbCBiYWNrLC
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*5) >=9
 
}
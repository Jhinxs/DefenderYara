
rule DoS_Win32_Rencisod_A{
	meta:
		description = "DoS:Win32/Rencisod.A,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 0a 00 00 "
		
	strings :
		$a_02_0 = {2e 00 70 00 64 00 66 00 [0-04] 2e 00 64 00 6f 00 63 00 [0-04] 2e 00 64 00 6f 00 63 00 78 00 } //10
		$a_02_1 = {2e 70 64 66 [0-04] 2e 64 6f 63 [0-04] 2e 64 6f 63 78 } //10
		$a_02_2 = {2e 00 73 00 71 00 6c 00 [0-04] 2e 00 6d 00 73 00 67 00 [0-04] 2e 00 70 00 73 00 74 00 } //10
		$a_02_3 = {2e 73 71 6c [0-04] 2e 6d 73 67 [0-04] 2e 70 73 74 } //10
		$a_80_4 = {57 65 20 68 61 76 65 20 7b 30 7d 20 74 6f 20 75 70 6c 6f 61 64 20 61 6e 64 20 7b 31 7d 20 63 6f 6d 70 6c 65 74 65 64 } //We have {0} to upload and {1} completed  1
		$a_80_5 = {2d 43 20 22 53 74 6f 70 2d 50 72 6f 63 65 73 73 20 2d 49 64 20 7b 30 7d 3b 20 53 74 61 72 74 2d 53 6c 65 65 70 20 33 3b 20 53 65 74 2d 43 6f 6e 74 65 6e 74 20 2d 50 61 74 68 20 27 7b 31 7d 27 20 2d 56 61 6c 75 65 20 30 22 } //-C "Stop-Process -Id {0}; Start-Sleep 3; Set-Content -Path '{1}' -Value 0"  1
		$a_80_6 = {73 79 6e 63 5f 65 6e 63 } //sync_enc  5
		$a_02_7 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 [0-05] 2f 00 64 00 61 00 74 00 61 00 2f 00 } //5
		$a_02_8 = {68 74 74 70 3a 2f 2f [0-05] 2f 64 61 74 61 2f } //5
		$a_81_9 = {42 30 31 42 46 33 46 32 41 33 42 45 31 32 30 42 31 30 35 33 35 38 42 42 31 41 42 38 43 35 31 30 41 34 34 33 43 33 37 39 44 41 31 32 36 42 42 45 34 44 42 39 34 41 37 42 46 30 39 37 32 36 32 45 } //5 B01BF3F2A3BE120B105358BB1AB8C510A443C379DA126BBE4DB94A7BF097262E
	condition:
		((#a_02_0  & 1)*10+(#a_02_1  & 1)*10+(#a_02_2  & 1)*10+(#a_02_3  & 1)*10+(#a_80_4  & 1)*1+(#a_80_5  & 1)*1+(#a_80_6  & 1)*5+(#a_02_7  & 1)*5+(#a_02_8  & 1)*5+(#a_81_9  & 1)*5) >=31
 
}

rule Constructor_Win32_Zegost_A{
	meta:
		description = "Constructor:Win32/Zegost.A,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {47 68 30 73 74 20 52 41 54 20 45 78 63 65 70 74 69 6f 6e 00 43 52 41 53 48 20 43 4f 44 45 3a 30 78 25 2e 38 78 20 41 44 44 52 3d 30 78 25 2e 38 78 20 46 4c 41 47 53 3d 30 78 25 2e 38 78 } //1 桇猰⁴䅒⁔硅散瑰潩n剃十⁈佃䕄〺╸㠮⁸䑁剄〽╸㠮⁸䱆䝁㵓砰⸥砸
		$a_01_1 = {43 47 68 30 73 74 44 6f 63 00 } //1 䝃と瑳潄c
		$a_01_2 = {64 65 6c 20 2f 71 20 2f 73 20 2f 61 20 63 3a 5c 55 52 61 74 43 61 63 68 65 } //1 del /q /s /a c:\URatCache
		$a_01_3 = {5c 55 70 64 61 74 65 5c 53 65 72 76 65 72 2e 44 61 74 } //1 \Update\Server.Dat
		$a_01_4 = {43 4d 6f 72 65 44 64 6f 73 00 } //1 䵃牯䑥潤s
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
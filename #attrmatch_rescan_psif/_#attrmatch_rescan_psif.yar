
rule _#attrmatch_rescan_psif{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_01_0 = {8b 40 28 83 c0 0e 66 8b 00 66 3b 45 e6 0f 84 } //1
	condition:
		((#a_01_0  & 1)*1) >=1
 
}
rule _#attrmatch_rescan_psif_2{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_03_0 = {8b 43 28 83 c0 ?? 66 8b 00 66 3b 45 e6 0f 84 4e 02 00 00 } //1
	condition:
		((#a_03_0  & 1)*1) >=1
 
}
rule _#attrmatch_rescan_psif_3{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 02 00 00 "
		
	strings :
		$a_01_0 = {0f 31 89 c3 0f 31 29 d8 77 fa } //10
		$a_03_1 = {e8 00 00 00 00 58 89 45 ?? c6 45 ?? 59 c6 45 ?? 2a c6 45 ?? 38 } //1
	condition:
		((#a_01_0  & 1)*10+(#a_03_1  & 1)*1) >=11
 
}
rule _#attrmatch_rescan_psif_4{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 03 00 00 "
		
	strings :
		$a_03_0 = {51 c7 45 fc 02 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 04 83 45 fc 06 8b 45 fc ff 14 85 } //1
		$a_03_1 = {51 c7 45 fc 02 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 09 8b 45 fc 83 c0 06 89 45 fc 8b 4d fc ff 14 8d } //1
		$a_03_2 = {51 c7 04 24 02 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 09 8b 04 24 83 c0 06 89 04 24 8b 0c 24 ff 14 8d } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1) >=1
 
}
rule _#attrmatch_rescan_psif_5{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 05 00 00 "
		
	strings :
		$a_01_0 = {56 69 72 41 6c 6c 78 00 6d 79 61 70 70 2e 65 78 65 } //1
		$a_01_1 = {6d 79 61 70 70 2e 65 78 65 00 00 00 71 65 6d 75 } //1
		$a_01_2 = {01 46 46 46 1f 5c 5c 5c 69 68 67 68 b9 73 72 73 } //1
		$a_01_3 = {6d 79 61 70 70 2e 65 78 65 00 00 00 73 52 61 53 } //1
		$a_03_4 = {6d 79 61 70 70 2e 65 78 65 00 00 00 00 53 00 4f 00 46 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 61 00 76 00 61 00 73 00 74 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_03_4  & 1)*1) >=1
 
}
rule _#attrmatch_rescan_psif_6{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 06 00 00 "
		
	strings :
		$a_03_0 = {64 8b 1d 30 00 00 00 89 5d fc 8b 45 fc 8b 40 0c 8b 70 0c 66 c7 45 ?? 70 00 66 c7 45 ?? 6d 00 66 c7 45 ?? 62 00 8b 46 28 } //1
		$a_03_1 = {e8 00 00 00 00 58 89 45 ?? c6 45 ?? 59 c6 45 ?? 2a c6 45 ?? 38 33 (c0 40|d2 42) 8b 90 03 01 01 4d 75 90 1b 00 } //1
		$a_03_2 = {66 8b 00 66 3b 85 ?? ?? ff ff 74 16 8b 45 ?? 8b 40 28 83 c0 06 66 8b 00 66 3b 85 ?? ?? ff ff 75 01 c3 } //1
		$a_03_3 = {64 8b 15 30 00 00 00 89 55 fc 8b 45 fc 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ff ff ?? 00 66 c7 85 ?? ?? ff ff ?? 00 8b 41 28 } //1
		$a_01_4 = {8b 5e 28 8b f8 03 ff 03 df 66 8b 1b 66 89 19 40 83 c1 02 4a 75 ea } //1
		$a_03_5 = {8b 43 28 8b d0 83 c2 ?? 66 8b 12 66 3b 55 ?? 0f 84 ?? ?? ?? ?? 83 c0 ?? 66 8b 00 66 3b 45 ?? 0f 84 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*1) >=1
 
}
rule _#attrmatch_rescan_psif_7{
	meta:
		description = "!#attrmatch_rescan_psif,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 07 00 00 "
		
	strings :
		$a_03_0 = {ff d7 c6 45 ?? 43 c6 45 ?? 6d c6 45 ?? 61 c6 45 ?? 2e 8a 85 ?? ?? ff ff 3a 45 ?? 75 ?? 8a 85 ?? ?? ff ff 3a 45 ?? 75 ?? 8a 85 ?? ?? ff ff 3a 45 ?? 75 ?? 8a 85 ?? ?? ff ff 3a 45 ?? 75 } //1
		$a_03_1 = {66 8b 09 66 8b 55 ?? 66 3b ca 75 90 09 1d 00 66 c7 45 ?? 70 00 66 c7 45 ?? 6d 00 66 c7 45 ?? 62 00 8b 45 ?? 8b 40 ?? 8b c8 83 c1 0c } //1
		$a_03_2 = {64 8b 05 30 00 00 00 89 45 ?? 8b 45 ?? 8b 40 0c 8b 70 0c 66 c7 45 ?? 6d 00 66 c7 45 ?? 61 00 8b 46 28 8b d0 83 c2 06 66 8b 12 66 3b 55 ?? 75 } //1
		$a_03_3 = {64 8b 15 30 00 00 00 89 55 ?? 8b 45 ?? 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ff ff 90 04 01 05 6d 79 61 70 70 00 66 c7 85 ?? ?? ff ff 90 04 01 05 6d 79 61 70 70 00 8b 41 28 8b d0 83 c2 ?? 66 8b 12 66 3b 95 ?? ?? ff ff 75 } //1
		$a_03_4 = {64 8b 15 30 00 00 00 89 55 ?? 8b 45 ?? 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ?? ?? 61 00 66 c7 85 ?? ?? ?? ?? 79 00 66 c7 85 ?? ?? ?? ?? 70 00 8b 41 28 8b d0 83 c2 ?? 66 8b 12 66 3b 95 ?? ?? ff ff 75 } //1
		$a_03_5 = {64 8b 15 30 00 00 00 89 55 ?? 8b 45 ?? 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ?? ?? 70 00 8b 41 28 8b d0 83 c2 ?? 66 8b 12 66 3b 95 ?? ?? ?? ?? 75 } //1
		$a_03_6 = {6d 00 66 c7 45 ?? 61 00 66 c7 45 ?? 78 00 8b 45 ?? 8b 40 28 8b d0 83 c2 06 66 8b 12 66 3b 55 ?? 75 1b 8b d0 83 c2 ?? 66 8b 12 66 3b 55 ?? 75 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1) >=1
 
}
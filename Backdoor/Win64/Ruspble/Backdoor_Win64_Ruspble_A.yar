
rule Backdoor_Win64_Ruspble_A{
	meta:
		description = "Backdoor:Win64/Ruspble.A,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 06 00 00 "
		
	strings :
		$a_41_0 = {8a 0c 00 8d 47 01 41 32 0b 99 41 f7 f9 41 32 ca 41 88 0b 8b fa 49 ff c3 44 8a d1 48 83 eb 01 01 } //1
		$a_48_1 = {30 2e 30 2e 30 2e 30 00 01 00 0a 41 48 b8 11 42 08 21 84 10 42 08 01 00 14 43 47 6c 6f 62 90 01 04 61 6c 5c 25 90 01 04 30 38 78 00 90 00 01 00 16 43 8e 4e 0e ec 74 90 01 03 aa fc 0d 7c 74 90 01 } //2560
		$a_af_2 = {90 00 01 00 11 01 53 79 73 74 65 6d 46 75 6e 63 74 69 6f 6e 30 33 36 00 00 5d 04 00 00 cc 3a 05 80 5c 27 00 00 d4 3a 05 80 00 00 01 00 08 00 11 00 af 01 46 6f 72 6d 42 6f 6f 6b 2e 42 47 21 4d 54 42 00 00 0a 40 05 82 70 00 04 00 67 16 00 00 d6 b1 dc 00 15 28 ec e6 b3 cb ee 56 00 e2 0b 00 01 20 c4 47 4e c8 67 16 00 00 01 45 c8 12 1f db 4a a6 69 10 65 cf 00 08 0c 00 01 20 c7 e4 98 7a 67 16 00 00 31 96 4c 85 d9 c0 45 6d 86 03 61 35 00 86 09 00 01 20 9a c1 a3 a0 67 16 00 00 60 f0 b1 b7 4e 2f 74 56 af fc f9 0a 1d 8c 0a 00 01 20 ed 28 15 ba 67 16 00 00 8c 82 a0 c3 77 67 93 8b be 0d 3e d9 08 16 0c 00 01 20 } //21507
		$a_b0_3 = {16 00 00 f2 3f 38 db 77 67 93 8b 9d 49 36 a3 08 1a 0c 00 01 20 a4 72 bb d2 67 16 00 00 c9 00 6d } //4308
		$a_de_4 = {a7 26 6b 12 00 8a 09 00 01 20 b0 0f c7 b0 67 16 00 00 52 6a 9d f3 e8 ba ee 50 58 57 99 a2 d6 7a 0a 00 01 20 a7 a9 bd 04 78 7d 00 00 05 00 05 00 02 00 00 03 00 47 03 16 0b 2b 2d 02 06 07 28 90 01 01 00 00 06 0c 04 03 6f 90 01 01 00 00 0a 59 0d 03 08 09 28 90 01 01 00 00 06 03 08 09 28 90 01 01 00 00 06 03 04 28 90 01 01 00 00 06 07 17 58 0b 07 02 6f 90 01 01 00 00 0a 32 90 00 02 00 25 03 02 03 16 61 04 16 60 6f 90 01 01 00 00 0a 0a 90 02 04 28 90 01 01 00 00 0a 16 61 28 90 01 01 00 00 0a 2a 90 00 00 00 78 2f 01 00 06 00 06 00 06 00 00 01 00 } //-32033
		$a_00_5 = {70 00 65 00 6e 00 76 00 70 00 6e 00 31 00 5c 00 6f 00 70 00 65 00 6e 00 76 00 70 00 6e 00 31 00 2e 00 65 00 78 00 65 00 01 00 12 01 68 50 66 64 73 66 68 64 73 64 72 6f 64 73 63 65 73 73 01 00 18 01 6c 70 42 61 73 66 73 64 73 64 66 65 64 64 66 68 73 41 64 64 72 65 73 73 01 00 5e 01 66 00 51 00 55 00 48 00 62 00 58 00 44 00 61 00 6a } //298
	condition:
		((#a_41_0  & 1)*1+(#a_48_1  & 1)*2560+(#a_af_2  & 1)*21507+(#a_b0_3  & 1)*4308+(#a_de_4  & 1)*-32033+(#a_00_5  & 1)*298) >=4
 
}

rule Backdoor_BAT_Crysan_ABX_MTB{
	meta:
		description = "Backdoor:BAT/Crysan.ABX!MTB,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_03_0 = {11 06 09 11 04 28 10 ?? ?? 0a 6f 11 ?? ?? 0a 13 07 72 01 ?? ?? 70 13 08 28 12 ?? ?? 0a 11 07 6f 13 ?? ?? 0a 13 09 28 14 ?? ?? 0a 13 0a 1a 8d 01 ?? ?? 01 13 0e 11 0e 16 11 0a a2 11 0e } //1
		$a_03_1 = {13 0b 11 09 72 b6 ?? ?? 70 6f 16 ?? ?? 0a 11 05 20 00 ?? ?? 00 14 14 11 0b 74 01 ?? ?? 1b 6f 17 ?? ?? 0a 90 0a 41 00 17 7e 15 ?? ?? 0a a2 11 0e 18 11 08 28 02 ?? ?? 06 a2 11 0e 19 17 8c 19 ?? ?? 01 a2 11 0e } //1
		$a_01_2 = {44 6f 77 6e 6c 6f 61 64 44 61 74 61 } //1 DownloadData
		$a_01_3 = {67 65 74 5f 45 78 65 63 75 74 61 62 6c 65 50 61 74 68 } //1 get_ExecutablePath
		$a_01_4 = {49 6e 76 6f 6b 65 4d 65 6d 62 65 72 } //1 InvokeMember
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
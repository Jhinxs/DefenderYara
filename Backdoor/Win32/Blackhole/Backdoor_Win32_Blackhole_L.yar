
rule Backdoor_Win32_Blackhole_L{
	meta:
		description = "Backdoor:Win32/Blackhole.L,SIGNATURE_TYPE_PEHSTR_EXT,0d 00 0d 00 04 00 00 "
		
	strings :
		$a_00_0 = {31 33 38 73 6f 66 74 2e 63 6f 6d 2f 62 6c 61 63 6b 68 6f 6c 65 2f 76 65 72 69 66 79 2e 61 73 70 3f 6d 64 35 3d } //1 138soft.com/blackhole/verify.asp?md5=
		$a_00_1 = {3a 28 52 61 6d 20 44 69 73 6b 29 } //1 :(Ram Disk)
		$a_00_2 = {42 72 63 53 65 72 76 65 72 32 2e 45 78 65 } //1 BrcServer2.Exe
		$a_02_3 = {0f 84 8e 00 00 00 b8 ?? ?? ?? ?? ba 1c 00 00 00 e8 ?? ?? ?? ?? c7 05 ?? ?? ?? ?? 10 01 00 00 c7 05 ?? ?? ?? ?? 02 00 00 00 c7 05 ?? ?? ?? ?? 03 00 00 00 c7 05 ?? ?? ?? ?? e8 03 00 00 68 ?? ?? ?? ?? a1 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? c6 05 ?? ?? ?? ?? 00 c6 05 ?? ?? ?? ?? 00 c7 05 ?? ?? ?? ?? 04 00 00 00 } //10
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_02_3  & 1)*10) >=13
 
}

rule Backdoor_Win32_Caphaw_AC{
	meta:
		description = "Backdoor:Win32/Caphaw.AC,SIGNATURE_TYPE_PEHSTR_EXT,65 00 65 00 16 00 00 "
		
	strings :
		$a_03_0 = {db 44 24 0c d9 (fa|fe) [0-2f] 03 44 24 08 89 44 24 08 8b ?? 24 04 90 03 01 01 41 42 89 ?? 24 04 81 7c 24 04 ?? ?? ?? ?? 72 } //100
		$a_03_1 = {db 44 24 08 d9 90 17 03 01 01 01 fa fe ff e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b ?? 24 (41|42) 89 ?? 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_2 = {db 44 24 08 dc ?? ?? ?? ?? ?? d9 (fa|fe) e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b 0c 24 41 89 0c 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_3 = {db 44 24 0c dc 7c 24 10 d9 ?? e8 ?? ?? 00 00 03 44 24 08 89 44 24 08 8b 4c 24 04 41 89 4c 24 04 81 7c 24 04 ?? ?? ?? ?? 72 } //100
		$a_03_4 = {db 44 24 0c d9 ed d9 c9 d9 f1 dc 44 24 10 e8 ?? ?? 00 00 03 44 24 08 89 44 24 08 8b 4c 24 04 41 89 4c 24 04 81 7c 24 04 ?? ?? ?? ?? 72 } //100
		$a_03_5 = {db 44 24 0c d9 ?? dc 44 24 10 e8 ?? ?? 00 00 03 44 24 08 89 44 24 08 8b ?? 24 04 (41|42) 89 ?? 24 04 81 7c 24 04 ?? ?? ?? ?? (|) 72 0f 82 } //100
		$a_03_6 = {db 44 24 0c d9 ?? dc 44 24 10 90 13 e8 ?? ?? 00 00 03 44 24 08 89 44 24 08 8b 4c 24 04 41 89 4c 24 04 81 7c 24 04 ?? ?? ?? ?? 0f 82 ?? ff ff ff } //100
		$a_03_7 = {db 44 24 08 d9 fe d9 fa 90 13 e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b ?? 24 (41|42) 89 ?? 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_8 = {db 44 24 08 d9 ?? dc ?? ?? ?? ?? ?? d9 fa 90 13 e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b 14 24 42 89 14 24 81 3c 24 ?? ?? ?? ?? (72|0f) } //100
		$a_03_9 = {db 44 24 08 dc ?? ?? ?? ?? ?? d9 fa 90 13 e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b ?? 24 (41|42) 89 ?? 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_10 = {db 44 24 0c dc ?? ?? ?? ?? ?? d9 ?? 90 13 e8 ?? ?? 00 00 03 44 24 08 89 44 24 08 8b 4c 24 04 41 89 4c 24 04 81 7c 24 04 ?? ?? ?? ?? 72 } //100
		$a_03_11 = {db 44 24 08 d9 ?? 90 13 e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b ?? 24 (41|42) 89 ?? 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_12 = {db 44 24 08 d9 fa d9 fe e8 ?? ?? 00 00 03 44 24 04 89 44 24 04 8b 0c 24 41 89 0c 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_13 = {db 44 24 0c d9 (fa|fe) dc 05 ?? ?? ?? ?? dc 7c 24 10 e8 ?? ?? 00 00 03 44 24 08 89 44 24 08 8b 54 24 04 42 89 54 24 04 81 7c 24 04 ?? ?? ?? ?? 0f 82 } //100
		$a_03_14 = {db 44 24 08 d9 c0 d9 (fa|fe) [0-2f] 03 44 24 04 89 44 24 04 8b 14 24 42 89 14 24 81 3c 24 ?? ?? ?? ?? 72 } //100
		$a_03_15 = {8b 43 3c 8b ?? ?? 28 03 } //1
		$a_03_16 = {8b 45 3c 8b ?? ?? 28 03 } //1
		$a_03_17 = {8b 47 3c 8b ?? ?? 28 03 } //1
		$a_03_18 = {8b 4b 3c 8b ?? ?? 28 03 } //1
		$a_03_19 = {8b 53 3c 8b ?? ?? 28 03 } //1
		$a_03_20 = {8b 55 3c 8b ?? ?? 28 03 } //1
		$a_03_21 = {8b 4d 3c 8b ?? ?? 28 03 } //1
	condition:
		((#a_03_0  & 1)*100+(#a_03_1  & 1)*100+(#a_03_2  & 1)*100+(#a_03_3  & 1)*100+(#a_03_4  & 1)*100+(#a_03_5  & 1)*100+(#a_03_6  & 1)*100+(#a_03_7  & 1)*100+(#a_03_8  & 1)*100+(#a_03_9  & 1)*100+(#a_03_10  & 1)*100+(#a_03_11  & 1)*100+(#a_03_12  & 1)*100+(#a_03_13  & 1)*100+(#a_03_14  & 1)*100+(#a_03_15  & 1)*1+(#a_03_16  & 1)*1+(#a_03_17  & 1)*1+(#a_03_18  & 1)*1+(#a_03_19  & 1)*1+(#a_03_20  & 1)*1+(#a_03_21  & 1)*1) >=101
 
}
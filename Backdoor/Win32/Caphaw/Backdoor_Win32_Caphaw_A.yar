
rule Backdoor_Win32_Caphaw_A{
	meta:
		description = "Backdoor:Win32/Caphaw.A,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 0a 00 00 "
		
	strings :
		$a_03_0 = {8b 03 8d 73 08 85 f6 74 ?? 8a 0e 33 ff 32 c8 74 ?? 69 c0 4d 03 00 00 05 41 02 00 00 83 c9 ff 33 d2 f7 f1 47 8a 0c 37 8b c2 32 c8 75 e4 } //3
		$a_03_1 = {3d 78 56 34 12 74 04 0b c0 75 07 c7 45 ?? 01 00 00 00 e8 ?? ?? ?? ?? 6a 00 ff 15 } //3
		$a_01_2 = {69 c0 4d 03 00 00 05 41 02 00 00 33 d2 83 cf ff f7 f7 46 8b c2 8a 14 0e 32 d0 75 e4 } //3
		$a_00_3 = {43 50 48 57 20 6b 69 6c 6c 20 62 79 20 74 69 6d 65 6f 75 74 00 } //2
		$a_00_4 = {2a 2a 2a 4c 6f 61 64 20 69 6e 6a 65 63 74 73 20 75 72 6c 3d 25 73 20 28 25 73 29 00 } //2
		$a_00_5 = {2a 2a 2a 69 73 49 6e 6a 65 63 74 3d 25 73 00 } //2
		$a_03_6 = {3d 00 00 50 00 0f 87 ?? ?? ?? ?? 85 d2 7c ?? 7f 07 3d 00 d0 07 00 76 } //2
		$a_01_7 = {41 56 43 49 6e 6a 65 63 74 73 50 61 63 6b 40 40 } //1 AVCInjectsPack@@
		$a_01_8 = {41 56 46 46 5f 48 6f 6f 6b 40 40 } //1 AVFF_Hook@@
		$a_01_9 = {41 56 49 45 5f 48 6f 6f 6b 40 40 } //1 AVIE_Hook@@
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*3+(#a_01_2  & 1)*3+(#a_00_3  & 1)*2+(#a_00_4  & 1)*2+(#a_00_5  & 1)*2+(#a_03_6  & 1)*2+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1) >=5
 
}

rule Backdoor_Win32_PcClient_DH{
	meta:
		description = "Backdoor:Win32/PcClient.DH,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 06 00 00 "
		
	strings :
		$a_03_0 = {e8 00 00 00 00 58 2d ?? ?? ?? ?? 05 [0-60] c7 40 ?? ?? ?? ?? ?? c7 40 90 08 20 01 c7 80 ?? 00 00 00 ?? ?? ?? ?? c7 80 ?? 00 00 00 } //2
		$a_02_1 = {2e 64 6c 6c 00 [0-10] 44 6f 4d 61 69 6e [0-10] 53 65 72 76 69 63 65 [0-10] 53 65 72 76 69 63 65 4d 61 69 6e } //1
		$a_00_2 = {25 30 34 64 25 30 32 64 25 30 32 64 2f 25 30 32 64 25 30 32 64 25 30 32 64 2f 25 64 2e 6a 73 70 } //1 %04d%02d%02d/%02d%02d%02d/%d.jsp
		$a_00_3 = {47 6c 6f 62 61 6c 5c 25 73 2d 6b 65 79 2d 6d 65 74 75 78 } //1 Global\%s-key-metux
		$a_00_4 = {50 4f 53 54 20 68 74 74 70 3a 2f 2f 25 73 3a 25 64 2f 25 73 20 48 54 54 50 2f 31 2e 31 } //1 POST http://%s:%d/%s HTTP/1.1
		$a_00_5 = {71 79 30 30 31 69 64 3d 25 64 3b 71 79 30 30 31 67 75 69 64 3d 25 73 } //1 qy001id=%d;qy001guid=%s
	condition:
		((#a_03_0  & 1)*2+(#a_02_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=4
 
}
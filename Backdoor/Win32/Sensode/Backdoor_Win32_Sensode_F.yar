
rule Backdoor_Win32_Sensode_F{
	meta:
		description = "Backdoor:Win32/Sensode.F,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 08 00 00 "
		
	strings :
		$a_03_0 = {58 00 4d 00 4b 00 44 00 [0-06] 46 00 49 00 4c 00 45 00 [0-06] 53 00 54 00 4f 00 52 00 [0-06] 52 00 45 00 54 00 52 00 [0-06] 53 00 49 00 5a 00 45 00 [0-06] 52 00 45 00 53 00 54 00 [0-06] 45 00 58 00 45 00 43 00 [0-06] 52 00 4e 00 54 00 4f 00 } //10
		$a_03_1 = {58 4d 4b 44 [0-06] 46 49 4c 45 [0-06] 53 54 4f 52 [0-06] 52 45 54 52 [0-06] 53 49 5a 45 [0-06] 52 45 53 54 [0-06] 45 58 45 43 [0-06] 52 4e 54 4f } //10
		$a_00_2 = {7a 78 70 6c 75 67 20 2d 61 64 64 20 67 65 74 78 78 78 20 63 3a 5c 78 79 7a 2e 64 6c 6c } //1 zxplug -add getxxx c:\xyz.dll
		$a_01_3 = {5c 43 75 72 72 65 6e 74 43 6f 6e 74 72 6f 6c 53 65 74 5c 43 6f 6e 74 72 6f 6c 5c 7a 78 70 6c 75 67 } //2 \CurrentControlSet\Control\zxplug
		$a_00_4 = {25 2e 32 64 2d 25 2e 32 64 2d 25 2e 32 64 20 25 2e 32 64 3a 25 2e 32 64 3a 25 2e 32 64 } //1 %.2d-%.2d-%.2d %.2d:%.2d:%.2d
		$a_00_5 = {2d 67 65 74 20 66 74 70 3a 2f 2f 75 73 65 72 3a 70 61 73 73 } //1 -get ftp://user:pass
		$a_00_6 = {25 73 20 53 50 25 64 2e 25 64 28 25 64 29 } //1 %s SP%d.%d(%d)
		$a_00_7 = {32 30 32 2e 39 36 2e 31 32 38 2e 31 36 36 } //2 202.96.128.166
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*10+(#a_00_2  & 1)*1+(#a_01_3  & 1)*2+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*2) >=12
 
}
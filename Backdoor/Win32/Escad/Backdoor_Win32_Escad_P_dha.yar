
rule Backdoor_Win32_Escad_P_dha{
	meta:
		description = "Backdoor:Win32/Escad.P!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_00_0 = {23 39 39 45 32 34 32 38 43 43 41 34 33 30 39 43 36 38 41 41 46 38 43 36 31 36 45 46 33 33 30 36 35 38 32 41 36 34 35 31 33 45 35 35 43 37 38 36 41 38 36 34 42 43 38 33 44 41 46 45 30 43 37 38 35 } //2 #99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A864BC83DAFE0C785
		$a_00_1 = {5c 5c 3f 5c 45 6c 52 61 77 44 69 73 6b 5c 3f 3f 5c } //1 \\?\ElRawDisk\??\
		$a_00_2 = {20 63 6c 20 22 25 73 22 } //1  cl "%s"
		$a_02_3 = {64 65 6c 20 22 [0-10] 69 66 20 65 78 69 73 74 20 22 } //1
		$a_00_4 = {25 00 73 00 25 00 73 00 2e 00 73 00 79 00 73 00 } //1 %s%s.sys
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_02_3  & 1)*1+(#a_00_4  & 1)*1) >=4
 
}
rule Backdoor_Win32_Escad_P_dha_2{
	meta:
		description = "Backdoor:Win32/Escad.P!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_00_0 = {23 39 39 45 32 34 32 38 43 43 41 34 33 30 39 43 36 38 41 41 46 38 43 36 31 36 45 46 33 33 30 36 35 38 32 41 36 34 35 31 33 45 35 35 43 37 38 36 41 38 36 34 42 43 38 33 44 41 46 45 30 43 37 38 35 } //2 #99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A864BC83DAFE0C785
		$a_00_1 = {5c 5c 3f 5c 45 6c 52 61 77 44 69 73 6b 5c 3f 3f 5c } //1 \\?\ElRawDisk\??\
		$a_00_2 = {20 63 6c 20 22 25 73 22 } //1  cl "%s"
		$a_02_3 = {64 65 6c 20 22 [0-10] 69 66 20 65 78 69 73 74 20 22 } //1
		$a_00_4 = {25 00 73 00 25 00 73 00 2e 00 73 00 79 00 73 00 } //1 %s%s.sys
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_02_3  & 1)*1+(#a_00_4  & 1)*1) >=4
 
}
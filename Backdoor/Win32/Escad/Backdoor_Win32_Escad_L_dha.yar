
rule Backdoor_Win32_Escad_L_dha{
	meta:
		description = "Backdoor:Win32/Escad.L!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 06 00 00 "
		
	strings :
		$a_01_0 = {25 73 5c 25 49 36 34 75 5f 25 49 36 34 75 00 } //1
		$a_01_1 = {63 6d 64 2e 65 78 65 20 2f 63 20 22 25 73 20 3e 20 25 73 20 32 3e 26 31 } //1 cmd.exe /c "%s > %s 2>&1
		$a_01_2 = {43 4d 53 41 63 74 69 6f 6e 3a 3a } //1 CMSAction::
		$a_01_3 = {6e 73 68 77 66 70 2e 6f 78 70 00 } //1
		$a_01_4 = {6d 73 61 66 64 2e 61 78 70 00 } //1
		$a_01_5 = {73 63 63 62 61 73 65 2e 64 65 70 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=4
 
}
rule Backdoor_Win32_Escad_L_dha_2{
	meta:
		description = "Backdoor:Win32/Escad.L!dha,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 09 00 00 "
		
	strings :
		$a_01_0 = {80 3c 07 4a 75 10 80 7c 07 01 45 75 09 c6 04 07 4d c6 44 07 01 5a } //2
		$a_01_1 = {8b 13 8b ca 8b f2 c1 e9 1d c1 ee 1e 8b fa 83 e1 01 83 e6 01 c1 ef 1f } //2
		$a_01_2 = {81 bc 24 0c 08 00 00 01 01 13 20 74 14 8b cb } //1
		$a_00_3 = {31 37 31 32 31 41 42 33 2d 30 37 39 45 2d 34 36 32 32 2d 39 33 31 35 2d 34 34 43 30 33 36 34 43 36 31 32 33 } //1 17121AB3-079E-4622-9315-44C0364C6123
		$a_00_4 = {31 32 37 2e 30 2e 30 2e 31 2f 74 6f 70 2e 67 69 66 } //1 127.0.0.1/top.gif
		$a_00_5 = {63 6d 64 2e 65 78 65 20 2f 63 20 25 73 20 3e 20 22 25 73 22 20 32 3e 26 31 } //1 cmd.exe /c %s > "%s" 2>&1
		$a_00_6 = {31 2e 32 2e 37 2e 66 2d } //1 1.2.7.f-
		$a_00_7 = {2e 47 65 2e 74 45 2e 78 69 20 74 43 2e 6f 64 20 65 50 2e 20 72 6f 63 20 65 2e 73 73 00 } //1
		$a_00_8 = {52 2e 20 65 2e 67 51 75 2e 2e 65 20 72 79 56 2e 61 6c 2e 75 65 45 20 78 41 00 } //1
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1) >=3
 
}
rule Backdoor_Win32_Escad_L_dha_3{
	meta:
		description = "Backdoor:Win32/Escad.L!dha,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 09 00 00 "
		
	strings :
		$a_01_0 = {80 3c 07 4a 75 10 80 7c 07 01 45 75 09 c6 04 07 4d c6 44 07 01 5a } //2
		$a_01_1 = {8b 13 8b ca 8b f2 c1 e9 1d c1 ee 1e 8b fa 83 e1 01 83 e6 01 c1 ef 1f } //2
		$a_01_2 = {81 bc 24 0c 08 00 00 01 01 13 20 74 14 8b cb } //1
		$a_00_3 = {31 37 31 32 31 41 42 33 2d 30 37 39 45 2d 34 36 32 32 2d 39 33 31 35 2d 34 34 43 30 33 36 34 43 36 31 32 33 } //1 17121AB3-079E-4622-9315-44C0364C6123
		$a_00_4 = {31 32 37 2e 30 2e 30 2e 31 2f 74 6f 70 2e 67 69 66 } //1 127.0.0.1/top.gif
		$a_00_5 = {63 6d 64 2e 65 78 65 20 2f 63 20 25 73 20 3e 20 22 25 73 22 20 32 3e 26 31 } //1 cmd.exe /c %s > "%s" 2>&1
		$a_00_6 = {31 2e 32 2e 37 2e 66 2d } //1 1.2.7.f-
		$a_00_7 = {2e 47 65 2e 74 45 2e 78 69 20 74 43 2e 6f 64 20 65 50 2e 20 72 6f 63 20 65 2e 73 73 00 } //1
		$a_00_8 = {52 2e 20 65 2e 67 51 75 2e 2e 65 20 72 79 56 2e 61 6c 2e 75 65 45 20 78 41 00 } //1
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1) >=3
 
}
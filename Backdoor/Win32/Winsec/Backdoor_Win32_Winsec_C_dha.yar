
rule Backdoor_Win32_Winsec_C_dha{
	meta:
		description = "Backdoor:Win32/Winsec.C!dha,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 0d 00 00 "
		
	strings :
		$a_01_0 = {8a 03 3c 61 0f be c0 7d 05 83 e8 30 eb 03 83 e8 57 66 01 06 8a 43 01 43 84 c0 75 } //2
		$a_03_1 = {8b 4c 24 08 8b 44 24 04 85 c9 7e 0e 8a 10 80 ?? ?? 80 ?? ?? 88 10 40 49 75 f2 } //2
		$a_01_2 = {83 f8 1a 7d 09 83 c0 61 c3 83 f8 1a 7c 09 83 f8 34 7d 09 83 c0 27 c3 83 f8 34 7c 09 83 f8 3e 7d 07 83 c0 fc } //2
		$a_80_3 = {52 45 53 50 4f 4e 53 45 20 32 30 30 20 4f 4b 21 21 21 } //RESPONSE 200 OK!!!  1
		$a_80_4 = {50 4f 53 54 20 48 54 54 50 20 52 45 51 55 45 53 54 3f } //POST HTTP REQUEST?  1
		$a_80_5 = {25 73 20 2f 63 20 22 25 73 22 20 3e 25 73 20 32 3e 26 31 } //%s /c "%s" >%s 2>&1  2
		$a_80_6 = {54 68 65 72 65 20 61 72 65 6e 60 74 20 6f 70 65 6e 20 70 6f 72 74 73 2e } //There aren`t open ports.  2
		$a_80_7 = {63 6d 25 73 78 25 73 22 25 73 20 25 73 20 25 73 22 20 32 3e 25 73 } //cm%sx%s"%s %s %s" 2>%s  2
		$a_80_8 = {25 73 5c 25 63 25 63 25 63 25 63 25 63 25 63 25 63 25 63 25 73 } //%s\%c%c%c%c%c%c%c%c%s  2
		$a_80_9 = {32 59 71 48 37 44 45 50 59 4b 5a 36 37 77 50 67 71 76 37 5a 63 } //2YqH7DEPYKZ67wPgqv7Zc  1
		$a_80_10 = {72 77 59 67 71 59 6c 37 37 44 65 59 44 62 75 6d 7a 5a 67 62 69 65 37 71 } //rwYgqYl77DeYDbumzZgbie7q  1
		$a_80_11 = {7a 71 67 77 71 7a 59 77 51 76 43 59 72 71 77 44 46 76 69 62 67 71 43 65 59 77 63 } //zqgwqzYwQvCYrqwDFvibgqCeYwc  1
		$a_80_12 = {32 59 71 63 76 5a 4f 37 30 6c 65 77 59 67 4f 33 77 37 43 59 69 69 4b 4f } //2YqcvZO70lewYgO3w7CYiiKO  1
	condition:
		((#a_01_0  & 1)*2+(#a_03_1  & 1)*2+(#a_01_2  & 1)*2+(#a_80_3  & 1)*1+(#a_80_4  & 1)*1+(#a_80_5  & 1)*2+(#a_80_6  & 1)*2+(#a_80_7  & 1)*2+(#a_80_8  & 1)*2+(#a_80_9  & 1)*1+(#a_80_10  & 1)*1+(#a_80_11  & 1)*1+(#a_80_12  & 1)*1) >=6
 
}
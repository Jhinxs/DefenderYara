
rule Backdoor_Win32_SilverMob_A_dha{
	meta:
		description = "Backdoor:Win32/SilverMob.A!dha,SIGNATURE_TYPE_PEHSTR_EXT,16 00 16 00 06 00 00 "
		
	strings :
		$a_03_0 = {b2 c0 50 51 c6 44 24 0c [0-05] c6 44 24 0e ?? c6 44 24 0f ?? c6 44 24 11 ?? c6 44 24 12 ?? c6 44 24 14 ?? c6 44 24 15 ?? c6 44 24 16 [0-05] c6 44 24 18 ?? c6 44 24 19 ?? c6 44 24 1a ?? c6 44 24 1b ?? e8 (?? ?? ?? ?? 33|c0 ?? ?? ?? ?? 83) c4 1c } //20
		$a_03_1 = {33 d2 8a 91 ?? ?? ?? ?? ff 24 95 ?? ?? ?? ?? 8b 44 24 08 50 e8 ?? ?? 00 00 83 c4 04 c3 } //10
		$a_00_2 = {70 00 69 00 6e 00 67 00 20 00 31 00 32 00 37 00 2e 00 30 00 2e 00 30 00 2e 00 31 00 20 00 2d 00 6e 00 20 00 33 00 } //1 ping 127.0.0.1 -n 3
		$a_00_3 = {32 00 2e 00 30 00 32 00 } //1 2.02
		$a_00_4 = {25 00 73 00 25 00 73 00 25 00 73 00 20 00 22 00 25 00 73 00 20 00 3e 00 20 00 25 00 73 00 20 00 32 00 3e 00 26 00 31 00 22 00 } //1 %s%s%s "%s > %s 2>&1"
		$a_00_5 = {22 00 20 00 67 00 6f 00 74 00 6f 00 20 00 6c 00 6f 00 6f 00 70 00 } //1 " goto loop
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*10+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=22
 
}
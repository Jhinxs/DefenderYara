
rule Backdoor_Win32_Dusenr_A{
	meta:
		description = "Backdoor:Win32/Dusenr.A,SIGNATURE_TYPE_PEHSTR_EXT,22 00 22 00 09 00 00 "
		
	strings :
		$a_00_0 = {53 68 65 6c 6c 2e 44 75 73 6e } //5 Shell.Dusn
		$a_00_1 = {47 6c 6f 62 61 6c 5c 57 49 4e 50 4f 50 55 50 5f 4d 45 4d 4f 52 59 } //5 Global\WINPOPUP_MEMORY
		$a_03_2 = {63 66 67 3a [0-20] 2e 74 6d 70 } //5
		$a_01_3 = {65 00 78 00 74 00 5c 00 73 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 7b 00 31 00 31 00 66 00 30 00 39 00 61 00 66 00 65 00 2d 00 37 00 35 00 61 00 64 00 2d 00 34 00 65 00 35 00 32 00 2d 00 61 00 62 00 34 00 33 00 2d 00 65 00 30 00 39 00 65 00 39 00 33 00 35 00 31 00 63 00 65 00 31 00 37 00 7d 00 } //5 ext\settings\{11f09afe-75ad-4e52-ab43-e09e9351ce17}
		$a_00_4 = {63 6e 72 64 6e 2e 63 6f 6d } //5 cnrdn.com
		$a_00_5 = {2e 63 6e 7a 7a 2e 63 6f 6d 2f 73 74 61 74 2e 70 68 70 3f 69 64 } //5 .cnzz.com/stat.php?id
		$a_00_6 = {53 65 72 76 65 72 3a 20 41 70 61 63 68 65 } //2 Server: Apache
		$a_00_7 = {32 30 38 2e 36 37 2e } //2 208.67.
		$a_00_8 = {31 31 34 2e 31 31 34 2e } //2 114.114.
	condition:
		((#a_00_0  & 1)*5+(#a_00_1  & 1)*5+(#a_03_2  & 1)*5+(#a_01_3  & 1)*5+(#a_00_4  & 1)*5+(#a_00_5  & 1)*5+(#a_00_6  & 1)*2+(#a_00_7  & 1)*2+(#a_00_8  & 1)*2) >=34
 
}

rule Backdoor_Win32_PornDialer_G{
	meta:
		description = "Backdoor:Win32/PornDialer.G,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 17 00 00 "
		
	strings :
		$a_00_0 = {57 65 62 64 69 61 6c 65 72 } //1 Webdialer
		$a_00_1 = {64 69 61 6c 65 72 2e 63 6f 6d } //1 dialer.com
		$a_00_2 = {64 69 61 6c 75 70 2e } //1 dialup.
		$a_00_3 = {64 69 61 6c 69 6e 2e } //1 dialin.
		$a_00_4 = {7b 31 46 42 41 30 34 45 45 2d 33 30 32 34 2d 31 31 44 32 2d 38 46 31 46 2d 30 30 30 30 46 38 37 41 42 44 31 36 7d } //1 {1FBA04EE-3024-11D2-8F1F-0000F87ABD16}
		$a_00_5 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 5c 45 78 74 65 6e 73 69 6f 6e 73 } //1 Software\Microsoft\Internet Explorer\Extensions
		$a_00_6 = {72 61 73 61 70 69 33 32 } //1 rasapi32
		$a_00_7 = {6d 6f 64 65 6d } //1 modem
		$a_00_8 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 52 41 53 20 50 68 6f 6e 65 62 6f 6f 6b } //1 Software\Microsoft\RAS Phonebook
		$a_00_9 = {39 30 30 20 74 65 6c 65 70 68 6f 6e 65 } //1 900 telephone
		$a_01_10 = {31 38 20 79 65 61 72 73 } //1 18 years
		$a_01_11 = {31 38 20 59 45 41 52 53 } //1 18 YEARS
		$a_00_12 = {53 74 61 72 64 69 61 6c 65 72 } //1 Stardialer
		$a_00_13 = {25 73 5c 2d 20 25 73 20 2d 5c 25 73 20 25 73 2e 6c 6e 6b } //1 %s\- %s -\%s %s.lnk
		$a_01_14 = {2f 6d 69 6e } //1 /min
		$a_01_15 = {2f 4d 69 6e } //1 /Min
		$a_00_16 = {2a 73 65 6e 64 6d 61 6e } //1 *sendman
		$a_00_17 = {73 74 65 72 72 65 69 63 68 } //1 sterreich
		$a_00_18 = {30 31 39 30 38 34 36 33 38 38 31 35 } //1 019084638815
		$a_00_19 = {30 39 33 30 38 32 30 37 30 34 } //1 0930820704
		$a_00_20 = {31 39 30 30 38 30 37 38 38 } //1 190080788
		$a_00_21 = {66 69 6e 64 65 6e 20 53 69 65 20 68 69 65 72 20 77 77 77 2e 67 6c 6f 62 61 6c 2d 6e 65 74 63 6f 6d 2e 64 65 2f 44 69 61 6c 65 72 2d 41 47 42 } //1 finden Sie hier www.global-netcom.de/Dialer-AGB
		$a_00_22 = {50 72 69 6e 74 20 77 69 74 68 20 7a 6f 64 69 61 63 20 73 69 67 6e 20 62 65 74 77 65 65 6e 20 64 65 67 72 65 65 73 20 61 6e 64 20 6d 69 6e 75 74 65 73 } //-100 Print with zodiac sign between degrees and minutes
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_00_16  & 1)*1+(#a_00_17  & 1)*1+(#a_00_18  & 1)*1+(#a_00_19  & 1)*1+(#a_00_20  & 1)*1+(#a_00_21  & 1)*1+(#a_00_22  & 1)*-100) >=8
 
}
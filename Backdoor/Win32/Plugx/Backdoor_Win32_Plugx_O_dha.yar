
rule Backdoor_Win32_Plugx_O_dha{
	meta:
		description = "Backdoor:Win32/Plugx.O!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 08 00 00 "
		
	strings :
		$a_01_0 = {75 36 80 78 01 65 75 30 80 78 02 74 75 2a 80 78 03 50 75 24 80 78 04 72 75 1e 80 78 05 6f 75 18 80 78 06 63 75 12 80 78 07 41 75 0c 80 78 08 64 75 06 80 78 09 64 } //2
		$a_01_1 = {b0 d0 03 00 01 0d 81 10 30 00 10 3c 10 63 3d 04 30 00 10 00 70 05 36 c6 56 56 c7 40 04 70 00 } //1
		$a_01_2 = {8b 0d 00 30 00 10 8d 81 10 30 00 10 83 c1 09 c7 00 52 65 61 64 c7 40 04 46 69 6c 65 89 7d f8 88 58 08 89 0d 00 30 00 10 39 1d 04 30 00 10 75 27 } //1
		$a_01_3 = {c7 00 6c 73 74 72 c7 40 04 63 70 79 57 88 58 08 89 0d 00 30 00 10 39 1d 04 30 00 10 75 25 64 8b 0d 30 00 00 00 } //1
		$a_01_4 = {ff d6 6a 00 6a 00 6a 00 88 5f 01 ff d6 6a 00 6a 00 6a 00 88 7f 02 ff d6 8a 55 fe 6a 00 6a 00 6a 00 88 57 03 ff d6 8a 45 ff } //1
		$a_01_5 = {0f b7 4d e8 0f b7 55 ea 6b c9 64 0f b7 45 ee 03 ca 6b c9 64 03 c8 81 f9 } //1
		$a_01_6 = {2b c3 89 45 f0 c7 45 f4 08 00 00 00 6a 00 6a 00 6a 00 ff d6 8b 55 f0 8a 04 1a ff 05 00 30 00 10 2c 6b 6a 00 34 3f 6a 00 04 6b 6a 00 88 03 ff d6 } //1
		$a_01_7 = {8b 4d f8 8b 41 24 8b 55 fc 8b 49 1c 8d 14 50 8b 45 f4 0f b7 14 02 8d 14 91 8b 34 02 03 f0 eb 03 } //1
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=4
 
}
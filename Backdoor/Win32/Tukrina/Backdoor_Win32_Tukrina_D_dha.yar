
rule Backdoor_Win32_Tukrina_D_dha{
	meta:
		description = "Backdoor:Win32/Tukrina.D!dha,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 0c 00 00 "
		
	strings :
		$a_43_0 = {66 89 45 90 01 01 6a 73 58 66 89 45 90 01 01 6a 33 58 66 89 45 90 01 01 6a 32 58 66 89 45 90 01 01 6a 6c 58 66 89 45 90 01 01 6a 6f 58 66 89 45 90 01 01 6a 63 58 90 00 06 } //6
		$a_6a_1 = {66 89 90 02 05 58 6a 69 66 89 90 02 05 58 6a 63 66 89 90 02 05 58 6a 72 66 89 90 02 05 58 6a 6f 90 00 06 00 25 43 6a 4d 58 66 89 90 02 05 6a 69 58 66 89 90 02 05 6a 63 58 66 89 90 02 05 6a 72 58 66 89 } //9216
		$a_6a_2 = {58 90 00 06 00 } //656
		$a_4f_3 = {00 00 66 89 84 24 90 01 04 b8 6e 00 00 00 66 89 84 24 90 01 04 b8 65 00 00 00 66 89 84 24 90 01 04 b8 44 00 00 00 66 89 84 24 90 01 04 b8 72 00 00 00 66 89 84 24 90 01 04 b8 69 00 00 00 90 00 06 00 4f 43 b8 30 55 00 00 66 89 84 24 90 01 04 b8 2d 55 00 00 66 89 84 24 90 01 04 b8 25 55 00 00 66 89 84 24 90 01 04 b8 39 55 00 00 66 89 84 24 90 01 04 b8 3a 55 00 00 66 89 84 24 90 01 04 b8 27 55 00 00 66 89 84 24 90 01 04 b8 30 55 00 00 90 00 02 00 16 43 1a 25 30 3b c7 90 02 05 05 27 3a 36 c7 90 02 05 30 26 26 55 90 00 02 00 16 43 16 27 30 34 c7 90 02 } //17219
		$a_05_4 = {27 c7 90 02 05 3a 36 30 26 90 00 02 00 16 43 03 3c 27 21 c7 90 02 05 20 34 39 14 c7 90 02 05 39 39 3a 36 90 00 02 00 16 43 16 39 3a 26 c7 90 02 } //8453
		$a_34_5 = {c7 90 02 05 31 39 30 55 90 00 02 00 20 01 06 55 30 55 11 55 30 55 37 55 20 55 32 55 05 } //12293
		$a_3c_6 = {23 55 3c 55 39 55 30 55 32 55 30 55 02 00 bc 01 5b 00 61 00 63 00 74 00 69 00 76 00 61 00 74 00 6f 00 72 00 5d 00 3a 00 3a 00 43 00 72 00 65 00 61 00 74 00 65 00 49 00 6e 00 73 00 74 00 61 00 6e 00 63 00 65 00 28 00 5b 00 54 00 79 00 70 00 65 00 5d 00 3a } //10069
		$a_00_8 = {54 00 79 00 70 00 65 00 46 00 72 00 6f 00 6d 00 43 00 4c 00 53 00 49 00 44 00 28 00 27 00 39 00 42 00 41 00 30 00 35 00 39 00 37 00 32 00 2d 00 46 00 36 00 41 00 38 00 2d 00 31 00 31 00 43 00 46 00 2d 00 41 00 34 00 34 00 32 00 2d 00 30 00 30 00 41 00 30 00 43 00 39 00 30 00 41 00 38 00 46 00 33 00 39 00 27 00 29 00 29 00 3b 00 04 00 30 01 25 00 } //101
		$a_00_9 = {00 00 25 00 32 00 33 00 00 00 25 00 32 00 34 00 00 00 25 00 32 00 36 00 00 00 25 00 32 00 37 00 00 00 25 00 32 00 38 00 00 00 00 00 5d 04 00 00 5d } //50
		$a_5c_10 = {00 00 5f f9 03 80 00 00 01 00 08 00 11 00 ac 21 4b 65 72 66 75 66 66 6c 65 2e 43 21 64 68 61 00 00 01 40 05 82 70 00 04 00 78 8d 00 00 07 00 07 00 08 00 00 01 00 0c 01 64 6c 6c 5f 77 57 69 6e 4d 61 69 6e 01 00 0e 01 49 6e 73 74 4c 73 70 44 6c 6c 2e 64 6c 6c 01 00 0c 01 49 6d 6d 57 69 6e 33 32 2e 69 6d 65 01 00 0b 01 6d 73 64 74 63 36 34 2e 73 79 73 02 00 0b 01 63 6f 6e 69 6d 65 31 } //1017
		$a_74_11 = {00 0a 01 57 69 6e 41 64 76 2e 62 61 6b 02 00 10 01 54 65 6d 70 5c 00 00 00 6b 65 6c 6c 2e 64 61 74 02 00 0e 01 54 65 6d 70 5c 00 00 00 77 6e 64 70 77 64 00 00 5d 04 00 00 5f f9 03 80 5c 26 00 00 60 f9 03 80 00 00 01 00 08 00 10 00 ac 21 4b 65 72 72 44 6f 77 6e 2e 42 21 64 68 61 00 00 01 40 } //25646
	condition:
		((#a_43_0  & 1)*6+(#a_6a_1  & 1)*9216+(#a_6a_2  & 1)*656+(#a_4f_3  & 1)*17219+(#a_05_4  & 1)*8453+(#a_34_5  & 1)*12293+(#a_3c_6  & 1)*10069+(#a_00_8  & 1)*101+(#a_00_9  & 1)*50+(#a_5c_10  & 1)*1017+(#a_74_11  & 1)*25646) >=10
 
}
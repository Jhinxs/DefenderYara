
rule Backdoor_Win32_Hackdef_AV_MTB{
	meta:
		description = "Backdoor:Win32/Hackdef.AV!MTB,SIGNATURE_TYPE_PEHSTR_EXT,09 00 09 00 0c 00 00 "
		
	strings :
		$a_80_0 = {73 79 73 74 65 6d 72 6f 6f 74 } //systemroot  1
		$a_80_1 = {73 65 6c 66 6b 69 6c 6c } //selfkill  1
		$a_80_2 = {6b 69 6c 6c 61 6c 6c 74 75 6e 73 } //killalltuns  1
		$a_80_3 = {5c 6c 69 62 63 72 79 70 74 6f 2e 64 6c 6c } //\libcrypto.dll  1
		$a_80_4 = {2f 63 20 70 69 6e 67 20 6c 6f 63 61 6c 68 6f 73 74 20 2d 6e 20 33 30 20 3e 20 6e 75 6c 20 26 20 64 65 6c } ///c ping localhost -n 30 > nul & del  1
		$a_80_5 = {78 63 6f 70 79 } //xcopy  1
		$a_02_6 = {41 00 70 00 70 00 44 00 61 00 74 00 61 00 5c 00 4c 00 6f 00 63 00 61 00 6c 00 5c 00 47 00 6f 00 6f 00 67 00 6c 00 65 00 5c 00 43 00 68 00 72 00 6f 00 6d 00 65 00 5c 00 55 00 73 00 65 00 72 00 20 00 44 00 61 00 74 00 61 00 5c 00 44 00 65 00 66 00 61 00 75 00 6c 00 74 00 [0-08] 2f 00 59 00 20 00 2f 00 48 00 20 00 2f 00 45 00 20 00 2f 00 65 00 78 00 63 00 6c 00 75 00 64 00 65 00 3a 00 25 00 74 00 65 00 6d 00 70 00 25 00 5c 00 [0-08] 2e 00 74 00 78 00 74 00 } //1
		$a_02_7 = {41 70 70 44 61 74 61 5c 4c 6f 63 61 6c 5c 47 6f 6f 67 6c 65 5c 43 68 72 6f 6d 65 5c 55 73 65 72 20 44 61 74 61 5c 44 65 66 61 75 6c 74 [0-08] 2f 59 20 2f 48 20 2f 45 20 2f 65 78 63 6c 75 64 65 3a 25 74 65 6d 70 25 5c [0-08] 2e 74 78 74 } //1
		$a_02_8 = {41 00 70 00 70 00 44 00 61 00 74 00 61 00 5c 00 72 00 6f 00 61 00 6d 00 69 00 6e 00 67 00 5c 00 4d 00 6f 00 7a 00 69 00 6c 00 6c 00 61 00 5c 00 46 00 69 00 72 00 65 00 66 00 6f 00 78 00 5c 00 50 00 72 00 6f 00 66 00 69 00 6c 00 65 00 73 00 [0-08] 2f 00 59 00 20 00 2f 00 48 00 20 00 2f 00 45 00 20 00 2f 00 65 00 78 00 63 00 6c 00 75 00 64 00 65 00 3a 00 25 00 74 00 65 00 6d 00 70 00 25 00 5c 00 [0-08] 2e 00 74 00 78 00 74 00 } //1
		$a_02_9 = {41 70 70 44 61 74 61 5c 72 6f 61 6d 69 6e 67 5c 4d 6f 7a 69 6c 6c 61 5c 46 69 72 65 66 6f 78 5c 50 72 6f 66 69 6c 65 73 [0-08] 2f 59 20 2f 48 20 2f 45 20 2f 65 78 63 6c 75 64 65 3a 25 74 65 6d 70 25 5c [0-08] 2e 74 78 74 } //1
		$a_80_10 = {70 61 72 65 6e 74 2e 6c 6f 63 6b } //parent.lock  1
		$a_80_11 = {55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 46 69 6c 65 57 } //URLDownloadToFileW  1
	condition:
		((#a_80_0  & 1)*1+(#a_80_1  & 1)*1+(#a_80_2  & 1)*1+(#a_80_3  & 1)*1+(#a_80_4  & 1)*1+(#a_80_5  & 1)*1+(#a_02_6  & 1)*1+(#a_02_7  & 1)*1+(#a_02_8  & 1)*1+(#a_02_9  & 1)*1+(#a_80_10  & 1)*1+(#a_80_11  & 1)*1) >=9
 
}

rule Backdoor_Win32_IRCbot_BH{
	meta:
		description = "Backdoor:Win32/IRCbot.BH,SIGNATURE_TYPE_PEHSTR_EXT,05 00 04 00 07 00 00 "
		
	strings :
		$a_01_0 = {b9 f4 01 00 00 bb 41 41 41 41 2b 4d fc 8b c3 8d bd 3e fd ff ff 8d b5 60 f9 ff ff 8b d1 6a 02 c1 e9 02 f3 ab 8b ca ba 32 02 00 00 } //4
		$a_03_1 = {ff d7 85 c0 75 47 83 7d fc 02 77 41 ff 15 ?? ?? ?? ?? 83 f8 05 74 0b ff 15 ?? ?? ?? ?? 83 f8 20 75 1a ff d6 2b 45 f8 3d a0 86 01 00 73 0b 68 e8 03 00 00 } //5
		$a_03_2 = {7e 59 c7 45 08 ?? ?? 40 00 8b 4d 08 66 8b 46 14 66 39 01 75 18 57 68 ?? ?? 40 00 6a 02 57 66 89 47 10 89 5f 14 e8 ?? ?? 00 00 83 c4 10 83 45 08 28 } //5
		$a_00_3 = {50 52 49 56 4d 53 47 00 02 5b 02 03 31 32 25 73 03 02 5d 02 3a 20 45 78 70 6c 6f 69 74 65 64 3a 20 25 73 } //1
		$a_00_4 = {53 52 56 53 56 43 00 00 2a 53 65 72 76 65 72 20 32 30 30 33 20 2a 00 00 2a 4c 41 4e 20 4d 61 6e 61 67 65 72 20 34 2e 30 2a } //1
		$a_00_5 = {45 78 70 6c 6f 69 74 20 53 74 61 74 69 73 74 69 63 73 3a 00 25 69 2e 25 69 2e 78 2e 78 00 00 00 78 2e 78 2e 78 2e 78 00 6e 6f 6e 65 00 00 00 00 02 5b 02 03 31 32 53 43 41 4e 03 02 5d } //1
		$a_01_6 = {4d 53 30 38 2d 30 36 37 } //1 MS08-067
	condition:
		((#a_01_0  & 1)*4+(#a_03_1  & 1)*5+(#a_03_2  & 1)*5+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_01_6  & 1)*1) >=4
 
}

rule Backdoor_Win32_Wydtin_A{
	meta:
		description = "Backdoor:Win32/Wydtin.A,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 0c 00 00 "
		
	strings :
		$a_01_0 = {64 79 77 74 2e 63 6f 6d 2e 63 6e } //1 dywt.com.cn
		$a_01_1 = {3d 3f 67 62 32 33 31 32 3f 42 3f } //1 =?gb2312?B?
		$a_00_2 = {64 30 39 66 32 33 34 30 38 31 38 35 31 31 64 33 39 36 66 36 61 61 66 38 34 34 63 37 65 33 32 35 } //1 d09f2340818511d396f6aaf844c7e325
		$a_00_3 = {46 37 46 43 31 41 45 34 35 43 35 43 34 37 35 38 41 46 30 33 45 46 31 39 46 31 38 41 33 39 35 44 } //1 F7FC1AE45C5C4758AF03EF19F18A395D
		$a_03_4 = {4c 4f 47 49 4e [0-20] 45 48 4c 4f 20 25 73 } //1
		$a_01_5 = {4d 41 49 4c 20 46 52 4f 4d 3a 3c 25 73 3e } //1 MAIL FROM:<%s>
		$a_01_6 = {52 43 50 54 20 54 4f 3a 3c 25 73 3e } //1 RCPT TO:<%s>
		$a_03_7 = {61 74 74 61 63 68 6d 65 6e 74 [0-10] 66 69 6c 65 6e 61 6d 65 3d 25 73 } //1
		$a_01_8 = {5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 53 79 73 74 65 6d 5c 44 69 73 61 62 6c 65 54 61 73 6b 4d 67 72 } //1 \Windows\CurrentVersion\Policies\System\DisableTaskMgr
		$a_01_9 = {65 78 65 66 69 6c 65 5c 73 68 65 6c 6c 5c 6f 70 65 6e 5c 63 6f 6d 6d 61 6e 64 5c 00 51 51 2e 65 78 65 } //1 硥晥汩履桳汥屬灯湥捜浯慭摮\兑攮數
		$a_01_10 = {73 6d 74 70 2e 71 71 2e 63 6f 6d } //1 smtp.qq.com
		$a_01_11 = {43 3a 5c 57 49 4e 44 4f 57 53 5c 63 69 74 79 31 5c 00 2e 6a 70 67 } //1 㩃坜义佄南捜瑩ㅹ\樮杰
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_03_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_03_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1) >=12
 
}
rule Backdoor_Win32_Wydtin_A_2{
	meta:
		description = "Backdoor:Win32/Wydtin.A,SIGNATURE_TYPE_PEHSTR_EXT,0c 00 0c 00 0d 00 00 "
		
	strings :
		$a_01_0 = {64 79 77 74 2e 63 6f 6d 2e 63 6e } //1 dywt.com.cn
		$a_01_1 = {3d 3f 67 62 32 33 31 32 3f 42 3f } //1 =?gb2312?B?
		$a_03_2 = {6b 72 6e 6c 6e 2e 66 6e 72 [0-05] 64 30 39 66 32 33 34 30 38 31 38 35 31 31 64 33 39 36 66 36 61 61 66 38 34 34 63 37 65 33 32 35 } //1
		$a_03_3 = {70 6f 70 33 [0-05] 36 36 33 39 31 33 34 45 38 32 33 34 34 36 33 37 41 37 31 41 42 31 44 36 42 37 30 43 32 30 35 31 } //1
		$a_03_4 = {69 6e 74 65 72 6e 65 74 [0-05] 37 30 37 63 61 33 37 33 32 32 34 37 34 66 36 63 61 38 34 31 66 30 65 32 32 34 66 34 62 36 32 30 } //1
		$a_03_5 = {4c 4f 47 49 4e [0-20] 45 48 4c 4f 20 25 73 } //1
		$a_01_6 = {4d 41 49 4c 20 46 52 4f 4d 3a 3c 25 73 3e } //1 MAIL FROM:<%s>
		$a_01_7 = {52 43 50 54 20 54 4f 3a 3c 25 73 3e } //1 RCPT TO:<%s>
		$a_03_8 = {61 74 74 61 63 68 6d 65 6e 74 [0-10] 66 69 6c 65 6e 61 6d 65 3d 25 73 } //1
		$a_01_9 = {43 6f 6e 6e 65 63 74 46 54 50 53 65 72 76 65 72 } //1 ConnectFTPServer
		$a_01_10 = {47 65 74 46 74 70 46 69 6c 65 } //1 GetFtpFile
		$a_01_11 = {50 75 74 46 74 70 46 69 6c 65 } //1 PutFtpFile
		$a_01_12 = {47 65 74 48 74 74 70 46 69 6c 65 } //1 GetHttpFile
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_03_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1) >=12
 
}
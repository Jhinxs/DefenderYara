
rule Virus_Win32_Rungbu_gen_C{
	meta:
		description = "Virus:Win32/Rungbu.gen!C,SIGNATURE_TYPE_PEHSTR,1c 00 14 00 1e 00 00 "
		
	strings :
		$a_01_0 = {40 00 7a 00 6f 00 6b 00 75 00 6b 00 65 00 } //1 @zokuke
		$a_01_1 = {48 00 35 00 4e 00 31 00 21 00 2e 00 76 00 62 00 70 00 } //1 H5N1!.vbp
		$a_01_2 = {7e 00 46 00 6c 00 75 00 5f 00 42 00 75 00 72 00 75 00 6e 00 67 00 2e 00 74 00 6d 00 70 00 } //2 ~Flu_Burung.tmp
		$a_01_3 = {73 00 68 00 65 00 6c 00 6c 00 33 00 32 00 2e 00 64 00 6c 00 6c 00 2c 00 4f 00 70 00 65 00 6e 00 41 00 73 00 5f 00 52 00 75 00 6e 00 44 00 4c 00 4c 00 } //1 shell32.dll,OpenAs_RunDLL
		$a_01_4 = {2e 00 45 00 58 00 45 00 20 00 3a 00 61 00 67 00 65 00 6e 00 74 00 } //1 .EXE :agent
		$a_01_5 = {62 00 65 00 67 00 6f 00 6c 00 75 00 2e 00 74 00 78 00 74 00 } //1 begolu.txt
		$a_01_6 = {3a 00 20 00 52 00 61 00 76 00 65 00 6e 00 20 00 54 00 65 00 61 00 6d 00 20 00 47 00 61 00 6d 00 65 00 20 00 54 00 72 00 69 00 70 00 6c 00 65 00 20 00 42 00 75 00 7a 00 7a 00 21 00 } //1 : Raven Team Game Triple Buzz!
		$a_01_7 = {49 00 74 00 27 00 73 00 20 00 4f 00 4b 00 20 00 59 00 6f 00 75 00 20 00 47 00 6f 00 74 00 20 00 4d 00 65 00 21 00 2e 00 20 00 53 00 65 00 65 00 20 00 79 00 6f 00 75 00 2e 00 2e 00 2e 00 } //1 It's OK You Got Me!. See you...
		$a_01_8 = {46 00 4c 00 55 00 5f 00 42 00 55 00 52 00 55 00 4e 00 47 00 } //2 FLU_BURUNG
		$a_01_9 = {57 00 69 00 6e 00 57 00 6f 00 72 00 64 00 2e 00 65 00 78 00 65 00 } //1 WinWord.exe
		$a_01_10 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 43 00 4c 00 41 00 53 00 53 00 45 00 53 00 5c 00 73 00 63 00 72 00 66 00 69 00 6c 00 65 00 } //1 SOFTWARE\CLASSES\scrfile
		$a_01_11 = {4f 6c 65 68 2d 6f 6c 65 68 20 64 61 72 69 20 41 4d 42 4f 4e } //1 Oleh-oleh dari AMBON
		$a_01_12 = {4b 61 74 6f 6e 67 20 70 75 6e 67 20 6a 75 61 20 62 69 73 61 } //1 Katong pung jua bisa
		$a_01_13 = {53 45 4c 41 4d 41 54 20 55 4c 54 41 48 20 4b 45 2d 32 30 20 41 67 6e 65 73 20 4d 6f 6e 69 63 61 21 } //1 SELAMAT ULTAH KE-20 Agnes Monica!
		$a_01_14 = {4d 6f 6f 6e 44 61 6e 63 65 } //1 MoonDance
		$a_01_15 = {4d 61 73 75 6b 61 6e 20 4e 61 6d 61 20 6f 72 61 6e 67 20 73 61 6b 74 69 4e 69 67 68 74 53 74 61 6c 6b 65 72 } //1 Masukan Nama orang saktiNightStalker
		$a_01_16 = {4f 50 45 52 41 20 54 48 45 20 46 41 53 54 20 41 4e 44 20 46 55 52 59 20 4f 46 20 4d 59 20 46 49 53 54 21 } //1 OPERA THE FAST AND FURY OF MY FIST!
		$a_01_17 = {54 6f 6d 62 20 52 61 69 64 65 72 20 33 32 2d 62 69 74 } //1 Tomb Raider 32-bit
		$a_01_18 = {53 68 65 6c 6c 45 78 65 63 75 74 65 41 } //1 ShellExecuteA
		$a_01_19 = {53 6c 61 6d 61 74 20 4d 75 61 61 61 63 68 21 21 21 20 28 44 69 6e 6f 20 47 69 74 63 68 75 29 } //1 Slamat Muaaach!!! (Dino Gitchu)
		$a_01_20 = {49 64 69 69 69 68 2e 2e 2e 2e 21 20 28 54 72 61 64 65 72 29 } //1 Idiiih....! (Trader)
		$a_01_21 = {70 73 61 70 69 2e 64 6c 6c } //1 psapi.dll
		$a_01_22 = {47 65 74 4d 6f 64 75 6c 65 46 69 6c 65 4e 61 6d 65 45 78 41 } //1 GetModuleFileNameExA
		$a_01_23 = {45 6e 75 6d 50 72 6f 63 65 73 73 4d 6f 64 75 6c 65 73 } //1 EnumProcessModules
		$a_01_24 = {50 72 6f 63 65 73 73 33 32 4e 65 78 74 } //1 Process32Next
		$a_01_25 = {52 65 67 53 65 74 56 61 6c 75 65 45 78 41 } //1 RegSetValueExA
		$a_01_26 = {53 70 69 64 65 72 57 65 62 } //1 SpiderWeb
		$a_01_27 = {50 72 6f 63 43 61 6c 6c 45 6e 67 69 6e 65 } //1 ProcCallEngine
		$a_01_28 = {5a 3a 5c 52 61 76 65 6e 20 54 65 61 6d 20 53 6f 66 74 77 61 72 65 5c 48 35 4e 31 2d 46 6c 75 42 75 72 75 6e 67 5c 52 54 41 5c 56 42 39 38 5c 56 42 36 2e 4f 4c 42 } //1 Z:\Raven Team Software\H5N1-FluBurung\RTA\VB98\VB6.OLB
		$a_01_29 = {42 75 67 73 20 42 75 6e 6e 79 20 73 61 79 20 22 57 68 61 74 27 73 20 75 70 20 64 6f 63 3f 22 } //1 Bugs Bunny say "What's up doc?"
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*2+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*2+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_01_16  & 1)*1+(#a_01_17  & 1)*1+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1+(#a_01_23  & 1)*1+(#a_01_24  & 1)*1+(#a_01_25  & 1)*1+(#a_01_26  & 1)*1+(#a_01_27  & 1)*1+(#a_01_28  & 1)*1+(#a_01_29  & 1)*1) >=20
 
}
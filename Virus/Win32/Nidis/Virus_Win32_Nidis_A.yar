
rule Virus_Win32_Nidis_A{
	meta:
		description = "Virus:Win32/Nidis.A,SIGNATURE_TYPE_PEHSTR_EXT,04 00 03 00 06 00 00 "
		
	strings :
		$a_00_0 = {6a 32 5f 6f 76 6f 73 5f 32 00 00 00 5c 00 3f 00 3f 00 5c 00 63 00 3a 00 5c 00 63 00 64 00 00 00 2e 00 6e 00 6c 00 73 00 00 00 00 00 63 00 3a 00 5c 00 63 00 64 00 00 00 2e 00 6e 00 6c 00 73 00 } //2
		$a_02_1 = {57 66 81 3a 4d 5a 74 ?? b8 be 00 00 00 eb ?? 8b 7a 3c 01 d7 66 81 3f 50 45 74 ?? b8 c8 00 00 00 eb ?? 8b 47 28 e8 ?? ?? 00 00 83 f8 00 75 ?? b8 d2 00 00 00 5f c3 } //1
		$a_02_2 = {53 51 57 56 66 81 3a 4d 5a 74 ?? b8 be 00 00 00 e9 ?? ?? 00 00 8b 7a 3c 01 d7 66 81 3f 50 45 74 ?? b8 c8 00 00 00 eb ?? 8b 87 a0 00 00 00 8b bf a4 00 00 00 e8 ?? ?? 00 00 83 f8 00 75 ?? b8 d2 00 00 00 eb ?? 89 c6 01 c7 39 fe 73 ?? 8b 4e 04 83 e9 02 83 f9 08 } //1
		$a_02_3 = {51 52 56 57 53 89 c6 89 da 66 81 3a 4d 5a 74 ?? b8 46 00 00 00 e9 ?? ?? 00 00 8b 7a 3c 01 d7 66 81 3f 50 45 74 ?? b8 50 00 00 00 e9 ?? ?? 00 00 8b 47 78 e8 ?? ?? 00 00 83 f8 00 75 ?? b8 5a 00 00 00 e9 ?? ?? 00 00 89 c3 89 f7 8b 43 20 e8 ?? ?? 00 00 89 c6 31 c9 83 fe 00 75 ?? b8 64 00 00 00 eb ?? 3b 4b 18 } //1
		$a_02_4 = {57 51 66 81 3a 4d 5a 74 ?? b8 0a 00 00 00 eb ?? 8b 7a 3c 01 d7 66 81 3f 50 45 74 ?? b8 14 00 00 00 eb ?? 8b 87 80 00 00 00 e8 ?? ?? ff ff 83 f8 00 75 ?? b8 1e 00 00 00 eb ?? 89 c1 83 79 0c 00 74 ?? e8 ?? ?? ff ff 83 c1 14 eb ?? e8 ?? ?? ff ff 59 5f c3 } //1
		$a_02_5 = {57 53 8a 1f 8a 38 80 fb 41 7c ?? 80 fb 5a 7f ?? 80 c3 20 80 ff 41 7c ?? 80 ff 5a 7f ?? 80 c7 20 38 fb 75 ?? 80 fb 00 74 ?? 47 40 eb ?? b8 01 00 00 00 eb ?? b8 00 00 00 00 5b 5f c3 } //1
	condition:
		((#a_00_0  & 1)*2+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1+(#a_02_3  & 1)*1+(#a_02_4  & 1)*1+(#a_02_5  & 1)*1) >=3
 
}
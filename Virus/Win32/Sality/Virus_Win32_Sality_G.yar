
rule Virus_Win32_Sality_G{
	meta:
		description = "Virus:Win32/Sality.G,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_03_0 = {41 4c 45 52 [0-06] 54 52 45 4e [0-06] 54 52 4f 4a [0-06] 41 4e 44 41 } //1
		$a_03_1 = {2e 74 6a 63 [0-06] 2e 61 76 63 [0-06] 2e 6b 65 79 [0-06] 2e 76 64 62 } //1
		$a_03_2 = {0f af c2 8b 8d ?? ?? ?? ?? d1 e1 2b c1 8b 55 ?? 66 8b 0c 55 ?? ?? ?? ?? 66 33 c8 8b 55 ?? 66 89 0c 55 ?? ?? ?? ?? 8b 85 ?? ?? ?? ?? 83 e8 01 89 85 ?? ?? ?? ?? 8b 4d ?? 83 c1 01 89 4d ?? 83 bd ?? ?? ?? ?? 00 75 ?? 68 00 50 00 00 68 58 70 00 10 8b 15 ?? ?? ?? ?? 03 55 ?? 52 ff 15 70 6e 00 10 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1) >=3
 
}
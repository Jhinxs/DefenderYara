
rule Virus_Win32_Sality_AM_corrupt{
	meta:
		description = "Virus:Win32/Sality.AM!corrupt,SIGNATURE_TYPE_PEHSTR_EXT,67 00 67 00 13 00 00 "
		
	strings :
		$a_01_0 = {8a 84 0d 16 10 00 00 } //10
		$a_01_1 = {8a a4 15 16 10 00 00 } //10
		$a_01_2 = {88 84 15 16 10 00 00 } //10
		$a_01_3 = {88 a4 0d 16 10 00 00 } //10
		$a_01_4 = {02 9c 15 16 10 00 00 } //1
		$a_01_5 = {02 9c 15 17 10 00 00 } //1
		$a_01_6 = {8a 84 15 16 10 00 00 } //1
		$a_01_7 = {8a 84 15 17 10 00 00 } //1
		$a_01_8 = {8a ac 1d 16 10 00 00 } //10
		$a_01_9 = {88 84 1d 16 10 00 00 } //10
		$a_01_10 = {88 ac 15 16 10 00 00 } //1
		$a_01_11 = {88 ac 15 17 10 00 00 } //1
		$a_01_12 = {8a 84 05 16 10 00 00 } //10
		$a_01_13 = {89 54 0e 0c } //10
		$a_01_14 = {89 44 0e 08 } //10
		$a_01_15 = {89 5c 0e 04 } //10
		$a_01_16 = {53 4f 53 69 54 45 5f 41 56 45 52 49 5f 53 4f 53 69 54 45 45 45 2e 68 61 68 61 } //50 SOSiTE_AVERI_SOSiTEEE.haha
		$a_00_17 = {2f 6c 6f 67 6f 73 2e 67 69 66 00 } //30
		$a_00_18 = {2f 6c 6f 67 6f 68 2e 67 69 66 00 } //30
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*10+(#a_01_9  & 1)*10+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*10+(#a_01_13  & 1)*10+(#a_01_14  & 1)*10+(#a_01_15  & 1)*10+(#a_01_16  & 1)*50+(#a_00_17  & 1)*30+(#a_00_18  & 1)*30) >=103
 
}
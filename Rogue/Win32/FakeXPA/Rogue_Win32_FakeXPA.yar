
rule Rogue_Win32_FakeXPA{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_01_0 = {47 6f 74 6f 48 65 6c 6c 31 32 33 31 32 33 5f 5f 00 00 00 00 53 68 69 74 00 } //1
	condition:
		((#a_01_0  & 1)*1) >=1
 
}
rule Rogue_Win32_FakeXPA_2{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_03_0 = {fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 00 ?? ?? ?? ?? 55 6e 69 6e 73 74 61 6c 6c 00 57 69 6e 64 6f 77 73 20 44 65 66 65 6e 63 65 } //1
	condition:
		((#a_03_0  & 1)*1) >=1
 
}
rule Rogue_Win32_FakeXPA_3{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_00_0 = {70 6e 2e 63 66 67 00 20 75 70 64 61 74 65 } //2
		$a_00_1 = {73 70 79 77 61 72 65 2e 64 61 74 00 73 70 79 77 61 72 65 2e 6f 6c 64 } //1
		$a_00_2 = {44 61 74 61 62 61 73 65 20 69 73 20 75 70 2d 74 6f 2d 64 61 74 65 21 } //1 Database is up-to-date!
		$a_02_3 = {76 65 72 2e 74 78 74 [0-04] 76 65 72 2e 74 78 74 } //1
		$a_00_4 = {73 70 79 77 61 72 65 2e 74 6d 70 00 61 75 74 6f } //1
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_02_3  & 1)*1+(#a_00_4  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_4{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 03 00 00 "
		
	strings :
		$a_03_0 = {0f b7 51 12 0f 84 0f 00 00 00 64 8f 05 00 00 00 00 81 c4 04 00 00 00 61 c3 90 09 05 00 ff ?? ?? 81 } //1
		$a_03_1 = {b8 f4 0f 84 0f 00 00 00 64 8f 05 00 00 00 00 81 c4 04 00 00 00 61 c3 90 09 07 00 ff ?? ?? 81 ?? 90 90 90 90 } //1
		$a_01_2 = {8b 00 81 f8 83 fa 08 0f 0f 84 0f 00 00 00 64 8f 05 00 00 00 00 81 c4 04 00 00 00 61 c3 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1) >=1
 
}
rule Rogue_Win32_FakeXPA_5{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 02 00 00 "
		
	strings :
		$a_03_0 = {20 44 65 66 65 6e 63 (|65) 20 90 03 00 07 43 65 6e 74 65 72 20 31 2e ?? 2e ?? 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 00 } //1
		$a_03_1 = {43 75 73 74 6f 6d 00 57 69 6e 64 6f 77 73 20 44 65 66 65 6e 63 (|65) 20 90 0f 01 00 2e 90 0f 01 00 2e 90 0f 01 00 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 00 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1) >=1
 
}
rule Rogue_Win32_FakeXPA_6{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_03_0 = {74 15 6a 2c 68 ?? ?? ?? ?? 68 c2 01 00 00 6a 10 56 ff 15 } //1
		$a_01_1 = {50 68 79 73 69 63 61 6c 20 6d 65 6d 6f 72 79 20 64 75 6d 70 20 63 6f 6d 70 6c 65 74 65 2e 20 52 65 73 74 61 72 74 69 6e 67 2e 2e 2e } //1 Physical memory dump complete. Restarting...
		$a_01_2 = {2a 2a 2a 20 44 52 56 2e 53 59 53 20 2d 20 41 64 64 72 65 73 73 } //1 *** DRV.SYS - Address
		$a_00_3 = {42 00 6c 00 75 00 65 00 53 00 63 00 72 00 65 00 65 00 6e 00 } //1 BlueScreen
	condition:
		((#a_03_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_00_3  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_7{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 05 00 00 "
		
	strings :
		$a_01_0 = {68 58 4d 56 0f 94 c0 } //1
		$a_01_1 = {65 78 64 6c 6c 2e 64 6c 6c 00 6d 79 46 75 6e 63 74 69 6f 6e 00 } //1
		$a_03_2 = {68 ff 07 00 00 be ?? ?? 00 10 56 ff 35 ?? ?? 00 10 ff 15 } //2
		$a_03_3 = {6a 22 83 c0 1a 68 ?? ?? 00 10 68 ?? ?? 00 10 a3 ?? ?? 00 10 e8 } //3
		$a_03_4 = {61 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 [0-08] 2e 00 63 00 6f 00 6d 00 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*2+(#a_03_3  & 1)*3+(#a_03_4  & 1)*1) >=6
 
}
rule Rogue_Win32_FakeXPA_8{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,06 00 05 00 06 00 00 "
		
	strings :
		$a_03_0 = {75 68 c6 45 e7 01 33 f6 8b 45 e8 8d 58 3c 8d 45 cc 50 8b 55 f8 b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 8b c8 49 } //4
		$a_01_1 = {5b 46 4c 54 5d 00 00 00 ff ff ff ff 05 00 00 00 5b 50 4f 50 5d 00 } //2
		$a_01_2 = {5b 6b 65 79 5d 00 00 00 03 00 00 00 ff ff ff ff 06 00 00 00 3f 6e 69 63 6b 3d 00 } //2
		$a_01_3 = {5b 53 52 56 5d 3b 28 3f 69 29 } //2 [SRV];(?i)
		$a_01_4 = {5b 53 52 56 5d 00 00 00 ff ff ff ff 03 00 00 00 23 23 23 00 } //2
		$a_00_5 = {2f 62 75 79 2e 70 68 70 3f 69 64 3d 25 61 66 66 25 } //1 /buy.php?id=%aff%
	condition:
		((#a_03_0  & 1)*4+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_00_5  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_9{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 06 00 00 "
		
	strings :
		$a_01_0 = {5c 5c 45 61 72 74 68 5c 5c 7b 41 35 37 32 38 37 44 41 2d 36 46 42 38 2d 37 43 41 38 2d 37 42 36 38 2d 37 36 38 42 44 37 36 46 44 34 46 44 7d } //1 \\Earth\\{A57287DA-6FB8-7CA8-7B68-768BD76FD4FD}
		$a_01_1 = {5c 45 61 72 74 68 20 41 56 2e 6c 6e 6b 00 } //1 䕜牡桴䄠⹖湬k
		$a_01_2 = {5c 50 72 6f 67 72 61 6d 73 5c 45 61 72 74 68 20 41 56 } //1 \Programs\Earth AV
		$a_01_3 = {20 2f 69 6d 20 4d 63 4e 41 53 76 63 2e 65 78 65 20 } //1  /im McNASvc.exe 
		$a_01_4 = {5c 57 69 6e 64 6f 77 73 20 44 65 66 65 6e 64 65 72 5c 2a 2e 2a 00 } //1 坜湩潤獷䐠晥湥敤屲⸪*
		$a_01_5 = {5c 65 63 61 5c 65 72 61 70 70 2e 65 78 65 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_10{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,0d 00 0d 00 05 00 00 "
		
	strings :
		$a_00_0 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 52 75 6e } //10 Software\Microsoft\Windows\CurrentVersion\Run
		$a_00_1 = {00 00 53 6f 66 74 77 61 72 65 5c 58 50 20 41 6e 74 69 76 69 72 75 73 00 00 } //1
		$a_00_2 = {00 00 58 50 20 41 6e 74 69 76 69 72 75 73 00 00 } //1
		$a_02_3 = {58 50 20 41 6e 74 69 76 69 72 75 73 [0-06] 75 6e 69 6e 73 74 61 6c 6c 65 64 20 73 75 63 63 65 73 73 66 75 6c 6c 79 } //1
		$a_00_4 = {54 66 72 6d 58 50 41 4d 61 69 6e } //1 TfrmXPAMain
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_02_3  & 1)*1+(#a_00_4  & 1)*1) >=13
 
}
rule Rogue_Win32_FakeXPA_11{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 03 00 00 "
		
	strings :
		$a_01_0 = {73 00 6d 00 73 00 65 00 72 00 76 00 69 00 63 00 65 00 5f 00 73 00 74 00 61 00 72 00 74 00 5f 00 67 00 75 00 69 00 5f 00 65 00 76 00 65 00 6e 00 74 00 } //1 smservice_start_gui_event
		$a_01_1 = {43 00 6f 00 6e 00 74 00 72 00 6f 00 6c 00 5c 00 44 00 65 00 66 00 65 00 6e 00 63 00 65 00 43 00 65 00 6e 00 74 00 65 00 72 00 5c 00 49 00 6e 00 66 00 6f 00 } //1 Control\DefenceCenter\Info
		$a_00_2 = {73 6d 6d 73 65 72 76 69 63 65 5f 77 69 74 68 5f 72 65 67 65 64 69 74 5c 52 65 6c 65 61 73 65 5c 73 6d 6d 73 65 72 76 69 63 65 2e 70 64 62 } //1 smmservice_with_regedit\Release\smmservice.pdb
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_00_2  & 1)*1) >=2
 
}
rule Rogue_Win32_FakeXPA_12{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_03_0 = {83 c0 09 8b 15 ?? ?? 40 00 2b d0 33 c9 8b 07 e8 ?? ?? ff ff 8d 55 fc b9 04 00 00 00 8b 07 e8 ?? ?? ff ff } //1
		$a_03_1 = {7e 29 8d 55 ef b9 01 00 00 00 8b 07 e8 ?? ?? ff ff a0 ?? ?? 40 00 30 45 ef 8d 55 ef b9 01 00 00 00 8b c6 e8 ?? ?? ff ff 4b 75 d7 } //2
		$a_03_2 = {83 e8 3a c1 e0 06 [0-10] e9 ?? 00 00 00 [0-10] 83 e8 3a c1 e0 0c [0-10] 90 04 01 02 eb e9 [0-10] 83 e8 3a c1 e0 12 } //1
		$a_00_3 = {58 50 61 6e 74 69 76 69 72 75 73 } //1 XPantivirus
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*2+(#a_03_2  & 1)*1+(#a_00_3  & 1)*1) >=3
 
}
rule Rogue_Win32_FakeXPA_13{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 07 00 00 "
		
	strings :
		$a_00_0 = {53 70 79 77 61 72 65 00 52 69 73 6b 77 61 72 65 00 50 61 63 6b 65 64 2c 20 70 6f 73 73 69 62 6c 65 20 73 70 79 77 61 72 65 } //10
		$a_00_1 = {4d 69 63 72 6f 73 6f 66 74 20 57 69 6e 33 32 73 20 3b 29 } //10 Microsoft Win32s ;)
		$a_01_2 = {00 53 53 53 2e 73 79 73 00 } //10
		$a_00_3 = {55 70 64 61 74 65 2e 65 78 65 00 6f 70 65 6e 00 75 70 64 61 74 65 2e 65 78 65 } //5 灕慤整攮數漀数n灵慤整攮數
		$a_00_4 = {53 68 65 6c 6c 00 72 75 6e 20 26 20 6c 6f 61 64 } //5
		$a_00_5 = {00 55 73 65 72 49 6e 69 74 20 68 69 6a 61 63 6b 00 } //5
		$a_00_6 = {00 76 65 72 2e 64 61 74 00 } //5
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_01_2  & 1)*10+(#a_00_3  & 1)*5+(#a_00_4  & 1)*5+(#a_00_5  & 1)*5+(#a_00_6  & 1)*5) >=40
 
}
rule Rogue_Win32_FakeXPA_14{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,2a 00 2a 00 07 00 00 "
		
	strings :
		$a_00_0 = {00 00 73 63 75 69 2e 63 70 6c 00 43 50 6c 41 70 70 6c 65 74 } //10
		$a_02_1 = {43 61 70 74 69 6f 6e [0-02] 57 69 6e 64 6f 77 73 20 53 65 63 75 72 69 74 79 20 43 65 6e 74 65 72 } //10
		$a_00_2 = {41 70 70 6c 65 74 49 63 6f 6e 2e 44 61 74 61 } //10 AppletIcon.Data
		$a_00_3 = {41 70 70 6c 65 74 4d 6f 64 75 6c 65 41 63 74 69 76 61 74 65 } //10 AppletModuleActivate
		$a_00_4 = {53 48 47 65 74 53 70 65 63 69 61 6c 46 6f 6c 64 65 72 4c 6f 63 61 74 69 6f 6e } //1 SHGetSpecialFolderLocation
		$a_00_5 = {47 65 74 53 74 61 72 74 75 70 49 6e 66 6f 41 } //1 GetStartupInfoA
		$a_00_6 = {43 72 65 61 74 65 42 69 74 6d 61 70 } //1 CreateBitmap
	condition:
		((#a_00_0  & 1)*10+(#a_02_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*10+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1) >=42
 
}
rule Rogue_Win32_FakeXPA_15{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 07 00 00 "
		
	strings :
		$a_00_0 = {25 62 6c 6b 63 6f 64 65 25 00 } //2 戥歬潣敤%
		$a_00_1 = {41 66 66 49 44 00 00 00 ff ff ff ff 05 00 00 00 25 61 66 66 25 00 } //2
		$a_00_2 = {70 72 74 6b 3a 3a 62 61 63 6b 00 } //1
		$a_00_3 = {3c 74 69 74 6c 65 3e 42 6c 6f 63 6b 65 64 3c 2f 74 69 74 6c 65 3e } //1 <title>Blocked</title>
		$a_00_4 = {2e 70 68 70 3f 61 66 3d 25 61 66 66 25 26 75 72 6c 3d 25 75 72 6c 25 20 66 72 61 6d 65 62 6f 72 64 65 72 3d 30 } //3 .php?af=%aff%&url=%url% frameborder=0
		$a_01_5 = {41 66 66 49 44 00 00 00 ff ff ff ff 09 00 00 00 41 63 74 69 76 61 74 65 64 00 } //2
		$a_00_6 = {5f 49 45 42 72 6f 77 73 65 72 48 65 6c 70 65 72 2e 70 61 73 } //1 _IEBrowserHelper.pas
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*2+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*3+(#a_01_5  & 1)*2+(#a_00_6  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_16{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 06 00 00 "
		
	strings :
		$a_03_0 = {6e 73 45 78 65 63 2e 64 6c 6c 00 ?? ?? 2e 65 78 65 20 2d 70 61 73 73 77 6f 72 64 3d [0-10] 00 45 } //2
		$a_01_1 = {00 50 50 2e 62 61 74 00 } //1 倀⹐慢t
		$a_01_2 = {00 6d 61 63 2e 65 78 65 00 } //1
		$a_02_3 = {20 41 6e 74 69 56 69 72 75 73 20 90 0e 0a 00 90 0f 01 00 2e 90 0f 01 00 2e 90 0f 01 00 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 } //2
		$a_03_4 = {45 41 56 20 90 0e 0a 00 90 0f 01 00 2e 90 0f 01 00 2e 90 0f 01 00 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 } //2
		$a_01_5 = {00 65 72 2e 65 78 65 00 6d 73 77 2e 65 78 65 00 } //1
	condition:
		((#a_03_0  & 1)*2+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_02_3  & 1)*2+(#a_03_4  & 1)*2+(#a_01_5  & 1)*1) >=3
 
}
rule Rogue_Win32_FakeXPA_17{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_02_0 = {80 7c 02 ff 21 75 1a 8b 45 fc e8 ?? ?? ff ff 8b d0 8d 45 fc b9 01 00 00 00 e8 ?? ?? ff ff ff 45 e8 4b 75 d1 } //1
		$a_02_1 = {83 e2 3f 8b cf c1 e1 03 8d 0c cd ?? ?? ?? ?? 0f b6 14 11 8b 4d ec 83 e1 c0 0b d1 e8 ?? ?? ff ff 8b 55 e0 8b 45 f8 e8 ?? ?? ff ff 8b 45 f8 83 ff 0f 75 04 33 ff eb 01 47 c1 ee 08 ff 4d f4 75 b0 } //1
		$a_02_2 = {8d 83 8c 05 00 00 e8 ?? ?? ff ff 8b 4b 28 e3 10 ff b3 8c 05 00 00 6a 00 6a 0c 51 e8 ?? ?? ff ff 0f b6 8b c2 00 00 00 e2 07 89 d8 e8 ?? ?? 00 00 93 5b ff b0 00 01 00 00 c3 } //1
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1) >=3
 
}
rule Rogue_Win32_FakeXPA_18{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,07 00 06 00 04 00 00 "
		
	strings :
		$a_01_0 = {42 00 69 00 6e 00 64 00 56 00 69 00 65 00 77 00 00 00 } //1
		$a_01_1 = {26 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 20 00 74 00 68 00 69 00 73 00 20 00 64 00 72 00 69 00 76 00 65 00 72 00 20 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 20 00 61 00 6e 00 79 00 77 00 61 00 79 00 00 00 } //1
		$a_01_2 = {26 00 43 00 6f 00 6e 00 74 00 69 00 6e 00 75 00 65 00 20 00 41 00 6e 00 79 00 77 00 61 00 79 00 00 00 } //1
		$a_03_3 = {be 01 00 01 00 56 6a 01 68 01 02 00 00 ff b5 ?? ?? ff ff ff d7 56 6a 01 68 02 02 00 00 ff b5 ?? ?? ff ff e9 } //4
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_03_3  & 1)*4) >=6
 
}
rule Rogue_Win32_FakeXPA_19{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 08 00 07 00 00 "
		
	strings :
		$a_01_0 = {41 64 64 53 65 65 73 69 6f 6e 53 51 4e 00 } //1 摁卤敥楳湯兓N
		$a_01_1 = {4e 45 57 20 44 45 53 54 3a 20 25 30 75 2e 25 30 75 2e 25 30 75 2e 25 30 75 00 } //1
		$a_01_2 = {47 45 54 20 2f 73 65 61 72 63 68 3f 00 } //1
		$a_01_3 = {47 45 54 20 2f 73 65 61 72 63 68 3b 00 } //1
		$a_01_4 = {47 45 54 20 2f 72 65 73 75 6c 74 73 2e 61 73 70 78 3f 00 } //1
		$a_01_5 = {61 6e 74 69 76 69 72 79 73 00 61 6e 74 69 76 79 72 75 73 00 61 6e 74 79 76 69 72 75 73 00 61 6e 74 69 76 69 72 75 73 00 } //4 湡楴楶祲s湡楴祶畲s湡祴楶畲s湡楴楶畲s
		$a_03_6 = {68 61 50 6d 49 6a 2e 8d 45 ?? 50 ff 15 ?? ?? ?? ?? 6a 2e ff 75 ?? 8d 45 ?? ff b3 f4 00 00 00 } //4
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*4+(#a_03_6  & 1)*4) >=8
 
}
rule Rogue_Win32_FakeXPA_20{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 07 00 00 "
		
	strings :
		$a_00_0 = {00 00 78 70 61 2e 65 78 65 } //1
		$a_00_1 = {58 50 41 5c 4c 4f 41 44 45 52 5c 4d 41 49 4e 49 43 4f 4e } //1 XPA\LOADER\MAINICON
		$a_00_2 = {61 6e 64 20 69 6e 73 74 61 6c 6c 20 58 50 20 61 6e 74 69 76 69 72 75 73 } //1 and install XP antivirus
		$a_00_3 = {78 70 61 6e 74 69 76 69 72 75 73 2e 63 6f 6d 2f 65 75 6c 61 } //1 xpantivirus.com/eula
		$a_02_4 = {64 6f 77 6e 6c 6f 61 64 2f 78 70 61 [0-04] 2e 65 78 65 } //1
		$a_00_5 = {00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 52 75 6e 5c 58 50 20 41 6e 74 69 76 69 72 75 73 } //1
		$a_00_6 = {55 6e 69 6e 73 74 61 6c 6c 20 58 50 20 41 6e } //1 Uninstall XP An
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_02_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_21{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_01_0 = {20 41 6e 74 69 56 69 72 75 73 20 49 6e 73 74 61 6c 6c 65 72 00 } //1
		$a_02_1 = {2d 61 6e 74 69 76 69 72 75 73 2d 32 30 90 0f 02 00 2e 63 6f 6d 2f 74 65 72 6d 73 2e 68 74 6d 6c } //1
		$a_03_2 = {54 6f 20 63 6f 6e 74 69 6e 75 65 20 69 6e 73 74 61 6c 6c 61 74 69 6f 6e 20 79 6f 75 20 6e 65 65 64 20 74 6f 20 63 6c 6f 73 65 20 61 6c 6c 20 [0-0c] 49 6e 74 65 72 6e 65 74 20 42 72 6f 77 73 65 72 73 2e } //1
		$a_01_3 = {00 42 61 73 65 2e 64 61 74 00 } //1
		$a_03_4 = {54 68 69 73 20 77 69 6c 6c 20 69 6e 73 74 61 6c 6c 20 [0-08] 20 41 56 20 6f 6e 20 79 6f 75 72 20 63 6f 6d 70 75 74 65 72 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_02_1  & 1)*1+(#a_03_2  & 1)*1+(#a_01_3  & 1)*1+(#a_03_4  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_22{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 05 00 00 "
		
	strings :
		$a_00_0 = {59 6f 75 72 20 73 79 73 74 65 6d 20 6d 69 67 68 74 20 62 65 20 61 74 20 72 69 73 6b 21 } //2 Your system might be at risk!
		$a_00_1 = {49 6e 73 74 61 6c 6c 20 66 72 65 65 20 58 50 20 61 6e 74 69 76 69 72 75 73 20 73 63 61 6e 6e 65 72 20 6e 6f 77 21 } //2 Install free XP antivirus scanner now!
		$a_00_2 = {2d 20 46 72 65 65 20 68 61 6e 64 79 20 56 69 72 75 73 20 53 74 61 74 69 73 74 69 63 73 } //2 - Free handy Virus Statistics
		$a_03_3 = {83 e8 3a c1 e0 06 [0-10] e9 ?? 00 00 00 [0-10] 83 e8 3a c1 e0 0c [0-10] 90 04 01 02 eb e9 [0-10] 83 e8 3a c1 e0 12 } //3
		$a_03_4 = {8d 83 8c 05 00 00 e8 ?? ?? ff ff 8b 4b 28 e3 10 ff b3 8c 05 00 00 6a 00 6a 0c 51 e8 ?? ?? ff ff 0f b6 8b c2 00 00 00 e2 07 89 d8 e8 ?? ?? 00 00 93 5b ff b0 00 01 00 00 c3 } //3
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*2+(#a_00_2  & 1)*2+(#a_03_3  & 1)*3+(#a_03_4  & 1)*3) >=7
 
}
rule Rogue_Win32_FakeXPA_23{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,0e 00 0e 00 09 00 00 "
		
	strings :
		$a_01_0 = {53 6f 66 74 77 61 72 65 5c 42 6f 72 6c 61 6e 64 5c 4c 6f 63 61 6c 65 73 } //10 Software\Borland\Locales
		$a_01_1 = {63 6f 6e 66 69 72 6d 2e 70 68 70 3f 70 72 6f 64 75 63 74 3d 25 70 72 6f 64 75 63 74 25 26 61 66 66 3d 25 61 66 66 25 26 65 6d 61 69 6c 3d 25 65 6d 61 69 6c 25 } //1 confirm.php?product=%product%&aff=%aff%&email=%email%
		$a_01_2 = {2e 70 68 70 3f 76 65 72 3d 25 61 66 66 25 } //1 .php?ver=%aff%
		$a_01_3 = {2e 64 6c 6c 23 23 23 44 69 61 6c 65 72 2e } //1 .dll###Dialer.
		$a_01_4 = {2e 65 78 65 23 23 23 57 69 6e 33 32 2e 52 62 6f 74 2e } //1 .exe###Win32.Rbot.
		$a_01_5 = {61 75 74 6f 72 75 6e 23 23 23 57 69 6e 33 32 2e } //1 autorun###Win32.
		$a_01_6 = {44 65 66 20 74 72 65 61 74 73 3a 20 00 } //1
		$a_01_7 = {41 66 74 65 72 20 72 65 67 69 73 74 65 72 20 55 52 4c 3a 20 00 } //1
		$a_01_8 = {53 63 61 6e 20 4e 6f 77 00 00 00 00 ff ff ff ff 04 00 00 00 53 74 6f 70 00 } //2
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*2) >=14
 
}
rule Rogue_Win32_FakeXPA_24{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_03_0 = {68 98 3a 00 00 6a 0a 56 89 0d ?? ?? ?? ?? ff d7 6a 00 68 20 4e 00 00 6a 0b 56 ff d7 6a 00 68 30 75 00 00 6a 0c } //1
		$a_03_1 = {68 00 00 ad 00 56 ff 15 ?? ?? ?? ?? 83 3d ?? ?? ?? ?? 00 74 15 6a ?? 68 ?? ?? ?? ?? 68 c2 01 00 00 6a ?? 56 ff 15 } //1
		$a_03_2 = {83 f8 0b 75 ?? 68 fa 00 00 00 68 c2 01 00 00 c7 05 ?? ?? ?? ?? 00 00 00 00 c7 05 ?? ?? ?? ?? 00 00 00 00 ff 15 } //1
		$a_02_3 = {50 00 68 00 79 00 73 00 69 00 63 00 61 00 6c 00 20 00 [0-04] 6d 00 65 00 6d 00 6f 00 72 00 79 00 20 00 [0-04] 64 00 75 00 6d 00 70 00 20 00 [0-04] 63 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00 2e 00 20 00 [0-04] 52 00 65 00 73 00 74 00 61 00 72 00 74 00 69 00 6e 00 67 00 [0-04] 2e 00 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_02_3  & 1)*1) >=3
 
}
rule Rogue_Win32_FakeXPA_25{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 0a 00 00 "
		
	strings :
		$a_01_0 = {00 3f 71 3d 00 26 71 3d 00 3f 70 3d 00 26 70 3d 00 } //1
		$a_01_1 = {00 57 79 00 00 56 79 00 00 77 79 00 00 76 79 00 } //1 圀y嘀y眀y瘀y
		$a_03_2 = {00 53 6f 66 74 77 61 72 65 5c ?? 41 56 5c ?? 41 56 } //1
		$a_01_3 = {00 57 69 00 00 56 69 00 00 77 69 00 00 76 69 00 } //1 圀i嘀i眀i瘀i
		$a_01_4 = {00 41 6e 74 79 00 00 00 00 61 6e 74 79 00 } //1
		$a_03_5 = {73 72 63 3d 68 74 74 70 3a 2f 2f 6d 69 63 72 6f 73 6f 66 74 90 10 01 00 2e 90 12 20 00 2e 90 12 04 00 2f } //1
		$a_01_6 = {74 72 79 6e 65 77 73 65 63 75 72 69 74 79 2e 69 6e 66 6f } //1 trynewsecurity.info
		$a_01_7 = {64 3a 5c 21 21 21 57 4f 52 4b 5c 61 77 6f 72 6b 5c 73 6f 66 74 5c 73 6f 66 74 5c } //1 d:\!!!WORK\awork\soft\soft\
		$a_01_8 = {52 65 70 6f 72 74 65 64 20 41 74 74 61 63 6b 20 53 69 74 65 21 3c 2f 74 69 74 6c 65 3e } //1 Reported Attack Site!</title>
		$a_01_9 = {6d 69 74 22 20 76 61 6c 75 65 3d 22 47 65 74 20 6d 65 20 6f 75 72 20 6f 66 20 68 65 72 65 } //1 mit" value="Get me our of here
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_26{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,07 00 06 00 05 00 00 "
		
	strings :
		$a_00_0 = {65 00 74 00 5f 00 64 00 6f 00 6d 00 61 00 69 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 74 00 79 00 70 00 65 00 3d 00 73 00 69 00 74 00 65 00 00 00 41 00 56 00 31 00 39 00 5f 00 47 00 65 00 74 00 } //1
		$a_00_1 = {5c 00 41 00 56 00 31 00 5c 00 41 00 56 00 31 00 5c 00 7b 00 46 00 32 00 37 00 35 00 45 00 39 00 33 00 31 00 2d 00 41 00 46 00 45 00 43 00 2d 00 } //1 \AV1\AV1\{F275E931-AFEC-
		$a_00_2 = {65 00 63 00 74 00 69 00 6f 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 73 00 74 00 65 00 70 00 3d 00 00 00 00 00 26 00 69 00 64 00 3d 00 00 00 00 00 6e 00 6f 00 6e 00 65 00 00 00 00 00 73 70 65 63 69 61 6c 69 6e 66 6f 3a 69 64 3d 00 00 00 00 00 } //1
		$a_00_3 = {5c 41 56 49 6e 73 74 61 6c 6c 65 72 5f 32 5c 52 65 6c 65 61 73 65 5c 53 74 61 67 65 } //1 \AVInstaller_2\Release\Stage
		$a_02_4 = {8b 2d 70 91 40 00 8b 44 24 18 85 c0 74 3c 50 e8 ?? ?? ?? ?? 83 c4 04 8b f8 8b 44 24 18 8d 54 24 20 52 50 57 56 ff d5 } //5
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_02_4  & 1)*5) >=6
 
}
rule Rogue_Win32_FakeXPA_27{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,15 00 0b 00 08 00 00 "
		
	strings :
		$a_01_0 = {4c 6f 61 64 46 69 72 65 77 61 6c 6c 52 75 6c 65 73 28 29 00 66 69 72 65 77 61 6c 6c 2e 63 66 67 00 66 69 72 65 77 61 6c 6c 2e 63 66 67 00 4c 6f 61 64 57 68 69 74 65 4c 69 73 74 28 29 00 77 68 69 74 65 6c 69 73 74 2e 63 66 67 00 77 68 69 74 65 6c 69 73 74 2e 63 66 67 00 4c 6f 61 64 69 6e 67 20 64 61 74 61 62 61 73 65 2e 2e 2e 00 } //10
		$a_01_1 = {53 70 79 77 61 72 65 00 52 69 73 6b 77 61 72 65 00 50 61 63 6b 65 64 2c 20 70 6f 73 73 69 62 6c 65 20 73 70 79 77 61 72 65 00 } //10
		$a_00_2 = {00 76 65 72 2e 64 61 74 00 } //5
		$a_00_3 = {00 55 73 65 72 49 6e 69 74 20 68 69 6a 61 63 6b 00 } //5
		$a_01_4 = {53 79 73 42 61 63 6b 75 70 5c 00 2e 6d 64 35 00 } //5 祓䉳捡畫屰⸀摭5
		$a_01_5 = {11 69 6d 67 53 74 61 72 74 53 63 61 6e 43 6c 69 63 6b } //1 椑杭瑓牡却慣䍮楬正
		$a_01_6 = {54 53 70 79 77 61 72 65 46 6f 75 6e 64 46 6f 72 6d 00 } //1 協祰慷敲潆湵䙤牯m
		$a_80_7 = {58 65 6e 41 6e 74 69 53 70 79 77 61 72 65 5f 72 75 6e 6e 69 6e 67 } //XenAntiSpyware_running  -20
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_00_2  & 1)*5+(#a_00_3  & 1)*5+(#a_01_4  & 1)*5+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_80_7  & 1)*-20) >=11
 
}
rule Rogue_Win32_FakeXPA_28{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,16 00 15 00 09 00 00 "
		
	strings :
		$a_00_0 = {5c 5c 45 63 6f 5c 5c 7b 41 35 37 32 38 37 44 41 2d 36 46 42 38 2d 37 43 41 38 2d 37 42 36 38 2d 37 36 38 42 44 37 36 46 44 34 46 44 7d } //10 \\Eco\\{A57287DA-6FB8-7CA8-7B68-768BD76FD4FD}
		$a_02_1 = {5c 50 72 6f 67 72 61 6d 73 5c [0-02] 45 63 6f [0-02] 41 6e 74 69 56 69 72 75 73 [0-02] 5c [0-02] 45 63 6f [0-02] 41 6e 74 69 56 69 72 75 73 [0-02] 2e 6c 6e 6b } //10
		$a_00_2 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 65 63 6f 61 76 2e 65 78 65 } //1 taskkill /f /im ecoav.exe
		$a_00_3 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 4d 53 41 53 43 75 69 2e 65 78 65 } //1 taskkill /f /im MSASCui.exe
		$a_00_4 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 6e 6f 64 33 32 6b 72 6e 2e 65 78 65 } //1 taskkill /f /im nod32krn.exe
		$a_00_5 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 6d 63 72 65 67 69 73 74 2e 65 78 65 20 } //1 taskkill /f /im mcregist.exe 
		$a_00_6 = {2f 69 6d 20 77 6d 69 70 72 76 73 65 2e 65 78 65 20 } //1 /im wmiprvse.exe 
		$a_00_7 = {2f 69 6d 20 6d 63 73 79 73 6d 6f 6e 2e 65 78 65 20 } //1 /im mcsysmon.exe 
		$a_00_8 = {2f 69 6d 20 4d 63 73 68 69 65 6c 64 2e 65 78 65 } //1 /im Mcshield.exe
	condition:
		((#a_00_0  & 1)*10+(#a_02_1  & 1)*10+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1) >=21
 
}
rule Rogue_Win32_FakeXPA_29{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 07 00 00 "
		
	strings :
		$a_01_0 = {51 57 50 72 6f 74 65 63 74 } //1 QWProtect
		$a_01_1 = {74 00 72 00 79 00 6e 00 65 00 77 00 73 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 2e 00 69 00 6e 00 66 00 6f 00 } //1 trynewsecurity.info
		$a_01_2 = {44 6c 6c 49 6e 73 74 61 6c 6c 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 } //1 汄䥬獮慴汬䐀汬敒楧瑳牥敓癲牥
		$a_01_3 = {7b 00 32 00 39 00 32 00 35 00 36 00 34 00 34 00 32 00 2d 00 32 00 43 00 31 00 34 00 2d 00 34 00 38 00 43 00 41 00 2d 00 42 00 37 00 35 00 36 00 2d 00 33 00 45 00 45 00 30 00 46 00 38 00 42 00 44 00 43 00 37 00 37 00 34 00 7d 00 } //1 {29256442-2C14-48CA-B756-3EE0F8BDC774}
		$a_01_4 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 45 00 63 00 6f 00 5c 00 45 00 63 00 6f 00 5c 00 } //1 Software\Eco\Eco\
		$a_01_5 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 45 00 61 00 72 00 74 00 68 00 5c 00 45 00 61 00 72 00 74 00 68 00 5c 00 } //1 Software\Earth\Earth\
		$a_01_6 = {22 3e 4f 6e 6c 69 6e 65 20 70 68 69 73 68 69 6e 67 20 28 70 72 6f 6e 6f 75 6e 63 65 64 20 66 69 73 68 69 6e 67 29 20 69 73 20 61 20 77 61 79 20 74 6f 20 74 72 69 63 6b 20 79 } //1 ">Online phishing (pronounced fishing) is a way to trick y
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_30{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 0e 00 00 "
		
	strings :
		$a_00_0 = {2f 61 64 6d 69 6e 2f 63 67 69 2d 62 69 6e 2f 67 65 74 5f 64 6f 6d 61 69 6e 2e 70 68 70 3f 74 79 70 65 3d } //3 /admin/cgi-bin/get_domain.php?type=
		$a_01_1 = {43 6c 69 63 6b 20 22 4e 65 78 74 22 20 74 6f 20 70 72 6f 63 65 65 64 20 77 69 74 68 20 41 6e 74 69 56 69 72 75 73 20 69 6e 73 74 61 6c 6c 61 74 69 6f 6e } //2 Click "Next" to proceed with AntiVirus installation
		$a_00_2 = {63 6f 6c 6c 65 63 74 69 6f 6e 2e 70 68 70 3f 73 74 65 70 3d } //2 collection.php?step=
		$a_00_3 = {41 56 42 48 4f 2e 64 6c 6c 00 } //1 噁䡂⹏汤l
		$a_00_4 = {41 56 2e 65 78 65 00 } //1
		$a_00_5 = {53 6f 66 74 77 61 72 65 5c 41 6e 74 69 76 69 72 75 73 20 41 56 } //1 Software\Antivirus AV
		$a_00_6 = {53 70 79 77 61 72 65 2e 49 45 4d 6f 6e 73 74 65 72 20 61 63 74 69 76 69 74 79 20 64 65 74 65 63 74 65 64 2e } //1 Spyware.IEMonster activity detected.
		$a_00_7 = {2f 62 6c 6f 63 6b 65 64 2e 70 68 70 3f 69 64 3d } //1 /blocked.php?id=
		$a_00_8 = {2f 70 72 65 73 61 6c 65 2f 32 2f 69 6e 64 65 78 2e 70 68 70 3f 69 64 3d } //1 /presale/2/index.php?id=
		$a_00_9 = {66 72 65 65 2b 61 6e 74 69 76 69 72 75 73 2b 73 6f 66 74 77 61 72 65 } //1 free+antivirus+software
		$a_00_10 = {2f 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 64 00 2e 00 70 00 68 00 70 00 3f 00 69 00 64 00 3d 00 } //1 /blocked.php?id=
		$a_00_11 = {61 00 6e 00 74 00 69 00 76 00 69 00 72 00 79 00 73 00 } //1 antivirys
		$a_00_12 = {61 00 6e 00 74 00 69 00 2b 00 76 00 69 00 74 00 79 00 73 00 } //1 anti+vitys
		$a_00_13 = {61 00 6e 00 74 00 69 00 2d 00 76 00 69 00 74 00 75 00 73 00 } //1 anti-vitus
	condition:
		((#a_00_0  & 1)*3+(#a_01_1  & 1)*2+(#a_00_2  & 1)*2+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_31{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 08 00 00 "
		
	strings :
		$a_03_0 = {68 80 01 00 00 8d 44 24 ?? 50 ff d6 8b f8 83 ff ff 74 2c 53 8d 44 24 ?? 50 6a 60 8d 44 24 ?? 50 53 53 68 64 00 09 00 57 ff 15 } //2
		$a_01_1 = {0f b7 48 04 33 d2 42 56 8b f2 03 c8 66 3b 70 06 73 1e 8d b0 fe 01 00 00 57 66 8b 3c 51 66 89 3e 0f b7 78 06 81 c6 00 02 00 00 42 3b d7 72 ea } //2
		$a_01_2 = {0f b7 41 14 03 c1 eb 0f 3b 4c 24 04 75 06 80 78 09 00 74 0c 03 40 04 8b 08 83 f9 ff 75 ea } //2
		$a_00_3 = {52 00 45 00 5c 00 4b 00 61 00 73 00 70 00 65 00 72 00 73 00 6b 00 79 00 4c 00 61 00 62 00 5c 00 53 00 65 00 74 00 75 00 70 00 46 00 6f 00 6c 00 64 00 65 00 72 00 73 00 5c 00 } //1 RE\KasperskyLab\SetupFolders\
		$a_00_4 = {49 00 64 00 65 00 6e 00 74 00 69 00 74 00 79 00 20 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00 69 00 6f 00 6e 00 5c 00 41 00 67 00 65 00 6e 00 74 00 5c 00 42 00 69 00 6e 00 5c 00 41 00 56 00 47 00 49 00 44 00 53 00 41 00 67 00 65 00 6e 00 74 00 2e 00 65 00 78 00 65 00 } //1 Identity Protection\Agent\Bin\AVGIDSAgent.exe
		$a_00_5 = {52 00 45 00 5c 00 4e 00 6f 00 72 00 74 00 6f 00 6e 00 5c 00 7b 00 30 00 43 00 35 00 35 00 43 00 30 00 39 00 36 00 2d 00 30 00 46 00 } //1 RE\Norton\{0C55C096-0F
		$a_00_6 = {52 00 45 00 5c 00 4d 00 63 00 41 00 66 00 65 00 65 00 5c 00 53 00 69 00 74 00 65 00 41 00 64 00 76 00 } //1 RE\McAfee\SiteAdv
		$a_00_7 = {52 00 45 00 5c 00 41 00 56 00 41 00 53 00 54 00 20 00 53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 41 00 76 00 61 00 73 00 74 00 } //1 RE\AVAST Software\Avast
	condition:
		((#a_03_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1) >=7
 
}
rule Rogue_Win32_FakeXPA_32{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,07 00 05 00 0a 00 00 "
		
	strings :
		$a_03_0 = {68 ff 07 00 00 8d 44 24 1c 50 55 ff 15 ?? ?? ?? ?? 85 c0 74 60 8b 4c 24 0c 33 c0 85 c9 76 11 80 7c 04 10 00 75 05 c6 44 04 10 2d 40 3b c1 72 ef } //5
		$a_00_1 = {2f 00 61 00 64 00 6d 00 69 00 6e 00 2f 00 63 00 67 00 69 00 2d 00 62 00 69 00 6e 00 2f 00 67 00 65 00 74 00 5f 00 64 00 6f 00 6d 00 61 00 69 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 74 00 79 00 70 00 65 00 3d 00 } //2 /admin/cgi-bin/get_domain.php?type=
		$a_00_2 = {63 00 6f 00 6c 00 6c 00 65 00 63 00 74 00 69 00 6f 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 73 00 74 00 65 00 70 00 3d 00 } //2 collection.php?step=
		$a_00_3 = {5f 00 47 00 65 00 74 00 49 00 64 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 _GetId_failure
		$a_00_4 = {5f 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 72 00 75 00 6e 00 } //1 _install_run
		$a_00_5 = {5f 00 69 00 6e 00 73 00 74 00 5f 00 64 00 6c 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 _inst_dl_failure
		$a_00_6 = {5f 00 69 00 6e 00 73 00 74 00 5f 00 72 00 75 00 6e 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 _inst_run_failure
		$a_00_7 = {5f 00 73 00 74 00 61 00 67 00 65 00 5f 00 6f 00 6e 00 65 00 5f 00 63 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00 } //1 _stage_one_complete
		$a_00_8 = {5f 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 72 00 75 00 6e 00 5f 00 61 00 75 00 74 00 6f 00 73 00 74 00 61 00 72 00 74 00 } //1 _install_run_autostart
		$a_00_9 = {5f 00 68 00 6f 00 73 00 74 00 73 00 5f 00 70 00 61 00 74 00 63 00 68 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 _hosts_patch_failure
	condition:
		((#a_03_0  & 1)*5+(#a_00_1  & 1)*2+(#a_00_2  & 1)*2+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_33{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 06 00 00 "
		
	strings :
		$a_02_0 = {2f 00 61 00 64 00 6d 00 69 00 6e 00 2f 00 63 00 67 00 69 00 2d 00 62 00 69 00 6e 00 2f 00 67 00 65 00 74 00 5f 00 64 00 6f 00 6d 00 61 00 69 00 6e 00 2e 00 70 00 68 00 70 00 [0-08] 74 00 79 00 70 00 65 00 3d 00 64 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 [0-08] 47 00 45 00 54 00 } //3
		$a_00_1 = {59 00 6f 00 75 00 20 00 6e 00 65 00 65 00 64 00 20 00 74 00 6f 00 20 00 68 00 61 00 76 00 65 00 20 00 69 00 6e 00 74 00 65 00 72 00 6e 00 65 00 74 00 20 00 61 00 63 00 63 00 65 00 73 00 73 00 20 00 74 00 6f 00 20 00 64 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 20 00 61 00 6e 00 64 00 20 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 20 00 74 00 68 00 65 00 20 00 66 00 72 00 65 00 65 00 20 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 20 00 6f 00 66 00 20 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 42 00 45 00 53 00 54 00 2e 00 } //1 You need to have internet access to download and install the free version of AntivirusBEST.
		$a_00_2 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 41 00 42 00 45 00 53 00 54 00 5c 00 41 00 42 00 45 00 53 00 54 00 5c 00 7b 00 43 00 39 00 44 00 42 00 34 00 39 00 31 00 31 00 2d 00 37 00 34 00 35 00 45 00 2d 00 34 00 34 00 32 00 30 00 2d 00 41 00 44 00 45 00 30 00 2d 00 46 00 41 00 41 00 35 00 45 00 32 00 41 00 32 00 34 00 45 00 38 00 43 00 7d 00 } //1 Software\ABEST\ABEST\{C9DB4911-745E-4420-ADE0-FAA5E2A24E8C}
		$a_02_3 = {63 00 6f 00 6c 00 6c 00 65 00 63 00 74 00 69 00 6f 00 6e 00 2e 00 70 00 68 00 70 00 [0-0a] 73 00 74 00 65 00 70 00 3d 00 [0-0a] 26 00 69 00 64 00 3d 00 } //1
		$a_00_4 = {4c 00 6f 00 63 00 61 00 6c 00 5c 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 42 00 45 00 53 00 54 00 } //1 Local\AntivirusBEST
		$a_00_5 = {37 00 30 00 2e 00 33 00 38 00 2e 00 31 00 31 00 2e 00 31 00 36 00 35 00 } //1 70.38.11.165
	condition:
		((#a_02_0  & 1)*3+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_02_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_34{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 15 00 00 "
		
	strings :
		$a_03_0 = {20 41 6e 74 69 76 69 72 75 73 20 32 30 ?? ?? 20 77 69 6c 6c 20 62 65 20 64 6f 77 6e 6c 6f 61 64 65 64 20 61 6e 64 20 69 6e 73 74 61 6c 6c 65 64 20 6e 6f 77 } //2
		$a_01_1 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 53 65 63 75 72 69 74 79 20 43 65 6e 74 65 72 00 41 6e 74 69 56 69 72 75 73 44 69 73 61 62 6c 65 4e 6f 74 69 66 79 } //2
		$a_01_2 = {72 65 67 73 76 72 33 32 20 2f 73 20 51 57 50 72 6f 74 65 63 74 2e 64 6c 6c } //2 regsvr32 /s QWProtect.dll
		$a_03_3 = {74 6f 70 74 65 6e 72 65 76 69 65 77 73 2e 63 6f 6d 0d 0a 00 90 10 03 00 2e 90 10 03 00 2e 90 10 03 00 2e 90 10 03 00 90 0e 04 00 77 77 77 2e 72 65 65 76 6f 6f 2e 63 6f 6d } //2
		$a_01_4 = {65 78 64 6c 6c 2e 64 6c 6c 00 6d 79 46 75 6e 63 74 69 6f 6e 00 } //2
		$a_01_5 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 4d 53 41 53 43 75 69 2e 65 78 65 } //1 taskkill /f /im MSASCui.exe
		$a_01_6 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 6d 63 72 65 67 69 73 74 2e 65 78 65 20 2f 69 6d } //1 taskkill /f /im mcregist.exe /im
		$a_01_7 = {74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 6e 6f 64 33 32 6b 72 6e 2e 65 78 65 } //1 taskkill /f /im nod32krn.exe
		$a_00_8 = {67 61 76 5f 69 6e 73 74 61 6c 6c 5f 69 65 70 6c 75 67 69 6e 00 } //2
		$a_01_9 = {5c 56 69 72 75 73 65 73 2e 64 61 74 00 } //1
		$a_01_10 = {53 65 6c 66 44 65 6c 2e 64 6c 6c 00 64 65 6c 00 } //1
		$a_00_11 = {00 67 61 76 5f } //1
		$a_03_12 = {20 41 6e 74 69 56 69 72 75 73 20 90 0f 01 00 2e 90 0f 01 00 2e 90 0f 01 00 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 } //2
		$a_01_13 = {55 41 43 2e 64 6c 6c 00 52 75 6e 45 6c 65 76 61 74 65 64 00 } //1 䅕⹃汤l畒䕮敬慶整d
		$a_01_14 = {5c 77 65 72 74 75 2e 64 6c 6c 00 } //1
		$a_01_15 = {00 74 61 73 6b 6b 69 6c 6c 20 2f 66 20 2f 69 6d 20 69 65 78 70 6c 6f 72 65 2e 65 78 65 00 45 78 65 63 00 72 65 67 73 76 72 33 32 20 2f 73 20 57 53 74 65 63 68 2e 64 6c 6c 00 } //2
		$a_02_16 = {20 41 6e 74 69 56 69 72 75 73 20 90 0e 0a 00 90 0f 01 00 2e 90 0f 01 00 2e 90 0f 01 00 90 0e 0a 00 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 } //2
		$a_01_17 = {2d 61 76 2e 63 6f 6d } //1 -av.com
		$a_01_18 = {23 5c 4d 69 63 72 6f 73 6f 66 74 5c 4d 61 63 68 69 6e 65 5c 57 53 74 65 63 68 2e 64 6c 6c } //1 #\Microsoft\Machine\WStech.dll
		$a_03_19 = {45 41 56 20 90 0e 0a 00 90 0f 01 00 2e 90 0f 01 00 2e 90 0f 01 00 90 0e 0a 00 00 fe 24 24 5c 77 69 6e 69 6e 69 74 2e 69 6e 69 } //2
		$a_03_20 = {72 65 67 73 76 72 33 32 20 2f 73 20 77 73 63 72 2e 64 6c 6c 00 45 78 65 63 00 [0-06] 5c 65 78 74 65 6e 73 69 6f 6e 73 5c 67 73 6c } //2
	condition:
		((#a_03_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_03_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_00_8  & 1)*2+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_00_11  & 1)*1+(#a_03_12  & 1)*2+(#a_01_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*2+(#a_02_16  & 1)*2+(#a_01_17  & 1)*1+(#a_01_18  & 1)*1+(#a_03_19  & 1)*2+(#a_03_20  & 1)*2) >=4
 
}
rule Rogue_Win32_FakeXPA_35{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,05 00 04 00 0e 00 00 "
		
	strings :
		$a_00_0 = {41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 32 00 30 00 31 00 30 00 20 00 73 00 79 00 73 00 74 00 65 00 6d 00 20 00 73 00 63 00 61 00 6e 00 20 00 72 00 65 00 70 00 6f 00 72 00 74 00 2e 00 } //1 Antivirus 2010 system scan report.
		$a_01_1 = {2f 00 61 00 76 00 32 00 30 00 31 00 30 00 2f 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 2e 00 70 00 68 00 70 00 } //1 /av2010/version.php
		$a_01_2 = {2f 00 61 00 76 00 32 00 30 00 31 00 30 00 2f 00 75 00 70 00 64 00 61 00 74 00 65 00 72 00 2e 00 65 00 78 00 65 00 } //1 /av2010/updater.exe
		$a_00_3 = {7b 00 33 00 35 00 33 00 39 00 44 00 46 00 45 00 38 00 2d 00 36 00 42 00 45 00 39 00 2d 00 34 00 34 00 61 00 33 00 2d 00 38 00 45 00 37 00 38 00 2d 00 34 00 34 00 44 00 42 00 41 00 45 00 35 00 42 00 44 00 43 00 31 00 33 00 7d 00 } //1 {3539DFE8-6BE9-44a3-8E78-44DBAE5BDC13}
		$a_00_4 = {3f 00 73 00 74 00 65 00 70 00 3d 00 61 00 76 00 32 00 30 00 31 00 30 00 5f 00 63 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00 } //1 ?step=av2010_complete
		$a_00_5 = {2f 00 67 00 65 00 74 00 2e 00 70 00 68 00 70 00 00 00 } //1
		$a_00_6 = {2f 61 64 6d 69 6e 2f 63 67 69 2d 62 69 6e 2f 67 65 74 5f 64 6f 6d 61 69 6e 2e 70 68 70 3f 74 79 70 65 3d 64 6f 77 6e 6c 6f 61 64 00 } //1
		$a_00_7 = {2f 61 64 6d 69 6e 2f 63 67 69 2d 62 69 6e 2f 67 65 74 5f 64 6f 6d 61 69 6e 2e 70 68 70 3f 74 79 70 65 3d 73 69 74 65 00 } //1
		$a_00_8 = {2f 63 6f 6c 6c 65 63 74 69 6f 6e 2e 70 68 70 00 } //1
		$a_00_9 = {68 61 73 20 61 75 74 6f 6d 61 74 69 63 61 6c 6c 79 20 75 70 64 61 74 65 64 20 74 68 65 20 76 69 72 75 73 20 64 61 74 61 62 61 73 65 2e 20 4e 6f 77 20 79 6f 75 72 20 63 6f 6d 70 75 74 65 72 20 69 73 20 70 72 6f 74 65 63 74 65 64 } //1 has automatically updated the virus database. Now your computer is protected
		$a_00_10 = {3f 73 74 65 70 3d 4e 31 39 5f 63 6f 6d 70 6c 65 74 65 5f 38 26 69 64 3d } //1 ?step=N19_complete_8&id=
		$a_00_11 = {7b 00 38 00 34 00 32 00 38 00 33 00 45 00 36 00 42 00 2d 00 43 00 33 00 37 00 37 00 2d 00 34 00 39 00 38 00 66 00 2d 00 42 00 46 00 39 00 31 00 2d 00 36 00 39 00 38 00 45 00 38 00 37 00 37 00 35 00 35 00 35 00 43 00 43 00 7d 00 } //1 {84283E6B-C377-498f-BF91-698E877555CC}
		$a_00_12 = {7b 00 46 00 32 00 37 00 35 00 45 00 39 00 33 00 31 00 2d 00 41 00 46 00 45 00 43 00 2d 00 34 00 66 00 37 00 30 00 2d 00 42 00 30 00 44 00 34 00 2d 00 43 00 43 00 32 00 37 00 33 00 31 00 42 00 39 00 34 00 35 00 45 00 30 00 7d 00 } //1 {F275E931-AFEC-4f70-B0D4-CC2731B945E0}
		$a_03_13 = {6a 01 6a 00 ff 15 ?? ?? ?? ?? 3b f4 e8 ?? ?? ?? ?? eb ?? 8b f4 68 ?? ?? ?? ?? 6a 00 ff 15 ?? ?? ?? ?? 3b f4 e8 ?? ?? ?? ?? 89 (45 ?? 85 ??|?? ?? ?? 83) 90 03 04 04 7d ?? bd ?? ?? ?? ?? 00 74 ?? 8b f4 68 03 02 00 00 6a 00 68 7b 80 00 00 } //4
	condition:
		((#a_00_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_03_13  & 1)*4) >=4
 
}
rule Rogue_Win32_FakeXPA_36{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 08 00 00 "
		
	strings :
		$a_00_0 = {53 00 50 00 59 00 57 00 41 00 52 00 45 00 2e 00 4d 00 4f 00 4e 00 53 00 54 00 45 00 52 00 2e 00 46 00 58 00 5f 00 57 00 49 00 4c 00 44 00 5f 00 30 00 78 00 30 00 30 00 30 00 30 00 30 00 30 00 30 00 30 00 00 00 } //10
		$a_00_1 = {57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 75 00 6e 00 72 00 65 00 67 00 69 00 73 00 74 00 72 00 65 00 64 00 20 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 20 00 6f 00 66 00 20 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 32 00 30 00 31 00 30 00 20 00 70 00 72 00 6f 00 74 00 65 00 63 00 74 00 69 00 6f 00 6e 00 20 00 6f 00 6e 00 20 00 79 00 6f 00 75 00 72 00 20 00 63 00 6f 00 6d 00 70 00 75 00 74 00 65 00 72 00 } //10 Windows detected unregistred version of Antivirus 2010 protection on your computer
		$a_00_2 = {2a 00 2a 00 2a 00 20 00 53 00 52 00 56 00 2e 00 53 00 59 00 53 00 20 00 2d 00 20 00 41 00 64 00 64 00 72 00 65 00 73 00 73 00 20 00 46 00 37 00 33 00 31 00 32 00 30 00 41 00 45 00 20 00 62 00 61 00 73 00 65 00 20 00 61 00 74 00 20 00 43 00 30 00 30 00 30 00 30 00 30 00 30 00 30 00 2c 00 20 00 44 00 61 00 74 00 65 00 53 00 74 00 61 00 6d 00 70 00 20 00 33 00 36 00 62 00 30 00 37 00 32 00 61 00 33 00 00 00 } //10
		$a_00_3 = {2a 00 2a 00 2a 00 53 00 54 00 4f 00 50 00 3a 00 20 00 30 00 78 00 30 00 30 00 30 00 30 00 30 00 30 00 44 00 31 00 20 00 28 00 30 00 78 00 30 00 30 00 30 00 30 00 30 00 30 00 30 00 30 00 2c 00 20 00 30 00 78 00 46 00 37 00 33 00 31 00 32 00 30 00 41 00 45 00 2c 00 20 00 30 00 78 00 43 00 30 00 30 00 30 00 30 00 30 00 30 00 38 00 2c 00 20 00 30 00 78 00 43 00 30 00 30 00 30 00 30 00 30 00 30 00 30 00 29 00 00 00 } //5
		$a_00_4 = {41 00 20 00 73 00 70 00 79 00 77 00 61 00 72 00 65 00 20 00 61 00 70 00 70 00 6c 00 69 00 63 00 61 00 74 00 69 00 6f 00 6e 00 20 00 68 00 61 00 73 00 20 00 62 00 65 00 65 00 6e 00 20 00 64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 61 00 6e 00 64 00 20 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 68 00 61 00 73 00 20 00 62 00 65 00 65 00 6e 00 20 00 73 00 68 00 75 00 74 00 20 00 64 00 6f 00 77 00 6e 00 20 00 74 00 6f 00 } //5 A spyware application has been detected and Windows has been shut down to
		$a_03_5 = {68 00 00 ad 00 56 ff 15 ?? ?? ?? ?? 8b 3d ?? ?? ?? ?? 6a 44 68 ?? ?? ?? ?? 6a 14 6a 10 56 ff d7 6a 49 68 ?? ?? ?? ?? 6a 3c 6a 10 56 ff d7 } //15
		$a_03_6 = {68 ff ff ff 00 56 ff 15 ?? ?? ?? ?? 68 00 00 ad 00 56 ff 15 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 8b 1d ?? ?? ?? ?? 68 00 01 00 00 8d 44 24 ?? 50 6a 68 51 ff } //15
		$a_01_7 = {6a 00 68 98 3a 00 00 6a 6e 56 ff d7 6a 00 68 20 4e 00 00 6a 6f 56 ff d7 6a 00 68 30 75 00 00 6a 70 } //10
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*5+(#a_00_4  & 1)*5+(#a_03_5  & 1)*15+(#a_03_6  & 1)*15+(#a_01_7  & 1)*10) >=20
 
}
rule Rogue_Win32_FakeXPA_37{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 21 00 00 "
		
	strings :
		$a_00_0 = {41 00 6e 00 74 00 69 00 2d 00 56 00 69 00 72 00 75 00 73 00 20 00 4e 00 75 00 6d 00 62 00 65 00 72 00 2d 00 31 00 00 00 } //2
		$a_00_1 = {45 00 6e 00 61 00 62 00 6c 00 65 00 20 00 61 00 6e 00 74 00 69 00 72 00 6f 00 6f 00 74 00 6b 00 69 00 74 00 00 00 } //1
		$a_00_2 = {20 00 2d 00 20 00 54 00 68 00 72 00 65 00 61 00 74 00 73 00 20 00 64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 00 00 } //1
		$a_00_3 = {50 00 72 00 6f 00 74 00 65 00 63 00 74 00 20 00 79 00 6f 00 75 00 72 00 20 00 50 00 43 00 20 00 66 00 72 00 6f 00 6d 00 20 00 76 00 69 00 6f 00 6c 00 65 00 6e 00 74 00 20 00 76 00 69 00 72 00 75 00 73 00 20 00 61 00 74 00 74 00 61 00 63 00 6b 00 73 00 21 00 00 00 } //1
		$a_00_4 = {53 00 70 00 79 00 77 00 61 00 72 00 65 00 20 00 43 00 3a 00 2f 00 2f 00 77 00 69 00 6e 00 64 00 6f 00 77 00 73 00 2f 00 73 00 79 00 73 00 74 00 65 00 6d 00 33 00 32 00 2f 00 69 00 65 00 73 00 65 00 74 00 75 00 70 00 2e 00 64 00 6c 00 6c 00 } //1 Spyware C://windows/system32/iesetup.dll
		$a_00_5 = {54 00 72 00 6f 00 6a 00 61 00 6e 00 2e 00 54 00 6f 00 6f 00 73 00 6f 00 } //1 Trojan.Tooso
		$a_00_6 = {43 00 68 00 65 00 63 00 6b 00 20 00 68 00 69 00 64 00 64 00 65 00 6e 00 20 00 61 00 72 00 65 00 61 00 73 00 00 00 } //1
		$a_02_7 = {20 00 70 00 72 00 69 00 76 00 69 00 74 00 65 00 [0-0a] 69 00 6e 00 66 00 6f 00 72 00 6d 00 61 00 74 00 69 00 6f 00 6e 00 [0-0a] 6d 00 6f 00 72 00 65 00 [0-0a] 76 00 75 00 6c 00 6e 00 65 00 72 00 61 00 62 00 6c 00 65 00 } //2
		$a_00_8 = {64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 69 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 20 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 20 00 63 00 6f 00 6e 00 66 00 6c 00 69 00 63 00 74 00 2e 00 20 00 53 00 6f 00 6d 00 65 00 20 00 61 00 70 00 70 00 6c 00 69 00 63 00 7a 00 74 00 69 00 6f 00 6e 00 20 00 74 00 72 00 69 00 65 00 73 00 } //2 detected internal software conflict. Some applicztion tries
		$a_00_9 = {51 00 57 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00 2e 00 64 00 6c 00 6c 00 } //1 QWProtect.dll
		$a_01_10 = {4d 00 61 00 43 00 61 00 74 00 74 00 65 00 20 00 } //2 MaCatte 
		$a_02_11 = {20 70 72 69 76 69 74 65 [0-0a] 69 6e 66 6f 72 6d 61 74 69 6f 6e [0-0a] 6d 6f 72 65 [0-0a] 76 75 6c 6e 65 72 61 62 6c 65 } //2
		$a_01_12 = {74 61 73 6b 6b 69 6c 6c 2e 65 78 65 20 2f 66 20 2f 69 6d 20 4d 53 41 53 43 75 69 2e 65 78 65 } //1 taskkill.exe /f /im MSASCui.exe
		$a_01_13 = {64 3a 5c 21 21 21 57 4f 52 4b 5c 61 77 6f 72 6b 5c 73 6f 66 74 5c 73 6f 66 74 5c } //1 d:\!!!WORK\awork\soft\soft\
		$a_03_14 = {6d 00 61 00 6c 00 63 00 6f 00 75 00 73 00 20 00 [0-0a] 54 00 72 00 6f 00 6a 00 61 00 6e 00 73 00 } //1
		$a_01_15 = {45 61 72 74 68 20 41 6e 74 69 56 69 72 75 73 } //1 Earth AntiVirus
		$a_00_16 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 47 00 41 00 56 00 5c 00 47 00 41 00 56 00 5c 00 } //1 Software\GAV\GAV\
		$a_01_17 = {44 00 65 00 66 00 65 00 6e 00 63 00 65 00 43 00 65 00 6e 00 74 00 65 00 72 00 20 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 } //1 DefenceCenter Antivirus
		$a_01_18 = {53 65 74 75 70 2e 49 6e 44 65 70 74 68 41 6e 61 6c 69 73 69 73 } //1 Setup.InDepthAnalisis
		$a_01_19 = {55 70 64 61 74 65 2e 41 75 74 6f 55 70 64 61 74 65 50 72 6f 67 72 61 6d 6d 4e 6f 74 69 66 79 57 68 65 6e 44 6f 6e 65 } //1 Update.AutoUpdateProgrammNotifyWhenDone
		$a_01_20 = {57 00 49 00 4e 00 2e 00 52 00 47 00 58 00 50 00 2e 00 54 00 6f 00 6f 00 73 00 6f 00 } //1 WIN.RGXP.Tooso
		$a_01_21 = {44 00 65 00 66 00 65 00 6e 00 63 00 65 00 43 00 65 00 6e 00 74 00 65 00 72 00 56 00 69 00 65 00 77 00 4d 00 65 00 73 00 73 00 61 00 67 00 65 00 73 00 43 00 61 00 74 00 63 00 68 00 65 00 72 00 57 00 69 00 6e 00 64 00 6f 00 77 00 } //1 DefenceCenterViewMessagesCatcherWindow
		$a_01_22 = {44 00 65 00 66 00 65 00 6e 00 63 00 65 00 4d 00 6f 00 64 00 65 00 6c 00 4d 00 65 00 73 00 73 00 61 00 67 00 65 00 73 00 43 00 61 00 74 00 63 00 68 00 65 00 72 00 57 00 69 00 6e 00 64 00 6f 00 77 00 } //1 DefenceModelMessagesCatcherWindow
		$a_03_23 = {41 56 44 42 50 61 74 68 20 3d 20 22 43 3a 5c 5c 44 6f 63 75 6d 65 6e 74 73 20 61 6e 64 20 53 65 74 74 69 6e 67 73 5c 5c 41 6c 6c 20 55 73 65 72 73 5c 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 5c [0-0a] 5c 5c 64 62 2e 61 76 64 62 22 } //1
		$a_01_24 = {57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5f 00 44 00 65 00 66 00 65 00 6e 00 63 00 65 00 5f 00 50 00 72 00 6f 00 6a 00 65 00 63 00 74 00 } //1 Windows_Defence_Project
		$a_01_25 = {5f 00 53 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 5f 00 43 00 65 00 6e 00 74 00 65 00 72 00 5f 00 50 00 72 00 6f 00 6a 00 65 00 63 00 74 00 } //1 _Security_Center_Project
		$a_01_26 = {53 65 74 75 70 2e 49 6e 73 70 65 63 74 48 69 64 64 65 6e 50 72 6f 63 63 65 73 73 65 73 } //1 Setup.InspectHiddenProccesses
		$a_01_27 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 44 00 65 00 66 00 65 00 6e 00 63 00 65 00 5c 00 43 00 6f 00 6e 00 66 00 69 00 67 00 } //1 Software\Defence\Config
		$a_01_28 = {53 6f 66 74 77 61 72 65 5c 44 66 63 5c 43 6f 6e 66 69 67 } //1 Software\Dfc\Config
		$a_01_29 = {53 65 74 75 70 2e 41 6e 74 69 52 6f 6f 74 6b 69 74 } //1 Setup.AntiRootkit
		$a_01_30 = {49 6e 66 6f 2e 53 65 63 43 65 6e 74 65 72 45 78 65 4e 61 6d 65 } //1 Info.SecCenterExeName
		$a_01_31 = {6f 00 77 00 73 00 20 00 44 00 65 00 66 00 65 00 6e 00 63 00 65 00 20 00 72 00 65 00 70 00 6f 00 72 00 74 00 73 00 20 00 74 00 68 00 61 00 74 00 20 00 69 00 74 00 } //1 ows Defence reports that it
		$a_01_32 = {69 00 6f 00 6e 00 20 00 44 00 61 00 74 00 61 00 5c 00 44 00 66 00 63 00 5c 00 43 00 6f 00 6e 00 66 00 69 00 67 00 } //1 ion Data\Dfc\Config
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_02_7  & 1)*2+(#a_00_8  & 1)*2+(#a_00_9  & 1)*1+(#a_01_10  & 1)*2+(#a_02_11  & 1)*2+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1+(#a_03_14  & 1)*1+(#a_01_15  & 1)*1+(#a_00_16  & 1)*1+(#a_01_17  & 1)*1+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1+(#a_03_23  & 1)*1+(#a_01_24  & 1)*1+(#a_01_25  & 1)*1+(#a_01_26  & 1)*1+(#a_01_27  & 1)*1+(#a_01_28  & 1)*1+(#a_01_29  & 1)*1+(#a_01_30  & 1)*1+(#a_01_31  & 1)*1+(#a_01_32  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_38{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 3f 00 00 "
		
	strings :
		$a_00_0 = {44 55 52 4c 00 00 00 00 ff ff ff ff 04 00 00 00 44 41 46 46 00 00 00 00 ff ff ff ff 04 00 00 00 54 52 4d 53 00 00 00 00 ff ff ff ff 05 00 00 00 46 42 55 52 4c 00 } //2
		$a_00_1 = {53 65 63 75 72 69 74 79 20 56 69 6f 6c 61 74 69 6f 6e 20 45 72 72 6f 72 23 23 23 49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 73 20 61 64 64 6f 6e 20 53 68 6f 63 6b 77 61 76 65 20 46 6c 61 73 68 20 76 73 2e 33 } //2 Security Violation Error###Internet Explorers addon Shockwave Flash vs.3
		$a_00_2 = {46 41 56 47 00 00 00 00 ff ff ff ff 05 00 00 00 41 66 66 49 44 00 } //1
		$a_00_3 = {46 41 56 47 00 00 00 00 ff ff ff ff 07 00 00 00 5b 44 4f 4d 41 49 4e 00 } //1
		$a_00_4 = {2f 62 75 79 2e 70 68 70 3f 69 64 3d 25 61 66 66 69 64 25 } //1 /buy.php?id=%affid%
		$a_00_5 = {2f 3f 61 63 74 3d 76 76 26 69 64 3d 25 61 66 66 69 64 25 } //1 /?act=vv&id=%affid%
		$a_00_6 = {2f 3f 61 63 74 3d 72 65 67 26 74 79 70 65 3d 25 70 72 6f 64 75 63 74 69 64 25 26 69 64 3d 25 61 66 66 69 64 25 } //1 /?act=reg&type=%productid%&id=%affid%
		$a_00_7 = {25 62 72 6f 77 73 65 72 25 00 00 00 ff ff ff ff 05 00 00 00 41 66 66 49 44 00 00 00 ff ff ff ff 07 00 00 00 25 61 66 66 69 64 25 00 } //1
		$a_00_8 = {41 63 74 69 76 61 74 69 6f 6e 54 79 70 65 00 00 ff ff ff ff 09 00 00 00 25 61 63 74 74 79 70 65 25 00 } //1
		$a_00_9 = {44 41 46 46 00 00 00 00 ff ff ff ff 06 00 00 00 48 4c 50 55 52 4c 00 } //1
		$a_00_10 = {78 78 78 50 41 56 4d 54 58 00 } //1 硸偸噁呍X
		$a_00_11 = {53 65 74 75 70 20 2d 20 50 41 56 00 } //1
		$a_00_12 = {49 74 20 69 73 20 72 65 63 6f 6d 6d 65 6e 64 65 64 20 74 68 61 74 20 79 6f 75 20 63 6c 6f 73 65 20 61 6c 6c 20 6f 74 68 65 72 20 61 70 70 6c 69 63 61 74 69 6f 6e 73 20 61 6e 64 20 61 6e 74 69 76 69 72 75 73 65 73 20 62 65 66 6f 72 65 20 63 6f 6e 74 69 6e 75 69 6e 67 2e } //1 It is recommended that you close all other applications and antiviruses before continuing.
		$a_00_13 = {25 76 6d 64 65 74 65 63 74 25 00 00 ff ff ff ff 0c 00 00 00 25 77 69 6e 69 6e 73 74 61 6c 6c 25 00 } //1
		$a_00_14 = {74 73 63 2e 65 78 65 00 } //1
		$a_00_15 = {73 6d 73 73 2e 65 78 65 7c 7c 63 73 72 73 73 2e 65 78 65 7c 7c 77 69 6e 6c 6f 67 6f 6e 2e 65 78 65 } //1 smss.exe||csrss.exe||winlogon.exe
		$a_01_16 = {8b 45 fc 0f b6 44 18 ff 83 e8 3a c1 e0 06 0b f0 } //1
		$a_01_17 = {53 63 61 6e 20 4e 6f 77 00 00 00 00 ff ff ff ff 04 00 00 00 53 74 6f 70 00 } //1
		$a_00_18 = {53 70 79 77 61 72 65 2e 49 45 4d 6f 6e 73 74 65 72 20 61 63 74 69 76 69 74 79 20 64 65 74 65 63 74 65 64 2e } //1 Spyware.IEMonster activity detected.
		$a_00_19 = {41 66 66 49 44 00 00 00 4c 64 72 55 53 41 00 } //1
		$a_02_20 = {42 79 20 63 6c 69 63 6b 69 6e 67 20 43 6f 6e 74 69 6e 75 65 20 62 75 74 74 6f 6e 20 79 6f 75 (20 61 72 65 20|20) 61 63 63 65 70 74 69 6e 67 20 6f 75 72 } //1
		$a_00_21 = {66 72 6d 55 53 41 4d 61 69 6e 00 } //1
		$a_00_22 = {25 76 6d 64 65 74 65 63 74 25 00 00 ff ff ff ff 08 00 00 00 25 62 61 64 75 72 6c 25 } //1
		$a_00_23 = {54 70 61 76 4d 61 69 6e 46 6f 72 6d } //1 TpavMainForm
		$a_00_24 = {54 66 6d 41 56 4d 61 69 6e 00 } //1 晔䅭䵖楡n
		$a_00_25 = {45 56 41 53 6d 61 6c 6c 43 6f 6d 70 6f 6e 65 6e 74 73 00 } //1
		$a_00_26 = {45 56 41 4c 6f 61 64 65 72 00 } //1 噅䱁慯敤r
		$a_00_27 = {53 6f 66 74 77 61 72 65 5c 45 56 41 46 46 46 5c 00 } //1
		$a_00_28 = {2f 64 6f 77 6e 6c 6f 61 64 2f 65 76 61 2e 64 72 76 00 } //1
		$a_00_29 = {45 56 41 47 6c 6f 62 61 6c 73 00 } //1
		$a_00_30 = {74 61 62 41 6e 74 69 53 70 79 49 6e 66 6f 00 } //1
		$a_00_31 = {74 61 62 52 65 73 53 68 69 65 6c 64 49 6e 66 6f 00 } //1
		$a_00_32 = {5b 44 4f 4d 41 49 4e 00 ff ff ff ff 01 00 00 00 5d 00 } //1
		$a_00_33 = {41 66 66 49 44 00 00 00 ff ff ff ff 05 00 00 00 25 61 66 66 25 00 } //1
		$a_00_34 = {44 6f 70 49 44 31 00 00 ff ff ff ff 05 00 00 00 25 64 69 64 25 00 } //1
		$a_00_35 = {41 66 66 49 44 00 00 00 4c 64 72 41 56 00 } //1
		$a_00_36 = {6d 6b 72 6c 64 72 00 } //1
		$a_00_37 = {2f 3f 61 3d 6c 26 69 64 3d 25 61 66 66 69 64 25 26 75 69 64 3d 25 75 69 64 25 00 } //1
		$a_01_38 = {46 4e 55 4c 4c 00 00 00 ff ff ff ff 0a 00 00 00 2d 75 6e 69 6e 73 74 61 6c 6c 00 } //1
		$a_01_39 = {4e 55 4c 4c 4d 54 58 00 } //1 啎䱌呍X
		$a_00_40 = {5b 44 4f 4d 41 49 4e 32 5d 2f 77 69 6e 62 69 74 2e 62 6d 70 00 } //2
		$a_00_41 = {5b 44 4f 4d 41 49 4e 31 5d 2f 3f 62 3d 25 61 66 66 69 64 25 00 } //1
		$a_00_42 = {53 6f 66 74 77 61 72 65 5c 00 00 00 ff ff ff ff 05 00 00 00 41 56 33 36 30 } //1
		$a_00_43 = {41 63 74 69 76 61 74 65 64 00 00 00 ff ff ff ff 05 00 00 00 41 66 66 49 44 } //1
		$a_00_44 = {53 6f 66 74 77 61 72 65 5c 00 00 00 ff ff ff ff 03 00 00 00 45 56 41 00 } //2
		$a_00_45 = {25 66 6e 61 6d 65 25 00 } //1 春慮敭%
		$a_01_46 = {54 45 56 41 4d 61 69 6e 46 6f 72 6d 00 } //1
		$a_01_47 = {72 65 67 44 65 76 56 65 72 4c 64 00 } //1 敲䑧癥敖䱲d
		$a_01_48 = {41 66 66 49 44 00 00 00 ff ff ff ff 06 00 00 00 49 6e 74 4d 73 67 00 } //2
		$a_01_49 = {40 67 5b 6f 4f 4e 5b 3f 75 21 00 } //1
		$a_01_50 = {3c 77 5a 6f 55 68 57 3e 51 6a 63 3e 49 00 } //1 眼潚桕㹗橑㹣I
		$a_03_51 = {b8 1a 00 00 00 e8 ?? ?? ?? ?? 8b d0 83 c2 61 8d 45 fc e8 ?? ?? ?? ?? 8b 55 fc b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 4b 75 ?? b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 40 08 2e } //2
		$a_03_52 = {b8 04 00 00 00 e8 ?? ?? ?? ?? 8b 4d f8 8d 45 fc ba ?? ?? ?? ?? e8 ?? ?? ?? ?? 8d 45 f4 8b 4d fc 8b d3 e8 ?? ?? ?? ?? 8b 45 f4 e8 ?? ?? ?? ?? 8b f8 57 56 e8 ?? ?? ?? ?? 6a 04 6a 00 8d 45 f0 8b 4d fc } //2
		$a_03_53 = {b8 04 00 00 00 e8 ?? ?? ?? ?? ff 75 ?? 8d 45 fc ba 03 00 00 00 e8 ?? ?? ?? ?? 8b 45 fc e8 ?? ?? ?? ?? 8b f8 57 56 e8 ?? ?? ?? ?? 6a 04 6a 00 57 e8 } //2
		$a_03_54 = {05 10 0e 00 00 2b [c3 c6 c7] b9 10 0e 00 00 99 f7 f9 83 fa 0a 7e } //2
		$a_00_55 = {59 6f 75 72 20 73 79 73 74 65 6d 20 6d 69 67 68 74 20 62 65 20 61 74 20 61 20 72 69 73 6b 20 6e 6f 77 2e } //1 Your system might be at a risk now.
		$a_00_56 = {47 65 74 4c 69 63 65 6e 73 65 43 6c 69 63 6b } //1 GetLicenseClick
		$a_00_57 = {50 72 6f 74 65 63 74 43 6c 69 63 6b } //1 ProtectClick
		$a_00_58 = {41 74 74 65 6e 74 69 6f 6e 21 20 5a 6c 6f 62 2e 50 6f 72 6e 41 64 76 65 72 74 69 73 65 72 2e 62 61 20 69 73 20 69 6e 20 53 74 61 6e 64 62 79 20 6d 6f 64 65 20 6e 6f 77 } //2 Attention! Zlob.PornAdvertiser.ba is in Standby mode now
		$a_03_59 = {03 c3 2b c6 99 f7 fb (83 fa 0a|42 83 fa 0b) 7e ?? (|) a1 8b 45 } //2
		$a_01_60 = {55 6e 69 49 44 00 00 00 ff ff ff ff 08 00 00 00 46 65 65 64 62 61 63 6b 00 } //2
		$a_01_61 = {5a 73 47 75 69 64 00 } //1
		$a_01_62 = {6d 61 6c 7a 69 6c 6c 61 00 00 00 00 ff ff ff ff 04 00 00 00 76 62 6f 78 00 } //1
	condition:
		((#a_00_0  & 1)*2+(#a_00_1  & 1)*2+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1+(#a_00_6  & 1)*1+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_00_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1+(#a_01_16  & 1)*1+(#a_01_17  & 1)*1+(#a_00_18  & 1)*1+(#a_00_19  & 1)*1+(#a_02_20  & 1)*1+(#a_00_21  & 1)*1+(#a_00_22  & 1)*1+(#a_00_23  & 1)*1+(#a_00_24  & 1)*1+(#a_00_25  & 1)*1+(#a_00_26  & 1)*1+(#a_00_27  & 1)*1+(#a_00_28  & 1)*1+(#a_00_29  & 1)*1+(#a_00_30  & 1)*1+(#a_00_31  & 1)*1+(#a_00_32  & 1)*1+(#a_00_33  & 1)*1+(#a_00_34  & 1)*1+(#a_00_35  & 1)*1+(#a_00_36  & 1)*1+(#a_00_37  & 1)*1+(#a_01_38  & 1)*1+(#a_01_39  & 1)*1+(#a_00_40  & 1)*2+(#a_00_41  & 1)*1+(#a_00_42  & 1)*1+(#a_00_43  & 1)*1+(#a_00_44  & 1)*2+(#a_00_45  & 1)*1+(#a_01_46  & 1)*1+(#a_01_47  & 1)*1+(#a_01_48  & 1)*2+(#a_01_49  & 1)*1+(#a_01_50  & 1)*1+(#a_03_51  & 1)*2+(#a_03_52  & 1)*2+(#a_03_53  & 1)*2+(#a_03_54  & 1)*2+(#a_00_55  & 1)*1+(#a_00_56  & 1)*1+(#a_00_57  & 1)*1+(#a_00_58  & 1)*2+(#a_03_59  & 1)*2+(#a_01_60  & 1)*2+(#a_01_61  & 1)*1+(#a_01_62  & 1)*1) >=3
 
}
rule Rogue_Win32_FakeXPA_39{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,0b 00 0b 00 01 00 00 "
		
	strings :
		$a_01_0 = {54 68 69 73 20 70 72 6f 67 72 61 6d 20 77 69 6c 6c 20 64 6f 77 6e 6c 6f 61 64 20 61 6e 64 20 69 6e 73 74 61 6c 6c 20 58 50 20 41 6e 74 69 76 69 72 75 73 20 6f 6e 20 79 6f 75 72 20 50 43 2e } //11 This program will download and install XP Antivirus on your PC.
	condition:
		((#a_01_0  & 1)*11) >=11
 
}
rule Rogue_Win32_FakeXPA_40{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {41 6e 74 69 76 69 72 75 73 20 32 30 30 39 20 2d 20 54 68 72 65 61 74 73 20 64 65 74 65 63 74 65 64 } //1 Antivirus 2009 - Threats detected
		$a_01_1 = {73 63 75 69 2e 63 70 6c } //1 scui.cpl
		$a_01_2 = {53 63 61 6e 20 49 45 20 63 6f 6f 6b 69 65 73 } //1 Scan IE cookies
		$a_01_3 = {24 24 24 24 2e 62 61 74 } //1 $$$$.bat
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_41{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,04 00 04 00 05 00 00 "
		
	strings :
		$a_01_0 = {51 57 50 72 6f 74 65 63 74 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 } //2
		$a_01_1 = {51 57 50 72 6f 74 65 63 74 42 48 4f } //1 QWProtectBHO
		$a_01_2 = {74 12 6a 02 6a 00 6a 00 8b 45 08 50 e8 } //1
		$a_01_3 = {83 e1 fd 8b 55 08 c1 fa 05 8b 45 08 83 e0 1f c1 e0 06 } //1
		$a_01_4 = {00 00 61 00 6e 00 74 00 79 00 00 00 00 00 61 00 6e 00 74 00 69 00 00 00 } //1
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_42{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,1e 00 1e 00 03 00 00 "
		
	strings :
		$a_01_0 = {68 74 74 70 3a 2f 2f 77 69 6e 61 6e 74 69 76 69 72 75 73 70 72 6f 2e 6e 65 74 2f 62 75 79 2e 70 68 70 3f 61 66 66 69 64 3d } //10 http://winantiviruspro.net/buy.php?affid=
		$a_01_1 = {37 34 35 32 37 30 45 37 2d 34 34 39 45 2d 34 36 37 45 2d 39 31 45 41 2d 31 34 33 44 45 41 32 36 30 42 32 32 } //10 745270E7-449E-467E-91EA-143DEA260B22
		$a_01_2 = {53 70 79 77 61 72 65 2e 49 45 4d 6f 6e 73 74 65 72 20 61 63 74 69 76 69 74 79 20 64 65 74 65 63 74 65 64 2e } //10 Spyware.IEMonster activity detected.
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10) >=30
 
}
rule Rogue_Win32_FakeXPA_43{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {4d 69 63 72 6f 73 6f 66 74 20 57 69 6e 64 6f 77 73 20 41 6c 65 72 74 21 } //1 Microsoft Windows Alert!
		$a_01_1 = {43 72 69 74 69 63 61 6c 20 53 79 73 74 65 6d 20 57 61 72 6e 69 6e 67 21 } //1 Critical System Warning!
		$a_01_2 = {59 6f 75 72 20 73 79 73 74 65 6d 20 69 73 20 70 72 6f 62 61 62 6c 79 20 69 6e 66 65 63 74 65 64 20 77 69 74 68 20 76 65 72 73 69 6f 6e 20 6f 66 20 53 70 79 77 61 72 65 2e 49 45 4d 6f 6e 73 74 65 72 2e 62 2e } //1 Your system is probably infected with version of Spyware.IEMonster.b.
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}
rule Rogue_Win32_FakeXPA_44{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,02 00 02 00 02 00 00 "
		
	strings :
		$a_01_0 = {47 00 68 00 6f 00 73 00 74 00 00 00 38 00 00 00 53 00 65 00 74 00 75 00 70 00 20 00 2d 00 20 00 45 00 2d 00 53 00 65 00 74 00 20 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 32 00 30 00 31 00 31 00 00 00 00 00 04 00 00 00 } //1
		$a_01_1 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 73 00 76 00 63 00 33 00 32 00 2e 00 65 00 78 00 65 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1) >=2
 
}
rule Rogue_Win32_FakeXPA_45{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,02 00 02 00 02 00 00 "
		
	strings :
		$a_01_0 = {54 68 69 73 20 70 72 6f 67 72 61 6d 20 77 69 6c 6c 20 64 6f 77 6e 6c 6f 61 64 20 61 6e 64 20 69 6e 73 74 61 6c 6c 20 41 6e 74 69 76 69 72 75 73 } //1 This program will download and install Antivirus
		$a_01_1 = {41 63 63 6f 72 64 69 6e 67 6c 79 20 74 6f 20 74 65 63 68 6e 69 63 61 6c 20 72 65 61 73 6f 6e 20 69 74 27 73 20 69 6d 70 6f 73 73 69 62 6c 65 20 74 6f 20 64 6f 77 6e 6c 6f 61 64 20 61 6e 64 20 69 6e 73 74 61 6c 6c 20 74 68 65 20 66 72 65 65 20 76 65 72 73 69 6f 6e } //1 Accordingly to technical reason it's impossible to download and install the free version
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1) >=2
 
}
rule Rogue_Win32_FakeXPA_46{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,06 00 05 00 07 00 00 "
		
	strings :
		$a_01_0 = {7b 38 42 31 45 36 32 35 36 2d 36 43 33 43 2d 34 34 32 63 2d 39 42 32 38 2d 45 35 32 36 45 41 32 45 37 33 46 36 7d } //1 {8B1E6256-6C3C-442c-9B28-E526EA2E73F6}
		$a_01_1 = {3a 2f 2f 73 63 61 6e 72 65 70 6f 72 74 69 6e 67 2e 63 6f 6d } //1 ://scanreporting.com
		$a_01_2 = {42 75 79 44 69 73 63 55 72 6c } //1 BuyDiscUrl
		$a_01_3 = {77 77 77 2e 57 69 6e 44 65 73 6b 74 6f 70 44 65 66 65 6e 64 65 72 2e 63 6f 6d 2f } //1 www.WinDesktopDefender.com/
		$a_01_4 = {44 65 73 6b 74 6f 70 20 44 65 66 65 6e 64 65 72 20 32 30 31 30 } //1 Desktop Defender 2010
		$a_01_5 = {69 6e 73 74 61 6c 6c 65 72 2d 6d 75 74 65 78 2d } //1 installer-mutex-
		$a_01_6 = {2f 68 74 74 70 73 73 2f 73 65 74 75 70 2e 70 68 70 3f } //1 /httpss/setup.php?
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_47{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,05 00 05 00 06 00 00 "
		
	strings :
		$a_01_0 = {41 00 00 00 54 68 69 73 20 70 72 6f 67 72 61 6d 20 77 69 6c 6c 20 64 6f 77 6e 6c 6f 61 64 20 61 6e 64 20 69 6e 73 74 61 6c 6c 20 41 6e 74 69 76 69 72 75 73 20 32 30 30 39 20 6f 6e 20 79 6f 75 72 20 50 43 2e } //1
		$a_01_1 = {05 00 00 00 66 4d 61 69 6e } //1
		$a_01_2 = {2e 00 00 00 42 49 54 42 54 4e 31 5f 42 49 54 4d 41 50 } //1
		$a_01_3 = {73 6f 66 74 77 61 72 65 5c 6d 69 63 72 6f 73 6f 66 74 5c 77 69 6e 64 6f 77 73 5c 63 75 72 72 65 6e 74 76 65 72 73 69 6f 6e 5c 72 75 6e } //1 software\microsoft\windows\currentversion\run
		$a_01_4 = {55 52 4c 4f 70 65 6e 53 74 72 65 61 6d 41 } //1 URLOpenStreamA
		$a_01_5 = {53 68 65 6c 6c 45 78 65 63 75 74 65 45 78 41 } //1 ShellExecuteExA
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_48{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {2e 00 70 00 68 00 70 00 3f 00 73 00 74 00 65 00 70 00 3d 00 } //1 .php?step=
		$a_01_1 = {5c 00 7b 00 46 00 32 00 37 00 35 00 45 00 39 00 33 00 31 00 2d 00 41 00 46 00 45 00 43 00 2d 00 34 00 66 00 37 00 30 00 2d 00 42 00 30 00 44 00 34 00 2d 00 43 00 43 00 32 00 37 00 33 00 31 00 42 00 39 00 34 00 35 00 45 00 30 00 7d 00 } //1 \{F275E931-AFEC-4f70-B0D4-CC2731B945E0}
		$a_01_2 = {5c 41 56 49 6e 73 74 61 6c 6c 65 72 } //1 \AVInstaller
		$a_01_3 = {5f 00 69 00 6e 00 73 00 74 00 5f 00 64 00 6c 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 _inst_dl_failure
		$a_01_4 = {5f 00 73 00 74 00 61 00 67 00 65 00 5f 00 6f 00 6e 00 65 00 5f 00 63 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00 } //1 _stage_one_complete
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_49{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {4a 61 76 61 53 63 72 69 70 74 00 00 73 61 79 48 65 6c 6c 6f 28 29 } //2
		$a_01_1 = {49 45 44 65 66 65 6e 64 65 72 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 } //2 䕉敄敦摮牥䐮䱌䐀汬慃啮汮慯乤睯
		$a_01_2 = {33 00 43 00 34 00 30 00 32 00 33 00 36 00 44 00 2d 00 39 00 39 00 30 00 42 00 2d 00 34 00 34 00 33 00 43 00 2d 00 39 00 30 00 45 00 38 00 2d 00 42 00 31 00 43 00 30 00 37 00 42 00 43 00 44 00 34 00 41 00 36 00 38 00 } //1 3C40236D-990B-443C-90E8-B1C07BCD4A68
		$a_01_3 = {46 00 32 00 37 00 35 00 45 00 39 00 33 00 31 00 2d 00 41 00 46 00 45 00 43 00 2d 00 34 00 66 00 37 00 30 00 2d 00 42 00 30 00 44 00 34 00 2d 00 43 00 43 00 32 00 37 00 33 00 31 00 42 00 39 00 34 00 35 00 45 00 30 00 } //1 F275E931-AFEC-4f70-B0D4-CC2731B945E0
		$a_01_4 = {2f 69 6e 64 65 78 2e 70 68 70 3f 69 64 3d } //1 /index.php?id=
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}
rule Rogue_Win32_FakeXPA_50{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,14 00 14 00 07 00 00 "
		
	strings :
		$a_01_0 = {2f 70 72 65 73 61 6c 65 2f 32 2f 69 6e 64 65 78 2e 70 68 70 3f 69 64 3d } //10 /presale/2/index.php?id=
		$a_01_1 = {7b 44 36 32 43 39 35 36 30 2d 30 31 38 30 2d 34 37 65 61 2d 41 33 45 33 2d 36 36 36 42 43 30 46 45 34 31 43 43 7d } //10 {D62C9560-0180-47ea-A3E3-666BC0FE41CC}
		$a_01_2 = {2f 00 61 00 64 00 6d 00 69 00 6e 00 2f 00 63 00 67 00 69 00 2d 00 62 00 69 00 6e 00 2f 00 67 00 65 00 74 00 5f 00 64 00 6f 00 6d 00 61 00 69 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 74 00 79 00 70 00 65 00 3d 00 73 00 69 00 74 00 65 00 } //10 /admin/cgi-bin/get_domain.php?type=site
		$a_01_3 = {2f 62 6c 6f 63 6b 65 64 2e 70 68 70 3f 69 64 3d } //5 /blocked.php?id=
		$a_01_4 = {61 00 6e 00 74 00 69 00 76 00 69 00 72 00 79 00 73 00 00 00 } //5
		$a_01_5 = {61 00 6e 00 74 00 69 00 76 00 79 00 72 00 75 00 73 00 00 00 } //5
		$a_01_6 = {61 00 6e 00 74 00 79 00 76 00 69 00 72 00 75 00 73 00 00 00 } //5
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*5+(#a_01_4  & 1)*5+(#a_01_5  & 1)*5+(#a_01_6  & 1)*5) >=20
 
}
rule Rogue_Win32_FakeXPA_51{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {7b 00 33 00 35 00 33 00 39 00 44 00 46 00 45 00 38 00 2d 00 36 00 42 00 45 00 39 00 2d 00 34 00 34 00 61 00 33 00 2d 00 38 00 45 00 37 00 38 00 2d 00 34 00 34 00 44 00 42 00 41 00 45 00 35 00 42 00 44 00 43 00 31 00 33 00 7d 00 } //1 {3539DFE8-6BE9-44a3-8E78-44DBAE5BDC13}
		$a_01_1 = {7b 00 38 00 34 00 32 00 38 00 33 00 45 00 36 00 42 00 2d 00 43 00 33 00 37 00 37 00 2d 00 34 00 39 00 38 00 66 00 2d 00 42 00 46 00 39 00 31 00 2d 00 36 00 39 00 38 00 45 00 38 00 37 00 37 00 35 00 35 00 35 00 43 00 43 00 7d 00 } //1 {84283E6B-C377-498f-BF91-698E877555CC}
		$a_01_2 = {2f 00 61 00 64 00 6d 00 69 00 6e 00 2f 00 63 00 67 00 69 00 2d 00 62 00 69 00 6e 00 2f 00 67 00 65 00 74 00 5f 00 64 00 6f 00 6d 00 61 00 69 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 74 00 79 00 70 00 65 00 3d 00 } //1 /admin/cgi-bin/get_domain.php?type=
		$a_01_3 = {2f 00 75 00 70 00 64 00 61 00 74 00 65 00 72 00 2e 00 65 00 78 00 65 00 } //1 /updater.exe
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_52{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,0a 00 0a 00 0e 00 00 "
		
	strings :
		$a_01_0 = {2f 65 6e 2f 65 78 65 2f 49 45 44 65 66 65 6e 64 65 72 2e 64 6c 6c } //2 /en/exe/IEDefender.dll
		$a_01_1 = {59 6f 75 20 6e 65 65 64 20 74 6f 20 68 61 76 65 20 69 6e 74 65 72 6e 65 74 20 61 63 63 65 73 73 20 74 6f 20 64 6f 77 6e 6c 6f 61 64 20 61 6e 64 20 69 6e 73 74 61 6c 6c 20 74 68 65 20 66 72 65 65 20 76 65 72 73 69 6f 6e 20 6f 66 20 41 6e 74 69 76 69 72 75 73 20 32 30 } //2 You need to have internet access to download and install the free version of Antivirus 20
		$a_01_2 = {59 6f 75 20 6d 75 73 74 20 68 61 76 65 20 61 64 6d 69 6e 20 72 69 67 68 74 73 21 } //1 You must have admin rights!
		$a_01_3 = {2f 65 6e 2f 65 78 65 2f 41 56 32 30 31 30 2e 65 78 65 } //1 /en/exe/AV2010.exe
		$a_01_4 = {53 6f 66 74 77 61 72 65 5c 41 56 32 30 31 30 5c 41 56 32 30 31 30 5c } //1 Software\AV2010\AV2010\
		$a_01_5 = {5c 77 69 6e 67 61 6d 6d 61 2e 65 78 65 } //1 \wingamma.exe
		$a_01_6 = {67 65 74 2e 70 68 70 3f 73 74 65 70 3d } //1 get.php?step=
		$a_01_7 = {2f 62 75 79 2e 70 68 70 } //1 /buy.php
		$a_01_8 = {5f 68 6f 73 74 66 69 6c 65 5f 64 6f 65 73 5f 6e 6f 74 5f 65 78 69 73 74 5f } //1 _hostfile_does_not_exist_
		$a_01_9 = {5f 67 65 6e 65 72 61 74 65 5f 63 6c 6f 6e 65 5f } //1 _generate_clone_
		$a_01_10 = {5f 69 6e 73 74 61 6c 6c 5f 72 75 6e 5f } //1 _install_run_
		$a_01_11 = {72 65 76 69 65 77 73 2e 72 69 76 65 72 73 74 72 65 61 6d 73 2e 63 6f 2e 75 6b } //1 reviews.riverstreams.co.uk
		$a_01_12 = {72 65 76 69 65 77 73 2e 74 65 63 68 72 61 64 61 72 2e 63 6f 6d } //1 reviews.techradar.com
		$a_01_13 = {73 6f 66 74 77 61 72 65 72 65 76 69 65 77 73 2e 63 6f 6d } //1 softwarereviews.com
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1) >=10
 
}
rule Rogue_Win32_FakeXPA_53{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,14 00 14 00 07 00 00 "
		
	strings :
		$a_01_0 = {2f 00 70 00 72 00 65 00 73 00 61 00 6c 00 65 00 2f 00 32 00 2f 00 69 00 6e 00 64 00 65 00 78 00 2e 00 70 00 68 00 70 00 3f 00 69 00 64 00 3d 00 } //10 /presale/2/index.php?id=
		$a_01_1 = {7b 00 46 00 32 00 37 00 35 00 45 00 39 00 33 00 31 00 2d 00 41 00 46 00 45 00 43 00 2d 00 34 00 66 00 37 00 30 00 2d 00 42 00 30 00 44 00 34 00 2d 00 43 00 43 00 32 00 37 00 33 00 31 00 42 00 39 00 34 00 35 00 45 00 30 00 7d 00 } //10 {F275E931-AFEC-4f70-B0D4-CC2731B945E0}
		$a_01_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 65 00 74 00 20 00 45 00 78 00 70 00 6c 00 6f 00 72 00 65 00 72 00 20 00 68 00 61 00 73 00 20 00 66 00 6f 00 75 00 6e 00 64 00 20 00 61 00 6e 00 20 00 75 00 6e 00 72 00 65 00 67 00 69 00 73 00 74 00 65 00 72 00 65 00 64 00 20 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 20 00 6f 00 66 00 20 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 32 00 30 00 31 00 30 00 2e 00 } //10 Internet Explorer has found an unregistered version of Antivirus 2010.
		$a_01_3 = {2f 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 64 00 2e 00 70 00 68 00 70 00 3f 00 69 00 64 00 3d 00 } //5 /blocked.php?id=
		$a_01_4 = {61 00 6e 00 74 00 69 00 76 00 69 00 72 00 79 00 73 00 00 00 } //5
		$a_01_5 = {61 00 6e 00 74 00 69 00 76 00 79 00 72 00 75 00 73 00 00 00 } //5
		$a_01_6 = {61 00 6e 00 74 00 79 00 76 00 69 00 72 00 75 00 73 00 00 00 } //5
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*5+(#a_01_4  & 1)*5+(#a_01_5  & 1)*5+(#a_01_6  & 1)*5) >=20
 
}
rule Rogue_Win32_FakeXPA_54{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,05 00 05 00 09 00 00 "
		
	strings :
		$a_01_0 = {2f 61 64 6d 69 6e 2f 63 67 69 2d 62 69 6e 2f 63 68 65 63 6b 5f 75 70 64 61 74 65 2e 70 68 70 3f 74 79 70 65 3d 73 69 74 65 } //3 /admin/cgi-bin/check_update.php?type=site
		$a_01_1 = {63 00 6f 00 6c 00 6c 00 65 00 63 00 74 00 69 00 6f 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 73 00 74 00 65 00 70 00 3d 00 } //2 collection.php?step=
		$a_01_2 = {2f 00 61 00 66 00 74 00 65 00 72 00 73 00 63 00 61 00 6e 00 2e 00 70 00 68 00 70 00 3f 00 69 00 64 00 3d 00 25 00 73 00 } //2 /afterscan.php?id=%s
		$a_01_3 = {61 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_01_4 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 00 00 } //1
		$a_01_5 = {53 00 70 00 79 00 77 00 61 00 72 00 65 00 2e 00 49 00 45 00 4d 00 6f 00 6e 00 73 00 74 00 65 00 72 00 20 00 61 00 63 00 74 00 69 00 76 00 69 00 74 00 79 00 20 00 64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 2e 00 } //1 Spyware.IEMonster activity detected.
		$a_01_6 = {7c 00 45 00 58 00 45 00 50 00 41 00 54 00 48 00 7c 00 } //1 |EXEPATH|
		$a_01_7 = {64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 69 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 20 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 20 00 63 00 6f 00 6e 00 66 00 6c 00 69 00 63 00 74 00 2e 00 } //1 detected internal software conflict.
		$a_01_8 = {2f 63 6f 6c 6c 65 63 74 69 6f 6e 2e 70 68 70 3f 73 74 65 70 3d 41 56 5f 75 6e 69 6e 73 74 61 6c 6c 5f 63 6f 6d 70 6c 65 74 65 26 69 64 3d 25 73 } //3 /collection.php?step=AV_uninstall_complete&id=%s
	condition:
		((#a_01_0  & 1)*3+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*3) >=5
 
}
rule Rogue_Win32_FakeXPA_55{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,1b 00 1b 00 0c 00 00 "
		
	strings :
		$a_01_0 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 5c 00 52 00 75 00 6e 00 } //10 Software\Microsoft\Windows\CurrentVersion\Run
		$a_01_1 = {2f 00 61 00 64 00 6d 00 69 00 6e 00 2f 00 63 00 67 00 69 00 2d 00 62 00 69 00 6e 00 2f 00 67 00 65 00 74 00 5f 00 64 00 6f 00 6d 00 61 00 69 00 6e 00 2e 00 70 00 68 00 70 00 } //10 /admin/cgi-bin/get_domain.php
		$a_01_2 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 41 00 56 00 31 00 5c 00 41 00 56 00 31 00 5c 00 } //1 Software\AV1\AV1\
		$a_01_3 = {41 00 56 00 31 00 39 00 5f 00 73 00 74 00 61 00 67 00 65 00 5f 00 6f 00 6e 00 65 00 5f 00 63 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00 } //1 AV19_stage_one_complete
		$a_01_4 = {41 00 56 00 31 00 39 00 5f 00 69 00 6e 00 73 00 74 00 5f 00 72 00 75 00 6e 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 AV19_inst_run_failure
		$a_01_5 = {41 00 56 00 31 00 39 00 5f 00 69 00 6e 00 73 00 74 00 5f 00 64 00 6c 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 AV19_inst_dl_failure
		$a_01_6 = {41 00 56 00 31 00 39 00 5f 00 69 00 6e 00 73 00 74 00 32 00 5f 00 64 00 6c 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 AV19_inst2_dl_failure
		$a_01_7 = {41 00 56 00 31 00 69 00 2e 00 65 00 78 00 65 00 } //1 AV1i.exe
		$a_01_8 = {41 00 56 00 31 00 54 00 77 00 6f 00 2e 00 65 00 78 00 65 00 } //1 AV1Two.exe
		$a_01_9 = {41 00 6e 00 74 00 69 00 2d 00 76 00 69 00 72 00 75 00 73 00 2d 00 31 00 } //1 Anti-virus-1
		$a_01_10 = {41 00 56 00 31 00 39 00 5f 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 72 00 75 00 6e 00 } //1 AV19_install_run
		$a_01_11 = {41 00 56 00 31 00 39 00 5f 00 47 00 65 00 74 00 49 00 64 00 5f 00 66 00 61 00 69 00 6c 00 75 00 72 00 65 00 } //1 AV19_GetId_failure
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1) >=27
 
}
rule Rogue_Win32_FakeXPA_56{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,04 00 04 00 08 00 00 "
		
	strings :
		$a_01_0 = {2a 2a 2a 53 54 4f 50 3a 20 30 78 30 30 30 30 30 30 44 31 20 28 30 78 30 30 30 30 30 30 30 30 2c 20 30 78 46 37 33 31 32 30 41 45 2c 20 30 78 43 30 30 30 30 30 30 38 2c 20 30 78 43 30 30 30 30 30 30 30 29 } //2 ***STOP: 0x000000D1 (0x00000000, 0xF73120AE, 0xC0000008, 0xC0000000)
		$a_01_1 = {2a 2a 2a 20 53 52 56 2e 53 59 53 20 2d 20 41 64 64 72 65 73 73 20 46 37 33 31 32 30 41 45 20 62 61 73 65 20 61 74 20 43 30 30 30 30 30 30 30 2c 20 44 61 74 65 53 74 61 6d 70 20 33 36 62 30 37 32 61 33 } //2 *** SRV.SYS - Address F73120AE base at C0000000, DateStamp 36b072a3
		$a_01_2 = {41 20 73 70 79 77 61 72 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 68 61 73 20 62 65 65 6e 20 64 65 74 65 63 74 65 64 20 61 6e 64 20 57 69 6e 64 6f 77 73 20 68 61 73 20 62 65 65 6e 20 73 68 75 74 20 64 6f 77 6e 20 74 6f } //2 A spyware application has been detected and Windows has been shut down to
		$a_01_3 = {53 50 59 57 41 52 45 2e 4d 4f 4e 53 54 45 52 2e 46 58 5f 57 49 4c 44 5f 30 78 30 30 30 30 30 30 30 30 } //2 SPYWARE.MONSTER.FX_WILD_0x00000000
		$a_01_4 = {49 66 20 74 68 69 73 20 69 73 20 74 68 65 20 66 69 72 73 74 20 74 69 6d 65 20 79 6f 75 60 76 65 20 73 65 65 6e 20 74 68 69 73 20 53 74 6f 70 20 65 72 72 6f 72 20 73 63 72 65 65 6e 2c 20 72 65 73 74 61 72 74 20 79 6f 75 } //1 If this is the first time you`ve seen this Stop error screen, restart you
		$a_01_5 = {6e 65 77 20 69 6e 73 74 61 6c 6c 61 74 69 6f 6e 2c 20 61 73 6b 20 79 6f 75 20 73 6f 66 74 77 61 72 65 20 6d 61 6e 75 66 61 63 74 75 72 65 72 20 66 6f 72 20 61 6e 79 20 61 6e 74 69 76 69 72 75 73 20 75 70 64 61 74 65 73 } //1 new installation, ask you software manufacturer for any antivirus updates
		$a_01_6 = {57 69 6e 64 6f 77 73 20 64 65 74 65 63 74 65 64 20 75 6e 72 65 67 69 73 74 72 65 64 20 76 65 72 73 69 6f 6e 20 6f 66 20 41 6e 74 69 76 69 72 75 73 20 32 30 31 30 20 70 72 6f 74 65 63 74 69 6f 6e 20 6f 6e 20 79 6f 75 72 20 63 6f 6d 70 75 74 65 72 2e } //1 Windows detected unregistred version of Antivirus 2010 protection on your computer.
		$a_01_7 = {49 66 20 70 72 6f 62 6c 65 6d 20 63 6f 6e 74 69 6e 75 65 2c 20 70 6c 65 61 73 65 20 61 63 74 69 76 61 74 65 20 79 6f 75 72 20 61 6e 74 69 76 69 72 75 73 20 73 6f 66 74 77 61 72 65 20 74 6f 20 70 72 65 76 65 6e 74 20 63 6f 6d 70 74 65 72 } //1 If problem continue, please activate your antivirus software to prevent compter
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1) >=4
 
}
rule Rogue_Win32_FakeXPA_57{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,0f 00 0f 00 11 00 00 "
		
	strings :
		$a_01_0 = {7b 00 33 00 43 00 34 00 30 00 32 00 33 00 36 00 44 00 2d 00 39 00 39 00 30 00 42 00 2d 00 34 00 34 00 33 00 43 00 2d 00 39 00 30 00 45 00 38 00 2d 00 42 00 31 00 43 00 30 00 37 00 42 00 43 00 44 00 34 00 41 00 36 00 38 00 7d 00 } //2 {3C40236D-990B-443C-90E8-B1C07BCD4A68}
		$a_01_1 = {61 00 76 00 32 00 30 00 31 00 30 00 2e 00 6e 00 65 00 74 00 } //2 av2010.net
		$a_01_2 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 41 00 56 00 32 00 30 00 31 00 30 00 5c 00 41 00 56 00 32 00 30 00 31 00 30 00 5c 00 7b 00 46 00 32 00 37 00 35 00 45 00 39 00 33 00 31 00 2d 00 41 00 46 00 45 00 43 00 2d 00 34 00 66 00 37 00 30 00 2d 00 42 00 30 00 44 00 34 00 2d 00 43 00 43 00 32 00 37 00 33 00 31 00 42 00 39 00 34 00 35 00 45 00 30 00 7d 00 } //2 Software\AV2010\AV2010\{F275E931-AFEC-4f70-B0D4-CC2731B945E0}
		$a_01_3 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 6d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 2e 00 62 00 72 00 6f 00 77 00 73 00 65 00 72 00 2d 00 73 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 2d 00 63 00 65 00 6e 00 74 00 65 00 72 00 2e 00 63 00 6f 00 6d 00 2f 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 64 00 2e 00 70 00 68 00 70 00 3f 00 69 00 64 00 3d 00 } //1 http://microsoft.browser-security-center.com/blocked.php?id=
		$a_01_4 = {72 00 65 00 76 00 69 00 65 00 77 00 2e 00 32 00 30 00 30 00 39 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 63 00 6f 00 6d 00 } //1 review.2009softwarereviews.com
		$a_01_5 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 74 00 65 00 63 00 68 00 72 00 61 00 64 00 61 00 72 00 2e 00 63 00 6f 00 6d 00 } //1 reviews.techradar.com
		$a_01_6 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 72 00 69 00 76 00 65 00 72 00 73 00 74 00 72 00 65 00 61 00 6d 00 73 00 2e 00 63 00 6f 00 2e 00 75 00 6b 00 } //1 reviews.riverstreams.co.uk
		$a_01_7 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 72 00 65 00 65 00 76 00 6f 00 6f 00 2e 00 63 00 6f 00 6d 00 } //1 reviews.reevoo.com
		$a_01_8 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 70 00 63 00 70 00 72 00 6f 00 2e 00 63 00 6f 00 2e 00 75 00 6b 00 } //1 reviews.pcpro.co.uk
		$a_01_9 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 70 00 63 00 6d 00 61 00 67 00 2e 00 63 00 6f 00 6d 00 } //1 reviews.pcmag.com
		$a_01_10 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 70 00 63 00 61 00 64 00 76 00 69 00 73 00 6f 00 72 00 2e 00 63 00 6f 00 2e 00 75 00 6b 00 } //1 reviews.pcadvisor.co.uk
		$a_01_11 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 64 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 2e 00 63 00 6f 00 6d 00 } //1 reviews.download.com
		$a_01_12 = {72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 74 00 6f 00 70 00 74 00 65 00 6e 00 72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 63 00 6f 00 6d 00 } //1 reviews.toptenreviews.com
		$a_01_13 = {64 00 31 00 2e 00 72 00 65 00 76 00 69 00 65 00 77 00 73 00 2e 00 63 00 6e 00 65 00 74 00 2e 00 63 00 6f 00 6d 00 } //1 d1.reviews.cnet.com
		$a_01_14 = {61 00 31 00 2e 00 72 00 65 00 76 00 69 00 65 00 77 00 2e 00 7a 00 64 00 6e 00 65 00 74 00 2e 00 63 00 6f 00 6d 00 } //1 a1.review.zdnet.com
		$a_01_15 = {6d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 2e 00 62 00 72 00 6f 00 77 00 73 00 65 00 72 00 2d 00 73 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 2d 00 63 00 65 00 6e 00 74 00 65 00 72 00 2e 00 63 00 6f 00 6d 00 } //1 microsoft.browser-security-center.com
		$a_01_16 = {70 00 6c 00 69 00 6d 00 75 00 73 00 2e 00 63 00 6f 00 6d 00 } //1 plimus.com
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_01_16  & 1)*1) >=15
 
}
rule Rogue_Win32_FakeXPA_58{
	meta:
		description = "Rogue:Win32/FakeXPA,SIGNATURE_TYPE_PEHSTR,08 00 08 00 0e 00 00 "
		
	strings :
		$a_01_0 = {41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 32 00 30 00 31 00 30 00 } //2 Antivirus 2010
		$a_01_1 = {3f 00 73 00 74 00 65 00 70 00 3d 00 61 00 76 00 32 00 30 00 31 00 30 00 5f 00 63 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00 26 00 69 00 64 00 3d 00 } //2 ?step=av2010_complete&id=
		$a_01_2 = {2f 00 61 00 63 00 74 00 69 00 76 00 61 00 74 00 65 00 2e 00 70 00 68 00 70 00 3f 00 65 00 6d 00 61 00 69 00 6c 00 3d 00 } //2 /activate.php?email=
		$a_01_3 = {63 00 3a 00 5c 00 75 00 73 00 65 00 72 00 73 00 5c 00 73 00 65 00 72 00 68 00 69 00 6a 00 5c 00 64 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 73 00 5c 00 76 00 69 00 73 00 75 00 61 00 6c 00 20 00 73 00 74 00 75 00 64 00 69 00 6f 00 20 00 32 00 30 00 30 00 38 00 5c 00 70 00 72 00 6f 00 6a 00 65 00 63 00 74 00 73 00 5c 00 } //2 c:\users\serhij\documents\visual studio 2008\projects\
		$a_01_4 = {46 00 75 00 6e 00 63 00 74 00 69 00 6f 00 6e 00 20 00 55 00 70 00 64 00 61 00 74 00 65 00 20 00 69 00 73 00 20 00 64 00 69 00 61 00 62 00 6c 00 65 00 64 00 2e 00 20 00 43 00 72 00 69 00 74 00 69 00 63 00 61 00 6c 00 20 00 74 00 68 00 72 00 65 00 61 00 74 00 20 00 6f 00 66 00 20 00 62 00 65 00 69 00 6e 00 67 00 20 00 61 00 74 00 74 00 61 00 63 00 6b 00 65 00 64 00 20 00 62 00 79 00 20 00 6e 00 6f 00 76 00 65 00 6c 00 20 00 76 00 69 00 72 00 75 00 73 00 65 00 73 00 20 00 61 00 6e 00 64 00 20 00 73 00 70 00 79 00 77 00 61 00 72 00 65 00 2e 00 } //1 Function Update is diabled. Critical threat of being attacked by novel viruses and spyware.
		$a_01_5 = {49 00 6e 00 20 00 63 00 61 00 73 00 65 00 20 00 61 00 75 00 74 00 6f 00 6d 00 61 00 74 00 69 00 63 00 20 00 75 00 70 00 64 00 61 00 74 00 69 00 6e 00 67 00 20 00 69 00 73 00 20 00 6e 00 6f 00 74 00 20 00 70 00 65 00 72 00 66 00 6f 00 72 00 6d 00 65 00 64 00 2c 00 20 00 79 00 6f 00 75 00 72 00 20 00 50 00 43 00 20 00 69 00 73 00 20 00 75 00 6e 00 64 00 65 00 72 00 20 00 74 00 68 00 72 00 65 00 61 00 74 00 20 00 6f 00 66 00 20 00 62 00 65 00 69 00 6e 00 67 00 20 00 61 00 74 00 74 00 61 00 63 00 6b 00 65 00 64 00 20 00 62 00 79 00 20 00 6e 00 6f 00 76 00 65 00 6c 00 } //1 In case automatic updating is not performed, your PC is under threat of being attacked by novel
		$a_01_6 = {54 00 68 00 69 00 73 00 20 00 66 00 75 00 6e 00 63 00 74 00 69 00 6f 00 6e 00 20 00 61 00 6c 00 6c 00 6f 00 77 00 73 00 20 00 74 00 68 00 65 00 20 00 70 00 72 00 6f 00 67 00 72 00 61 00 6d 00 20 00 74 00 6f 00 20 00 70 00 65 00 72 00 66 00 6f 00 72 00 6d 00 20 00 61 00 75 00 74 00 6f 00 6d 00 61 00 74 00 69 00 63 00 20 00 75 00 70 00 64 00 61 00 74 00 69 00 6e 00 67 00 20 00 74 00 6f 00 20 00 72 00 61 00 69 00 73 00 65 00 20 00 79 00 6f 00 75 00 72 00 20 00 73 00 79 00 73 00 74 00 65 00 6d 00 20 00 73 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 } //1 This function allows the program to perform automatic updating to raise your system security
		$a_01_7 = {64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 69 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 20 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 20 00 63 00 6f 00 6e 00 66 00 6c 00 69 00 63 00 74 00 2e 00 20 00 53 00 6f 00 6d 00 65 00 20 00 61 00 70 00 70 00 6c 00 69 00 63 00 7a 00 74 00 69 00 6f 00 6e 00 20 00 74 00 72 00 69 00 65 00 73 00 20 00 74 00 6f 00 20 00 67 00 65 00 74 00 20 00 61 00 63 00 63 00 65 00 73 00 73 00 20 00 74 00 6f 00 20 00 73 00 79 00 73 00 74 00 65 00 6d 00 20 00 6b 00 65 00 72 00 6e 00 65 00 6c 00 } //1 detected internal software conflict. Some applicztion tries to get access to system kernel
		$a_01_8 = {70 00 72 00 6f 00 74 00 65 00 63 00 74 00 69 00 6f 00 6e 00 20 00 68 00 61 00 73 00 20 00 64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 53 00 70 00 79 00 77 00 61 00 72 00 65 00 20 00 70 00 72 00 6f 00 67 00 72 00 61 00 6d 00 20 00 57 00 69 00 6e 00 33 00 32 00 2e 00 4d 00 6f 00 6e 00 73 00 74 00 65 00 72 00 2e 00 66 00 78 00 20 00 74 00 68 00 61 00 74 00 20 00 69 00 73 00 20 00 74 00 72 00 79 00 69 00 6e 00 67 00 20 00 74 00 6f 00 20 00 61 00 74 00 74 00 61 00 63 00 6b 00 20 00 79 00 6f 00 75 00 72 00 } //1 protection has detected Spyware program Win32.Monster.fx that is trying to attack your
		$a_01_9 = {64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 20 00 61 00 20 00 50 00 72 00 69 00 76 00 61 00 63 00 79 00 20 00 56 00 69 00 6f 00 6c 00 61 00 74 00 69 00 6f 00 6e 00 2e 00 20 00 41 00 20 00 70 00 72 00 6f 00 67 00 72 00 61 00 6d 00 20 00 69 00 73 00 20 00 73 00 65 00 63 00 72 00 65 00 74 00 6c 00 79 00 20 00 73 00 65 00 6e 00 64 00 69 00 6e 00 67 00 20 00 79 00 6f 00 75 00 72 00 20 00 70 00 72 00 69 00 76 00 61 00 74 00 65 00 20 00 64 00 61 00 74 00 61 00 20 00 74 00 6f 00 20 00 61 00 6e 00 20 00 75 00 6e 00 74 00 72 00 75 00 73 00 74 00 65 00 64 00 } //1 detected a Privacy Violation. A program is secretly sending your private data to an untrusted
		$a_01_10 = {53 00 6f 00 6d 00 65 00 20 00 63 00 72 00 69 00 74 00 69 00 63 00 61 00 6c 00 20 00 73 00 79 00 73 00 74 00 65 00 6d 00 20 00 66 00 69 00 6c 00 65 00 73 00 20 00 6f 00 66 00 20 00 79 00 6f 00 75 00 72 00 20 00 63 00 6f 00 6d 00 70 00 75 00 74 00 65 00 72 00 20 00 77 00 65 00 72 00 65 00 20 00 6d 00 6f 00 64 00 69 00 66 00 69 00 65 00 64 00 20 00 62 00 79 00 20 00 6d 00 61 00 6c 00 69 00 63 00 69 00 6f 00 75 00 73 00 20 00 70 00 72 00 6f 00 67 00 72 00 61 00 6d 00 } //1 Some critical system files of your computer were modified by malicious program
		$a_01_11 = {53 00 70 00 79 00 77 00 61 00 72 00 65 00 2e 00 49 00 45 00 4d 00 6f 00 6e 00 73 00 74 00 65 00 72 00 20 00 61 00 63 00 74 00 69 00 76 00 69 00 74 00 79 00 20 00 64 00 65 00 74 00 65 00 63 00 74 00 65 00 64 00 2e 00 20 00 49 00 74 00 20 00 69 00 73 00 20 00 73 00 70 00 79 00 77 00 61 00 72 00 65 00 20 00 74 00 68 00 61 00 74 00 20 00 61 00 74 00 74 00 65 00 6d 00 70 00 74 00 73 00 20 00 74 00 6f 00 20 00 73 00 74 00 65 00 61 00 6c 00 20 00 70 00 61 00 73 00 73 00 77 00 6f 00 72 00 64 00 73 00 } //1 Spyware.IEMonster activity detected. It is spyware that attempts to steal passwords
		$a_01_12 = {53 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 20 00 63 00 65 00 6e 00 74 00 65 00 72 00 20 00 72 00 65 00 70 00 6f 00 72 00 74 00 73 00 20 00 74 00 68 00 61 00 74 00 20 00 27 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 32 00 30 00 31 00 30 00 27 00 20 00 69 00 73 00 20 00 69 00 6e 00 61 00 63 00 74 00 69 00 76 00 65 00 2e 00 20 00 41 00 6e 00 74 00 69 00 76 00 69 00 72 00 75 00 73 00 20 00 73 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 20 00 68 00 65 00 6c 00 70 00 73 00 20 00 74 00 6f 00 20 00 70 00 72 00 6f 00 74 00 65 00 63 00 74 00 } //1 Security center reports that 'Antivirus 2010' is inactive. Antivirus software helps to protect
		$a_01_13 = {45 00 52 00 52 00 4f 00 52 00 2e 00 20 00 45 00 2d 00 6d 00 61 00 69 00 6c 00 20 00 79 00 6f 00 75 00 20 00 65 00 6e 00 74 00 65 00 72 00 65 00 64 00 20 00 69 00 73 00 20 00 6e 00 6f 00 74 00 20 00 72 00 65 00 67 00 69 00 73 00 74 00 65 00 72 00 65 00 64 00 20 00 69 00 6e 00 20 00 6f 00 75 00 72 00 20 00 74 00 72 00 61 00 6e 00 73 00 61 00 63 00 74 00 69 00 6f 00 6e 00 20 00 64 00 61 00 74 00 61 00 62 00 61 00 73 00 65 00 2e 00 49 00 74 00 20 00 73 00 65 00 65 00 6d 00 73 00 20 00 74 00 68 00 61 00 74 00 20 00 70 00 75 00 72 00 63 00 68 00 61 00 73 00 65 00 } //1 ERROR. E-mail you entered is not registered in our transaction database.It seems that purchase
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*2+(#a_01_3  & 1)*2+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1) >=8
 
}